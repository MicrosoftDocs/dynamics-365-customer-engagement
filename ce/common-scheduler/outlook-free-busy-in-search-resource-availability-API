---
title: "Outlook free/busy schedules considered by Universal Resource Scheduling's search resource availability API | MicrosoftDocs"
description: "Learn how to include Outlook free/busy schedules when calling Universal Resource Scheduling's search resource availability API."
ms.date: 11/15/2021
ms.reviewer: krbjoran
ms.service: dynamics-365-field-service
ms.subservice: common-scheduler
ms.topic: article
applies_to: 
  - "Dynamics 365 (online)"
  - "Dynamics 365 Version 9.x"
author: salehasiddique-msft
ms.author: salsiddi
search.app: 
  - D365CE
  - D365FS
---


# Outlook Free/Busy Schedules included in search resource availability API 

Universal Resource Scheduling's search resource availability API can now consider Outlook appointments in Exchange, in addition to availability defined in Dynamics (through Bookings and Dataverse Appointments). Resources do not have to manually sync their Outlook appointments to Dataverse. Including a complete view of availability from both Exchange and Dynamics increases scheduler productivity and reduces avoidable scheduling errors. 


## Prerequisites

- Universal Resource Scheduling 3.12.64.x+, available in Field Service 8.8.52.x+ (October Wave 2 2021)


## Step 1: Enable setting to include Outlook free/busy in search resource availability API  

## Step 2: Enable setting to include Outlook free/busy in search resource availability API  

### At the organization level 

1. Go to **Resource Scheduling** > **Settings** > **Administration** > **Scheduling Parameters** and set **Include Appointments** to *Yes*.

> [!div class="mx-imgBorder"]
> ![Screenshot of organization level setting.](../media/OutlookFreeBusyInSAAPI-SchedulingParameters)

2. An informational dialog will appear. Select **Got it. Letâ€™s enable.** Then **Save and close**. 

> [!div class="mx-imgBorder"]
> ![Screenshot of dialog.](../media/OutlookFreeBusyInSAAPI-Dialog)

All resources are automatically opted-in the first time you enable the feature. You may opt out resources using the resource level setting, which is visible only if the organization level setting is set to *Yes*.  

### At the resource level 

The resource level setting will only show if the organization level setting is enabled - that is, if **Include Appointments** in **Resource Scheduling** > **Settings** > **Administration** > **Scheduling Parameters** is set to *Yes*. 

To control individual resources, go to the **Scheduling** tab on the resource form and change the **Include Appointments** field. 

> [!div class="mx-imgBorder"]
> ![Screenshot of resource level setting.](../media/OutlookFreeBusyInSAAPI-ResourceFlag)


## Step 3: Call the API 

You can create Dataverse appointments in Dynamics 365 apps like in
- [Customer Service Hub using Activities](/dynamics365/customer-service/customer-service-hub-user-guide-basics#understand-activities). 
- [Dynamics 365 Sales Professional to manage tasks, appointments, email, or phone calls](/dynamics365/sales-professional/manage-activities).

Dataverse appointments can also originate in Outlook, and be synced to Dynamics 365 if [server-side synchronization](/power-platform/admin/server-side-synchronization) has been set up. An Outlook appointment must be manually assigned the special [Tracked to Dynamics 365](/power-platform/admin/use-outlook-category-track-appointments-emails) category so it appears as a Dataverse appointment record.



For customers with Resource Scheduling Optimization, appointments will be respected in both non-interactive and interactive optimizations. 

- Non-interactive optimizations are triggered when an optimization schedule is run. 
- Interactive optimizations are triggered from the new schedule board, from **Optimize Schedule** (by right-clicking on a resource), the **Suggest resources (Preview)**, and **Book resources (Preview)** buttons that appear when a requirement is selected in the bottom grid. 

Appointments with statuses *Busy* and *Completed* will be considered as unavailable by scheduling operations. 


Meanwhile, developers can use the schedule assistant APIs for both requirements and requirement groups for:

- Custom web apps
- A Dynamics 365 portal 
- Power Apps canvas apps to support appointment scheduling scenarios. 

Some key points:

- This extensibility feature only works when directly calling the search resource availability APIs with **ConsiderOutlookSchedules** as _true_. Out of the box availability searches triggered from the Schedule Board or from the Book button on any schedulable entity do not consider Outlook schedules
- Reading schedules from Exchange will increase the time the Search Resource Availability API takes to retrieve results, depending on the number of resources and period of time being considered.
- The feature is available for search resource availability APIs for both requirements (**INSERT**) and requirement groups (**msdyn_SearchResourceAvailabilityForRequirementGroup**)
- To protect privacy, only the start and end times of resources' schedule items are read, along with their free/busy status
- Outlook appointments are considered as location agnostic

[!INCLUDE[footer-include](../includes/footer-banner.md)]
