---
title: "Outlook free/busy schedules considered by Universal Resource Scheduling's search resource availability API | MicrosoftDocs"
description: "Learn how to include Outlook free/busy schedules when calling Universal Resource Scheduling's search resource availability API."
ms.date: 11/15/2021
ms.reviewer: krbjoran
ms.service: dynamics-365-field-service
ms.subservice: common-scheduler
ms.topic: article
applies_to: 
  - "Dynamics 365 (online)"
  - "Dynamics 365 Version 9.x"
author: salehasiddique-msft
ms.author: salsiddi
search.app: 
  - D365CE
  - D365FS
---


# Outlook Free/Busy Schedules included in search resource availability API 

Universal Resource Scheduling's search resource availability API can now consider Outlook appointments in Exchange, in addition to availability defined in Dynamics (through Bookings and Dataverse Appointments). Resources do not have to manually sync their Outlook appointments to Dataverse. Including a complete view of availability from both Exchange and Dynamics increases scheduler productivity and reduces avoidable scheduling errors. 

Some key points:

- Developers are provided this extensibility feature to use when directly calling the search resource availability API. It is not available from availability searches triggered from the Schedule Board or from the Book button on any schedulable entity.  
- The feature is available for the search resouce availability APIs for both requirements and requirement groups
- The API retrieves only free/busy schedules and not the name of the appointments

feature is only available when directly calling the search resource availability API, and is not available from availability searches from the Schedule Board
- 
- Outlook appointments are considered as location agnostic
- Outlook free/busy schedules are t
- The legend shows the colors for various appointment statuses.



Developers are provided this extensibility feature to use when calling the search resource availability API for both requirements and requirement groups. They can make this API call from custom web apps, a Dynamics 365 portal or Power Apps canvas apps to support scheduling scenarios.  


Organizations often use appointments in Dynamics 365. Typical examples are a salesperson using appointments to meet with potential customers or a customer service rep creating a service appointment to help a customer with an issue. Other examples may include organizations creating appointments because of integrations with other systems.

Dynamics 365 Appointments ([Microsoft Dataverse appointments](/dynamics365/customer-engagement/web-api/appointment)) can be displayed on the Field Service schedule board alongside bookings and can be considered during scheduling to understand if a frontline worker or bookable resource is available. 


> [!div class="mx-imgBorder"]
> ![Screenshot of the schedule board with appointments.](./media/Appointment05-ScheduleBoard.png)

By including appointments on the schedule board and during the scheduling process, dispatchers can have an accurate view of availability in one place and don't have to switch between multiple tools such as Outlook, service calendar, and Field Service's new schedule board. This view increases scheduler productivity and reduces avoidable scheduling errors. Additionally, admins no longer need to create bookings based on appointments. 

For a guided walkthrough, check out the following video.

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RWEhqZ]

## Prerequisites

- Field Service 8.8.40.x+ (April Wave 1 2021)
- Resource Scheduling Optimization 3.3.0.108+, only if there is a requirement for appointments to be supported in optimization-related scheduling operations.

## Step 1: Enable setting to include Outlook free/busy in search resource availability API  

### At the organization level 

1. Go to **Resource Scheduling** > **Settings** > **Administration** > **Scheduling Parameters** and set **Include Appointments** to *Yes*.

> [!div class="mx-imgBorder"]
> ![Screenshot of organization level setting.](../media/OutlookFreeBusyInSAAPI-SchedulingParameters)

2. An informational dialog will appear. Select **Got it. Letâ€™s enable.** Then **Save and close**. 

> [!div class="mx-imgBorder"]
> ![Screenshot of dialog.](../media/OutlookFreeBusyInSAAPI-Dialog)

All resources are automatically opted-in the first time you enable the feature. You may opt out resources using the resource level setting, which is visible only if the organization level setting is set to *Yes*.  

### At the resource level 

The resource level setting will only show if the organization level setting is enabled - that is, if **Include Appointments** in **Resource Scheduling** > **Settings** > **Administration** > **Scheduling Parameters** is set to *Yes*. 

To control individual resources, go to the **Scheduling** tab on the resource form and change the **Include Appointments** field. 

> [!div class="mx-imgBorder"]
> ![Screenshot of resource level setting.](../media/OutlookFreeBusyInSAAPI-ResourceFlag)


## Step 2: Call the API 

You can create Dataverse appointments in Dynamics 365 apps like in
- [Customer Service Hub using Activities](/dynamics365/customer-service/customer-service-hub-user-guide-basics#understand-activities). 
- [Dynamics 365 Sales Professional to manage tasks, appointments, email, or phone calls](/dynamics365/sales-professional/manage-activities).

Dataverse appointments can also originate in Outlook, and be synced to Dynamics 365 if [server-side synchronization](/power-platform/admin/server-side-synchronization) has been set up. An Outlook appointment must be manually assigned the special [Tracked to Dynamics 365](/power-platform/admin/use-outlook-category-track-appointments-emails) category so it appears as a Dataverse appointment record.


## Step 3: View appointments on the schedule board

Appointments will be visible on the new schedule board for the required attendees and the owner, as long as they are set up as bookable resources. 

> [!div class="mx-imgBorder"]
> ![Screenshot of the schedule board with appointments.](./media/Appointment05-ScheduleBoard.png)


Some more key points:

- Appointments will show as read-only on the new schedule board and cannot be moved.
- Appointments are supported in all views of the new schedule board - namely the hourly, daily, weekly, and monthly views. 
- Hovering on an appointment shows more details in a card. 
- The legend shows the colors for various appointment statuses.


### Hide canceled appointments on the schedule board

If you do not wish to see canceled appointments on the new schedule board, the **Hide Canceled** tab-level setting accessible from the old schedule board will hide both canceled bookings and canceled appointments on the new schedule board. 

Go to the old schedule board using the toggle in the top-right. Open the tab and select the gear icon in the top-right of the schedule board. Check the **Hide Canceled** checkbox, and toggle back to the new schedule board. 

> [!div class="mx-imgBorder"]
> ![Screenshot of hide canceled tab setting in old schedule board.](./media/Appointment06-HideCanceledAppointment.png)


## Step 4: Respect appointments when scheduling 

For customers with Resource Scheduling Optimization, appointments will be respected in both non-interactive and interactive optimizations. 

- Non-interactive optimizations are triggered when an optimization schedule is run. 
- Interactive optimizations are triggered from the new schedule board, from **Optimize Schedule** (by right-clicking on a resource), the **Suggest resources (Preview)**, and **Book resources (Preview)** buttons that appear when a requirement is selected in the bottom grid. 

Appointments with statuses *Busy* and *Completed* will be considered as unavailable by scheduling operations. 

For customers without Resource Scheduling Optimization, the schedule assistant is planned to consider appointments in a future release. 

Meanwhile, developers can use the schedule assistant APIs for both requirements and requirement groups for:

- Custom web apps
- A Dynamics 365 portal 
- Power Apps canvas apps to support appointment scheduling scenarios. 

Some more key points:

- Scheduling operations will consider appointments as location-agnostic.
- If an appointment had related bookings, those bookings will not be shown and will not be considered in scheduling operations.


[!INCLUDE[footer-include](../includes/footer-banner.md)]
