(window.wordOnlineExpChunks=window.wordOnlineExpChunks||[]).push([[20],{1754:function(t,n,e){var o={"./af-ZA/canvas-contextual.json":[1097,25],"./am-ET/canvas-contextual.json":[1098,28],"./ar-SA/canvas-contextual.json":[1099,31],"./as-IN/canvas-contextual.json":[1100,34],"./az-Latn-AZ/canvas-contextual.json":[1101,37],"./be-BY/canvas-contextual.json":[1102,39],"./bg-BG/canvas-contextual.json":[1103,42],"./bn-BD/canvas-contextual.json":[1104,44],"./bn-IN/canvas-contextual.json":[1105,47],"./bs-Latn-BA/canvas-contextual.json":[1106,50],"./ca-ES/canvas-contextual.json":[1107,53],"./ca-Es-VALENCIA/canvas-contextual.json":[1108,56],"./chr-Cher-US/canvas-contextual.json":[1109,58],"./cs-CZ/canvas-contextual.json":[1110,61],"./cy-GB/canvas-contextual.json":[1111,64],"./da-DK/canvas-contextual.json":[1112,67],"./de-DE/canvas-contextual.json":[1113,70],"./el-GR/canvas-contextual.json":[1114,73],"./en-GB/canvas-contextual.json":[1115,76],"./en-US/canvas-contextual.json":[1116,78],"./es-ES/canvas-contextual.json":[1117,81],"./es-MX/canvas-contextual.json":[1118,84],"./et-EE/canvas-contextual.json":[1119,87],"./eu-ES/canvas-contextual.json":[1120,90],"./fa-IR/canvas-contextual.json":[1121,93],"./fi-FI/canvas-contextual.json":[1122,96],"./fil-PH/canvas-contextual.json":[1123,99],"./fr-CA/canvas-contextual.json":[1124,102],"./fr-FR/canvas-contextual.json":[1125,105],"./ga-IE/canvas-contextual.json":[1126,108],"./gd-gb/canvas-contextual.json":[1127,111],"./gl-ES/canvas-contextual.json":[1128,114],"./gu-IN/canvas-contextual.json":[1129,117],"./ha-Latn-NG/canvas-contextual.json":[1130,119],"./he-IL/canvas-contextual.json":[1131,122],"./hi-IN/canvas-contextual.json":[1132,125],"./hr-HR/canvas-contextual.json":[1133,128],"./hu-HU/canvas-contextual.json":[1134,131],"./hy-AM/canvas-contextual.json":[1135,134],"./id-ID/canvas-contextual.json":[1136,137],"./is-IS/canvas-contextual.json":[1137,140],"./it-IT/canvas-contextual.json":[1138,143],"./ja-JP/canvas-contextual.json":[1139,146],"./ka-GE/canvas-contextual.json":[1140,149],"./kk-KZ/canvas-contextual.json":[1141,152],"./km-KH/canvas-contextual.json":[1142,155],"./kn-IN/canvas-contextual.json":[1143,158],"./ko-KR/canvas-contextual.json":[1144,161],"./kok-IN/canvas-contextual.json":[1145,164],"./ky-KG/canvas-contextual.json":[1146,166],"./lb-LU/canvas-contextual.json":[1147,169],"./lo-LA/canvas-contextual.json":[1148,172],"./lt-LT/canvas-contextual.json":[1149,175],"./lv-LV/canvas-contextual.json":[1150,178],"./mi-NZ/canvas-contextual.json":[1151,181],"./mk-MK/canvas-contextual.json":[1152,184],"./ml-IN/canvas-contextual.json":[1153,187],"./mn-MN/canvas-contextual.json":[1154,189],"./mr-IN/canvas-contextual.json":[1155,192],"./ms-MY/canvas-contextual.json":[1156,195],"./mt-MT/canvas-contextual.json":[1157,198],"./nb-NO/canvas-contextual.json":[1158,201],"./ne-NP/canvas-contextual.json":[1159,204],"./nl-NL/canvas-contextual.json":[1160,207],"./nn-NO/canvas-contextual.json":[1161,210],"./or-IN/canvas-contextual.json":[1162,213],"./pa-IN/canvas-contextual.json":[1163,216],"./pl-PL/canvas-contextual.json":[1164,219],"./prs-AF/canvas-contextual.json":[1165,221],"./pt-BR/canvas-contextual.json":[1166,224],"./pt-PT/canvas-contextual.json":[1167,227],"./qps-ploc/canvas-contextual.json":[1168,229],"./qps-ploca/canvas-contextual.json":[1169,231],"./qps-plocm/canvas-contextual.json":[1170,233],"./quz-PE/canvas-contextual.json":[1171,236],"./ro-RO/canvas-contextual.json":[1172,239],"./ru-RU/canvas-contextual.json":[1173,242],"./sd-Arab-PK/canvas-contextual.json":[1174,244],"./si-LK/canvas-contextual.json":[1175,246],"./sk-SK/canvas-contextual.json":[1176,249],"./sl-SI/canvas-contextual.json":[1177,252],"./sq-AL/canvas-contextual.json":[1178,255],"./sr-Cyrl-BA/canvas-contextual.json":[1179,258],"./sr-Cyrl-RS/canvas-contextual.json":[1180,261],"./sr-Latn-RS/canvas-contextual.json":[1181,264],"./sv-SE/canvas-contextual.json":[1182,267],"./sw-KE/canvas-contextual.json":[1183,269],"./ta-IN/canvas-contextual.json":[1184,272],"./te-IN/canvas-contextual.json":[1185,275],"./th-TH/canvas-contextual.json":[1186,278],"./tk-TM/canvas-contextual.json":[1187,280],"./tr-TR/canvas-contextual.json":[1188,283],"./tt-RU/canvas-contextual.json":[1189,286],"./ug-CN/canvas-contextual.json":[1190,289],"./uk-UA/canvas-contextual.json":[1191,292],"./ur-PK/canvas-contextual.json":[1192,295],"./uz-Latn-UZ/canvas-contextual.json":[1193,298],"./vi-VN/canvas-contextual.json":[1194,301],"./zh-CN/canvas-contextual.json":[1195,304],"./zh-TW/canvas-contextual.json":[1196,307]};function i(t){if(!e.o(o,t))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[t],i=n[0];return e.e(n[1]).then((function(){return e.t(i,3)}))}i.keys=function(){return Object.keys(o)},i.id=1754,t.exports=i},2867:function(t,n,e){"use strict";e.r(n);var o,i=e(80),r=e(5);!function(t){t[t.CommentThread=0]="CommentThread",t[t.TrackedChange=1]="TrackedChange"}(o||(o={}));var a,s,c;function d(t){switch(t){case o.CommentThread:return i.b.CommentThread;case o.TrackedChange:return i.b.TrackedChange;default:return i.b.CommentThread}}!function(t){t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(a||(a={})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(s||(s={})),function(t){t[t.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(c||(c={}));var l,u=function(){function t(t,n,e){void 0===e&&(e=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.shouldUpdatePositions=!1,this.aggregateHeight=0,this.possibleTopForNextContainer=0,this.renderMode=i.e.Integrated,this.constructContainerId=t,this.ulsLogger=n,this.activeContainerAnchorLeft=e}return t.prototype.getAggregateHeight=function(){return this.aggregateHeight},t.prototype.calculateNewPositions=function(t,n,e){this.disableRepositioningAnimation=!!e&&!!e.disableRepositioningAnimation,this.positionFixed=!!e&&!!e.positionFixed,this.shouldUpdatePositions=!e||!1!==e.shouldUpdatePositions;var o=t[0];if(this.anchorLeft=o&&o.anchorLeft?o.anchorLeft:0,e&&e.activeContainerInfo){var i=e.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(t,n,i)}else{var r=e?e.topOfFirstContainer:void 0;this.setRestPositionOfContainers(t,n,r)}},t.prototype.updateContainersPositions=function(t,n,e){this.calculateNewPositions(t,n,e)},t.prototype.updateContainerPositionsAroundActiveContainer=function(t,n,e){var o=n[e.containerId];if(o){var i=o.floatingContainerRef,c=this.shouldUpdatePositions&&i?i.height():o.position.height;this.shouldUpdatePositions&&i&&(i.anchorPoint().y!==o.anchorTop||i.anchorPoint().x!==this.activeContainerAnchorLeft)&&i.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:o.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,e.containerId,Object(r.__assign)(Object(r.__assign)({},o.position),{x:this.activeContainerAnchorLeft,y:o.anchorTop})),this.updateContainerPositionsAboveActiveContainer(t,n,o.anchorTop,e.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(o,o.anchorTop,c),this.updateContainerPositionsDownwards(t,n,e.containerPositionIndex+1),this.aggregateHeight=e.containerPositionIndex===t.length-1?c+o.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,a.msoulscat_Wac_Telemetry,s.Error,"Floating container info does not exist for the active container Id: ".concat(e.containerId))},t.prototype.updateContainerPositionsDownwards=function(t,n,e,o){void 0===e&&(e=0),void 0===o&&(o=!1);for(var i={},r=e;r<t.length;r+=1){if((a=t[r])&&a.contentId){if(!(s=this.getFloatingContainerInfo(a,n)))continue;i[a.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}}for(r=e;r<t.length;r+=1){var a,s=this.getFloatingContainerInfo(t[r],n),c=(a=t[r])&&a.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(t[r],n,i[c]);if(r===t.length-1&&s&&(this.aggregateHeight=i[c]+s.position.y),o&&d)return}},t.prototype.updateContainerPositionsAboveActiveContainer=function(t,n,e,o){var i=t[0]?t[0].anchorTop:void 0;this.setRestPositionOfContainers(t.slice(0,o+1),n,i);for(var a=e,s=o;s>=0;s-=1){var c=this.getFloatingContainerInfo(t[s],n);if(void 0===c||this.getBottomPositionOfContainer(c)<=a)return;var d=c.floatingContainerRef,l=a-(this.shouldUpdatePositions&&d?d.height():c.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:l},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,this.getContainerId(t[s]),Object(r.__assign)(Object(r.__assign)({},c.position),{x:this.anchorLeft,y:l})),a=l}},t.prototype.setRestPositionOfContainers=function(t,n,e){var o;if(t.length>0){var i=this.getFloatingContainerInfo(t[0],n);if(void 0===i)return;var r=null===(o=i.floatingContainerRef)||void 0===o?void 0:o.anchorPoint().y,a=this.shouldUpdatePositions&&void 0!==r&&!this.positionFixed?r:i.position.y;this.possibleTopForNextContainer=null!=e?e:Math.max(i.anchorTop,a),this.updateContainerPositionsDownwards(t,n,0)}},t.prototype.getFloatingContainerInfo=function(t,n){return n[this.getContainerId(t)]},t.prototype.getContainerId=function(t){var n=t.contentId;return this.constructContainerId({contentId:n,contentType:d(t.containerContentType),renderMode:this.renderMode})},t.prototype.updateFloatingContainerPosition=function(t,n,e){var o=this.getFloatingContainerInfo(t,n);if(void 0===o)return!1;var i=this.shouldUpdatePositions&&o.floatingContainerRef?o.floatingContainerRef.anchorPoint().y:o.position.y,a=Math.max(this.possibleTopForNextContainer,o.anchorTop);return a!==i&&(this.shouldUpdatePositions&&o.floatingContainerRef&&o.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:a},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(n,this.getContainerId(t),Object(r.__assign)(Object(r.__assign)({},o.position),{x:this.anchorLeft,y:a}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(o,a,e),a===i},t.prototype.getBottomPositionOfContainer=function(t,n,e){void 0===n&&(n=void 0),void 0===e&&(e=void 0);var o,i,r=t.floatingContainerRef,a=null==r?void 0:r.anchorPoint().y;return this.shouldUpdatePositions&&r&&void 0!==a?(o=a,i=r.height()):(o=t.position.y,i=t.position.height),(null!=n?n:o)+(null!=e?e:i)+10},t.prototype.updateFloatingContainerPositionInCache=function(t,n,e){t[n].position=e},t}(),p=e(2501),h=function(){function t(t){this.eventSink=t}return t.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},t}(),C=function(){function t(){this.handlers=[]}return t.prototype.subscribe=function(t){var n=new h(this);return this.handlers.push({subscription:n,handler:t}),n},t.prototype.unsubscribe=function(t){this.handlers=this.handlers.filter((function(n){return n.subscription!==t}))},t.prototype.trigger=function(t){this.handlers.forEach((function(n){return n.handler(t,n.subscription)}))},t}(),f=function(){function t(t){this.onContainerShouldBeCreated=new C,this.motionDuration=p.b.duration4,this.posUpdateAnimationsInProgress=!1,this.containerVirtualizationEnabled=!1,t&&(this.containerVirtualizationEnabled=!!t.containerVirtualizationEnabled)}return t.prototype.updateContainersVisibility=function(t,n,e,o,i){var r=this;if(void 0===e&&(e=!1),void 0===i&&(i=!1),n.height>0){var a={viewportTop:n.y-n.height/2,viewportBottom:n.y+1.5*n.height,containerIdToInfoMap:t,activeContainerId:o};if(!i&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(e,a);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(a),setTimeout((function(){r.updatePositions(a,e),window.clearTimeout(r.hideContainersTimeout),r.hideContainersTimeout=window.setTimeout((function(){r.hideContainersOutsideViewport(a),r.posUpdateAnimationsInProgress=!1}),parseInt(r.motionDuration,10))}),0)}},t.prototype.handleContainerVirtualization=function(t,n){var e=this;Object.keys(n.containerIdToInfoMap).forEach((function(o){var i=e.extractContainerInfo(o,n);e.updateContainerVisibility(i,n.activeContainerId===o),e.updateContainerPosition(i,t)}))},t.prototype.showContainersComingIntoViewport=function(t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(e){var o=n.extractContainerInfo(e,t);n.updateContainerVisibility(o,t.activeContainerId===e)}))},t.prototype.hideContainersOutsideViewport=function(t){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(e){var o=n.extractContainerInfo(e,t);n.updateContainerVisibility(o,t.activeContainerId===e)}))},t.prototype.updatePositions=function(t,n){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(o){var i=e.extractContainerInfo(o,t);e.updateContainerPosition(i,n)}))},t.prototype.updateContainerVisibility=function(t,n){if(t.containerRef&&t.containerElement){var e=t.isContainerInViewport||n;t.containerElement.style.display=e?"block":"none",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!e)}},t.prototype.updateContainerPosition=function(t,n){var e=t.containerElement;e&&(e.style.top="".concat(t.containerPosition.y,"px"),e.style.left="".concat(t.containerPosition.x,"px"),e.style.transitionDuration=n?"0ms":this.motionDuration)},t.prototype.extractContainerInfo=function(t,n){var e,o=n.containerIdToInfoMap[t],i=o.floatingContainerRef,r=o.position,a={containerElement:void 0,isContainerInViewport:r.y+r.height>=n.viewportTop&&r.y<=n.viewportBottom,containerRef:void 0,containerPosition:r};return i&&(a.containerRef=i,a.containerElement=null===(e=document.getElementById(i.parentDivId()))||void 0===e?void 0:e.querySelector("[id ^= 'floatingContainerView']")),a},t}(),v=e(19),g=e(2493),I=e(257),m=e(4),y=e(28),T=e(47);!function(t){t[t.Enablement=1]="Enablement",t[t.Focus=2]="Focus",t[t.Hover=3]="Hover",t[t.Resize=4]="Resize",t[t.Visibility=5]="Visibility"}(l||(l={}));var b,x=e(230);function P(t,n){return{type:t,payload:n}}!function(t){t.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",t.EmptyActionType="",t.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",t.RepositionType="REPOSITION_FLOATING_CONTAINER",t.SetContentType="SET_CONTENT",t.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION",t.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",t.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",t.UpdateContentSetItemDetailsType="UPDATE_CONTENT_SET_ITEM_DETAILS"}(b||(b={}));var A={anchorPoint:{x:0,y:0}};function R(t,n){var e;return void 0===n&&(n=A),{anchorPoint:n.anchorPoint,contentIdentifier:t,disableRepositioningAnimation:!1,isVisible:!1,isVirtualized:!1,maxDimensions:n.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1,accessibilityMetadata:null!==(e=n.accessibilityMetadata)&&void 0!==e?e:{}}}var E={contentId:"",contentType:i.b.Empty};function S(t,n){switch(void 0===t&&(t=R(E)),void 0===n&&(n=P(b.EmptyActionType,{})),n.type){case b.ChangeRenderedContentIdentifierType:return function(t,n){if(t.contentIdentifier.contentId===n.payload.newContentIdentifier.contentId&&t.contentIdentifier.contentType===n.payload.newContentIdentifier.contentType)return t;return Object(r.__assign)(Object(r.__assign)({},t),{contentIdentifier:n.payload.newContentIdentifier})}(t,n);case b.RemoveVisibilityAnimationType:return function(t){return Object(r.__assign)(Object(r.__assign)({},t),{useVisibilityAnimation:!1})}(t);case b.RepositionType:return function(t,n){if(t.anchorPoint.x===n.payload.anchorPoint.x&&t.anchorPoint.y===n.payload.anchorPoint.y&&t.disableRepositioningAnimation===n.payload.disableRepositioningAnimation&&t.positionFixed===n.payload.positionFixed)return t;return Object(r.__assign)(Object(r.__assign)({},t),{anchorPoint:n.payload.anchorPoint,disableRepositioningAnimation:n.payload.disableRepositioningAnimation,positionFixed:n.payload.positionFixed})}(t,n);case b.SetContentType:return function(t,n){return Object(r.__assign)(Object(r.__assign)({},t),{content:n.payload.content,isVisible:!!n.payload.content&&t.isVisible})}(t,n);case b.UpdateContentMaxDimensionsType:return function(t,n){if(t.maxDimensions.height===n.payload.maxDimensions.height&&t.maxDimensions.width===n.payload.maxDimensions.width)return t;return Object(r.__assign)(Object(r.__assign)({},t),{maxDimensions:n.payload.maxDimensions})}(t,n);case b.UpdateContentSetItemDetailsType:return function(t,n){var e,o=null===(e=t.accessibilityMetadata)||void 0===e?void 0:e.setItem,i=n.payload.setItemDetails;if(o===i)return t;if(o&&i&&o.positionInSet===i.positionInSet&&o.setSize===i.setSize&&o.level===i.level)return t;return Object(r.__assign)(Object(r.__assign)({},t),{accessibilityMetadata:Object(r.__assign)(Object(r.__assign)({},t.accessibilityMetadata),{setItem:i})})}(t,n);case b.UpdateContainerVisibilityType:return function(t,n){return Object(r.__assign)(Object(r.__assign)({},t),{isVisible:n.payload.isVisible,useVisibilityAnimation:n.payload.useVisibilityAnimation})}(t,n);case b.UpdateContainerVirtualizationType:return function(t,n){return Object(r.__assign)(Object(r.__assign)({},t),{isVirtualized:n.payload.isVirtualized})}(t,n);default:return t}}function F(t){return P(b.SetContentType,{content:t})}var j=function(t){return t.isVirtualized},O=e(50),w=e(814),_=Object(O.bb)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),D=Object(O.bb)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),k=Object(w.c)((function(t,n,e,o){return{floatingContainerView:Object(O.eb)({animationName:n?t?_:D:void 0,animationDuration:"".concat(300,"ms"),animationTimingFunction:p.c.decelerate,background:"transparent",position:o?"fixed":"absolute",transitionDuration:t&&!e?p.b.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:p.c.decelerate,visibility:t?"visible":"hidden"})}}));var M=e(2790),V=e(647);function U(t){return"floatingContainerView".concat(t.contentId,"Type").concat(t.contentType)}var N=function(t){function n(n){var e=t.call(this,n)||this;return e.handleResizeUpdates=function(t){t.forEach((function(t){e.props.onContainerStateChanged.trigger({stateChangeType:l.Resize,contentIdentifier:e.props.contentIdentifier,contentRect:t.contentRect})}))},e.triggerVisibilityUpdateNotification=function(){e.props.onContainerStateChanged.trigger({stateChangeType:l.Visibility,contentIdentifier:e.props.contentIdentifier,isVisible:e.props.isVisible})},e.getHostedResource=function(t){return{id:t}},e.onFocusChange=function(t,n){var o=t.relatedTarget||document.activeElement;e.parentDivRef&&o instanceof HTMLElement&&e.parentDivRef.contains(o)||e.props.onContainerStateChanged.trigger({stateChangeType:l.Focus,contentIdentifier:e.props.contentIdentifier,isFocused:n})},e.onFocusOut=function(t){e.onFocusChange(t,!1)},e.onFocusIn=function(t){e.onFocusChange(t,!0)},e.onMouseEnter=function(){e.props.onContainerStateChanged.trigger({stateChangeType:l.Hover,contentIdentifier:e.props.contentIdentifier,isHovered:!0})},e.onMouseLeave=function(){e.props.onContainerStateChanged.trigger({stateChangeType:l.Hover,contentIdentifier:e.props.contentIdentifier,isHovered:!1})},e.setContentRef=function(t){e.contentRef=t},e.setParentDivRef=function(t){t!==e.parentDivRef&&(e.parentDivRef&&(e.resizeObserver.unobserve(e.parentDivRef),e.parentDivRef.removeEventListener("focusin",e.onFocusIn,!0),e.parentDivRef.removeEventListener("focusout",e.onFocusOut,!0)),t&&(e.resizeObserver.observe(t),t.addEventListener("focusin",e.onFocusIn,!0),t.addEventListener("focusout",e.onFocusOut,!0))),e.parentDivRef=t},e.contentRef=void 0,e.parentDivRef=void 0,e.resizeObserver=new V.a((function(t){window.requestAnimationFrame((function(){e.handleResizeUpdates(t)}))})),e.setContentRef=e.setContentRef.bind(e),e.setParentDivRef=e.setParentDivRef.bind(e),e.getHostedResource=Object(M.a)(e.getHostedResource.bind(e)),e}return Object(r.__extends)(n,t),n.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},n.prototype.componentDidUpdate=function(t){var n=this,e=!1;t.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?e=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){e&&n.triggerVisibilityUpdateNotification(),n.props.removeVisibilityAnimation()}),300)},n.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},n.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},n.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},n.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var t=k(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),n=this.props.content;return m.createElement("div",{key:U(this.props.contentIdentifier),id:U(this.props.contentIdentifier),ref:this.setParentDivRef,className:t.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x,top:this.props.anchorPoint.y}},m.createElement(n,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized,accessibilityMetadata:this.props.accessibilityMetadata}))},n}(m.Component);var L,z=Object(T.connect)((function(t){return{accessibilityMetadata:t.accessibilityMetadata,anchorPoint:t.anchorPoint,content:t.content,contentIdentifier:t.contentIdentifier,disableRepositioningAnimation:t.disableRepositioningAnimation,isVisible:t.isVisible,isVirtualized:t.isVirtualized,maxDimensions:t.maxDimensions,positionFixed:t.positionFixed,useVisibilityAnimation:t.useVisibilityAnimation}}),(function(t,n){return{removeVisibilityAnimation:function(){t(P(b.RemoveVisibilityAnimationType,{}))}}}),void 0,{forwardRef:!0})(N),H=function(){function t(t,n,e,o){var i;this.onContainerStateChanged=new C,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===o.isDraftContainer&&(this.floatingContainerCreationActivity=Object(v.k)().createActivityObject("FloatingContainerCreation",Object(v.l)(v.g.GlobalAPI),Object(v.j)())),this.store=(i=R(e,o))?Object(x.createStore)(S,i):Object(x.createStore)(S),this.extensionProvider=n,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=o.containerId||Object(g.a)(),t.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(e),this.render()}return t.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},t.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},t.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},t.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},t.prototype.parentDivId=function(){return this.parentDiv.id},t.prototype.observeStore=function(t){var n=this;if(Object(i.i)(this.extensionProvider)){var e=t;this.unsubscribeStoreListener=this.store.subscribe((function(){var t=n.contentIdentifier();e.contentId===t.contentId&&e.contentType===t.contentType||(e=t,n.removeExtensionUpdatedEventSubscription(),n.setContentFromExtension())}))}},t.prototype.setContentFromExtension=function(){var t=this,n=void 0;if(Object(i.i)(this.extensionProvider)){if(n=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=n.onUpdated.subscribe((function(n){t.onUpdatedEventHandler()}))),n.priority===i.d.Disabled)return this.canShow=!1,void this.store.dispatch(F(void 0))}else n=this.extensionProvider.getExtension();this.canShow=!0,Object(I.d)().getComponent(n.componentKey).then((function(n){t.store.dispatch(F(n.component)),t.floatingContainerCreationActivity&&(t.floatingContainerCreationActivity.successTag(593872975),t.floatingContainerCreationActivity=void 0)})).catch((function(t){Object(v.k)().assertConditionTag(!1,"Error when registering component in setContentFromExtension ".concat(t),595632583)}))},t.prototype.render=function(){var t={onContainerStateChanged:this.onContainerStateChanged};y.render(m.createElement(T.Provider,{store:this.store},m.createElement(z,Object(r.__assign)({ref:this.setFloatingContainerRef},t))),this.parentDiv)},t.prototype.updateContainerPosition=function(t){var n,e,o;this.store.dispatch((n=t.anchorPoint,e=!!t.disableRepositioningAnimation,o=!!t.positionFixed,P(b.RepositionType,{anchorPoint:n,disableRepositioningAnimation:e,positionFixed:o})))},t.prototype.updateMaximumDimensions=function(t){this.store.dispatch(function(t){return P(b.UpdateContentMaxDimensionsType,{maxDimensions:t})}(t))},t.prototype.updateSetItemDetails=function(t){this.store.dispatch(function(t){return P(b.UpdateContentSetItemDetailsType,{setItemDetails:t})}(t))},t.prototype.updateContainerVirtualization=function(t){t&&!j(this.store.getState())?this.store.dispatch(P(b.UpdateContainerVirtualizationType,{isVirtualized:!0})):j(this.store.getState())&&this.store.dispatch(P(b.UpdateContainerVirtualizationType,{isVirtualized:!1}))},t.prototype.showFloatingContainer=function(t){return!!this.canShow&&(this.store.dispatch(function(t){return P(b.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:t})}(!!t)),!0)},t.prototype.hideFloatingContainer=function(t){this.store.dispatch(function(t){return P(b.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:t})}(!!t))},t.prototype.destroyFloatingContainer=function(t){var n=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(t),t?setTimeout((function(){n.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},t.prototype.cleanupDomOnDestroy=function(){y.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},t.prototype.isShowing=function(){return this.store.getState().isVisible},t.prototype.setFocus=function(){var t=this;this.floatingContainerRef?this.floatingContainerRef.setFocus():setTimeout((function(){var n;return null===(n=t.floatingContainerRef)||void 0===n?void 0:n.setFocus()}))},t.prototype.changeRenderedContentIdentifier=function(t){this.store.dispatch(function(t){return P(b.ChangeRenderedContentIdentifierType,{newContentIdentifier:t})}(t))},t.prototype.onUpdatedEventHandler=function(){var t=this.canShow;this.setContentFromExtension(),t!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:l.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},t.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},t.prototype.setFloatingContainerRef=function(t){this.floatingContainerRef=null!=t?t:void 0},t}(),B=new(function(){function t(){}return t.prototype.createFloatingContainer=function(t,n,e,o){return new H(t,n,e,o)},t}()),W=e(1222);!function(t){t[t.DeselectionEnabled=0]="DeselectionEnabled",t[t.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",t[t.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",t[t.ShouldInitialize=3]="ShouldInitialize",t[t.ScrollingPerfImprovementEnabled=4]="ScrollingPerfImprovementEnabled",t[t.SynchronousContainerPositioningEnabled=5]="SynchronousContainerPositioningEnabled",t[t.TrackChangesInSidetrackEnabled=6]="TrackChangesInSidetrackEnabled",t[t.ContentNavigationApiEnabled=7]="ContentNavigationApiEnabled",t[t.ReturnToDraftFixEnabled=8]="ReturnToDraftFixEnabled"}(L||(L={}));var G,Q=e(2465),q=e(1390),K=e(295),Z=e(2906);!function(t){t[t.Focus=0]="Focus"}(G||(G={}));var J=e(172);function Y(t){return"".concat(t.contentId,"_").concat(t.contentType,"_").concat(t.renderMode)}function X(t){switch(t){case i.b.CommentThread:return o.CommentThread;case i.b.TrackedChange:return o.TrackedChange;default:return o.CommentThread}}var $=function(t){var n=t.id,e=t.containerContent,o=t.componentRef,a=m.useState(e),s=a[0],c=a[1],d=m.useCallback((function(t){var n;switch(t.type){case"content":c(t.data);break;case"behavior":t.data.action===G.Focus&&(null===(n=p.current)||void 0===n||n.focus())}}),[]),l=yt.getTrackChangesStore(),u=yt.getFCContentNavigationAPI(),p=m.useRef(null),h=m.useCallback((function(){var t;null===(t=p.current)||void 0===t||t.focus()}),[]),C=m.useCallback((function(){return n}),[n]);m.useEffect((function(){return l.registerOnStoreUpdate(n,d),o&&o({focus:h,getInstanceId:C}),function(){l.removeFromStore(n)}}),[n,o,d,l,h,C]);var f=m.useMemo((function(){var t,n;return{definitionType:"TrackChangeDefinition",authorName:null!==(t=s.authorName)&&void 0!==t?t:"",authorColor:null!==(n=s.authorColor)&&void 0!==n?n:"",changeDescriptor:s.changeDescriptor,acceptDisabled:!!s.acceptDisabled,rejectDisabled:!!s.rejectDisabled,theme:s.theme}}),[s]),v=m.useMemo((function(){return l.cardStrings}),[l.cardStrings]),g=m.useMemo((function(){return l.getCardActionCallbacks(n)}),[n,l]),I=m.useMemo((function(){return{definition:f,strings:v,onAcceptHoverIn:g.onAcceptHoverIn,onRejectHoverIn:g.onRejectHoverIn,onAcceptHoverOut:g.onAcceptHoverOut,onRejectHoverOut:g.onRejectHoverOut,onAcceptClick:g.onAcceptClick,onRejectClick:g.onRejectClick,style:l.cardStyles}}),[f,v,g.onAcceptHoverIn,g.onRejectHoverIn,g.onAcceptHoverOut,g.onRejectHoverOut,g.onAcceptClick,g.onRejectClick,l]),y=m.useCallback((function(){g.onCardClick(),h()}),[g,h]),T=m.useCallback((function(){g.onCardHoverIn()}),[g]),b=m.useCallback((function(){g.onCardHoverOut()}),[g]),x=m.useCallback((function(t){var e,o="ArrowDown"===(e=t.key)||"Down"===e?J.d.Next:"ArrowUp"===e||"Up"===e?J.d.Previous:J.d.None;o!==J.d.None&&(null==u||u.selectNextOrPreviousContent({selectDirection:o,preventLooping:!1,reason:J.c.Keyboarding,restrictToCurrentContext:!0,from:{contentId:n,contentType:i.b.TrackedChange}}),t.preventDefault())}),[u,n]),P=m.useMemo((function(){var t,n=(null===(t=s.theme)||void 0===t?void 0:t.borderColor)?"1px solid ".concat(s.theme.borderColor):void 0;return Object(O.eb)({outline:"none",boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0,0,0,0.14)",borderRadius:"4px",":hover":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0,0,0,0.14)"},border:n,":focus":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 8px 16px rgba(0,0,0,0.14)"}})}),[s]);return m.createElement("div",{onClick:y,onMouseEnter:T,onMouseLeave:b,onKeyDown:x,tabIndex:0,ref:p,className:P},m.createElement(Z.a,Object(r.__assign)({},I)))},tt=function(t){var n,e,o=yt.getTrackChangesStore().getContainerContent(null===(n=t.resource)||void 0===n?void 0:n.id);return o?m.createElement($,{id:null===(e=t.resource)||void 0===e?void 0:e.id,containerContent:o,componentRef:t.componentRef}):null};var nt=e(899),et=e(1609),ot={width:0,height:0,x:0,y:0};function it(t){return void 0!==t.hasBeenRendered}var rt=function(){function t(t,n,e,o,r){var a=this;this.supportedContentTypes=[i.b.CommentThread,i.b.TrackedChange],this.getContentCardIndex=function(t,n){if(!a.containerIdToInfoMap[t])return a.ULS.sendTraceTag(595883362,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[getContentCardIndex]Container with id ".concat(t," does not exist.")),-1;var e=a.containerIdToInfoMap[t].anchorTop;e=n?Math.max(e,n):e;for(var o=a.getContentCardInsertionPoint(e),i=o;i<a.contentAnchorPositions.length;i+=1)if(a.checkIfContainerIdCorrespondsToGivenPosition(t,i))return i;for(i=0;i<o;i+=1)if(a.checkIfContainerIdCorrespondsToGivenPosition(t,i))return i;return-1},this.initializeExtensionProviderCollection=function(t){a.extensionProviderCollection=a.contentExtensionHostAPIGetter().getExtensions(a.supportedContentTypes,i.c),a.updateContentTypeToExtensionProviderMap(t),a.extensionProviderCollection.onUpdated.subscribe((function(){return a.updateContentTypeToExtensionProviderMap(t)}))},this.getContentCardInsertionPoint=function(t){for(var n,e=0,o=a.contentAnchorPositions.length;e<o;){n=e+Math.floor((o-e)/2),a.contentAnchorPositions[n].anchorTop<t-4?e=n+1:o=n}return e},this.getContainerStateChangedCallback=function(t,n){return function(e,o){switch(e.stateChangeType){case l.Resize:t(e,o);break;case l.Visibility:if(e.isVisible)if(!a.commentsTTVRReported)n===a.lastCommentVisibleID&&(Object(nt.e)(nt.d,{component:"canvas",subComponent:"floatingComments",state:et.c}),Object(nt.e)(nt.d,{component:"canvas",subComponent:"floatingComments",state:et.a}),a.commentsTTVRReported=!0)}}},this.renderFloatingContainerAtAnchorPosition=function(t){var n=a.containerIdToInfoMap[t];n&&n.floatingContainerRef&&n.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=function(t){a.contentTypeToExtensionProviderMap.clear(),void 0!==a.extensionProviderCollection?(a.areCommentExtensionProvidersDefinedOnce||(a.areCommentExtensionProvidersDefinedOnce=0!==a.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===i.b.CommentThread&&t.scope.renderMode===i.e.Integrated})).length),a.extensionProviderCollection.providers.forEach((function(t){t.scope.renderMode===i.e.Integrated&&a.contentTypeToExtensionProviderMap.set(t.scope.contentType,t)})),t()):a.ULS.sendTraceTag(595886287,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"extensionProviderCollection should not be null")},this.contentExtensionHostAPIGetter=t,this.dhcContainerPanel=n,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=r||ot,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=e,this.ULS=o,this.processedContainersVisibleAtBoot=!1,this.isFirstCommentRenderDone=!1,this.lastCommentVisibleID="",this.commentsTTVRReported=!1}return t.prototype.addContentAnchorPosition=function(t,n,e){void 0===n&&(n=0),void 0===e&&(e=-1);var o=e>-1?e:this.getContentCardInsertionPoint(t.anchorTop)+n;return this.contentAnchorPositions.splice(o,0,t),o},t.prototype.getContainerIdToInfoMap=function(){return this.containerIdToInfoMap},t.prototype.getContentAnchorPositions=function(){return this.contentAnchorPositions},t.prototype.getContentAnchorPosition=function(t){var n=this.getContentCardIndex(t);if(n>-1)return this.contentAnchorPositions[n]},t.prototype.initializeAndRenderFloatingContainer=function(t,n,e,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var r;return r=this.initializeFloatingContainerState(t,e,o,i),i&&this.renderFloatingContainerAtAnchorPosition(n),r},t.prototype.isContainerInViewPort=function(t){return t>this.viewportInfo.y-.5*this.viewportInfo.height&&t<this.viewportInfo.y+1.5*this.viewportInfo.height},t.prototype.removeContentAnchorPosition=function(t){var n=this.getContentCardIndex(t);return-1===n?(this.ULS.sendTraceTag(595736577,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[RemoveContentAnchorPosition]Content anchor position for id ".concat(t," does not exist.")),-1):(this.contentAnchorPositions.splice(n,1),n)},t.prototype.checkIfContainerIdCorrespondsToGivenPosition=function(t,n){return t===this.getContainerIdUsingPositionalIndex(n)},t.prototype.getContainerIdUsingPositionalIndex=function(t){var n=this.contentAnchorPositions[t];return Y({contentId:n.contentId,contentType:d(n.containerContentType),renderMode:i.e.Integrated})},t.prototype.createFloatingContainer=function(t,n,e,o){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,t,{contentId:n.contentId,contentType:d(n.containerContentType)},{anchorPoint:{x:0,y:e},isDraftContainer:o});this.ULS.sendTraceTag(595883361,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")},t.prototype.initializeFloatingContainerState=function(t,n,e,o){if(t){var a=this.contentTypeToExtensionProviderMap.get(d(t.containerContentType));if(void 0===a)return this.ULS.sendTraceTag(595883363,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[initializeFCState]ExtensionProvider not found for contentType ".concat(t.containerContentType)),!1;var s=t.contentId;if(!s)return this.ULS.sendTraceTag(595883407,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[initializeFCState]ContentId is null or empty."),!1;var c=Y({contentId:s,contentType:d(t.containerContentType),renderMode:i.e.Integrated}),l=void 0;if(e){if(!(l=this.createFloatingContainer(a,{contentId:s,containerContentType:t.containerContentType},t.anchorTop,o)))return this.ULS.sendTraceTag(595886286,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[createFloatingContainer] Could not create fc for content id ".concat(s)),!1;l.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(n,c))}if(this.containerIdToInfoMap[c])this.containerIdToInfoMap[c].floatingContainerRef=l;else{var u=Object(r.__assign)(Object(r.__assign)({position:{height:0,width:0,x:0,y:t.anchorTop}},this.containerIdToInfoMap[c]),{anchorTop:t.anchorTop,floatingContainerRef:l,hasBeenRendered:!1});this.containerIdToInfoMap[c]=u}return!0}return!1},t}(),at=function(){function t(t,n,e,a,s,c,u,p){var h=this;this.floatingContainerPositioner=t,this.floatingContainerVirtualizer=n,this.store=e,this.featureSettings=c,this.trackChangesStore=p,this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.containerCreationTimers={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=void 0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.draftContainerId="",this.emitEvent=function(t,n){if(h.store.isCommentPaneOpen||!h.store.dhcContainerPanel||!h.store.areCommentExtensionProvidersDefinedOnce)return h.store.ULS.sendTraceTag(538022540,Q.a.msoulscat_Wac_Telemetry,q.a.Warning,"FCM not handling the event. {\n          isCommentPaneOpen: ".concat(h.store.isCommentPaneOpen,",\n          dhcContainerPanelNotDefined: ").concat(!h.store.dhcContainerPanel,",\n          extensionProvidersNotDefined: ").concat(!h.store.areCommentExtensionProvidersDefinedOnce,"\n        }")),void(n&&n.viewportInfo&&(h.store.viewportInfo=n.viewportInfo));switch(t){case 0:if(n&&n.contentAnchorPosition){var e=n.contentAnchorPosition.contentId,r=n.noOfPrecedingThreadsOnSameLine?n.noOfPrecedingThreadsOnSameLine:0;if(!e)return void h.store.ULS.sendTraceTag(595903774,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[AddContainer]ContentId is null.");var a=Y({contentId:e,contentType:d(n.contentAnchorPosition.containerContentType),renderMode:i.e.Integrated}),s=h.store.getContainerIdToInfoMap()[a];if(void 0!==h.containerCreationTimers[a])return void h.store.ULS.sendTraceTag(509634193,Q.a.msoulscat_Wac_Telemetry,q.a.Warning,"[AddContainer]Container Creation in queue.");if(s&&s.floatingContainerRef)return void h.store.ULS.sendTraceTag(595097123,Q.a.msoulscat_Wac_Telemetry,q.a.Warning,"[AddContainer]Container already exists.");var c=h.store.initializeAndRenderFloatingContainer(n.contentAnchorPosition,a,h.onContainerResize,void 0,!0);if(h.draftContainerId=e,c){h.store.addContentAnchorPosition(n.contentAnchorPosition,r);var l={contentId:e,containerContentType:n.contentAnchorPosition.containerContentType};n.shouldSetFocus&&h.emitEvent(2,{containerContentDescriptor:l})}}break;case 1:if(n&&n.containerContentDescriptor){if(!n.containerContentDescriptor.contentId)return void h.store.ULS.sendTraceTag(595903775,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[DeleteContainer]ContentId is null.");a=Y({contentId:n.containerContentDescriptor.contentId,contentType:d(n.containerContentDescriptor.containerContentType),renderMode:i.e.Integrated});if(!(s=h.store.getContainerIdToInfoMap()[a]))return void h.store.ULS.sendTraceTag(595723333,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[DeleteContainer]Container info for id ".concat(a," does not exist."));var u=s.position.y,p=h.deleteContainer(a,!!n.animateOutOnDeletion);if(-1===p)return;h.store.activeContainerId&&h.store.activeContainerId!==a?h.positionFloatingContainers(h.store.getContentAnchorPositions(),void 0,h.store.activeContainerId):h.positionFloatingContainers(h.store.getContentAnchorPositions().slice(p),u)}break;case 2:if(n&&n.containerContentDescriptor){if(!n.containerContentDescriptor.contentId)return void h.store.ULS.sendTraceTag(595903777,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[FocusContainer]ContentId is null.");var C=Y({contentId:n.containerContentDescriptor.contentId,contentType:d(n.containerContentDescriptor.containerContentType),renderMode:i.e.Integrated});if(!h.store.getContainerIdToInfoMap()[C])return h.store.ULS.sendTraceTag(595903778,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[FocusContainer]Container with id ".concat(C," does not exist")),void h.setInitialActiveContainerIdV2(n.containerContentDescriptor,null);h.store.activeContainerId!==C&&(h.clearSelection(!0),h.positionFloatingContainers(h.store.getContentAnchorPositions(),void 0,C,void 0,!0));var f=h.store.getContainerIdToInfoMap()[C].floatingContainerRef;n.shouldSetFocus&&f&&f.setFocus(),h.store.activeContainerId=C}break;case 3:if(n&&n.contentAnchorPositions){if(n.containerContentByType&&n.containerContentByType[o.TrackedChange])for(var v=n.containerContentByType[o.TrackedChange],g=0,I=Object.entries(v);g<I.length;g++){var m=I[g],y=m[0],T=m[1];h.trackChangesStore.addOrUpdateStore(y,T)}h.processContentAnchorPositionsInView(n.contentAnchorPositions)}break;case 4:n&&n.viewportInfo&&(h.store.viewportInfo=n.viewportInfo,h.featureSettings.SynchronousContainerPositioningEnabled||h.positionFloatingContainers());break;case 5:if(n&&n.infoToReplaceContent){var b=n.infoToReplaceContent.currentContentId,x=n.infoToReplaceContent.newContentId;if(!b||!x)return void h.store.ULS.sendTraceTag(595855174,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[ReplaceContainerContent]".concat(b?"NewContentId":"CurrentContentId"," is null."));var P=Y({contentId:b,contentType:d(n.infoToReplaceContent.containerContentType),renderMode:i.e.Integrated});if(!(s=h.store.getContainerIdToInfoMap()[P]))return void h.store.ULS.sendTraceTag(595855175,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[ReplaceContainerContent]ContainerInfo for id ".concat(P," does not exist"));if(!s.floatingContainerRef)return void h.store.ULS.sendTraceTag(595855176,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[ReplaceContainerContent]FloatingContainerRef with id ".concat(P," does not exist"));s.floatingContainerRef.changeRenderedContentIdentifier({contentId:x,contentType:d(n.infoToReplaceContent.containerContentType)}),h.replacementContentId=x;var A=Y({contentId:x,contentType:d(n.infoToReplaceContent.containerContentType),renderMode:i.e.Integrated}),R=h.store.getContentCardIndex(P);if(-1===R)return void h.store.ULS.sendTraceTag(595855178,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[ReplaceContainerContent]Positional index for content id ".concat(b," should not be negative"));h.store.activeContainerId=h.store.activeContainerId===P?A:h.store.activeContainerId,h.store.getContainerIdToInfoMap()[A]=s,delete h.store.getContainerIdToInfoMap()[P],h.store.getContentAnchorPositions()[R].contentId=x}break;case 6:h.positionFloatingContainers()}},this.getAreContainersEnabled=function(){return!h.store.isCommentPaneOpen&&h.store.areCommentExtensionProvidersDefinedOnce},this.getContentAnchorPosition=function(t){if(!t)return null;var n=Y({contentId:t,contentType:i.b.CommentThread,renderMode:i.e.Integrated}),e=h.store.getContentCardIndex(n);return-1!==e?h.store.getContentAnchorPositions()[e]:null},this.containerShouldBeCreatedEventHandler=function(t){var n=h.store.getContentCardIndex(t.containerId);h.store.initializeAndRenderFloatingContainer(h.store.getContentAnchorPositions()[n],t.containerId,h.onContainerResize)},this.updateCommentPaneState=function(){h.store.isCommentPaneOpen=!0,h.store.extensionProviderCollection&&(h.store.isCommentPaneOpen=0===h.store.extensionProviderCollection.providers.filter((function(t){return t.scope.contentType===i.b.CommentThread&&t.scope.renderMode===i.e.Integrated})).length),h.onCommentPaneStateChange()},this.onContainerResize=function(t){if(!h.store.isCommentPaneOpen&&t.stateChangeType===l.Resize&&0!==t.contentRect.height){var n=t.contentIdentifier,e=Y({contentId:n.contentId,contentType:n.contentType,renderMode:i.e.Integrated}),o=h.store.getContainerIdToInfoMap()[e];if(o){var r=o.position.height!==t.contentRect.height;if(h.isInitialActiveIdSet&&h.store.activeContainerId===e&&o.floatingContainerRef&&(h.onInitialActiveContainerRender?(h.onInitialActiveContainerRender(),h.onInitialActiveContainerRender=void 0):o.floatingContainerRef.setFocus()),r){if(o.position.height=t.contentRect.height,o.position.width=t.contentRect.width,h.firstContainerBeingRendered){var a=window.performance&&window.performance.now?window.performance.now():Date.now();h.store.ULS.sendTraceTag(595718473,Q.a.msoulscat_Wac_Telemetry,q.a.Info,a.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),h.firstContainerBeingRendered=!1}var s=void 0!==h.containerCreationTimers[e];if(h.featureSettings.DeselectionEnabled?h.positionContainersOnResize(e,o,s):h.positionFloatingContainers(h.store.getContentAnchorPositions(),void 0,h.store.activeContainerId,s),n.contentId&&n.contentId===h.draftContainerId){var c=h.store.isContainerInViewPort(o.anchorTop);h.store.ULS.sendTraceTag(553747984,Q.a.msoulscat_Wac_Telemetry,q.a.Info,"[ContainerResize] Draft Container created with id: ".concat(n.contentId," created and in viewport ").concat(c))}h.isInitialActiveIdSet&&h.store.activeContainerId===e&&o.floatingContainerRef&&(h.isInitialActiveIdSet=!1),o.floatingContainerRef&&o.floatingContainerRef.showFloatingContainer(s),t.contentIdentifier.contentId===h.replacementContentId&&(h.replacementContentId=void 0),s&&(delete h.containerCreationTimers[e],void 0!==h.stallDetectorUsed&&(window.clearTimeout(h.stallDetectorTimeoutId),h.stallDetectorTimeoutId=void 0,h.processContainerQueue()))}}else h.store.ULS.sendTraceTag(595646153,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[ContainerResize] ContainerInfo does not exist, id: ".concat(e,", size: ").concat(t.contentRect.height))}},this.paneClosedCallback=a,this.paneOpenedCallback=s,this.destroyAllContainersCallback=u,c.ShouldInitialize&&this.initialize(),c.TrackChangesInSidetrackEnabled&&(Object(I.d)().registerComponent("TrackedChange",tt),function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){return t={priority:i.d.Primary,renderMode:i.e.Integrated,instanceId:K.a,componentDimensions:void 0},[2,Object(i.g)().registerExtension(i.b.TrackedChange,"TrackedChange",t)]}))}))}().catch((function(t){h.store.ULS.sendTraceTag(538022360,Q.a.msoulscat_Wac_Telemetry,q.a.Warning,"Failed to register TrackChange extension: ".concat(t))})))}return t.prototype.initialize=function(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)},t.prototype.enterFixedPositionMode=function(){this.inFixedMode=!0},t.prototype.exitFixedPositionMode=function(){this.inFixedMode=!1},t.prototype.setFirstCommentRenderDone=function(){this.store.isFirstCommentRenderDone=!0},t.prototype.setContainerCreationPauseState=function(t){this.pauseContainerCreation=t,t&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)},t.prototype.clearSelection=function(t){if(void 0===t&&(t=!1),this.store.activeContainerId){var n=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!n)return;if(n.position.x=0,t)return;this.positionFloatingContainers()}},t.prototype.setInitialActiveContainerId=function(t){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=Y({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:i.e.Integrated}))},t.prototype.setInitialActiveContainerIdV2=function(t,n){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=Y({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:i.e.Integrated}),n&&(this.onInitialActiveContainerRender=n))},t.prototype.insertContentAnchorPosition=function(t,n,e){var o=e&&Math.abs(t.anchorTop-n)<=4?this.store.getContentCardIndex(e)+1:-1;this.store.addContentAnchorPosition(t,0,o)},t.prototype.processContentAnchorPositionsInView=function(t){var n=this,e=!1,o=void 0,r=void 0,a=0;if(t.forEach((function(s,c){if(s){var l=s.contentId;if(!l)return void n.store.ULS.sendTraceTag(595903808,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[processContentAnchorPosition]ContentId is null.");var u=Y({contentId:l,contentType:d(s.containerContentType),renderMode:i.e.Integrated}),p=t.length;n.trackLastCommentRenderedInViewport(s,c,u,p);var h=n.store.getContainerIdToInfoMap()[u];if(!h){var C=n.store.initializeAndRenderFloatingContainer(s,u,n.onContainerResize,!1);return C&&!n.containerCreationQueue.includes(u)&&(n.containerCreationQueue.push(u),n.containerCreationEnqueueTimes[u]=Date.now()),void(C&&(n.insertContentAnchorPosition(s,a,o),o=u,a=s.anchorTop))}var f=n.store.getContentCardIndex(u,s.anchorTop);if(-1===f)return void n.store.ULS.sendTraceTag(595883392,Q.a.msoulscat_Wac_Telemetry,q.a.Error,"[processContentAnchorPosition]Container was supposed to be found.");var v=n.store.getContentAnchorPositions()[f],g=void 0!==r&&h.position.y>=r.position.y&&h.position.y<=r.position.y+r.position.height,I=Math.abs(v.anchorTop-s.anchorTop)>4;if(e=e||I||g,I){var m=Y({contentId:l,contentType:d(s.containerContentType),renderMode:i.e.Integrated});n.store.removeContentAnchorPosition(m),n.insertContentAnchorPosition(s,a,o)}o=u,a=s.anchorTop,h.anchorTop=s.anchorTop,r=h}})),this.updateProcessedContainersVisibleAtBootState(),!this.featureSettings.TrackChangesInSidetrackEnabled&&this.isContainerQueueInProgress||this.processContainerQueue(),e||this.inFixedMode){var s=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),s,this.store.activeContainerId)}},t.prototype.processContainerQueue=function(){var t=this;if(0===this.containerCreationQueue.length||this.pauseContainerCreation)this.isContainerQueueInProgress=!1;else{this.isContainerQueueInProgress=!0;var n=this.containerCreationQueue.shift(),e=this.store.getContentAnchorPosition(n);if(e)if(this.store.isContainerInViewPort(e.anchorTop)){if(!this.featureSettings.TrackChangesInSidetrackEnabled||!this.containerCreationTimers[n]){var o=window.setTimeout((function(){t.containerCreationTimers[n]&&(t.containerCreationTimers[n].creationStarted=!0),t.createContainer(e,n),t.setupStallDetector(n)}),this.containerDelayTimeMs);this.containerCreationTimers[n]={timer:o,creationStarted:!1}}}else this.deleteContainer(n),this.processContainerQueue();else this.featureSettings.TrackChangesInSidetrackEnabled&&this.processContainerQueue()}},t.prototype.trackLastCommentRenderedInViewport=function(t,n,e,o){this.store.processedContainersVisibleAtBoot||(this.store.isContainerInViewPort(t.anchorTop)?this.store.lastCommentVisibleID=e:0===n&&Object(nt.e)(nt.d,{component:"canvas",subComponent:"floatingComments",state:"unused"})),n!==o-1||this.store.processedContainersVisibleAtBoot||(this.store.processedContainersVisibleAtBoot=!0)},t.prototype.updateProcessedContainersVisibleAtBootState=function(){this.store.isFirstCommentRenderDone&&!this.store.processedContainersVisibleAtBoot&&(this.store.processedContainersVisibleAtBoot=!0,Object(nt.e)(nt.d,{component:"canvas",subComponent:"floatingComments",state:"unused"}))},t.prototype.setupStallDetector=function(t){var n=this;this.stallDetectorUsed=!1,!(this.featureSettings.TrackChangesInSidetrackEnabled&&void 0!==this.stallDetectorTimeoutId)&&(this.stallDetectorTimeoutId=window.setTimeout((function(){n.stallDetectorUsed=!0,n.processContainerQueue(),n.store.ULS.sendTraceTag(593281990,Q.a.msoulscat_Wac_Telemetry,q.a.Warning,"[CommentCreationQueueStallDetector]: Container ".concat(t," creation resize call not received or took too long"))}),this.queueStallDetectionTimeMs))},t.prototype.createContainer=function(t,n){if(this.store.initializeAndRenderFloatingContainer(t,n,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[n]){var e=Date.now();this.store.ULS.sendTraceTag(593891910,Q.a.msoulscat_Wac_Telemetry,q.a.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:".concat(e-this.containerCreationEnqueueTimes[n])),delete this.containerCreationEnqueueTimes[n]}}else this.deleteContainer(n),this.processContainerQueue()},t.prototype.onCommentPaneStateChange=function(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()},t.prototype.deleteContainer=function(t,n){var e;void 0===n&&(n=!1);var o=this.store.removeContentAnchorPosition(t);if(-1===o)return-1;var i=this.store.getContainerIdToInfoMap()[t].floatingContainerRef;return i&&(i.destroyFloatingContainer(n),this.featureSettings.TrackChangesInSidetrackEnabled||(clearTimeout(null===(e=this.containerCreationTimers[t])||void 0===e?void 0:e.timer),delete this.containerCreationTimers[t],this.removeFromCreationQueue(t))),this.featureSettings.TrackChangesInSidetrackEnabled&&(void 0!==this.containerCreationTimers[t]&&(this.containerCreationTimers[t].creationStarted?(clearTimeout(this.stallDetectorTimeoutId),this.stallDetectorTimeoutId=void 0):clearTimeout(this.containerCreationTimers[t].timer),delete this.containerCreationTimers[t]),this.removeFromCreationQueue(t)),delete this.store.getContainerIdToInfoMap()[t],delete this.containerCreationEnqueueTimes[t],o},t.prototype.destroyAllContainers=function(){var t=this,n=Object.keys(this.store.getContainerIdToInfoMap());n.length>0&&this.destroyAllContainersCallback&&this.destroyAllContainersCallback(),n.forEach((function(n){t.deleteContainer(n)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.containerCreationTimers={},this.containerCreationQueue=[]},t.prototype.positionFloatingContainers=function(t,n,e,o,i){if(void 0===o&&(o=!1),void 0===i&&(i=!1),t&&t.length>0){var r=e?{containerId:e,containerPositionIndex:this.store.getContentCardIndex(e)}:void 0;this.floatingContainerPositioner.calculateNewPositions(t,this.store.getContainerIdToInfoMap(),{activeContainerInfo:r,disableRepositioningAnimation:o||this.inFixedMode,topOfFirstContainer:n,shouldUpdatePositions:!1})}var a=e;a=null!=a?a:this.store.activeContainerId,this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,o||this.inFixedMode||void 0!==this.replacementContentId,this.isInitialActiveIdSet?void 0:a,i)},t.prototype.positionContainersOnResize=function(t,n,e){var o=this.store.getContentCardIndex(t),i=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==i&&i>=o?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,e):(o-=!(it(n)&&n.hasBeenRendered)&&o>0?1:0,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(o),void 0,void 0,e));it(n)&&(n.hasBeenRendered=!0)},t.prototype.removeFromCreationQueue=function(t){var n=this.containerCreationQueue.indexOf(t);n>-1&&this.containerCreationQueue.splice(n,1)},t}(),st=e(646),ct=function(){function t(t){var n,e;this.wordContentNavigationApi=t,this.directionTranslation=((n={})[st.a.None]=0,n[st.a.Previous]=2,n[st.a.Next]=1,n),this.navReasonTranslation=((e={})[J.c.HostAction]=2,e[J.c.Keyboarding]=1,e)}return t.prototype.bringContentIntoView=function(t){this.wordContentNavigationApi.bringContentIntoView({contentIdentifier:{contentId:t.contentIdentifier.contentId,containerContentType:X(t.contentIdentifier.contentType)}})},t.prototype.moveFocus=function(t){var n,e;this.wordContentNavigationApi.moveFocus({resource:{contentId:null===(n=t.resource)||void 0===n?void 0:n.contentId,containerContentType:X(null===(e=t.resource)||void 0===e?void 0:e.contentType)}})},t.prototype.selectNextOrPreviousContent=function(t){this.wordContentNavigationApi.selectNextOrPreviousContent({selectDirection:this.directionTranslation[t.selectDirection],reason:this.navReasonTranslation[t.reason],preventLooping:t.preventLooping,restrictToCurrentContext:t.restrictToCurrentContext,from:t.from&&{contentId:t.from.contentId,containerContentType:X(t.from.contentType)}})},t}(),dt=function(){function t(t){this.stringLoader=t,this.trackChangeInfoById=new Map,this.storeUpdateHandlers=new Map,this.updateVersion=0,this.styles={minWidth:238,maxWidth:238,borderRadius:4}}return Object.defineProperty(t.prototype,"cardStyles",{get:function(){return this.styles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cardStrings",{get:function(){var t;return null!==(t=this.strings)&&void 0!==t?t:{regularHeading:"Accept or reject suggestion?",acceptHoveredHeading:"Accept Suggestion",rejectHoveredHeading:"Reject Suggestion"}},enumerable:!1,configurable:!0}),t.prototype.loadStrings=function(t){var n=this;void 0===t&&(t="en-US"),this.stringLoader.loadStrings(t).then((function(t){n.strings={regularHeading:t.TrackChangeCardAcceptOrRejectSuggestionLabel,acceptHoveredHeading:t.TrackChangeCardAcceptSuggestionLabel,rejectHoveredHeading:t.TrackChangeCardRejectSuggestionLabel}})).catch((function(t){}))},t.prototype.registerOnStoreUpdate=function(t,n){this.storeUpdateHandlers.set(t,n)},t.prototype.addOrUpdateStore=function(t,n){this.trackChangeInfoById.set(t,n);var e=this.storeUpdateHandlers.get(t);e&&e({type:"content",data:n})},t.prototype.removeFromStore=function(t){this.trackChangeInfoById.delete(t),this.storeUpdateHandlers.delete(t)},t.prototype.reloadStore=function(){this.updateVersion++},t.prototype.registerTrackChangeCardActionExecuter=function(t){this.trackChangeCardActionExecuter=t},t.prototype.getCardActionCallbacks=function(t){return{onAcceptClick:this.createActionCallback("AcceptClick",t),onRejectClick:this.createActionCallback("RejectClick",t),onAcceptHoverIn:this.createActionCallback("AcceptMouseOver",t),onAcceptHoverOut:this.createActionCallback("AcceptMouseOut",t),onRejectHoverIn:this.createActionCallback("RejectMouseOver",t),onRejectHoverOut:this.createActionCallback("RejectMouseOut",t),onCardHoverIn:this.createActionCallback("CardMouseOver",t),onCardHoverOut:this.createActionCallback("CardMouseOut",t),onCardClick:this.createActionCallback("CardClick",t)}},t.prototype.getContainerContent=function(t){return this.trackChangeInfoById.get(t)},t.prototype.clearStore=function(){this.trackChangeInfoById.clear(),this.storeUpdateHandlers.clear()},t.prototype.focusTrackChangeCard=function(t){var n=this.storeUpdateHandlers.get(t);n&&n({type:"behavior",data:{action:G.Focus}})},t.prototype.createActionCallback=function(t,n){var e=this;return function(){e.trackChangeCardActionExecuter&&e.trackChangeCardActionExecuter(t,e.updateVersion,n)}},t}(),lt=e(339),ut=e(477),pt=e(481),ht=e(970),Ct=function(){function t(){}return t.prototype.loadStrings=function(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(r.__generator)(this,(function(o){return[2,e(1754)("./".concat(t,"/canvas-contextual.json")).then((function(t){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return[2,t]}))}))})).catch((function(t){return ht.CanvasContextual}))]}))}))},t}(),ft=e(203),vt=e(2789),gt=e(169),It=function(t,n,e,o){return e?function(t,n,e,o){var i=0,r=0,a=0,s=new Set,c=[];for(;i<t.length&&r<n.length;)t[i].contentId===n[r].contentId?(i++,r++,a++):e.has(t[i].contentId)?o.has(n[r].contentId)?s.has(n[r].contentId)?(s.delete(n[r].contentId),c.push({type:"Insert",index:a,content:n[r]}),a++,r++):(s.add(t[i].contentId),c.push({type:"Remove",index:a}),i++):(c.push({type:"Insert",index:a,content:n[r]}),r++,a++):(c.push({type:"Remove",index:a}),i++);for(;r<n.length;)c.push({type:"Insert",content:n[r],index:a}),a++,r++;for(;i<t.length;)c.push({type:"Remove",index:a}),i++;return c}(t,n,o,e):[{type:"Reload",fullContent:n,reason:ft.d.DivergentChange}]};var mt=function(){function t(t){this.wordFilterAPI=t,this.activeFilteredRange=void 0,this.filteredContentMap=new Map,this.filterMap=new Map,this.idsInFilter=new Map,this.onFilteredRangeUpdated=new gt.EventImpl((function(){})),this.onActiveFilterUpdated=new gt.EventImpl((function(){})),this.onUserFilterManagerEvent=new gt.EventImpl((function(){})),t.registerOnContentChangeCallback(this.onContentChanged.bind(this))}return t.prototype.updateFilterForFilteredRangeId=function(t,n){if(this.filterMap.has(t)){var e=this.updateOrder(t,n);e.length>0&&this.onFilteredRangeUpdated.trigger({filterId:t,payload:{changes:e}})}},t.prototype.getExistingFilteredRange=function(t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,e;return Object(r.__generator)(this,(function(o){return n=this.filterMap.get(t),e=this.filteredContentMap.get(t),n&&e?[2,{content:e,filter:n.filter,filterId:t,supportsFilterUpdates:n.supportsFilterUpdates}]:[2]}))}))},t.prototype.setActiveFilteredRange=function(t){var n,e;this.activeFilteredRange=t,t&&(null===(e=(n=this.wordFilterAPI).updateCurrentFilteredContent)||void 0===e||e.call(n,this.idsInFilter.get(t)))},t.prototype.getActiveFilteredRangeId=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,this.activeFilteredRange]}))}))},t.prototype.getFilteredRange=function(t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(o){return e=Object(vt.a)(),this.updateOrder(e,t.hostFilter),[2,{filterId:e,content:null!==(n=this.filteredContentMap.get(e))&&void 0!==n?n:[],supportsFilterUpdates:t.supportsFilterUpdates,filter:t.hostFilter}]}))}))},t.prototype.teardownFilteredRange=function(t){this.filteredContentMap.delete(t),this.filterMap.delete(t)},t.prototype.getCapabilities=function(){return Promise.resolve({supportedContentTypes:i.b.CommentThread,supportsMentionToMeFilter:!0})},t.prototype.getHostSpecificLabels=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,{}]}))}))},t.prototype.getFilterUsers=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return[2,[]]}))}))},t.prototype.updateOrder=function(t,n){var e,i,r,a,s,c=this,l=new Set,u=null!==(e=this.filteredContentMap.get(t))&&void 0!==e?e:[],p=null!==(r=null===(i=this.wordFilterAPI)||void 0===i?void 0:i.getAllContent().filter((function(t){if((null==t?void 0:t.contentId)&&(null==t?void 0:t.containerContentType)===o.CommentThread){var e=t.contentId;return!!c.includeCommentInOrder(n,t)&&(!l.has(e)&&(l.add(e),!0))}return!1})).map((function(t){var n;return{contentId:null!==(n=t.contentId)&&void 0!==n?n:"",contentType:d(t.containerContentType)}})))&&void 0!==r?r:[];this.filteredContentMap.set(t,p),this.filterMap.set(t,{filter:n,supportsFilterUpdates:!0});var h=this.idsInFilter.get(t);return this.idsInFilter.set(t,l),this.activeFilteredRange===t&&(null===(s=(a=this.wordFilterAPI).updateCurrentFilteredContent)||void 0===s||s.call(a,l)),It(u,p,h,l)},t.prototype.onContentChanged=function(){var t=this;this.filterMap.forEach((function(n,e){t.updateFilterForFilteredRangeId(e,n.filter)}))},t.prototype.includeCommentInOrder=function(t,n){var e,o;if(t.CommentThread){if(n.contentId&&(null===(o=(e=this.wordFilterAPI).isDraftContent)||void 0===o?void 0:o.call(e,n.contentId)))return!0;if(t.CommentThread.resolutionStatus===ft.a.ResolvedOnly&&this.wordFilterAPI.isContentActive(n))return!1;if(t.CommentThread.resolutionStatus===ft.a.ActiveOnly&&!this.wordFilterAPI.isContentActive(n))return!1}return!(t.mentionsToCurrentUser&&!this.wordFilterAPI.isCurrentUserMentioned(n))},t}(),yt=new(function(){function t(){var t=new Ct;this.trackChangesStore=new dt(t)}return t.prototype.getFCManagerInstance=function(t){if(void 0===this.floatingContainerManagerInstance){if(!t)throw new Error("Floating Container Manager creation arguments are missing!");t.ulsLogger&&W.a.setLogger(t.ulsLogger);var n={DeselectionEnabled:!!(c=t.featureGates).deselectionEnabled,FloatingContainerVirtualizationEnabled:!!c.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!c.improveJumpingFixEnabled,ShouldInitialize:!1!==c.shouldInitialize,ScrollingPerfImprovementEnabled:!!c.scrollingPerfImprovementEnabled,SynchronousContainerPositioningEnabled:!!c.synchronousContainerPositioningEnabled,TrackChangesInSidetrackEnabled:!!c.trackChangeInSidetrackEnabled,ContentNavigationApiEnabled:!!c.contentNavigationApiEnabled,ReturnToDraftFixEnabled:!!c.returnToDraftFixEnabled};t.featureGateApiSettings&&Object(lt.c)({appSettings:t.featureGateApiSettings,mapping:ut.a});var e=t.isRtl?1:-1,o=t.canvasAndFcHostOffset?e*(t.canvasAndFcHostOffset-1):0,r=new u(Y,W.a,o),a=new f({containerVirtualizationEnabled:n.FloatingContainerVirtualizationEnabled}),s=new rt(i.g,t.containerPanel,B,W.a,t.viewportInfo);t.telemetryDetails&&Object(v.m)(pt.a,t.telemetryDetails),this.trackChangesStore.loadStrings(t.uiCulture),this.floatingContainerManagerInstance=new at(r,a,s,t.paneClosedCallback,t.paneOpenedCallback,n,t.destroyAllContainersCallback,this.trackChangesStore),n.ContentNavigationApiEnabled&&t.sidetrackContentNavigationApi&&this.registerContentNavigationApi(t.sidetrackContentNavigationApi),n.ContentNavigationApiEnabled&&t.contentFilterAPI&&this.registerContentFilteredRangeHostApi(t.contentFilterAPI)}var c;return this.floatingContainerManagerInstance},t.prototype.getTrackChangesStoreApi=function(){return this.trackChangesStore},t.prototype.getFCContentNavigationAPI=function(){return this.floatingContainerContentNavigationAPI},t.prototype.getTrackChangesStore=function(){return this.trackChangesStore},t.prototype.registerContentNavigationApi=function(t){Object(J.h)(this.initializeAndGetContentNavigationAPI(t),K.a)},t.prototype.initializeAndGetContentNavigationAPI=function(t){return this.floatingContainerContentNavigationAPI||(this.floatingContainerContentNavigationAPI=new ct(t)),this.floatingContainerContentNavigationAPI},t.prototype.registerContentFilteredRangeHostApi=function(t){Object(ft.g)(K.a,this.initializeAndGetContentFilteredRangeHostApi(t))},t.prototype.initializeAndGetContentFilteredRangeHostApi=function(t){return this.contentFilteredRangeHostAPI||(this.contentFilteredRangeHostAPI=new mt(t)),this.contentFilteredRangeHostAPI},t}()),Tt=yt;e.d(n,"FactoryGlobal",(function(){return Tt}))}}]);
//# sourceMappingURL=floatingContainerManager.min.js.map