function $_global_core(){if("undefined"==typeof g_all_modules)g_all_modules={};g_all_modules["core.js"]={version:{rmj:16,rmm:0,rup:23717,rpr:12e3}};typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkBegin_core.js");SPAnimation={};SPAnimation.g_Curves=new Array(7);SPAnimation.g_Curves[0]=new SPCurve(0,0,0,0,0,0);SPAnimation.g_Curves[1]=new SPCurve(1,1,0,0,0,0);SPAnimation.g_Curves[2]=new SPCurve(2,2,0,0,0,0);SPAnimation.g_Curves[3]=new SPCurve(3,3,.1,.9,.2,1);SPAnimation.g_Curves[4]=new SPCurve(4,3,.42,0,1,1);SPAnimation.g_Curves[5]=new SPCurve(5,3,0,0,.58,1);SPAnimation.g_Curves[6]=new SPCurve(6,3,.42,0,.58,1);SPKeyFrame.prototype={type:0,curveID:0,startTime:0,endTime:0,startValue:0,endValue:0,relativeTo:0,operationType:0};SPAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5};SPAnimation.ID={Basic_Show:0,Basic_SlowShow:1,Basic_Fade:2,Basic_Move:3,Basic_Size:4,Content_SlideInFadeInRight:5,Content_SlideInFadeInRightInc:6,Content_SlideOutFadeOutRight:7,Content_SlideInFadeInLeft:8,Content_SlideInFadeInLeftInc:9,SmallObject_SlideInFadeInTop:10,SmallObject_SlideInFadeInLeft:11,Test_Instant:12,Test_Hold:13,Basic_Opacity:14,Basic_QuickShow:15,Basic_QuickFade:16,Content_SlideInFadeInGeneric:17,Basic_StrikeThrough:18,SmallObject_SlideInFadeInBottom:19,SmallObject_SlideOutFadeOutBottom:20,Basic_QuickSize:21};SPAnimation.g_Animations=new Array(22);SPAnimation.g_Animations[SPAnimation.ID.Basic_Show]=new Animation(SPAnimation.ID.Basic_Show,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_SlowShow]=new Animation(SPAnimation.ID.Basic_SlowShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,700,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickShow]=new Animation(SPAnimation.ID.Basic_QuickShow,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Fade]=new Animation(SPAnimation.ID.Basic_Fade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickFade]=new Animation(SPAnimation.ID.Basic_QuickFade,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Move]=new Animation(SPAnimation.ID.Basic_Move,[new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Size]=new Animation(SPAnimation.ID.Basic_Size,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,367,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,367,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_QuickSize]=new Animation(SPAnimation.ID.Basic_QuickSize,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1),new SPKeyFrame(SPAnimation.Attribute.Height,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRight]=new Animation(SPAnimation.ID.Content_SlideInFadeInRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,-100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInRightInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInRightInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideOutFadeOutRight]=new Animation(SPAnimation.ID.Content_SlideOutFadeOutRight,[new SPKeyFrame(SPAnimation.Attribute.Opacity,0,0,1,1,0,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeft]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,100,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,367,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInLeftInc]=new Animation(SPAnimation.ID.Content_SlideInFadeInLeftInc,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,-100,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInTop]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInTop,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,-40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInLeft]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInLeft,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Instant]=new Animation(SPAnimation.ID.Test_Instant,[new SPKeyFrame(SPAnimation.Attribute.PositionX,0,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Test_Hold]=new Animation(SPAnimation.ID.Test_Hold,[new SPKeyFrame(SPAnimation.Attribute.PositionX,1,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,1,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_Opacity]=new Animation(SPAnimation.ID.Basic_Opacity,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Content_SlideInFadeInGeneric]=new Animation(SPAnimation.ID.Content_SlideInFadeInGeneric,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,367,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionX,3,0,367,null,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,0,367,null,1,1,0)]);SPAnimation.g_Animations[SPAnimation.ID.Basic_StrikeThrough]=new Animation(SPAnimation.ID.Basic_StrikeThrough,[new SPKeyFrame(SPAnimation.Attribute.Width,3,0,167,null,0,1,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideInFadeInBottom]=new Animation(SPAnimation.ID.SmallObject_SlideInFadeInBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,0,1,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,40,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,0,0,1)]);SPAnimation.g_Animations[SPAnimation.ID.SmallObject_SlideOutFadeOutBottom]=new Animation(SPAnimation.ID.SmallObject_SlideOutFadeOutBottom,[new SPKeyFrame(SPAnimation.Attribute.Opacity,2,0,167,1,0,1,0),new SPKeyFrame(SPAnimation.Attribute.PositionY,0,0,1,null,0,0,1),new SPKeyFrame(SPAnimation.Attribute.PositionY,3,1,167,null,40,0,1)]);SPAnimation.g_AnimationEngine=function(){return null}();SPAnimation.Logging=window.location.search.indexOf("AnimationLogging=1")!=-1;SPAnimation.g_AnimationWSA=null;SPAnimation.DATAID_SPANIMATION=9423;SPAnimation.g_AnimationThrottleCutoffFPS=11;SPAnimation.g_AnimationThrottleNumInstance=3;!IsNullOrUndefined(window.sessionStorage)&&IsNullOrUndefined(window.sessionStorage.SPAnimationEnabled)&&TrySetProperty(window.sessionStorage,"SPAnimationEnabled",1);!IsNullOrUndefined(window.localStorage)&&IsNullOrUndefined(window.localStorage.SPAnimationEnabled)&&TrySetProperty(window.localStorage,"SPAnimationEnabled",1);SPAnimation.Settings={};SPAnimation.Settings.EnableAnimation=function(){TrySetProperty(window.sessionStorage,"SPAnimationEnabled",1);TrySetProperty(window.localStorage,"SPAnimationEnabled",1);typeof UpdateAnimationUserControl!="undefined"&&UpdateAnimationUserControl(false)};SPAnimation.Settings.DisableAnimation=function(){TrySetProperty(window.localStorage,"SPAnimationEnabled",0);typeof UpdateAnimationUserControl!="undefined"&&UpdateAnimationUserControl(false)};SPAnimation.Settings.DisableSessionAnimation=function(){TrySetProperty(window.sessionStorage,"SPAnimationEnabled",0);typeof UpdateAnimationUserControl!="undefined"&&UpdateAnimationUserControl(false)};SPAnimation.Settings.IsAnimationEnabled=function(){var a=IsNullOrUndefined(window.sessionStorage)?false:window.sessionStorage.SPAnimationEnabled==1,b=IsNullOrUndefined(window.localStorage)?false:window.localStorage.SPAnimationEnabled==1;return a&&b};UpdateAnimationStateFromQuery();SPAnimation.State=SPAnimation_State;SPAnimation.Object=SPAnimation_Object;AnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,frameInterval:1e3/60,resetInterval:3e4,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};AnimationEngine.prototype.LocalStepper=function(){SPAnimation.g_AnimationEngine.StepAllAnimations()};AnimationEngine.prototype.LocalStopper=function(){SPAnimation.g_AnimationEngine.StopEngine()};AnimationEngine.prototype.StartEngine=function(){if(this.sharedTimer!=null||this.sharedCancelTimer!=null||this.sharedTimerRefs!=0)return;this.sharedTimer=window.setInterval(AnimationEngine.prototype.LocalStepper,this.frameInterval);this.sharedCancelTimer=window.setTimeout(AnimationEngine.prototype.LocalStopper,this.resetInterval);this.sharedTimerRefs=0;SPAnimation.g_TelemetryObject.Start()};AnimationEngine.prototype.StopEngine=function(){SPAnimation.g_TelemetryObject.Stop();if(this.sharedCancelTimer!=null){window.clearTimeout(this.sharedCancelTimer);this.sharedCancelTimer=null}if(this.sharedTimer!=null){window.clearInterval(this.sharedTimer);this.sharedTimer=null}this.sharedTimerRefs=0;this.conflictTable=new Array(0)};AnimationEngine.prototype.StartAnimation=function(a){this.AnimationQueue[this.sharedTimerRefs++]=a};AnimationEngine.prototype.StopAnimation=function(b){for(var a=0;a<this.AnimationQueue.length;a++)if(this.AnimationQueue[a]==b){this.RemoveTemporaryIds(b);this.AnimationQueue[a]=null}};AnimationEngine.prototype.StepAllAnimations=function(){for(var c=false,b=null,a=0;a<this.AnimationQueue.length;a++)if(this.AnimationQueue[a]!=null){if(IsNullOrUndefined(b))b=this.AnimationQueue[a].currentTime;this.currentAnimationIndex=a;this.AnimationQueue[a].StepAnimation();c=true}this.currentAnimationIndex=-1;c&&!IsNullOrUndefined(b)&&SPAnimation.g_TelemetryObject.AddPerfData(new Date-b);!c&&this.StopEngine()};AnimationEngine.prototype.CheckForConflictingAnimations=function(e,i){if(e.id==null||e.id==""){var k="tempAnimID_"+String(this.temporaryIDGenerator);this.temporaryIDGenerator++;e.id=k}var j=e.id+"_"+String(i),d=this.conflictTable[j];if(IsNullOrUndefined(d)||d==this.currentAnimationIndex||this.AnimationQueue[d]==null)this.conflictTable[j]=this.currentAnimationIndex;else{var a=this.AnimationQueue[d];a.curveID.SetAttribute(i,null);var b=this.AnimationQueue[this.currentAnimationIndex],f=a.finishFunc,g=a.extraData,c=b.finishFunc,h=b.extraData;b.finishFunc=f==null?c==null?function(){a.StopAnimation()}:function(){c(h);a.StopAnimation()}:c==null?function(){f(g);a.StopAnimation()}:function(){f(g);c(h);a.StopAnimation()};b.extraData=null;a.finishFunc=null}};AnimationEngine.prototype.RemoveTemporaryIds=function(b){var a;if(IsArray(b.element))for(var d=b.element.length,c=0;c<d;c++){a=b.element[c];if(a.id.indexOf("tempAnimID_")==0)a.id==null}else{a=b.element;if(a.id.indexOf("tempAnimID_")==0)a.id==null}};SPAnimation_State.prototype={Index:0,Data:new Array(0)};SPAnimation_State.prototype.SetAttribute=function(a,b){var c=this.GetDataIndex(a);if(c==-1){var d=this.Data.length;this.Index+=a*Math.pow(10,d);this.Data[d]=b}else this.Data[c]=b};SPAnimation_State.prototype.GetAttribute=function(b){var a=this.GetDataIndex(b);return a==-1?null:this.Data[a]};SPAnimation_State.prototype.GetDataIndex=function(c){var b=0,a=this.Index;while(a!=0){var d=a%10;if(d==c)return b;a=Math.floor(a/10);b++}return-1};SPAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0};SPAnimation_Object.prototype.Initialize=function(a,f,e,b,c,d){this.animationID=a;this.delay=f;this.element=e;this.finalState=b;this.finishFunc=c;this.extraData=d;this.arrAnimationUnits=new Array(0);this.idxAnimUnit=0};SPAnimation_Object.prototype.RunAnimation=function(){if(this.ValidateParametersForAnimation()){var a;if(SPAnimation.Settings.IsAnimationEnabled()){this.GenerateAnimationUnits();a=this.arrAnimationUnits.length;for(var c=0;c<a;c++)this.arrAnimationUnits[c].StartAnimation()}else{var d=SPAnimation.g_Animations[this.animationID];if(IsArray(this.element)){a=this.element.length;for(var b=0;b<a;b++)this.AdvanceToFinalState(b,d)}else this.AdvanceToFinalState(-1,d);this.finishFunc!=null&&this.finishFunc(this.extraData);typeof ExecuteOrDelayUntilScriptLoaded=="function"&&ExecuteOrDelayUntilScriptLoaded(function(){var a=GetAnimationWSA();WSAEnabled()&&!IsNullOrUndefined(a)&&a.addToStreamDw(SPAnimation.DATAID_SPANIMATION,Number(SPAnimation.Settings.IsAnimationEnabled()),0,0,0,0,0,0,0)},"SP.core.js")}}};SPAnimation_Object.prototype.ValidateParametersForAnimation=function(){var a=true;if(this.animationID==-1||this.element==null)a=false;else if(IsArray(this.element)){for(var c=this.element.length,b=0;b<c;b++)if(typeof this.element[b].style=="undefined"){a=false;break}}else if(typeof this.element.style=="undefined")a=false;return a};SPAnimation_Object.prototype.AdvanceToFinalState=function(f,d){for(var c=new SPAnimation_State,j=d.keyFrames.length,b=0;b<j;b++){var e=d.keyFrames[b];c.SetAttribute(e.type,this.GetFinalValue(e,f))}for(var h=5,i=IsArray(this.element)?this.element[f]:this.element,a=1;a<=h;a++){var g=c.GetAttribute(a);g!=null&&AnimationUnit.prototype.SetStyle(a,i,g)}};SPAnimation_Object.prototype.GenerateAnimationUnits=function(){for(var i=SPAnimation.g_Animations[this.animationID],e=null,j=i.keyFrames.length,c=null,h=0;h<j;h++){var a=i.keyFrames[h],f=this.FindMatchingAnimationUnit(a),d,g;if(f!=null){f.startValue.SetAttribute(a.type,a.startValue);f.curveID.SetAttribute(a.type,a.curveID);if(IsArray(this.element)){g=this.element.length;for(d=0;d<g;d++){c=this.GetFinalValue(a,d);if(IsNullOrUndefined(c)){f.curveID.SetAttribute(a.type,null);break}else f.targetValue[d].SetAttribute(a.type,c)}}else{c=this.GetFinalValue(a,-1);if(IsNullOrUndefined(c))f.curveID.SetAttribute(a.type,null);else f.targetValue.SetAttribute(a.type,c)}}else{var b=new AnimationUnit(this.element,a.startTime+this.delay,a.endTime-a.startTime,null,null);b.startValue.SetAttribute(a.type,a.startValue);b.curveID.SetAttribute(a.type,a.curveID);if(IsArray(this.element)){g=this.element.length;for(d=0;d<g;d++){if(b.targetValue==null)b.targetValue=new Array(this.element.length);if(b.targetValue[d]==null)b.targetValue[d]=new SPAnimation_State;c=this.GetFinalValue(a,d);if(IsNullOrUndefined(c)){b.curveID.SetAttribute(a.type,null);break}else b.targetValue[d].SetAttribute(a.type,c)}}else{if(b.targetValue==null)b.targetValue=new SPAnimation_State;c=this.GetFinalValue(a,-1);if(IsNullOrUndefined(c))b.curveID.SetAttribute(a.type,null);else b.targetValue.SetAttribute(a.type,c)}if(e==null||e.delay+e.duration<=b.delay+b.duration)e=b;this.arrAnimationUnits[this.idxAnimUnit++]=b}}if(e!=null){e.finishFunc=this.finishFunc;e.extraData=this.extraData}};SPAnimation_Object.prototype.FindMatchingAnimationUnit=function(b){for(var d=this.arrAnimationUnits.length,c=0;c<d;c++){var a=this.arrAnimationUnits[c];if(a.delay==b.startTime+this.delay&&a.duration==b.endTime-b.startTime)return a}return null};SPAnimation_Object.prototype.GetFinalValue=function(a,e){var b=null;if(!IsNullOrUndefined(a.endValue))switch(a.relativeTo){case 0:var g=IsArray(this.element)?this.element[e]:this.element,d=a.startValue==null?GetCurrentAttributeValue(g,a.type):a.startValue;b=a.operationType==0?a.endValue*d:a.endValue+d;break;case 1:var f=IsArray(this.element)?this.finalState[e]:this.finalState,c=f.GetAttribute(a.type);if(!IsNullOrUndefined(c))b=a.operationType==0?a.endValue*c:a.endValue+c;break;case 2:b=a.endValue}return b};AnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:false};AnimationUnit.prototype.Initialize=function(d,e,c,a,b){this.element=d;this.delay=e;this.duration=c;this.finishFunc=a;this.extraData=b;this.startValue=new SPAnimation_State;this.perElementStartValue=null;this.targetValue=null;this.curveID=new SPAnimation_State;this.startTime=null;this.fIsExecuting=false};AnimationUnit.prototype.StartAnimation=function(){if(SPAnimation.g_AnimationEngine==null)SPAnimation.g_AnimationEngine=new AnimationEngine;SPAnimation.g_AnimationEngine.sharedTimer==null&&SPAnimation.g_AnimationEngine.StartEngine();this.startTime=new Date;this.currentTime=new Date;SPAnimation.g_AnimationEngine.StartAnimation(this)};AnimationUnit.prototype.StopAnimation=function(){SPAnimation.g_AnimationEngine.StopAnimation(this)};AnimationUnit.prototype.StepAnimation=function(){this.currentTime=new Date;var g=Number(this.currentTime)-Number(this.startTime);if(g<this.delay)return;g-=this.delay;for(var j=false,k=!this.fIsExecuting,m=5,a=1;a<=m;a++){var l=this.curveID.GetAttribute(a);if(IsNullOrUndefined(l))continue;var i=this.PositionFunction(g,this.duration,l),b,c,d,f,h;if(IsArray(this.element))for(var n=this.element.length,e=0;e<n;e++){f=this.element[e];b=this.startValue.GetAttribute(a);h=this.targetValue[e];c=h.GetAttribute(a);if(IsNullOrUndefined(b)){if(this.perElementStartValue==null)this.perElementStartValue=new Array(this.element.length);if(IsNullOrUndefined(this.perElementStartValue[e]))this.perElementStartValue[e]=new SPAnimation_State;b=this.perElementStartValue[e].GetAttribute(a);if(IsNullOrUndefined(b)){b=GetCurrentAttributeValue(f,a);this.perElementStartValue[e].SetAttribute(a,b)}}if(isNaN(b)){SPAnimation.g_TelemetryObject.LogData("Unexpected: bogus start value for element "+String(f.id)+", attribute "+String(a));d=c}else d=b+i*(c-b);if(g>this.duration||i>1){d=c;j=true}k&&SPAnimation.g_AnimationEngine.CheckForConflictingAnimations(f,a);this.SetStyle(a,f,d)}else{f=this.element;b=this.startValue.GetAttribute(a);h=this.targetValue;c=h.GetAttribute(a);if(IsNullOrUndefined(b)){b=GetCurrentAttributeValue(this.element,a);this.startValue.SetAttribute(a,b)}if(isNaN(b)){SPAnimation.g_TelemetryObject.LogData("Unexpected: bogus start value for element "+String(this.element.id)+", attribute "+String(a));d=c}else d=b+i*(c-b);if(g>this.duration||i>1){d=c;j=true;SPAnimation.g_TelemetryObject.LogData("done")}k&&SPAnimation.g_AnimationEngine.CheckForConflictingAnimations(this.element,a);this.SetStyle(a,this.element,d)}}this.fIsExecuting=true;if(j){this.StopAnimation();if(this.finishFunc!=null){SPAnimation.g_TelemetryObject.LogData("calling fnishfunc");this.finishFunc(this.extraData)}}};AnimationUnit.prototype.PositionFunction=function(c,d,e){var a=0,b=SPAnimation.g_Curves[e];switch(b.type){case 0:a=1;break;case 1:a=c<d?0:1;break;case 2:a=c/d;break;case 3:a=BezierFunction(b.x1,b.y1,b.x2,b.y2,c/d)}return a};AnimationUnit.prototype.SetStyle=function(c,b,a){switch(c){case 1:this.StyleLeftSetter(b,a);break;case 2:this.StyleTopSetter(b,a);break;case 3:this.StyleHeightSetter(b,a);break;case 4:this.StyleWidthSetter(b,a);break;case 5:this.StyleOpacitySetter(b,a)}};AnimationUnit.prototype.StyleLeftSetter=function(b,a){if(fRightToLeft)b.style.right=String(a)+"px";else b.style.left=String(a)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+b.id+", "+(fRightToLeft?"right":"left")+": "+String(a)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleTopSetter=function(a,b){a.style.top=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", top: "+String(a.style.top)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleHeightSetter=function(a,b){a.style.height=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", height: "+String(a.style.height)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleWidthSetter=function(a,b){a.style.width=String(b)+"px";SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+a.id+", width: "+String(a.style.width)+", timestamp: "+String(Number(new Date)))};AnimationUnit.prototype.StyleOpacitySetter=function(b,a){SetOpacity(b,a);SPAnimation.Logging&&SPAnimation.g_TelemetryObject.LogData("element: "+b.id+", opacity: "+String(a)+", timestamp: "+String(Number(new Date)))};AnimationTelemetry.prototype={perfData:null,logData:null,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0};AnimationTelemetry.prototype.Start=function(){this.startTime=new Date;this.perfDataIndex=0;this.logDataIndex=0};AnimationTelemetry.prototype.Stop=function(){this.duration=Number(new Date)-Number(this.startTime);this.numUnits=SPAnimation.g_AnimationEngine.sharedTimerRefs;this.CalculateAndShowStatistics();this.perfDataIndex=0;this.logDataIndex=0};AnimationTelemetry.prototype.AddPerfData=function(a){this.perfData[this.perfDataIndex++]=a};AnimationTelemetry.prototype.LogData=function(a){this.logData[this.logDataIndex++]=a};AnimationTelemetry.prototype.CalculateStatistics=function(){var h=0,j=0,i=0,e=0,c=0,l="",k="",f=this.duration;if(IsNullOrUndefined(f))f=Number(new Date)-Number(this.startTime);if(SPAnimation.Logging&&this.logDataIndex>0)for(var m=this.logDataIndex,a=0;a<m;a++){if(a!=0)l+="<br/>";l+=this.logData[a]}if(this.perfDataIndex>0){j=Number.MAX_VALUE;i=Number.MIN_VALUE;var d=this.perfDataIndex;for(a=0;a<d;a++){if(this.perfData[a]<j)j=this.perfData[a];if(this.perfData[a]>i)i=this.perfData[a];e+=this.perfData[a];if(a!=0)k+=", ";k+=this.perfData[a]}if(d>1)e/=d-1;e=Math.round(e*100)/100;for(a=0;a<d;a++){var g=this.perfData[a]-e;g=g*g;c+=g}if(d>1)c/=d-1;c=Math.sqrt(c);c=Math.round(c*100)/100;h=this.perfDataIndex/f*1e3;h=Math.round(h)}var b=new Array(9);b[0]=f;b[1]=h;b[2]=j;b[3]=i;b[4]=e;b[5]=c;b[6]=k;b[7]=l;b[8]=this.numUnits;return b};AnimationTelemetry.prototype.CalculateAndShowStatistics=function(){var a=this.CalculateStatistics();SPAnimation.g_LastAnimationTelemetryData=a;this.ShowAnimationStats(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]);typeof ExecuteOrDelayUntilScriptLoaded=="function"&&ExecuteOrDelayUntilScriptLoaded(function(){var b=GetAnimationWSA();WSAEnabled()&&!IsNullOrUndefined(b)&&b.addToStreamDw(SPAnimation.DATAID_SPANIMATION,Number(SPAnimation.Settings.IsAnimationEnabled()),a[0],a[1],a[2],a[3],Math.round(a[4]),Math.round(a[5]),a[8])},"SP.core.js");if(!IsNullOrUndefined(window.sessionStorage))if(a[1]<SPAnimation.g_AnimationThrottleCutoffFPS){TrySetProperty(window.sessionStorage,"SPAnimationThrottleCounter",IsNullOrUndefined(window.sessionStorage.SPAnimationThrottleCounter)?1:Number(window.sessionStorage.SPAnimationThrottleCounter)+1);if(window.sessionStorage.SPAnimationThrottleCounter>=SPAnimation.g_AnimationThrottleNumInstance){SPAnimation.Settings.DisableSessionAnimation();TrySetProperty(window.sessionStorage,"SPAnimationThrottleCounter",0)}}else TrySetProperty(window.sessionStorage,"SPAnimationThrottleCounter",0)};AnimationTelemetry.prototype.ShowAnimationStats=function(g,s,v,u,r,k,q,t,h){this.animationIndex++;var b=String(this.animationIndex);if(typeof DeveloperDashboard!="undefined"&&typeof DeveloperDashboard.PostMsg!="undefined"){var a=typeof Strings!="undefined"&&typeof Strings.STS!="undefined",f=a&&typeof Strings.STS.L_DevDashAnimation_Duration!="undefined"?Strings.STS.L_DevDashAnimation_Duration:"Duration",n=a&&typeof Strings.STS.L_DevDashAnimation_FPS!="undefined"?Strings.STS.L_DevDashAnimation_FPS:"FPS",p=a&&typeof Strings.STS.L_DevDashAnimation_Min!="undefined"?Strings.STS.L_DevDashAnimation_Min:"Min",o=a&&typeof Strings.STS.L_DevDashAnimation_Max!="undefined"?Strings.STS.L_DevDashAnimation_Max:"Max",m=a&&typeof Strings.STS.L_DevDashAnimation_Avg!="undefined"?Strings.STS.L_DevDashAnimation_Avg:"Average",j=a&&typeof Strings.STS.L_DevDashAnimation_Stddev!="undefined"?Strings.STS.L_DevDashAnimation_Stddev:"Standard Dev",l=a&&typeof Strings.STS.L_DevDashAnimation_NumUnits!="undefined"?Strings.STS.L_DevDashAnimation_NumUnits:"#Units",i=a&&typeof Strings.STS.L_DevDashAnimation_AllFrames!="undefined"?Strings.STS.L_DevDashAnimation_AllFrames:"All Frames:",d=a&&typeof Strings.STS.L_DevDashAnimation_Header!="undefined"?Strings.STS.L_DevDashAnimation_Header:"Animation",c=a&&typeof Strings.STS.L_DevDashAnimation_Millisec!="undefined"?Strings.STS.L_DevDashAnimation_Millisec:"ms",e="<div class='ms-dd-anim'><div class='ms-dd-anim-header'>"+d+" "+b+"</div><table class='ms-dd-anim-table'><tr><td>"+f+"</td><td>"+n+"</td><td>"+p+"</td><td>"+o+"</td><td>"+m+"</td><td>"+j+"</td><td>"+l+"</td></tr><tr><td><span id='duration"+b+"'>"+String(g)+c+"</span></td><td><span id='fps"+b+"'>"+String(s)+"</span></td><td><span id='min"+b+"'>"+String(v)+c+"</span></td><td><span id='max"+b+"'>"+String(u)+c+"</span></td><td><span id='avg"+b+"'>"+String(r)+c+"</span></td><td><span id='stddev"+b+"'>"+String(k)+"</span></td><td><span id='numunit"+b+"'>"+String(h)+"</span></td></tr><tr><td colspan='7'><div id='all"+b+"'> "+i+q+"</div></td></tr><tr><td colspan='7'><div id='log"+b+"'>"+t+"</div></td></tr></table></div>";DeveloperDashboard.PostMsg("MS.AnimationTelemetry","AddAnimationData",e)}};SPAnimation.g_TelemetryObject=new AnimationTelemetry;SPAnimation.g_LastAnimationTelemetryData=null;SPAnimationUtility={};SPAnimationUtility.BasicAnimator={};SPAnimationUtility.BasicAnimator.FadeIn=function(a,c,d){if(a==null)return;SetOpacity(a,0);if(a.style.display=="none")a.style.display="";if(a.style.visibility=="hidden")a.style.visibility="";var b=new SPAnimation.State;b.SetAttribute(SPAnimation.Attribute.Opacity,1);var e=new SPAnimation.Object(SPAnimation.ID.Basic_QuickShow,0,a,b,c,d);e.RunAnimation()};SPAnimationUtility.BasicAnimator.FadeOut=function(a,c,d){if(a==null)return;var b=new SPAnimation.State;b.SetAttribute(SPAnimation.Attribute.Opacity,0);var e=new SPAnimation.Object(SPAnimation.ID.Basic_QuickFade,0,a,b,c,d);e.RunAnimation()};SPAnimationUtility.BasicAnimator.Move=function(a,c,d,e,f){if(a==null)return;var g=c==null?pxToNum(a.style.left):c,h=d==null?pxToNum(a.style.top):d,b=new SPAnimation.State;b.SetAttribute(SPAnimation.Attribute.PositionX,g);b.SetAttribute(SPAnimation.Attribute.PositionY,h);var i=new SPAnimation.Object(SPAnimation.ID.Basic_Move,0,a,b,e,f);i.RunAnimation()};SPAnimationUtility.BasicAnimator.StrikeThrough=function(a,h,l,m){if(a==null)return;var r=SPAnimationUtility.BasicAnimator.GetTopOffset(a),q=SPAnimationUtility.BasicAnimator.GetLeftOffset(a),s=SPAnimationUtility.BasicAnimator.GetRightOffset(a),d=a.offsetWidth,g=a.offsetHeight;if(h==null)h=d;var f=document.createElement("div"),e=document.createElement("div");e.style.overflow="hidden";var b=document.createElement("div");b.style.overflow="hidden";var i=a.cloneNode(true);i.style.textDecoration="line-through";e.appendChild(i);var c=a.cloneNode(true);b.appendChild(c);f.appendChild(b);f.appendChild(e);a.parentNode.appendChild(f);a.style.visibility="hidden";SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(f,r,q,g,d);var p=8;SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(e,0,0,g,p);SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(b,0,0,g,d);SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(i,0,0,g,d);SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(c,0,0,g,d);if(!fRightToLeft){b.style.left=c.style.left="";b.style.right=c.style.right="0px"}else{b.style.right=c.style.right="";b.style.left=c.style.left="0px"}var k=new SPAnimation.State;k.SetAttribute(SPAnimation.Attribute.Width,d-h);var o=new SPAnimation.Object(SPAnimation.ID.Basic_StrikeThrough,0,b,k,null,m);o.RunAnimation();var j=new SPAnimation.State;j.SetAttribute(SPAnimation.Attribute.Width,h);var n=new SPAnimation.Object(SPAnimation.ID.Basic_StrikeThrough,0,e,j,function(){a.style.textDecoration="line-through";a.style.visibility="";a.parentNode.removeChild(f);l!=null&&l()},m);n.RunAnimation()};SPAnimationUtility.BasicAnimator.PositionAbsolute=function(a){if(a==null)return;var e=SPAnimationUtility.BasicAnimator.GetTopOffset(a),d=fRightToLeft?SPAnimationUtility.BasicAnimator.GetRightOffset(a):SPAnimationUtility.BasicAnimator.GetLeftOffset(a),c=a.offsetWidth==0?a.parentNode.offsetWidth:a.offsetWidth,b=a.offsetHeight;SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(a,e,d,b,c)};SPAnimationUtility.BasicAnimator.PositionRelative=function(a){if(a==null)return;SPAnimationUtility.BasicAnimator.PositionRelativeExact(a,0,0,null,null)};SPAnimationUtility.BasicAnimator.PositionAbsoluteExact=function(a,e,d,b,c){if(a==null)return;a.style.position="absolute";SPAnimationUtility.BasicAnimator.PositionElement(a,e,d,b,c)};SPAnimationUtility.BasicAnimator.PositionRelativeExact=function(a,e,d,b,c){if(a==null)return;a.style.position="relative";SPAnimationUtility.BasicAnimator.PositionElement(a,e,d,b,c)};SPAnimationUtility.BasicAnimator.ResetPosition=function(a){if(a==null)return;a.style.position=a.style.top=a.style.left=""};SPAnimationUtility.BasicAnimator.GetLeftOffset=function(a){if(a==null)return 0;var b=a.offsetLeft;while(a.offsetParent!=null){a=a.offsetParent;if(SPAnimationUtility.BasicAnimator.IsPositioned(a)&&!(browseris.firefox&&a.tagName.toUpperCase()=="TD"))break;b+=a.offsetLeft}return b};SPAnimationUtility.BasicAnimator.GetTopOffset=function(a){if(a==null)return 0;var b=a.offsetTop;while(a.offsetParent!=null){a=a.offsetParent;if(SPAnimationUtility.BasicAnimator.IsPositioned(a)&&!(browseris.firefox&&a.tagName.toUpperCase()=="TD"))break;b+=a.offsetTop}return b};SPAnimationUtility.BasicAnimator.IsPositioned=function(a){var b=Boolean(window.getComputedStyle)?window.getComputedStyle(a,null):a.currentStyle;return b.position=="relative"||b.position=="absolute"};SPAnimationUtility.BasicAnimator.GetDefaultCloneId=function(a){return a.id+"_clone"};SPAnimationUtility.BasicAnimator.CloneElement=function(a,k,l,n,g,p,m){if(a==null)return null;if(a.id!=null&&a.id.indexOf("_clone")!=-1)return a;var j=SPAnimationUtility.BasicAnimator.GetDefaultCloneId(a),b=document.getElementById(j);if(b==null){b=document.createElement("div");if(p)b.style.zIndex="-100";var h=SPAnimationUtility.BasicAnimator.GetWindowScrollPosition(),q=h.x,r=h.y,i=SPAnimationUtility.BasicAnimator.IsPositioned(a),d=g?SPAnimationUtility.BasicAnimator.GetTopOffset(a):a.offsetTop;if(a.parentNode!=null&&a.parentNode.offsetTop>d)d=a.parentNode.offsetTop;if(!i)d-=r;var f=null;if(!m){f=fRightToLeft?SPAnimationUtility.BasicAnimator.GetRightOffset(a):g?SPAnimationUtility.BasicAnimator.GetLeftOffset(a):a.offsetLeft;if(!i)f-=q}var e=a.offsetWidth==0?a.parentNode.offsetWidth:a.offsetWidth;if(n)e=e+1;var o=a.offsetHeight==0?a.parentNode.offsetHeight:a.offsetHeight;SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(b,d,f,o,e);var c=a.innerHTML.replace(/(\s+)id=(["])([^"]*)(["])/g,"$1");c=c.replace(/(\s+)id=(['])([^']*)(['])/g,"$1");if(browseris.ie8standard)c=c.replace(/(\s+)id=([^\s<>]*)([\s>])/g,"$1$3");b.innerHTML=c;b.className=a.className;b.id=j;a.style.visibility="hidden";k&&SetOpacity(a,0);if(l)a.parentNode.insertBefore(b,a);else a.parentNode.appendChild(b)}return b};SPAnimationUtility.BasicAnimator.CommonResize=function(a,b,c,f,g,e){if(a==null)return;if(!IsNullOrUndefined(b)&&(a.style.height==null||a.style.height==""))a.style.height=String(a.clientHeight)+"px";if(!IsNullOrUndefined(c)&&(a.style.width==null||a.style.width==""))a.style.width=String(a.clientWidth)+"px";var d=new SPAnimation.State;!IsNullOrUndefined(b)&&d.SetAttribute(SPAnimation.Attribute.Height,b);!IsNullOrUndefined(c)&&d.SetAttribute(SPAnimation.Attribute.Width,c);var h=new SPAnimation.Object(e,0,a,d,f,g);h.RunAnimation()};SPAnimationUtility.BasicAnimator.Resize=function(d,b,c,a,e){SPAnimationUtility.BasicAnimator.CommonResize(d,b,c,a,e,SPAnimation.ID.Basic_Size)};SPAnimationUtility.BasicAnimator.QuickResize=function(d,b,c,a,e){SPAnimationUtility.BasicAnimator.CommonResize(d,b,c,a,e,SPAnimation.ID.Basic_QuickSize)};SPAnimationUtility.BasicAnimator.ResizeContainerAndFillContent=function(a,b,g,h){if(a==null||b==null)return;var i=a.style.zIndex,f=a.style.position,j=a.style.left,k=a.style.top;a.style.zIndex=String(1);a.style.position="absolute";a.style.left="0px";a.style.top="0px";a.style.visibility="hidden";if(!h)b.insertBefore(a,b.firstChild);else b.appendChild(a);var c=document.createElement("div");c.style.height="0px";c.style.width="0px";b.insertBefore(c,a);var d=a.clientHeight,e=a.clientWidth;SPAnimationUtility.BasicAnimator.Resize(c,d,e,function(){b.removeChild(c);a.style.left=j;a.style.top=k;a.style.zIndex=i;a.style.position=f;SPAnimationUtility.BasicAnimator.FadeIn(a,g,null)},null)};SPAnimationUtility.BasicAnimator.GetRightOffset=function(a){return document.body.offsetWidth-a.offsetWidth-SPAnimationUtility.BasicAnimator.GetLeftOffset(a)};SPAnimationUtility.BasicAnimator.PositionElement=function(a,e,b,c,d){if(!IsNullOrUndefined(e))a.style.top=String(e)+"px";if(!IsNullOrUndefined(b))fRightToLeft?a.style.right=String(b)+"px":a.style.left=String(b)+"px";if(!IsNullOrUndefined(d))a.style.width=String(d)+"px";if(!IsNullOrUndefined(c))a.style.height=String(c)+"px"};SPAnimationUtility.BasicAnimator.GetWindowScrollPosition=function(){var a=0,b=0,c=document.getElementById("s4-workspace");if(c!=null){b=c.scrollTop;a=c.scrollLeft}else{b=window.pageYOffset;a=window.pageXOffset}if(IsNullOrUndefined(b))b=0;if(IsNullOrUndefined(a))a=0;return{x:a,y:b}};SPAnimationUtility.RowAddInfo=function(){};SPAnimationUtility.RowMoveInfo=function(){};SPAnimationUtility.TableAnimator=SPAnimUtil_TableAnimator;SPAnimUtil_TableAnimator.prototype={tableElement:null,tbody:null,headerRow:null,footer:null,fAnimatable:false,topOffset:0,leftOffset:0,headerRowHeight:0,itemRowHeight:0,headerColWidths:null,itemColWidths:null};SPAnimUtil_TableAnimator.prototype.AnimatePaging=function(b,c,g){this.IncrementRefCount();var f=this.tableElement.parentNode.style.overflow;this.tableElement.parentNode.style.overflow="hidden";SetOpacity(this.tableElement,0);var a=this.tbody,h=a.nextSibling;h.style.display="";this.footer=c;SetOpacity(this.footer,0);this.footer.style.display="";a.parentNode.removeChild(a);var d=new SPAnimation.State;d.SetAttribute(SPAnimation.Attribute.Opacity,1);var k=new SPAnimation.Object(SPAnimation.ID.Basic_QuickShow,0,c,d,null,null);k.RunAnimation();var i=b?100:-100;SPAnimationUtility.BasicAnimator.PositionRelativeExact(this.tableElement,null,i,null,null);var j=this,e=new SPAnimation.State;e.SetAttribute(SPAnimation.Attribute.Opacity,1);var l=new SPAnimation.Object(b?SPAnimation.ID.Content_SlideInFadeInLeftInc:SPAnimation.ID.Content_SlideInFadeInRightInc,0,this.tableElement,e,function(){j.ResetPagingAnimation(f);g()},null);l.RunAnimation()};SPAnimUtil_TableAnimator.prototype.ResetPagingAnimation=function(a){var b=this.DecrementRefCount();if(b==0){SPAnimationUtility.BasicAnimator.ResetPosition(this.footer);this.tableElement.parentNode.style.overflow=a}};SPAnimUtil_TableAnimator.prototype.AnimateSort=function(g,b,f){this.PrepareForSortAnimation(g,b);for(var e=15,c=b.rows.length,a=0;a<c;a++){var i=b.rows[a],d=new SPAnimation.State;d.SetAttribute(SPAnimation.Attribute.Opacity,1);var h=a==0?0:100+(a-1)*e,j=new SPAnimation.Object(SPAnimation.ID.Basic_QuickShow,h,i,d,a==c-1?f:null,null);j.RunAnimation()}};SPAnimUtil_TableAnimator.prototype.PrepareForSortAnimation=function(a,b){for(var d=b.rows.length,c=0;c<d;c++){var e=b.rows[c];SetOpacity(e,0)}b.style.display="";a!=null&&a.parentNode!=null&&a.parentNode.removeChild(a)};SPAnimUtil_TableAnimator.prototype.AnimateFooter=function(c,a){this.doneFooter=false;if(this.footer!=null&&c!=0){var b=new SPAnimation.State,d=fRightToLeft?pxToNum(this.footer.style.right):pxToNum(this.footer.style.left);b.SetAttribute(SPAnimation.Attribute.PositionX,d);b.SetAttribute(SPAnimation.Attribute.PositionY,pxToNum(this.footer.style.top)+c*this.itemRowHeight);var f=this,e=new SPAnimation.Object(SPAnimation.ID.Basic_Move,0,this.footer,b,function(){a!=null&&a()},null);e.RunAnimation()}else a!=null&&a()};SPAnimUtil_TableAnimator.prototype.Initialize=function(){var a=SPAnimationUtility.BasicAnimator.GetWindowScrollPosition(),b=a.x,c=a.y;this.topOffset=SPAnimationUtility.BasicAnimator.GetTopOffset(this.tableElement)-c;this.leftOffset=fRightToLeft?SPAnimationUtility.BasicAnimator.GetRightOffset(this.tableElement)-b:SPAnimationUtility.BasicAnimator.GetLeftOffset(this.tableElement)-b;this.tbody=this.GetTableBody();this.headerRow=this.tableElement.rows[0];this.headerRowHeight=this.tableElement.firstChild.offsetHeight;this.itemRowHeight=this.tbody.rows[0].offsetHeight;this.headerColWidths=this.GetColumnWidths(this.headerRow);this.itemColWidths=this.GetColumnWidths(this.tbody.rows[0])};SPAnimUtil_TableAnimator.prototype.GetTableBody=function(){var a=this.tableElement.firstChild;while(a.nodeName!="TBODY")a=a.nextSibling;return a};SPAnimUtil_TableAnimator.prototype.GetColumnWidths=function(b){var i=new Array(0);while(this.IsErrorRow(b))b=b.nextSibling;for(var c=0;c<b.childNodes.length;c++){var f=b.childNodes[c],a=Boolean(window.getComputedStyle)?window.getComputedStyle(f,null):f.currentStyle,h=pxToNum(a.paddingLeft),g=pxToNum(a.paddingRight),e=pxToNum(a.borderLeftWidth)+pxToNum(a.marginLeft),d=pxToNum(a.borderRightWidth)+pxToNum(a.marginRight);if(isNaN(e))e=0;if(isNaN(d))d=0;i[c]=[f.clientWidth-h-g,h+e,g+d]}return i};SPAnimUtil_TableAnimator.prototype.IncrementRefCount=function(){var a=this.tableElement.getAttribute("AnimationRefCount"),b=a==null?1:Number(a)+1;this.tableElement.setAttribute("AnimationRefCount",String(b));return b};SPAnimUtil_TableAnimator.prototype.DecrementRefCount=function(){var a=Number(this.tableElement.getAttribute("AnimationRefCount"));this.tableElement.setAttribute("AnimationRefCount",String(--a));return a};SPAnimUtil_TableAnimator.prototype.IsErrorRow=function(a){return a.className.indexOf("ms-dragupload-error")!=-1};IsMenuShown=false;ChevronContainer=null;itemTableDeferred=null;imageCell=null;onKeyPress=false;downArrowText=null;currentEditMenu=null;currentItemID=null;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemOpenApp=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;bIsCheckout=0;currentItemCanModify=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemEvtType=0;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null;currentItemIsMountPoint=null;g_MaximumSelectedItemsAllowed=100;g_CustomActionDialogHandlers={};g_CustomActionDialogHandlerId=0;g_ExpGroupWPState=new LRUCache;DocOpen={CLIENT:0,BROWSER:1};hoverTR=null;ecbTD=null;ProtocolCommand={View:"ofv",Edit:"ofe",New:"nft"};phManager=new function(){var a=false,c=false,b={};this.ShouldTryProtocolHandler=function(a){return!IsStrNullOrEmpty(a)&&typeof navigator.msLaunchUri=="function"&&b[a]==null};this.Win7IE11=function(){return navigator.appVersion.indexOf("Windows NT 6.1")!=-1&&browseris.ie11};this.SetProtocolHandlerEnabled=function(d,a){b[d]=a;if(a===null)c=false};this.LaunchProtocolHandler=function(c,b){var d=setTimeout(function(){window.removeEventListener("blur",a);alert(b)},1e4);function a(){clearTimeout(d);window.removeEventListener("blur",a)}window.onblur=a;window.location.href=c};this.LaunchProtocolHandlerInIFrame=function(c,b){var a=document.querySelector("#hiddenIFrame");if(a==undefined){a=document.createElement("iframe");a.src="about:blank";a.id="hiddenIFrame";a.style.display="none";document.body.appendChild(a)}try{a.contentWindow.location.href=c}catch(d){d.name=="NS_ERROR_UNKNOWN_PROTOCOL"&&alert(b)}};this.IsProtocolHandlerEnabled=function(d,e){if(IsStrNullOrEmpty(d))return false;if((browseris.ie10standardUp||browseris.msEdge)&&typeof navigator.msLaunchUri=="undefined"&&d!=="ms-project"&&!this.Win7IE11())return false;if(b[d]!=null)return b[d];if((IsSupportedChromeOnWin()||IsSupportedFirefoxOnWin())&&d==="ms-project")a=true;if(c)return a;c=true;if(d==="ms-project"){if(typeof navigator.msLaunchUri=="function"){a=true;return a}if(this.Win7IE11())a=true}if(Boolean(window.ActiveXObject)||"ActiveXObject"in window)try{if(d==="ms-project")var g=new ActiveXObject("WinProj.Activator");else var h=new ActiveXObject("SharePoint.OpenDocuments.3");a=true}catch(i){}else if(IsSupportedNPApiBrowserOnWin()){var f=CreateNPApiOnWindowsPlugin("application/x-sharepoint");if(f!=null)try{if(f.GetOfficeVersion()=="15")a=true}catch(i){}else if(browseris.chrome&&!e)a=true}else if((browseris.safari||browseris.ie11)&&!e)a=true;return a};this.CreateBlogPostProtocolHandlerUrl=function(b,d,c){var a=[];a.push("ms-word:obe|bp|");a.push(b);a.push("|bu|");a.push(d);a.push("|bn|");a.push(c);return Encoding.EncodePath(a.join(""),true)};this.CreateProtocolHandlerUrl=function(c,h,e,i,f){var a=[],d=f,b=c.split("|");if(b.length==2){a.push(b[0]);a.push(":");a.push(h);return a.join("")}else if(b.length==3)c=b[0];a.push(c);a.push(":");a.push(e);!(window.OffSwitch==null||OffSwitch.IsActive("423DCB15-E0B1-485E-9D9C-89DD8488B184"))&&Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.isSPO)&&c==="ms-excel"&&e!=ProtocolCommand.New&&a.push(d?"%7Cofc":"|ofc");a.push(d?"%7Cu%7C":"|u|");a.push(h);if(e==ProtocolCommand.New){a.push(d?"%7Cs%7C":"|s|");a.push(i)}var g=a.join("");return f?g:Encoding.EncodePath(g,true)}};CBSelectedValues_InitializePrototype();g_ExtensionNotSupportCheckoutToLocal=["ascx","asp","aspx","htm","html","master","odc","exe","bat","com","cmd","onetoc2"];g_ExtensionDefaultForRead=["jpg","jpeg","bmp","png","gif","onetoc2","one","odc"];bValidSearchTerm=false;fListControl=false;fListErrorShown=false;fNewDoc=false;fNewDoc2=false;fNewDoc3=false;SPDesignerDownloadUrl="http://o15.officeredir.microsoft.com/r/rlidSPD2013Download";SPDesignerProgID="SharePoint.WebPartPage.Document";CtxRgiid_InitializePrototype();g_varSkipRefreshOnFocus=0;g_useDialogAlwaysList=["upload.aspx","uploadex.aspx","deploydeveloperapp.aspx"];DocType={Invalid:0,Word:1,Excel:2,PowerPoint:3,Visio:8};LRUCache_InitializePrototype();v_stsOpenDoc=null;v_strStsOpenDoc=null;_lightboxImageExtensions=["GIF","JPG","JPEG","JPE","JFIF","BMP","DIB","PNG","TIF","TIFF","ICO","WDP","HDP"];_lightboxVideoExtensions=["WMV","WMA","AVI","MPG","MP4","ASF","OGG","OGV","OGA","WEBM"];g_AdditionalNavigateHierarchyQString="";httpFolderTarget=null;httpFolderSource=null;httpFolderDiv=null;IframeWorker=function(b){var g=500,f=10,d=0,a=document.getElementById(b);function c(e,a){var i=document.getElementById(b),h=GetIFrameDoc(i);if(h.readyState=="complete"){Boolean(e)&&e();return}d++;if(d<=f)window.setTimeout(function(){c(e,a)},g);else Boolean(a)&&a()}function e(c){if(!Boolean(a)&&Boolean(c)){a=document.createElement("iframe");a.id=b;a.name=b;a.className="ObjectInDialog";a.style.visibility="hidden";a.src=c;document.body.appendChild(a)}return a}return{getFrameId:function(){return b},getFrame:function(){return a},checkFrameLoaded:c,createAndAppendFrame:e}};g_onRefreshCommandUIHandlers=[];previousClickedItemRow=null;Point.prototype={x:undefined,y:undefined,toString:function(){return"("+String(this.x)+","+String(this.y)+")"}};isdlg=ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"));if(_spBodyOnLoadFunctionNames!=null&&typeof _spBodyOnLoadFunctionNames!="undefined"){_spBodyOnLoadFunctionNames.push("SearchOnBodyLoad");_spBodyOnLoadFunctionNames.push("LoadGroupAndSiteLinkingBanners")}preventResizeHandler=false;if(typeof g_PreventResizeHandler!=="undefined"&&g_PreventResizeHandler!==null)preventResizeHandler=Boolean(g_PreventResizeHandler);isdlg==null&&!preventResizeHandler&&SetEvent("resize",FixRibbonAndWorkspaceDimensionsForResize,window);g_listItemCache={};g_fSkipAnimation=false;g_fSkipNextTabExpandAnimation=false;_searchClickLogTerm="";_searchClickLogSeq=0;_updateInterval=30*1e3*60;g_NotificationEngine=null;g_notiExpireTimerId=-1;g_standardNotiCt=null;g_statusNotiCt=null;SPNotifications={};SPNotifications.ContainerID={Basic:0,Status:1};g_SPNotificationEventID_Count=5;SPNotifications.EventID={OnShow:0,OnHide:1,OnDisplayNotification:2,OnRemoveNotification:3,OnNotificationCountChanged:4,OnDisposing:5};SP.UI.Notify={};SP.UI.Notify.Notification=SPNotification;SP.UI.Notify.NotificationContainer=SPNotificationContainer;SP.UI.Notify.addNotification=function(b,a){return addNotification(b,a)};SP.UI.Notify.removeNotification=function(a){removeNotification(a)};SP.UI.Notify.showLoadingNotification=function(a){var b="<img src='/_layouts/15/images/loadingcirclests16.gif?rev=47' style='vertical-align:bottom; display:inline-block; margin-"+(document.documentElement.dir=="rtl"?"left":"right")+":2px;' />&nbsp;<span style='vertical-align:top;'>"+STSHtmlEncode(Strings.STS.L_Loading_Text)+"</span>";return addNotification(b,a)};NotificationEngine.prototype={Initialized:false,Notifications:undefined,Containers:undefined,Initialize:undefined,AddNotification:undefined,AddContainer:undefined,DisposeNotification:undefined,SetExpireTimer:undefined,RetireNotificationInternal:undefined};(function(){var d=null,b=-1;NotificationEngine.prototype.Initialize=function(){if(this.Initialized)return;this.Notifications={};this.Containers={};this.Initialized=true};NotificationEngine.prototype.Reset=function(){var a,c;for(c in this.Containers){a=this.Containers[c];a.Dispose();a.UnblockUpdatesInternal()}var d=b;b=-1;window.clearInterval(d)};NotificationEngine.prototype.AddNotification=function(b,a){var c=this.Containers[b];a.container=c;this.Notifications[a.id]=a};NotificationEngine.prototype.AddContainer=function(a){this.Containers[a.id]=a};NotificationEngine.prototype.DisposeNotification=function(a){if(this.Notifications[a.id]!=null){delete this.Notifications[a.id];delete a}};NotificationEngine.prototype.SetExpireTimer=function(d,c){var e=new Date;d.expires=e.valueOf()+c;if(b==-1)b=window.setInterval(function(){a().RetireNotificationInternal()},750)};NotificationEngine.prototype.RetireNotificationInternal=function(){var i=new Date,h=i.valueOf(),e=true,d,c,a,f=[];for(d in this.Notifications){c=this.Notifications[d];if(c.expires!=null)if(h>c.expires)f.push(c);else e=false}while(f.length>0){c=f.shift();a=c.container;a.RemoveNotification(c);a.pendingUpdate=true}for(d in this.Containers){a=this.Containers[d];if(a.items.length>0)e=false;if(Boolean(a.pendingUpdate)){a.Update();delete a.pendingUpdate}}if(e){var g=b;b=-1;window.clearInterval(g)}};SPNotification.prototype={id:undefined,elm:undefined,strHtml:undefined,strTooltip:undefined,bSticky:undefined,bIsAdd:undefined,bNoAnimate:undefined,bHidden:undefined,onclickHandler:undefined,container:undefined,extraData:undefined,expires:undefined,ariaLiveAttribute:undefined};SPNotification.prototype.Initialize=function(f,j,i,g,d,h,e){var c="notification_"+String(getUniqueIndex()),b=document.createElement("span");b.id=c;this.id=c;this.bIsAdd=true;this.elm=b;this.strHtml=j;this.extraData=h;this.bSticky=i;this.strTooltip=g;this.onclickHandler=d;this.bHidden=false;this.ariaLiveAttribute=e;a().AddNotification(f,this)};SPNotification.prototype.Show=function(a){if(Boolean(a)==true)this.bNoAnimate=true;this.container.AddNotification(this)};SPNotification.prototype.Hide=function(a){if(Boolean(a)==true)this.bNoAnimate=true;this.container.RemoveNotification(this)};SPNotificationContainer.prototype={id:undefined,element:undefined,bIsShown:undefined,bIsBlocked:undefined,nDisposalState:undefined,nNotificationLayer:25,nDisplayDuration:7e3,nMaxNotifications:20,events:undefined,items:undefined,pending:undefined,blockedUpdates:undefined};SPNotificationContainer.prototype.Initialize=function(f,d,e,b){this.id=f;this.element=d;this.events=new Array(g_SPNotificationEventID_Count);this.bIsShown=false;this.nNotificationLayer=e;this.bIsBlocked=false;this.items=[];this.pending=[];this.blockedUpdates=[];this.nDisposalState=0;var c=this;this.items.add=function(a){this.push(a);c.FireEvent(SPNotifications.EventID.OnNotificationCountChanged)};this.items.remove=function(d){var a,b;for(a=0,b=this.length;a<b;a++)if(d.id==this[a].id){this.splice(a,1);c.FireEvent(SPNotifications.EventID.OnNotificationCountChanged);return true}return false};if(b!=null)this.nMaxNotifications=b;a().AddContainer(this)};SPNotificationContainer.prototype.Dispose=function(){if(this.nDisposalState>0)return;this.nDisposalState=1;this.Clear()};SPNotificationContainer.prototype.AddNotification=function(b){var d,e;for(d=0,e=this.items.length;d<e;d++)if(b.id==this.items[d].id)return;if(this.GetCount()<this.nMaxNotifications){b.bHidden=false;b.elm.style.display=""}else{b.bHidden=true;b.elm.style.display="none"}this.items.add(b);var c=this,f=function(){!Boolean(b.bSticky)&&a().SetExpireTimer(b,c.nDisplayDuration);!c.bIsShown&&c.Show();c.FireEvent(SPNotifications.EventID.OnDisplayNotification,b,function(){c.Update();return true});c.Update()};if(this.bIsBlocked&&this.nDisposalState===0)this.pending.push(f);else f()};SPNotificationContainer.prototype.RemoveNotification=function(b){if(b.bIsAdd===false)return;b.bIsAdd=false;var d,f,e=false;for(d=0,f=this.pending.length;d<f;d++)if(b.id==this.pending[d].id){this.pending.splice(d,1);e=true}if(e){this.items.remove(b);return}var c=this,g=function(){c.FireEvent(SPNotifications.EventID.OnRemoveNotification,b,function(){try{c.items.remove(b);var e=b.elm,d=c.element;d.removeChild(e)}catch(f){}a().DisposeNotification(b);c.Update();return true});c.Update()};if(this.bIsBlocked&&this.nDisposalState===0)this.pending.push(g);else g()};SPNotificationContainer.prototype.ShowAllNotifications=function(){var a,d,c=this.items;for(a=0,d=c.length;a<d;a++){var b=c[a];if(b.bHidden){b.bHidden=false;b.elm.style.display=""}}};SPNotificationContainer.prototype.Update=function(){!this.element.hasChildNodes()&&this.items.length==0&&this.Hide();if(this.bIsShown)for(var b in a().Containers)this.BlockUpdatesInternal(a().Containers[b])};SPNotificationContainer.prototype.Clear=function(d){for(var c=this.items,b=c.length-1;b>=0;b--){var a=c[b];if(!Boolean(a)||!a.bIsAdd)continue;if(Boolean(d))a.bNoAnimate=true;this.RemoveNotification(a)}};SPNotificationContainer.prototype.GetCount=function(){return this.items.length};SPNotificationContainer.prototype.GetHiddenCount=function(){var b=0,a,d,c=this.items;for(a=0,d=c.length;a<d;a++){var e=c[a];if(e.bHidden)b++}return b};SPNotificationContainer.prototype.SetEventHandler=function(a,b){if(this.events[a]!=null)throw"Event handler already specified for eventId "+String(a)+". ContainerId: "+String(this.id);this.events[a]=b};SPNotificationContainer.prototype.FireEvent=function(a){if(a>g_SPNotificationEventID_Count)throw"Invalid eventId "+String(a)+". ContainerId: "+String(this.id);if(this.events[a]!=null){var b=this.events[a];Array.prototype.shift.call(arguments);b.apply(null,arguments)}};SPNotificationContainer.prototype.Show=function(){if(this.bIsShown)return;this.bIsShown=true;var a=this;this.FireEvent(SPNotifications.EventID.OnShow,function(){a.Update();return true})};SPNotificationContainer.prototype.Hide=function(){if(!this.bIsShown)return;this.bIsShown=false;while(this.element.hasChildNodes())this.element.removeChild(this.element.firstChild);var a=this;this.FireEvent(SPNotifications.EventID.OnHide,function(){if(a.nDisposalState==0){a.UnblockUpdatesInternal();a.Update()}else if(a.nDisposalState==1){a.nDisposalState=2;a.FireEvent(SPNotifications.EventID.OnDisposing)}return true})};SPNotificationContainer.prototype.BlockUpdatesInternal=function(a){if(a.nNotificationLayer>this.nNotificationLayer||a.id==this.id)return;var b,d,c=false;for(b=0,d=this.blockedUpdates.length;b<d;b++)if(a.id==this.blockedUpdates[b].id){c=true;break}if(c)return;a.bIsBlocked=true;this.blockedUpdates.push(a);return};SPNotificationContainer.prototype.UnblockUpdatesInternal=function(){while(this.blockedUpdates.length>0){var a=this.blockedUpdates.shift();a.bIsBlocked=false;while(a.pending.length>0){var b=a.pending.shift();b()}a.Update()}};var e=function(a,j){var b=a.elm,e=a.onclickHandler,f=a.strTooltip,i=a.bNoAnimate,h=function(){e!=null&&e();removeNotification(b.id,i);return false};b.className="ms-trcnoti-base";!a.bNoAnimate&&SetOpacity(b,0);var c=document.createElement("div");c.className="ms-trcnoti-bg";AttachEvent("click",h,c);var d=document.createElement("div");d.className=j;c.appendChild(d);b.appendChild(c);if(Boolean(f))b.title=f;b.setAttribute("role","alert");if(Boolean(a.ariaLiveAttribute)&&Boolean(a.container)){var g=a.container.element;Boolean(g)&&g.setAttribute("aria-live",a.ariaLiveAttribute)}return d},c=function(a,f,d,c){var g=a.elm;if(a.bNoAnimate||IsAccessibilityFeatureEnabled())c(a);else{var b=new SPAnimation.State;b.SetAttribute(SPAnimation.Attribute.Opacity,d);var e=new SPAnimation.Object(f,0,g,b,c,a);e.RunAnimation()}};function f(d){var a=document.createElement("div"),c=document.createElement("div"),b=document.createElement("div");a.className="ms-trcnoti-border";c.className="ms-fullWidth";b.className="ms-trcnoti-host ms-fullWidth";c.appendChild(b);a.appendChild(c);d.appendChild(a);return{ctr:d,root:a,host:b}}function i(){var c=document.createElement("div");c.className="ms-trcnoti-ctr";document.body.appendChild(c);var a=f(c);a.root.id="js-trcnoti-ct";a.host.id="js-trcnoti-host";a.root.style.display="none";var b=document.createElement("div");b.id="ms-trcnoti-ovrflw";b.className="ms-trcnoti-ovrflw ms-trcnoti-bg";a.host.parentNode.appendChild(b);a.ovrflw=b;return a}function j(){var a=document.getElementById("notificationArea");if(a==null){a=document.createElement("div");a.id="notificationArea";var b=document.getElementById("contentBox");if(null!=b)b.appendChild(a);else document.body.appendChild(a)}a.style.display="none";var c=f(a);return c}function g(){if(g_standardNotiCt!=null)return g_standardNotiCt;var d=j(),a=d.ctr,b=d.host;g_standardNotiCt=new SPNotificationContainer(SPNotifications.ContainerID.Basic,b,50);var f=function(a){var b=e(a,"ms-trcnoti-toast");b.innerHTML=a.strHtml},i=function(b){a.style.display="none";b()},k=function(b){a.setAttribute("aria-live","polite");a.setAttribute("aria-relevant","all");a.style.display="block";b()},g=function(a,e){f(a);var d=a.elm;d.style.top="0px";b.appendChild(d);c(a,SPAnimation.ID.SmallObject_SlideInFadeInTop,1,e)},h=function(b,a){c(b,SPAnimation.ID.Basic_Fade,0,a)};g_standardNotiCt.SetEventHandler(SPNotifications.EventID.OnHide,i);g_standardNotiCt.SetEventHandler(SPNotifications.EventID.OnShow,k);g_standardNotiCt.SetEventHandler(SPNotifications.EventID.OnDisplayNotification,g);g_standardNotiCt.SetEventHandler(SPNotifications.EventID.OnRemoveNotification,h);return g_standardNotiCt}function h(){var g=i(),q=g.ctr,f=g.root,b=g.ovrflw,d=g.host,a=new SPNotificationContainer(SPNotifications.ContainerID.Status,d,75,3);function j(g,e,f){var d=document.createElement("span"),b=document.createElement("a"),a=document.createElement("img"),c=document.createElement("a");b.href="#";c.className="ms-core-defaultFont ms-textLarge";b.className="ms-imnlink";b.onclick=function(){IMNImageOnClick(event);return false};a.id=g+"_imn,type=sip";a.setAttribute("name","imnmark");a.className="ms-imnImg";a.title="";a.border=0;a.src="/_layouts/15/images/blank.gif?rev=47";a.alt=Strings.STS.L_NoPresenceInformation;a.width="12px";a.height="12px";a.style.verticalAlign="middle";a.style.marginRight="0px";a.setAttribute("sip",f);c.innerHTML=e;b.appendChild(a);d.appendChild(b);d.appendChild(c);return d}var h=function(h){var q=e(h,"ms-trcnoti-status"),m=h.strHtml,b=h.extraData,k=document.createElement("div"),d=document.createElement("div"),a=document.createElement("div");d.className="ms-trcnoti-body";k.className="ms-trcnoti-gfx";a.className="ms-trcnoti-txt ms-core-defaultFont ms-trc-noti-title";if(b.img!=null){var i=document.createElement("img");i.src=b.img;if(browseris.ie){i.removeAttribute("width");i.removeAttribute("height")}k.appendChild(i)}if(b.sip!=null)if(browseris.ie5up){var p=j(h.id,m,b.sip);a.appendChild(p);for(var g=p.getElementsByTagName("img"),c=0,r=g.length;c<r;c++)g[c].name=="imnmark"&&IMNRC(g[c].getAttribute("sip"),g[c])}else{var o=document.createElement("span");o.innerHTML=m;a.insertBefore(o,a.firstChild)}else{var l=document.createElement("span");l.className="ms-core-defaultFont ms-textLarge";l.innerHTML=m;a.appendChild(l)}a.appendChild(document.createTextNode(" "));var n=document.createElement("span");n.className="ms-textSmall";n.innerHTML=b.txt;a.appendChild(n);d.appendChild(a);if(b.dt!=null){var f=document.createElement("div");f.className="ms-trcnoti-dt ms-metadata";if(browseris.ie)f.style.paddingBottom="1px";f.innerHTML=b.dt;d.appendChild(f)}q.appendChild(k);q.appendChild(d)},p=function(b){d.setAttribute("aria-live","polite");d.setAttribute("aria-relevant","all");if(IsAccessibilityFeatureEnabled())b();else{var a=new SPAnimation.State;a.SetAttribute(SPAnimation.Attribute.Opacity,1);f.style.top="0px";var c=new SPAnimation.Object(SPAnimation.ID.SmallObject_SlideInFadeInTop,0,f,a,b,null);c.RunAnimation()}f.style.display="block"},o=function(a){f.style.display="none";a()},l=function(a,b){if(typeof a.extraData==="undefined"||a.extraData===null)throw"Argument Error: Status notifications requires extraData argument";h(a);d.insertBefore(a.elm,d.firstChild);a.elm.style.top="0px";c(a,SPAnimation.ID.SmallObject_SlideInFadeInTop,1,b)},n=function(b,a){c(b,SPAnimation.ID.Basic_Fade,0,a)},k=function(){var c=a.GetHiddenCount();if(c>0){b.style.display="block";b.innerHTML=StBuildParam(Strings.STS.L_NotificationsAndNMore,c);b.onclick=function(){a.ShowAllNotifications();b.style.display="none";return false}}else b.style.display="none"},m=function(){document.body.removeChild(q)};a.SetEventHandler(SPNotifications.EventID.OnShow,p);a.SetEventHandler(SPNotifications.EventID.OnHide,o);a.SetEventHandler(SPNotifications.EventID.OnDisplayNotification,l);a.SetEventHandler(SPNotifications.EventID.OnRemoveNotification,n);a.SetEventHandler(SPNotifications.EventID.OnNotificationCountChanged,k);a.SetEventHandler(SPNotifications.EventID.OnDisposing,m);g_statusNotiCt=a}addNotification=function(f,e,d,b,c){var a=new SPNotification(SPNotifications.ContainerID.Basic,f,e,d,b);a.Show(c);return a.id};removeNotification=function(d,c){var b=a().Notifications[d];Boolean(b)&&b.Hide(c)};function a(){if(d===null){g_NotificationEngine=new NotificationEngine;d=g_NotificationEngine;g();h()}return d}NotificationEngine.GetInstance=a})();cGCMinimumWidth=400;cGCMinimumHeight=200;cGCMaxGCResizeCount=10;glGCObjectHeight=0;glGCObjectWidth=0;glGCResizeCounter=0;objGCGlobal=null;checkNewEcbFlights(null);WSS_MENUITEMSEQUENCE_REPLY=100;WSS_MENUITEMSEQUENCE_VIEWPROPERTIES=200;WSS_MENUITEMSEQUENCE_EDITPROPERTIES=220;WSS_MENUITEMSEQUENCE_EDITSERIESITEM=230;WSS_MENUITEMSEQUENCE_EDITINOIS=260;WSS_MENUITEMSEQUENCE_EDITINAPPLICATION=260;WSS_MENUITEMSEQUENCE_OPENFOLDER=270;WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT=300;WSS_MENUITEMSEQUENCE_DISCARDCHECKOU=310;WSS_MENUITEMSEQUENCE_PUBLISHITEM=320;WSS_MENUITEMSEQUENCE_CANCELPUBLISH=330;WSS_MENUITEMSEQUENCE_EXPORTCONTACT=350;WSS_MENUITEMSEQUENCE_SENDMENU=400;WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM=440;WSS_MENUITEMSEQUENCE_DOCTRANMENU=500;WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL=550;WSS_MENUITEMSEQUENCE_VERSIONS=800;WSS_MENUITEMSEQUENCE_MODERATEITEM=850;WSS_MENUITEMSEQUENCE_WORKFLOWS=900;WSS_MENUITEMSEQUENCE_ADDTOMYLINKS=1e3;WSS_MENUITEMSEQUENCE_ADDTOCATEGORY=1050;WSS_MENUITEMSEQUENCE_SUBSCRIBE=1100;WSS_MENUITEMSEQUENCE_DISCUSS=1130;WSS_MENUITEMSEQUENCE_PUBLISHBACK=1140;WSS_MENUITEMSEQUENCE_CREATEDWS=1140;WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS=1160;WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON=1170;WSS_MENUITEMSEQUENCE_DELETEITEM=1180;WSS_MENUITEMSEQUENCE_DELETEDOCITEM=1190;WSS_MENUITEMSEQUENCE_MOVECOPYITEM=1200;WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION=1210;WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION=1220;WSS_MENUITEMSEQUENCE_UPGRADESOLUTION=1230;WSS_MENUITEMSEQUENCE_ENCRYPTITEM=1240;setNewEcbCmdSequence();g_menuLaunchPoint=null;ecbManager={callOutPar:null,DismissECB:function(){var c={};if(ecbManager.callOutPar!=null){var e=itemTable;c.callOut=true;OutItem(c);ecbManager.callOutPar=null;itemTable=e}var d=window.event,a=null;if(d!=null)a=Boolean(d.srcElement)?d.srcElement:d.target;while(a!=null&&a.tagName!="TR")a=a.parentNode;var b=null;if(a!=null&&itemTable!=null){b=itemTable;while(b!=null){if(b==a)break;b=b.parentNode}}if(b==null){c.callOut=false;OutItem(c)}}};ecbItems="ECBItems";SYSTEM_ACCOUNT_ID=1073741823;_ContextForShowingShareDialog=null;resetItemGlobals();seqCompare=function(a,b){return Number(a.seq)<Number(b.seq)?-1:Number(a.seq)>Number(b.seq)?1:0};_spBodyOnLoadFunctions.push(InitFullScreenMode);filterTable=null;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;filterStr=null;strFieldName="";bMenuLoadInProgress=false;strFilteredValue=null;bIsMultiFilter=false;fnOnFilterMouseOut=null;if(typeof String.prototype.trim=="undefined")String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};if(typeof Object.create==="undefined")Object.create=function(b){function a(){}a.prototype=b;return new a};if(typeof Object.keys==="undefined")Object.keys=function(c){var b=[];for(var a in c)c.hasOwnProperty(a)&&b.push(a);return b};RibbonBlock.prototype={initialTabId:null,buildMinimized:true,initStarted:false,initialTabSelectedByUser:false,launchedByKeyboard:false};kfnDisableEvent=new Function("return false");g_menuHtc_lastMenu=null;g_uniqueNumber=0;g_MenuEndOfDOM=false;ElementPosition_InitializePrototype();MenuTag_InitializePrototype();MMU_chDelim=",";MMU_chDelimEnc="%2c";MMU_postbackPrefix="javascript:__doPostBack(";MMU_chDelim2="%";MMU_chDelim2Enc="%25";MHash_InitializePrototype();ParseContext_InitializePrototype();MMU_reDelimEnc=new RegExp(MMU_chDelimEnc,"g");MMU_reDelim2Enc=new RegExp(MMU_chDelim2Enc,"g");MMU_reDelimDec=new RegExp(MMU_chDelim,"g");MMU_reDelim2Dec=new RegExp(MMU_chDelim2,"g");g_MMU_HighlightedEcbTable=null;g_MMU_HighlightedEcbTableOpen=null;g_MMU_OpenTimeoutHandle=null;g_MMU_theFormActionAtPageLoad=null;g_MMU_Form0ActionAtPageLoad=null;g_MMU_Form0ActionAtPreMenuOpen=null;g_MMU_RequestTimeoutTimeoutHandle=null;_AddSilverlightWebPartPopupUI_InitializePrototype();_ConfigSilverlightWebpartPopupUI_InitializePrototype();_launchNotificationId=null;_tenantAppData=null;if(typeof Accessibility=="undefined"){Accessibility={__namespace:true};Accessibility_module_def()}if(typeof DOM_afterglass=="undefined"){DOM_afterglass={__namespace:true};DOM_afterglass_module_def()}GetAncestor=DOM_afterglass.GetAncestor;GetAncestorByTagNames=DOM_afterglass.GetAncestorByTagNames;GetParentLinkFromEvent=DOM_afterglass.GetParentLinkFromEvent;GetPosition=DOM_afterglass.GetPosition;GetSelectedElement=DOM_afterglass.GetSelectedElement;IsContained=DOM_afterglass.IsContained;IsEventRightClickOnAnchor=DOM_afterglass.IsEventRightClickOnAnchor;IsEventTargetAnchor=DOM_afterglass.IsEventTargetAnchor;if(typeof ListModule_afterglass=="undefined"){ListModule_afterglass={__namespace:true};ListModule_afterglass_module_def()}_ListHeaderMenu_OnMouseDown=ListModule.Util.headerMenuMouseDown;CountSelectedItems=ListModule.Util.countSelectedItems;CountTotalItems=ListModule.Util.countTotalItems;CreateAjaxMenu=ListModule.Util.createAjaxMenu;CtxFromElement=ListModule.Util.ctxFromElement;FetchEcbInfo=ListModule.Util.fetchEcbInfo;FindSTSMenuTable=ListModule.Util.findSTSMenuTable;FocusRow=ListModule.Util.focusRow;GetEcbDivFromEcbTd=ListModule.Util.getEcbDivFromEcbTd;GetEcbTdFromRow=ListModule.Util.getEcbTdFromRow;GetItemRowCbx=ListModule.Util.getItemRowCbx;getFilterValueFromUrl=ListModule.Util.getFilterValueFromUrl;GetLastSelectableRowIdx=ListModule.Util.getLastSelectableRowIdx;GetRootFolder=ListModule.Util.getRootFolder;GetRootFolder2=ListModule.Util.getRootFolder2;GetUrlWithNoSortParameters=ListModule.Util.getUrlWithNoSortParameters;GroupNameFromRow=ListModule.Util.groupNameFromRow;GroupStringFromGroupName=ListModule.Util.groupStringFromGroupName;ItemHasiid=ListModule.Util.itemHasIid;ItemIsCurrentlySelected=ListModule.Util.itemIsCurrentlySelected;ItemIsCurrentlyVisible=ListModule.Util.itemIsCurrentlyVisible;ItemIsSelectable=ListModule.Util.itemIsSelectable;OnItemSelectionChanged=ListModule.Util.onItemSelectionChanged;SelectListItem=ListModule.Util.selectListItem;SetFocusOnRowDelayed=ListModule.Util.setFocusOnRowDelayed;ShowECBMenuForTr=ListModule.Util.showEcbMenuForTr;ToggleItemRowSelection2=ListModule.Util.toggleItemRowSelection2;UpdateCtxLastSelectableRow=ListModule.Util.updateCtxLastSelectableRow;UpdateSelectAllCbx=ListModule.Util.updateSelectAllCbx;_OnFocusFilter=ListModule.Util.onFocusFilter;FindCtxImg=ListModule.Util.findCtxImg;ShowCtxImg=ListModule.Util.showCtximg;RemoveCtxImg=ListModule.Util.removeCtxImg;PositionCtxImg=ListModule.Util.positionCtxImg;List_CreateCtxImg_Helper=ListModule.Util.createCtxImg_Helper;FilterFieldV3=ListModule.Util.FilterField;RegisterOnItemSelectionChangedHandler=ListModule.Util.registerOnItemSelectionChangedHandler;UnregisterOnItemSelectionChangedHandler=ListModule.Util.unregisterOnItemSelectionChangedHandler;DocumentType={Invalid:0,Word:1,Excel:2,PowerPoint:3,OneNote:4,ExcelForm:5,Folder:6,SuiteExtensionApp:7,Visio:8,Max:9};DocumentInformation.prototype={type:undefined,idToken:undefined,imgSrc:undefined,imgAlt:undefined,textLabel:undefined};c_newdocWOPIID="js-newdocWOPI-";c_newDocDivHtml=['<a id="{0}" class="ms-newdoc-callout-item ms-displayBlock" onclick="{5}" href="#">','<img id="{1}" src="{2}" alt="{3}" class="ms-verticalAlignMiddle ms-newdoc-callout-img"/>','<h3 id="{4}" class="ms-displayInline ms-newdoc-callout-text ms-verticalAlignMiddle ms-soften">{6}</h3></a>'].join("");c_onClickCreateDoc="CalloutManager.closeAll(); OpenPopUpPageWithTitle(&quot;{0}&TemplateType={1}&quot;, OnCloseDialogNavigate); return false;";c_newDocCalloutWidth=parseInt(typeof Strings!="undefined"?Strings.STS.L_NewDocumentCalloutSize:"");NewDocumentInfo=InitializeNewDocumentInfo();g_lastLaunchPointIIDClicked=null;usedCalloutIDs={};generateUniqueCalloutIDFromBaseID=function(a){if(typeof usedCalloutIDs[a]!=="number"){usedCalloutIDs[a]=0;return a}else{++usedCalloutIDs[a];return a+"_"+String(usedCalloutIDs[a])}};Callout_OnOpeningCallback=function(b,f){var d=b.getLaunchPoint(),h=GetAncestorByTagNames(d,["TR"]),a=GetEcbTdFromRow(h),c=null;if(a!=null)c=GetEcbDivFromEcbTd(a);else{a=GetAncestorByTagNames(d,["TD"]);c=m$(a).find("div.ms-vb.itx")[0]}var g=c.getAttribute("CTXName"),e=GenerateCtx(g_ctxDict[g],f);e.CurrentCallout=b;SPClientRenderer.Render(b.getContentElement(),e)};GenerateCtx=function(f,i){var g="ctx"+f.ctxId+"Callout",a=g_ctxDict[g];a={};for(var b in f)if(b!=="OnPostRender"&&b!=="OnPreRender")a[b]=f[b];a.BaseViewID="Callout";a.Templates=SPClientTemplates.TemplateManager.GetTemplates(a);g_ctxDict[g]=a;for(var h=getItemIdxByID(a.ListData.Row,i),e=a.ListSchema.Field,d=null,c=0;c<e.length&&d===null;++c)if(e[c].CalloutMenu==="TRUE")d=e[c];a.CurrentItemIdx=h;a.CurrentItem=a.ListData.Row[h];a.CurrentFieldSchema=d;return a};(function(){var b=function(b,a){return Boolean(a)?getExceptionHandlingScopeLoggingInfo(b)+"\n"+getLoggingInfo(a):getExceptionHandlingScopeLoggingInfo(b)},f=function(f,e,g){var d=f.get_serverErrorCode(),a=false,c=null;if(d==-2147024891){c=e+"ExpectedFailure_AccessDenied";a=true}else if(d==-2147024809){c=e+"ExpectedFailure_ItemNotFound";a=true}else if(d==-2130575322){c=e+"ExpectedFailure_ListDeleted";a=true}else if(d==-2130575306){c=e+"ExpectedFailure_AlreadyCheckedOut";a=true}if(a){SP.QoS.WriteFailure(c);SP.DebugLogger.Write(c,SP.DebugLogger.LoggingLevel.Interesting,b(f,g))}return a},e=function(d,a,c){SP.QoS.WriteFailure(a+"Failure_CSOM");SP.DebugLogger.Write(a+"Failure_CSOM",SP.DebugLogger.LoggingLevel.Interesting,b(d,c))},c=function(b,a){if(f(b,a))return true;else e(b,a);return false},g=function(c,a,h){var g=c.get_serverErrorCode(),d=false;if(g==-2147024738){SP.QoS.WriteFailure(a+"ExpectedFailure_NotCheckedOut");SP.DebugLogger.Write(a+"ExpectedFailure_NotCheckedOut",SP.DebugLogger.LoggingLevel.Interesting,b(c,h));d=true}else if(f(c,a))d=true;else e(c,a);return d},h=function(c,a,h){var g=c.get_serverErrorCode(),d=false;if(g==-2147024738){SP.QoS.WriteFailure(a+"ExpectedFailure_NotCheckedOut");SP.DebugLogger.Write(a+"ExpectedFailure_NotCheckedOut",SP.DebugLogger.LoggingLevel.Interesting,b(c,h));d=true}else if(f(c,a))d=true;else e(c,a);return d},d=function(c,b){var a=[c];if(Boolean(b.RealHttpRoot)){a.push("Remote");a.push("OneDrive")}else{a.push("Local");a.push(b.listTemplate==700?"OneDrive":"TeamSite")}return a.join("_")+"_"},a=function(h,e,a,m,l,i){var k,f=0,g=0,d=false,c=null;if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(e)&&e.get_hasException()){d=true;c=b(e,i)}if(Boolean(h.rgehs))for(k in h.rgehs){g++;var j=h.rgehs[k];if(j.get_hasException()){if(d){SP.QoS.WriteFailure(a+"Failure_RemoteWebCreationFailed");SP.DebugLogger.Write(a+"Failure_RemoteWebCreationFailed",SP.DebugLogger.LoggingLevel.Interesting,c)}else if(l(j,a,i))f++}else{SP.QoS.WriteSuccess(a+"Success");f++}}for(;g<m;g++)if(d){SP.QoS.WriteFailure(a+"Failure_RemoteWebCreationFailed");SP.DebugLogger.Write(a+"Failure_RemoteWebCreationFailed",SP.DebugLogger.LoggingLevel.Interesting,c+"\nEHSMissing:true")}else SP.QoS.WriteFailure(a+"Failure_EHSMissing");SP.DebugLogger.Write(a+"SuccessCount",SP.DebugLogger.LoggingLevel.Interesting,f.toString())};_CountDictionary=function(b){var a=0,c;for(c in b)a++;return a};_CheckoutSelectedItems=function(h){h=FixupCtx(h);var b=h.clvp;b.EnsureChangeContext();var i=GetSelectedItemsDict(h),f=_CountDictionary(i),j,n,l=null,g=null,k=null,e=d("CheckOut",h);if(f<=0){SP.QoS.WriteStart(e+"Start");SP.QoS.WriteFailure(e+"Failure_NoItemsSelected");SP.DebugLogger.Write(e+"ItemCount",SP.DebugLogger.LoggingLevel.Interesting,f.toString());return}else if(f>1)if(!confirm(typeof Strings!="undefined"?Strings.STS.L_CheckoutConfirm:""))return;SP.DebugLogger.Write(e+"_ItemCount",SP.DebugLogger.LoggingLevel.Interesting,f.toString());if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.ctx.RealHttpRoot)){g=new SP.ExceptionHandlingScope(b.cctx);k=g.startScope();l=new SP.RemoteWeb(b.cctx,b.ctx.HttpRoot);k.dispose()}for(n in i){SP.QoS.WriteStart(e+"Start");j=i[n];b.CheckoutItem(j.id,j.fsObjType,l)}if(f>0){var o=typeof Strings!="undefined"?Strings.STS.L_Notification_CheckOut:"",m=addNotification(o,true);b.cctx.executeQueryAsync(function(){a(b,g,e,f,c);if(typeof b.rgehs!="undefined"){removeNotification(m);b.ShowErrorDialog(RefreshOnDialogClose,g)}else RefreshPage(SP.UI.DialogResult.OK)},function(h,d){a(b,g,e,f,c,d);removeNotification(m);typeof b.rgehs!="undefined"&&b.ShowErrorDialog(null,g)})}};_DiscardCheckoutSelectedItems=function(f){f=FixupCtx(f);var b=f.clvp;b.EnsureChangeContext();var i=GetSelectedItemsDict(f),e=_CountDictionary(i),j,n,l=null,h=null,k=null,c=d("DiscardCheckOut",f);if(e<=0){SP.QoS.WriteStart(c+"Start");SP.QoS.WriteFailure(c+"Failure_NoItemsSelected");SP.DebugLogger.Write(c+"ItemCount",SP.DebugLogger.LoggingLevel.Interesting,e.toString());return}else if(e>1)if(!confirm(typeof Strings!="undefined"?Strings.STS.L_DiscardCheckoutConfirm:""))return;SP.DebugLogger.Write(c+"_ItemCount",SP.DebugLogger.LoggingLevel.Interesting,e.toString());if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.ctx.RealHttpRoot)){h=new SP.ExceptionHandlingScope(b.cctx);k=h.startScope();l=new SP.RemoteWeb(b.cctx,b.ctx.HttpRoot);k.dispose()}for(n in i){SP.QoS.WriteStart(c+"Start");j=i[n];b.DiscardCheckoutItem(j.id,j.fsObjType,l)}var o=typeof Strings!="undefined"?Strings.STS.L_Notification_DiscardCheckOut:"",m=addNotification(o,true);b.cctx.executeQueryAsync(function(){a(b,h,c,e,g);if(typeof b.rgehs!="undefined"){removeNotification(m);b.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(f,d){a(b,h,c,e,g,d);removeNotification(m);typeof b.rgehs!="undefined"&&b.ShowErrorDialog()})};_CheckinSelectedItems=function(f){f=FixupCtx(f);var b=f.clvp;b.EnsureChangeContext();var e=[],l=GetSelectedItemsDict(f),i=_CountDictionary(l),q,r,n=null,j=null,m=null,c=d("CheckIn",f);if(i<=0){SP.QoS.WriteStart(c+"Start");SP.QoS.WriteFailure(c+"Failure_NoItemsSelected");SP.DebugLogger.Write(c+"ItemCount",SP.DebugLogger.LoggingLevel.Interesting,i.toString());return}var g,k=null;if(Boolean(b.ctx.RealHttpRoot)&&(k=ListModule.Util.makeMountedFolderQueryStrParams(false,false))!=null)g=b.ctx.RealHttpRoot;else g=b.ctx.HttpRoot;e.push(g);g[g.length-1]!="/"&&e.push("/");e.push("_layouts/15/checkin.aspx?List=");e.push(b.ctx.listName);e.push("&IsBulk=1");k!=null&&e.push(k);var o=function(g){if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.ctx.RealHttpRoot)){j=new SP.ExceptionHandlingScope(b.cctx);m=j.startScope();n=new SP.RemoteWeb(b.cctx,b.ctx.HttpRoot);m.dispose()}var f,d;for(f in l){SP.QoS.WriteStart(c+"Start");d=l[f];b.CheckinItem(d.id,d.fsObjType,g,n)}SP.DebugLogger.Write(c+"ItemCount",SP.DebugLogger.LoggingLevel.Interesting,i.toString());var k=typeof Strings!="undefined"?Strings.STS.L_Notification_CheckIn:"",e=addNotification(k,true);b.cctx.executeQueryAsync(function(){a(b,j,c,i,h);if(typeof b.rgehs!="undefined"){removeNotification(e);b.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(f,d){a(b,j,c,i,h,d);removeNotification(e);typeof b.rgehs!="undefined"&&b.ShowErrorDialog()})},p=function(a,c){if(a==SP.UI.DialogResult.OK)b.EnsureEcbInfo(o,"fnCheckinWithEcb",c,null);else RefreshPage(a)};OpenPopUpPage(e.join(""),p)};_DeleteSelectedItemsCore=function(e,j,m,v,t){e=FixupCtx(e);var f=j.length,b=e.clvp;b.EnsureChangeContext();var r=null,k=null,o=null,i=d("DeleteItems",e);if(ContainsRecurrenceItem(j))return;if(f<=0){SP.QoS.WriteStart(i+"Start");SP.QoS.WriteFailure(i+"Failure_NoItemsSelected");SP.DebugLogger.Write(i+"ItemCount",SP.DebugLogger.LoggingLevel.Interesting,f.toString());return}if(!Boolean(t)){var h=typeof Strings!="undefined"?Strings.STS.L_STSRecycleConfirm_Text:"";if(!Boolean(e.RecycleBinEnabled)||e.ExternalDataList)h=typeof Strings!="undefined"?Strings.STS.L_STSDelConfirm_Text:"";if(e.overrideDeleteConfirmation!=null)h=e.overrideDeleteConfirmation;if(Boolean(e.HasRelatedCascadeLists)&&e.CascadeDeleteWarningMessage!=null)h=e.CascadeDeleteWarningMessage+h;if(Boolean(e.HasRelatedCascadeLists)&&e.listTemplate==171){var l=false,g=0;if(e.inGridMode){var w=window[g_SPGridInitInfo[e.view].controllerId];for(g=0;g<f;g++)if(w.IsParent(j[g])){l=true;break}}else{var q=GetClientHierarchyManagerForWebpart!=null?GetClientHierarchyManagerForWebpart(e.wpq):null;if(q!=null)for(g=0;g<f;g++)if(q.IsParent(j[g])){l=true;break}}h=l?typeof Strings!="undefined"?Strings.STS.L_STSDelConfirmParentTask:"":typeof Strings!="undefined"?Strings.STS.L_STSDelConfirm_Text:""}var p=ContainsMountPoint(b.ctx,j);if(Boolean(p))if(f===1){var u=p[j[0]];h=String.format(typeof Strings!="undefined"?Strings.STS.L_RemoveMountPointConfirmation:"",u);SP.QoS.WriteStart("RemoveMountPoint_RibbonOrDeleteBtn_SingleMountPoint")}else SP.QoS.WriteStart("RemoveMountPoint_ECBOrDeleteBtn_MultipleItems");if(!confirm(h))return}SP.DebugLogger.Write(i+"_ItemCount",SP.DebugLogger.LoggingLevel.Interesting,f.toString());if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.ctx.RealHttpRoot)){k=new SP.ExceptionHandlingScope(b.cctx);o=k.startScope();r=new SP.RemoteWeb(b.cctx,b.ctx.HttpRoot);o.dispose()}for(var n=0;n<f;n++){SP.QoS.WriteStart(i+"Start");var y=j[n];b.DeleteItemCore(String(y),r)}b.pendingItems=[];if(f>0){var x=typeof Strings!="undefined"?Strings.STS.L_Notification_Delete:"",s=addNotification(x,true);b.cctx.executeQueryAsync(function(){a(b,k,i,f,c);if(typeof b.rgehs!="undefined"){if(b.rgehs.length==1&&b.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(b.rgehs[0].get_serverErrorValue());return}removeNotification(s);b.ShowErrorDialog(m)}else m!=null&&m()},function(e,d){a(b,k,i,f,c,d);removeNotification(s);typeof b.rgehs!="undefined"&&b.ShowErrorDialog(v)})}}})();(function(){var a=function(b,d,a){var c="s4-dlg-err-itm";if(!d){c="s4-dlg-err-firstitm";a.push(SP.Res.dlgTitleError)}var e=b.get_errorMessage();a.push('<div class="'+c+'">');if(typeof b.itmContext!="undefined")try{a.push('<div class="s4-dlg-err-itmName">');a.push(b.itmContext.get_item("FileLeafRef"));a.push("</div>")}catch(f){a.push("</div>")}a.push('<div class="s4-dlg-err-itmMsg">');a.push(e);a.push("</div>");a.push("</div>")};_CLVPShowErrorDialog=function(d,f,e){var k,b=[],g=null,c=false;if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(e))if(e.get_hasException()){a(e,c,b);c=true}for(k in d.rgehs){var i=d.rgehs[k];if(i.get_hasException())if(!(d.ctx.listTemplate==171&&i.get_serverErrorCode()==-2147024809)){a(i,c,b);c=true}}if(c){b.push("<div class='ms-core-form-bottomButtonBox' id='dlgDivButton'><button id='ms-OKBtnDismissDlg' class='ms-ButtonHeightWidth' onclick='DismissErrDlg(this)'>");b.push(SP.Res.okButtonCaption);b.push("</button></div>")}var j=b.join("");if(j.length>0){var h=document.createElement("DIV");h.className="s4-dlg-err";h.innerHTML=j;var l={html:h,title:typeof Strings!="undefined"?Strings.STS.L_ErrorDialog_Title:"",dialogReturnValueCallback:f},m=new SP.UI.ModalDialog.showModalDialog(l);g=document.getElementById("ms-OKBtnDismissDlg");Boolean(g)&&g.focus()}else typeof f=="function"&&f();d.rgehs=[]}})();g_FP_nextId=1;c_fpContainerID="DeltaPlaceHolderSearchArea";c_maxFaces=4;ExecuteOrDelayUntilScriptLoaded(function(){SP.SOD.executeFunc("mquery.js","m$",bindSharingEventsForFacePile)},"core.js");g_ClipboardControl=null;g_IsClipboardControlValid=false;(function(){window.FollowingDocument=function(){ExecuteOrDelayUntilScriptLoaded(function(){var b=SP.ScriptHelpers.getDocumentQueryPairs(),c,e,f,d;for(var a in b)if(a.toLowerCase()=="followdocument")c=b[a];else if(a.toLowerCase()=="itemid")e=b[a];else if(a.toLowerCase()=="listid")f=b[a];else if(a.toLowerCase()=="docname")d=decodeURI(b[a]);c!=null&&c=="1"&&f!=null&&e!=null&&d!=null&&SP.SOD.executeFunc("followingcommon.js","FollowDocumentFromEmail",function(){FollowDocumentFromEmail(e,f,d)})},"SP.init.js")};window.FollowingCallout=function(){var b=54,a=55;if(typeof SPClientTemplates==="undefined"||SPClientTemplates===null||typeof APD_InAssetPicker==="function"&&APD_InAssetPicker())return;var d=function(c,d){if(!(window.OffSwitch==null||OffSwitch.IsActive("b9530760-4111-42c9-9af1-b7bbdfd33b9e"))){SP.SOD.executeFunc("followingcommon.js","PrepareYammerEnvironment",function(){PrepareYammerEnvironment(null)});window.DocLibCalloutPostToYammer=function(b){var a=function(){PostSelectedDocToYammer(b)};if(typeof PostSelectedDocToYammer==="undefined"||typeof PostSelectedDocToYammer===null)SP.SOD.executeFunc("followingcommon.js","PostSelectedDocToYammer",a);else a()}}if(c.ListTemplateType==700||typeof isSharedWithUsView=="function"&&isSharedWithUsView())typeof myDocsActionsMenuPopulator!="undefined"&&myDocsActionsMenuPopulator(c,d);else CalloutOnPostRenderTemplate(c,d);var e=c.CurrentItem;if(typeof e==="undefined"||e===null)return;var g=false,f=getViewCtxFromCalloutCtx(c);if(typeof f!="undefined"&&Boolean(f))g=f.BaseViewID==b||f.BaseViewID==a||typeof isSharedWithUsView=="function"&&isSharedWithUsView();if(e.FSObjType==0&&!g&&!Boolean(c.RealHttpRoot)&&(!Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||!IsMountPoint(e)))if(!(window.OffSwitch==null||OffSwitch.IsActive("b9530760-4111-42c9-9af1-b7bbdfd33b9e"))&&SP!=null&&typeof SP.YammerSwitch!="undefined"&&SP.YammerSwitch!=null&&typeof SP.YammerSwitch.IsEnabled!="undefined"&&Boolean(SP.YammerSwitch.IsEnabled))d.addAction(new CalloutAction({text:Strings.STS.L_CalloutPostAction,tooltip:Strings.STS.L_CalloutPostAction_Tooltip,onClickCallback:function(){var a=GetCalloutFromRenderCtx(c);!(typeof a==="undefined"||a===null)&&a.close();DocLibCalloutPostToYammer(c)}}));else(!Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)||window.groupContextData==null)&&window.IsSPSocialSwitchEnabled&&IsSPSocialSwitchEnabled()&&d.addAction(new CalloutAction({text:Strings.STS.L_CalloutFollowAction,tooltip:Strings.STS.L_CalloutFollowAction_Tooltip,onClickCallback:function(){var a=GetCalloutFromRenderCtx(c);!(typeof a==="undefined"||a===null)&&a.close();_WriteDocEngagement("Documents_CalloutFollowClick","OneDrive_CalloutFollowClick");SP.SOD.executeFunc("followingcommon.js","FollowSelectedDocument",function(){FollowSelectedDocument(c)})}}))},c=function(e){var c={};c.BaseViewID="Callout";c.ListTemplateType=e;c.Templates={};c.Templates.Footer=function(e){var f=true,c=getViewCtxFromCalloutCtx(e);if(typeof c!="undefined"&&Boolean(c))f=c.BaseViewID!=b&&c.BaseViewID!=a&&(typeof isGroupsSharedWithUsView!="function"||!isGroupsSharedWithUsView());return CalloutRenderFooterTemplate(e,d,f)};SPClientTemplates.TemplateManager.RegisterTemplateOverrides(c)};typeof SP.UI.Group==="undefined"&&c(101);SP.SOD.executeFunc("mydocs.js","myDocsActionsMenuPopulator",function(){c(700)})}})();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("core.js");typeof spWriteProfilerMark=="function"&&spWriteProfilerMark("perfMarkEnd_core.js")}var SPAnimation;function SPCurve(b,a,c,e,d,f){this.ID=b;this.type=a;this.x1=c;this.y1=e;this.x2=d;this.y2=f}function SPKeyFrame(h,e,c,f,d,g,b,a){this.type=h;this.curveID=e;this.startTime=c;this.endTime=f;this.startValue=d;this.endValue=g;this.relativeTo=b;this.operationType=a}function Animation(a,b){this.ID=a;this.keyFrames=b}function UpdateAnimationStateFromQuery(){var a=window.location.href,b=a!=null&&a.indexOf("Animation=0")!=-1,c=a!=null&&a.indexOf("Animation=1")!=-1;b&&SPAnimation.Settings.DisableAnimation();c&&SPAnimation.Settings.EnableAnimation()}function AnimationEngine(){this.AnimationQueue=new Array(0);this.sharedTimer=null;this.sharedCancelTimer=null;this.frameInterval=1e3/60;this.resetInterval=3e4;this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.currentAnimationIndex=-1;this.temporaryIDGenerator=0}function SPAnimation_State(){this.Index=0;this.Data=new Array(0)}function SPAnimation_Object(a,f,e,b,c,d){this.Initialize(a,f,e,b,c,d)}function AnimationUnit(d,e,c,a,b){this.Initialize(d,e,c,a,b)}function AnimationTelemetry(){this.perfData=new Array(0);this.logData=new Array(0);this.perfDataIndex=0;this.logDataIndex=0;this.animationIndex=0;this.startTime=null;this.duration=null;this.numAddedUnits=0}function GetCurrentAttributeValue(b,c){var a=0;switch(c){case 1:if(fRightToLeft)a=parseInt(b.style.right.replace("px",""));else a=parseInt(b.style.left.replace("px",""));break;case 2:a=parseInt(b.style.top.replace("px",""));break;case 3:a=parseInt(b.style.height.replace("px",""));break;case 4:a=parseInt(b.style.width.replace("px",""));break;case 5:a=GetOpacity(b)}return a}function TrySetProperty(b,c,d){var a=false;if(b!=null)try{b[c]=d;a=true}catch(e){}return a}function B1(a){return a*a*a}function B2(a){return 3*a*a*(1-a)}function B3(a){return 3*a*(1-a)*(1-a)}function B4(a){return(1-a)*(1-a)*(1-a)}function BezierFunction(d,b,e,c,a){return 0*B4(a)+b*B3(a)+c*B2(a)+1*B1(a)}function GetAnimationWSA(){if(typeof SPAnimation.g_AnimationWSA=="undefined"||!Boolean(SPAnimation.g_AnimationWSA))if(SP)if(SP.BWsaClient!=null){var a=GetWSA();SPAnimation.g_AnimationWSA=a;SPAnimation.g_AnimationWSA.createStream(SPAnimation.DATAID_SPANIMATION,1,8,200)}return SPAnimation.g_AnimationWSA}var SPAnimationUtility;function SPAnimUtil_TableAnimator(a){this.tableElement=a;this.fAnimatable=false;this.Initialize()}function SiteLogoImagePageUpdate(a,b){a.src=b.ImageUrl;a.alt=b.AlternateText}function SearchAreaPageUpdate(c,b){var a=c.getElementsByTagName("select")[0];a.options[0].value=b.Site.value;a.options.length>1&&a.remove(1);if(b.List.isValid){a.options[1]=new Option(b.List.text,b.List.value);a.selectedIndex=1}else a.selectedIndex=0;if(typeof searchAreaUrl!="undefined")searchAreaUrl=b.SearchAreaUrl}var IsMenuShown,ChevronContainer,itemTableDeferred,imageCell,onKeyPress,downArrowText,currentEditMenu,currentItemID,currentItemAppName,currentItemProgId,currentItemIcon,currentItemOpenControl,currentItemOpenApp,currentItemFileUrl,currentItemFSObjType,currentItemContentTypeId,currentItemCheckedOutUserId,currentItemCheckoutExpires,currentItemModerationStatus,currentItemUIString,currentItemCheckedoutToLocal,bIsCheckout,currentItemCanModify,currentItemPermMaskH,currentItemPermMaskL,currentItemEvtType,currentItemIsEventsExcp,currentItemIsEventsDeletedExcp,currentItemIsMountPoint,g_MaximumSelectedItemsAllowed,g_CustomActionDialogHandlers,g_CustomActionDialogHandlerId,g_RevertToClassicMessageId,g_ExpGroupWPState,DocOpen,hoverTR,ecbTD;function RowOnHover(b,c){var g=b.getAttribute("iid"),f=CtxFromRow(b);if(CountSelectedItems(f)>1&&ItemIsCurrentlySelected(f,g,b)){ecbTD=null;hoverTR=null;for(var e=0;e<b.childNodes.length;e++){var d=b.childNodes[e];if(d.getAttribute("IsECB")=="TRUE"){OnChildItem(d);ecbTD=d;hoverTR=b;break}}var a=null;if(c!=null)a=c.toElement!=null?c.toElement:c.target;if(a!=null&&b!=a){if(a.tagName!="DIV")a=GetAncestor(a,"DIV");if(a!=null&&typeof a.onmouseover=="function")a.onmouseover(c)}}}function RowHoverOff(e,c){if(hoverTR==null||c==null||ecbTD==null||CountSelectedItems(CtxFromRow(e))<=1)return;var b=c.toElement!=null?c.toElement:c.relatedTarget;if(b!=null&&b.tagName!="TR"){var a=b.parentNode;while(a!=null&&a.tagName!="TR")a=a.parentNode;if(a==hoverTR)return}else if(b==hoverTR)return;var d={};OutItem(d);ecbTD=null;hoverTR=null}function ShowMenuForTrOuter(d,b,c){if(b==null)return true;var a=b.srcElement;if(a==null)return true;_WriteDocEngagement("CalloutMenuClick","OneDrive_CalloutMenuClick");return a.tagName.toLowerCase()=="div"&&a.className.indexOf("ms-list-itemLink")>=0?ShowCalloutMenuForTr(d,b,c):true}function ShowCalloutMenuForTr(c,d,b){var a=false;EnsureScriptFunc("callout.js","Callout",function(){a=ShowCalloutMenuForTrInner(c,d,b)});return a}function ShowCalloutMenuForTrInner(i,a,h){var d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(162);if(IsEventRightClickOnAnchor(a)&&!d)return true;var c=GetAncestor(i,"TR"),f=GetEcbTdFromRow(c),b=GetEcbDivFromEcbTd(f),e=GetEcbAffordanceDivFromRow(c);if(b==null)return true;if(d&&a.type=="contextmenu"&&a.target!=null)e=a.target.nodeName.toUpperCase()=="IMG"?a.target.parentNode:a.target;h&&SingleItemSelectByElement(c,false);var g=GetAttributeFromItemTable(b,"ItemId","Id");OpenCallout(e,a,b,g);return false}function FIsMouseCursorInsideElement(a,c){if(a==null||c==null||a.clientX==null||a.clientY==null||a.clientX==0||a.clientY==0)return false;var b=c.getBoundingClientRect();return b.left<=a.clientX&&b.right>=a.clientX&&b.top<=a.clientY&&b.bottom>=a.clientY?true:false}var ProtocolCommand,phManager;function CBSelectedValues(b,a){this.strList=b;this.fAllChecked=a}function CBSelectedValues_InitializePrototype(){CBSelectedValues.prototype.strList="";CBSelectedValues.prototype.fAllChecked=false}var _groupCollapse,bGridViewPresent,_fV4Calendar,_spCustomNavigateHierarchy,g_ExtensionNotSupportCheckoutToLocal,g_ExtensionDefaultForRead,bValidSearchTerm,ListCtrlObj,fListControl,fListErrorShown,fNewDoc,fNewDoc2,fNewDoc3,SPDesignerDownloadUrl,SPDesignerProgID;function CtxRgiid(b,a){this.ctx=b;this.rgiid=a}function CtxRgiid_InitializePrototype(){CtxRgiid.prototype={ctx:undefined,rgiid:undefined}}function FilterNoteField(b,g,i,o){if(o!=13)return;event.returnValue=false;var a=window.location.href,m=/&Paged=TRUE&p_[^&]*&PageFirstRow=[^&]*/gi;a=a.replace(m,"");var f=Nav.getUrlKeyValue("View",true);if(f==""){a=StURLSetVar2(a,"View",b);f=b}var e;if(b.toUpperCase()!=f.toUpperCase()){var k=escapeProperly(b);if(k.toUpperCase()!=f.toUpperCase()){var p=/\?[^?]*/i;e=a.indexOf("?");if(e!=-1)a=a.replace(p,"?View="+b);else a=a+"?View="+b}}var c=a.match(new RegExp("FilterField([0-9]+)="+g));if(c==null){e=a.indexOf("?");if(e!=-1)a=a+"&";else a=a+"?";var d=0,h;do{d++;h=a.match(new RegExp("FilterField"+String(d)+"=[^&]*&FilterValue"+String(d)+"=[^&]*"))}while(h!=null);a=a+"FilterField"+String(d)+"="+g+"&FilterValue"+String(d)+"="+escapeProperly(i);a=a.replace("Filter=1&","")}else{var n=parseInt(c[1]),l=a.match(new RegExp("&FilterValue"+String(n)+"=[^&]*")),q="&"+c[0]+l[0],j="&FilterField"+c[1]+"="+g+"&FilterValue"+c[1]+"="+escapeProperly(i);a=a.replace(q,j);a=a.replace("Filter=1&","")}window.location.href=STSPageUrlValidation(a)}function _SelectField(k,m){var a=ajaxNavigate.get_href(),i=ajaxNavigate.get_hash(),b=false,e=/\#.*/i;a=a.replace(e,"");var h=Nav.getUrlKeyValue("View",true),g=Nav.getUrlKeyValue("PageView",true),j=Nav.getUrlKeyValue("ID",true),f=Nav.getUrlKeyValue("ContentTypeId",true);if(k.toUpperCase()!=h.toUpperCase()){var c=escapeProperly(k);if(c.toUpperCase()!=h.toUpperCase()){e=/\?[^?]*/i;var l=a.indexOf("?");if(l!=-1)a=a.replace(e,"?View="+c);else a=a+"?View="+c;b=true}}if(!b&&Nav.getUrlKeyValue("SelectedID")!=""){var d=/&SelectedID=[^&]*/gi;a=a.replace(d,"");d=/\?SelectedID=[^&]*&?/;a=a.replace(d,"?")}a=a+"&SelectedID=";a=a+m;if(b&&g!="")a=a+"&PageView="+g;if(j!="")a=a+"&ID="+j;if(f!="")a=a+"&ContentTypeId="+f;if(i!="")a=a+i;_SubmitFormPost(a);return false}function getSortQueryParam(b){if(b==null||b=="")return"";var c="",a;a=b.match(new RegExp("SortField=[^&]*&SortDir=[^&]*"));if(a!=null)c=a[0];return c}function _FilterField(d,b,a,c){return FilterFieldV3(d,b,a,c,"",false)}function _SetControlValue(b,c){var a=document.getElementById(b);if(a!=null)a.value=c}function SetSearchView(){if(typeof bValidSearchTerm!="undefined")bValidSearchTerm=true}function GroupCollapse(){return typeof _groupCollapse!="undefined"&&_groupCollapse}function HandleFilter(c,a,b){if(FV4UI()){EnsureScriptParams("inplview","inplview.HandleFilterReal",c,a,b);return}_SubmitFormPost(a)}function _SubmitFormPost(a,d,c){if(typeof MSOWebPartPageFormName!="undefined"){var b=document.forms[MSOWebPartPageFormName];if(null!=b)if(d!=undefined&&d==true||typeof b.onsubmit=="undefined"||b.onsubmit==null||b.onsubmit()!=false){typeof window.WebForm_OnSubmit=="function"&&window.WebForm_OnSubmit();if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)a+=a.indexOf("?")==-1?"?IsDlg=1":"&IsDlg=1";if(FV4UI())try{var e=SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId();if(Boolean(e)){a=StURLSetVar2(a,"InitialTabId",escapeProperly(e));a=StURLSetVar2(a,"VisibilityContext","WSSTabPersistence")}}catch(f){}if(c!=undefined&&c==true){a=DemoteIntoFormBody(b,a,"owsfileref");a=DemoteIntoFormBody(b,a,"NextUsing")}b.action=STSPageUrlValidation(a);b.method="POST";if(isPortalTemplatePage(a))b.target="_top";!bValidSearchTerm&&_ClearSearchTerm("");b.submit()}}}function DemoteIntoFormBody(e,c,b){var d=Nav.getUrlKeyValue(b,false,c);if(d.length>0){var a=document.createElement("INPUT");if(a!=null){a.setAttribute("type","hidden");a.setAttribute("id",b);a.setAttribute("name",b);a.setAttribute("value",d);e.appendChild(a);return RemoveUrlKeyValue(b,c)}}return c}function _RefreshPageTo(b,c,a){EnsureScript("inplview",typeof inplview,null,true);inplview.RefreshPageTo(b,c,a)}var g_varSkipRefreshOnFocus;function RefreshOnFocus(){(typeof g_varSkipRefreshOnFocus=="undefined"||!Boolean(g_varSkipRefreshOnFocus))&&_RefreshPage(1)}function RefreshOnFocusForOneRow(){RefreshOnFocus()}function DisableRefreshOnFocus(){g_varSkipRefreshOnFocus=1}function SetWindowRefreshOnFocus(){window.onbeforeunload=DisableRefreshOnFocus;window.onfocus=RefreshOnFocus}function _GoToPageRelative(a){if(a.substr(0,4)!="http"&&a.substr(0,1)!="/"){var b=RemoveParametersFromUrl(window.location.href),c=b.lastIndexOf("/");if(c>0)a=b.substring(0,c+1)+a}GoToPage(a)}function CallSuiteExtensionControlFactory(a,f,c,d,e){if(IsFileExtensionControlsSupported())if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function")if(typeof SuiteExtensions.ControlFactory.CreateControl=="function"&&typeof SuiteExtensions.ControlType.Edit=="number"){var b=SuiteExtensions.ControlFactory.CreateControl(c,SuiteExtensions.ControlType.Edit);if(b!=null){b.httpRoot=d;b.itemUrl=e;b.updateElement(a);if(IsFileHandlerForAllNonOfficeFilesSupported()){a.editHref="";a.removeAttribute("isEdit");a.removeAttribute("App");itemTable=FindSTSMenuTable(a,"CTXName");itemTable!=null&&itemTable.removeAttribute("App")}}}}function EnterFolderAjax(g,b,e,i){var a=GetCurrentCtx();if(!Boolean(a))return;g!=null&&CancelEvent(g);if(a.clvp!=null){if(Boolean(a.RealCtx)){a=a.RealCtx;a.RealCtx=null;typeof SaveCurrentContextInfo=="function"&&SaveCurrentContextInfo(a)}var j=b;b=Boolean(b)?unescapeProperly(b):"";var c=null;if(Boolean(e)){var h=e.indexOf("?");if(h>=0)e=e.substring(h+1);c=MountPointInfo.createByQueryString(e);a.mountPointUrl=c.getMountPointUrl();a.rootFolder="";a.clvp.rootFolder="";a.hasRootFolder=false;a.RealHttpRoot=a.HttpRoot}else{if(Boolean(i)){c=MountPointInfo.createByContext(a);if(c.isInitProperly){var d=c.rootFolder;if(d!=""&&d.indexOf(b)==0||b!=""&&b.indexOf(d)==0)if(d.length>b.length)c.decrementMinorLevel();else d.length<b.length&&c.incrementMinorLevel();a.mountPointUrl=c.getMountPointUrl()}}else{a.mountPointUrl="";a.RealHttpRoot=""}a.rootFolder=j;a.hasRootFolder=true;a.clvp.rootFolder=URI.decodeURIComponent(b)}a.clvp.RefreshInplViewUrl();a.clvp.rgpaging=[];a.onViewReRenderCompleted=function(b){var a=new BreadcrumbRender(b);a.RenderBreadCrumb()};a.onDataRefreshCompleted=function(){AsyncRenderSharedWithFacePile(a,b)};AsyncDataLoadPostRender(a);var f=document.getElementById(g_Workspace);if(null!=f)f.scrollTop=0}}function BreadcrumbRender(a,d){var j=this;function f(){return a.ListTitle}function i(){return URI.decodeURIComponent(a.rootFolder)}function c(){return URI.decodeURIComponent(a.listUrlDir)}function h(){return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null?'<span><span class="ms-group-BreadCrumbSeperator"/></span></span>':'<span> <span><span class="ms-titleSeparator-rightArrowImgSpan"><img class="ms-titleSeparator-rightArrowImg" alt=":" src="'+GetThemedImageUrl("spcommon.png")+'"></span></span> </span>'}function e(){return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null?"":b(f(),"",false)}function b(b,e,c){var d="EnterFolderAjax(event, '"+URI_Encoding.encodeURIComponent(e)+"', '', "+String(c)+");",a='<span><a title="'+URI_Encoding.encodeURIComponent(b)+'" href="#" onclick="javascript:WriteEngagementLog(\'ODBreadcrumbClick\'); ';a+=d;a+=' return false;">'+STSHtmlEncode(b)+"</a></span>";return a}function g(){return Boolean(a.RealHttpRoot)}this.RenderBreadCrumb=function(){var a;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null)a=document.getElementById("groupDobLibBreadCrumb");else a=document.getElementById("DeltaPlaceHolderPageTitleInTitleArea");a!=null&&EnsureScript("inplview",typeof inplview,function(){var c=j.render();if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null){var b=document.getElementById("groupDocLibPivotBox");if(b!=null)if(Boolean(c))b.style.display="none";else b.style.display=""}a.innerHTML=c})};this.render=function(){if(d==null&&Boolean(_spPageContextInfo))d=_spPageContextInfo.serverRequestPath;var l=i(),o=g(),v="",n=MountPointInfo.createByContext(a),k=-1;if(!Boolean(l)||l==c()||l.indexOf(c())!=0)return e();var j=l.substring(c().length);if(j.length==0||j[0]!="/")return e();j=j.substring(1);k=j.lastIndexOf("/");var m,r,p,q,s=false;if(k<=0||o&&n.getMinorLevel()==0){if(Boolean(window.OverrideBreadcrumbRoot))m=Strings.STS.L_GroupFilesCommand;else m=f();p="";r=k>0?j.substring(k+1):j;q=l;if(o&&n.isInitProperly){j=n.mpPrefix.substring(_spPageContextInfo.webServerRelativeUrl.length+1);var u=j.split("/"),t=u.length;if(t>=2)m=u[t-2];p=n.mpPrefix.substring(0,n.mpPrefix.lastIndexOf("/"));q=""}}else{r=j.substring(k+1);j=j.substring(0,k);k=j.lastIndexOf("/");m=j.substring(k+1);k=l.lastIndexOf("/");p=l.substring(0,k);q=l;s=o}return b(m,p,s)+h()+b(r,q,o)}}function _EnterFolder(c){var b,a,e=new URI(ajaxNavigate.get_href()),f=new URI(c);b=e.getQueryParameter("RootFolder");a=f.getQueryParameter("RootFolder");if(!Boolean(a))a="";if(!Boolean(b))b="";var d=a!=null&&a.length>0&&a.charAt(0)=="/"&&a.length<b.length&&b.indexOf(a)==b.length-a.length;if(!d&&a.toLowerCase()!=b.toLowerCase())Nav.navigate(c);else _SubmitFormPost(c)}function _HandleFolder(g,a,c,n,j,m,e,p,f,b,d,q,r,o,l,t){WriteSearchClickLog(a);var s=Boolean(b)&&b!="",k=Boolean(d)&&d!="",h=!IsNullOrUndefined(g.getAttribute("isEdit"));if(s&&k||b=="OneNote.Notebook"&&h){if(e=="FALSE"&&g!=null&&h&&!IsNullOrUndefined(f))e=f;DispEx(g,a,n,j,m,e,p,f,b,d,q,r,o,l,t)}else{var i=GetCurrentCtx();if(SupportAjaxFolderNav(i)){var u=new URI(c);c=u.getQueryParameter("RootFolder");EnterFolderAjax(a,URI_Encoding.encodeURIComponent(c),"",Boolean(i.RealHttpRoot))}else{a!=null&&CancelEvent(a);_EnterFolder(c)}}}function createMetaNodes(){a=document.createElement("meta");a.name="viewport";a.content="width=device-width, initial-scale=1.0, maximum-scale= 1.0, minimum-scale=1.0, user-scalable=no";document.head.insertBefore(a,document.head.firstChild);var a=document.createElement("meta");a.httpEquiv="X-UA-Compatible";a.content="IE=edge";document.head.insertBefore(a,document.head.firstChild)}function getMarkTime(c){if(Boolean(window.performance)&&Boolean(window.performance.mark&&Boolean(window.performance.now))){var d=window.performance.getEntriesByName(c)[0];return Boolean(d)?Math.round(d.startTime):NaN}else{var a=window._perfMarks,e=NaN;if(Boolean(a)&&a.length>0)for(var b=0;b<a.length;b++)if(a[b].name===c){e=Math.round(a[b].startTime);break}return e}}function mark(b){if(Boolean(window.performance)&&Boolean(window.performance.mark&&Boolean(window.performance.now)))window.performance.mark(b);else{var a;if(window._perfMarks!=undefined)a=window._perfMarks;else a=window._perfMarks=[];a.push({name:b,startTime:Date.now()})}}function RemoveDOMNodes(c){for(var d=c.length,a=0;a<d;a++)try{var b=c[d-a-1],e=b.getAttribute("rel");if(Boolean(e)&&e=="shortcut icon")continue;b.parentNode.removeChild(b)}catch(f){}}function GCBeforeOnePageNavigation(d){var e={};for(var b in window){try{var h=window[b]}catch(i){}if(Boolean(b)&&Boolean(h))e[b]=1}var f=window._initGlobalSnapShot,a,c,g=function(a){return a}();for(a in e){try{c=window[a]}catch(i){}if(c!=null&&"undefined"!=typeof c&&d.modernGlobalWhiteList.indexOf(a)==-1&&d.classicGlobalWhiteList.indexOf(a)==-1&&!Boolean(f[a]))try{window[a]=g;delete window[a]}catch(i){}}}function GCGivenGlobals(d){for(var a,b,e=function(a){return a}(),c=0;c<d.length;c++){a=d[c];try{b=window[a]}catch(f){}if(b!=null&&"undefined"!=typeof b)try{window[a]=e;delete window[a]}catch(f){}}}function getUnique(a){for(var b=0;b<a.length;++b)for(var c=b+1;c<a.length;++c)a[b]===a[c]&&a.splice(c--,1);return a}function clearEventHandlers(){window.removeEventListener(null,null,false);document.removeEventListener(null,null,false);$clearHandlers(document.head);$clearHandlers(document.body);$clearHandlers(document);$clearHandlers(window);clearOnEvents(window);clearOnEvents(document);clearOnEvents(document.head);clearOnEvents(document.body);var a=document.body,b=a.cloneNode(true);a.parentNode.replaceChild(b,a);OnePageUtil.undoOverrideEventListenerFunctions(document);OnePageUtil.undoOverrideEventListenerFunctions(window)}function clearOnEvents(c){for(var d="onabort,onanimationend,onanimationiteration,onanimationstart,onauxclick,onbeforeunload,onblur,oncancel,oncanplay,oncanplaythrough,onchange,onclick,onclose,oncontextmenu,oncuechange,ondblclick,ondevicemotion,ondeviceorientation,ondeviceorientationabsolute,ondrag,ondragend,ondragenter,ondragleave,ondragover,ondragstart,ondrop,ondurationchange,onemptied,onended,onerror,onfocus,ongotpointercapture,onhashchange,oninput,oninvalid,onkeydown,onkeypress,onkeyup,onlanguagechange,onload,onloadFuncts,onloadeddata,onloadedmetadata,onloadstart,onlostpointercapture,onmessage,onmousedown,onmouseenter,onmouseleave,onmousemove,onmouseout,onmouseover,onmouseup,onmousewheel,onoffline,ononline,onpagehide,onpageshow,onpause,onplay,onplaying,onpointercancel,onpointerdown,onpointerenter,onpointerleave,onpointermove,onpointerout,onpointerover,onpointerup,onpopstate,onprogress,onratechange,onrejectionhandled,onreset,onresize,onscroll,onsearch,onseeked,onseeking,onselect,onshow,onstalled,onstorage,onsubmit,onsuspend,ontimeupdate,ontoggle,ontransitionend,onunhandledrejection,onunload,onvolumechange,onwaiting",b=d.split(","),a=0;a<b.length;a++)c[b[a]]=null}function displayPageContent(b,a){if(b){if(Boolean(a.hidden))document.body.style.visibility="";a.hidden=false}else if(typeof a.hidden==="undefined"){document.body.style.visibility="hidden";a.hidden=true}}function clearAllDOMElements(a){var f=Boolean(a.headNodesBeforeOnePageNavigation)?[].slice.call(a.headNodesBeforeOnePageNavigation):[],d=document.querySelectorAll("style:not([data-glamor]):not([data-merge-styles])"),h=d.length>0?[].slice.call(d):[],i=document.getElementsByTagName("link").length>0?[].slice.call(document.getElementsByTagName("link")):[],c=document.head.querySelectorAll("head>script[src^='/_layouts']"),e=Boolean(c)?[].slice.call(c):[],g=getUnique([].concat.apply([],[f,h,i,e]));RemoveDOMNodes(g);var b=a.bodyNodesBeforeOnePageNavigation;Boolean(b)&&RemoveDOMNodes([].slice.call(b))}function clearBodyDOMElements(){var a=document.body.childNodes.length>0?[].slice.call(document.body.childNodes):[];a.length>0&&RemoveDOMNodes(a)}function clearDOMElementsBeforeFallback(){var a=document.childNodes.length>0?[].slice.call(document.childNodes):[];a.length>0&&RemoveDOMNodes(a)}function prefetchCallback(g,l,k,f){var b=true,c={};try{if(g==200){mark("EUPL.OnePage.Prefetch.End");var d=undefined,a=JSON.parse(l),h=undefined;if(Boolean(a)){var e=Boolean(a.NewExperienceRendering);if(Boolean(a.ViewMetadata)){h=a.ViewMetadata.Id;b=!e;c={shouldRenderNewExperience:e};if(e){var i=Boolean(a.ShouldLoadSPFramework),j=Boolean(a.SPFrameworkClientInfo);b=b||i&&!j;c.ShouldLoadSPFramework=i}}d=JSON.parse(a.PageContextInfo);if(Boolean(h))d.viewId=h}if(!b){displayPageContent(true,f);updatePageContext(d,f);k(d);SP.QoS.WriteSuccess("ClassicToModernOnePageNavigation_Success")}}else{SP.QoS.WriteFailure("ClassicToModernOnePageNavigation_FailureHttpStatus",{prefetchStatus:g});c["prefetch failure"]=g}}catch(m){SP.QoS.WriteFailure("ClassicToModernOnePageNavigation_FailureException",{exception:m.toString()});c.exception=m.toString();b=true}b&&fallbackToNormalNavigation(f.fallbackUrl,c)}function updatePageContext(a,b){if(!(window.OffSwitch==null||OffSwitch.IsActive("33A53C67-7F66-418D-836D-AB0CE62123BA"))&&typeof a!=="undefined"){window._spPageContextInfo=a;if(isItemsScope())if(isSPListLightSpeed())if(isWebpack())loadResourcesFromModern(b,"updatePageContextForLightSpeed",function(b){b(a)});else require([mapModuleName("odsp-next/roots/splist/SPListLightSpeed",b)],function(c){var b=c.updatePageContextForLightSpeed;b&&b(a)});else if(!(window.OffSwitch==null||OffSwitch.IsActive("E3AC56EF-E1BB-4760-B7D9-0A07F48298BD"))){var c=getSplistEntryModule();c==="odsp-next/roots/splist/SPList-IS"&&require([mapModuleName(c,b)],function(c){var b=c.updatePageContextForClassicOnePage;b&&b(a)})}}}function isWebpack(){return!(window.OffSwitch==null||OffSwitch.IsActive("DB2D39E3-45A8-4DA7-8BF9-DED05F2D330F"))&&window._spModuleLink.manifestName==="SPListWebPack"}function loadResourcesFromModern(b,d,c){if(!Boolean(b.resources))b.resources={};var a=b.resources[d];if(!Boolean(a))a=b.resources[d]={};if(Boolean(a.value))c(a.value);else a.callback=c}function fixUpBrowserLocation(a){if(Boolean(window.history)&&Boolean(window.history.pushState)&&Boolean(window.history.replaceState)){var b=window.location.href;window.history.replaceState({onepageInfo:"ClassicPageBeforeNavigatingToModernPage",originalNavUrl:a.fallbackUrl},"ClassicPageBeforeNavigatingToModernPage",b);window.history.pushState({onepageInfo:"ModernPageFromClassicPage",urlBeforeNavigation:b},"ModernPageFromClassicPage",a.newBrowserLocation)}else fallbackToNormalNavigation(a.fallbackUrl,{"window.history":Boolean(window.history)})}function fallbackToNormalNavigation(a,d){if(!(window.OffSwitch==null||OffSwitch.IsActive("88105407-2855-45BC-90F1-E3C26E98DB79")))clearDOMElementsBeforeFallback();else clearBodyDOMElements();SP.QoS.WriteUserEngagement("ClassicToModernOnePageNavigation_FallbackToNormalNavigation",{reason:d,location:Boolean(a)?a.split("/"):undefined});if(Boolean(window.history)&&Boolean(window.history.pushState)&&Boolean(window.history.replaceState)){var b=window.history.state.urlBeforeNavigation;Boolean(b)&&window.history.replaceState({onepageInfo:"BeforeFallbackToNormalNavigation"},"BeforeFallbackToNormalNavigation",b)}var c=window.OffSwitch==null||OffSwitch.IsActive("57AC0D40-DEBB-4EEF-AA45-3E6EC93FF6B5")?5e3:1e3;if(Boolean(a))if(!(window.OffSwitch==null||OffSwitch.IsActive("791F30E4-53FE-44CA-81DB-CC0CD010BFC9")))window.location.href=a;else window.setTimeout(function(){window.location.href=a},c)}function applyStylesForOnePageNavigation(a){var b=window.__themeState__;b.registeredStyles=[];mark("before require theme code");if(isWebpack())loadResourcesFromModern(a,"loadStyles",function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e(c[d]);a.resolvedToBeRegisteredStyles=undefined}});else require([mapModuleName("@microsoft/load-themed-styles",a)],function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e.loadStyles(c[d]);a.resolvedToBeRegisteredStyles=undefined}},function(b){fallbackToNormalNavigation(a.fallbackUrl,{"requre error":b})})}function applyStylesAndBoot(a){var b=window.__themeState__;b.registeredStyles=[];mark("EUPL.applyStylesAndBoot.Start");if(isWebpack())loadResourcesFromModern(a,"loadStyles",function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e(c[d]);a.resolvedToBeRegisteredStyles=undefined}mark("EUPL.applyStylesAndBoot.StyleApplied");Boolean(a.boot)&&a.boot()});else require([mapModuleName("@microsoft/load-themed-styles",a)],function(e){var c=a.resolvedToBeRegisteredStyles;b.loadStyles=undefined;if(Boolean(c)&&c.length>0){for(var d=0;d<c.length;d++)e.loadStyles(c[d]);a.resolvedToBeRegisteredStyles=undefined}mark("EUPL.applyStylesAndBoot.StyleApplied");Boolean(a.boot)&&a.boot()},function(b){fallbackToNormalNavigation(a.fallbackUrl,{"requre error":b})})}function clearAsyncTimer(){var a=OnePageUtil.GetTimerManager();a.clearAllIntervals();a.clearAllTimeouts();a.undoOverrideTimer()}function applyStringPolyfill(){String.prototype.endsWith=function(b,a){if(typeof a==="undefined"||a>this.length)a=this.length;return this.substring(a-b.length,a)===b}}function doPrepareWorkBeforeOnePageNav(a){clearAllDOMElements(a);clearEventHandlers();spinnerOnload(a);createMetaNodes();applyStylesForOnePageNavigation(a);!(window.OffSwitch==null||OffSwitch.IsActive("DB2D39E3-45A8-4DA7-8BF9-DED05F2D330F"))&&applyStringPolyfill();GCBeforeOnePageNavigation(a)}function doPrepareWorkBeforeOnePageNavForFasterOnePage(a){clearAllDOMElements(a);displayPageContent(false,a);clearEventHandlers();createMetaNodes();!(window.OffSwitch==null||OffSwitch.IsActive("DB2D39E3-45A8-4DA7-8BF9-DED05F2D330F"))&&applyStringPolyfill();GCBeforeOnePageNavigation(a);window.__odsp_culture=a.__odsp_culture;if(a.__odspSriHashes)window.__odspSriHashes=a.__odspSriHashes;if(a.__odsp_libraryScripts)window.__odsp_libraryScripts=a.__odsp_libraryScripts}function bootModernApp(a){try{doPrepareWorkBeforeOnePageNavForFasterOnePage(a);applyStylesAndBoot(a)}catch(b){fallbackToNormalNavigation(a.fallbackUrl,{exception:b.toString()})}}function runModernAppPrefetchForFasterOnePage(a){mark("EUPL.OnePage.Prefetch.Start");var b=window._spPageContextInfo;if(Boolean(a.startPrefetch)&&Boolean(a)&&Boolean(a.targetListUrl))a.startPrefetch({inputPageContextInfo:{webAbsoluteUrl:b.webAbsoluteUrl,webTemplate:b.webTemplate,listBaseTemplate:101,listUrl:a.targetListUrl},onePagePrefetchCompleteCallback:function(c,d,b){prefetchCallback(c,d,b,a)}});else fallbackToNormalNavigation(a.fallbackUrl,{startPrefetch:Boolean(a.startPrefetch),targetListUrl:Boolean(a.targetListUrl)})}function preloadModernApp(){var a=window.__onePageContext;if(Boolean(a))loadModernAppInternalForFasterOnePage(a);else window.__onePageContextReady=function(a){loadModernAppInternalForFasterOnePage(a)}}function checkRequireJSLoaded(){return typeof require!=="undefined"&&Boolean(require)&&typeof require==="function"&&Boolean(require.version)&&Boolean(require.config)}function checkSPModuleLoader(){return typeof spModuleLoader!=="undefined"}function checkLoadThemableStyles(){var a=Boolean(window.__themeState__);a&&SP.QoS.WriteUserEngagement("LoadThemableStyles_Before_OnePage");return!(window.OffSwitch==null||OffSwitch.IsActive("43CD91E9-E92F-4B07-B4CD-078A917FD612"))&&a}function cleanRequireJS(){window["require"]=window.requirejs=window.define=undefined}function cleanFabricGlobals(){if(typeof __globalSettings__!=="undefined")window.__globalSettings__=__globalSettings__=undefined;if(typeof __stylesheet__!=="undefined")window.__stylesheet__=__stylesheet__=undefined}function loadRequireJS(b,c){if(Boolean(b)&&!Boolean(getMarkTime("EUPL.OnePage.LoadRequireJS.Start"))){mark("EUPL.OnePage.LoadRequireJS.Start");cleanRequireJS();var a=document.createElement("script");a.type="text/javascript";a.src=b;a.onload=a.onreadystatechange=function(){if(!Boolean(a.readyState)||/loaded|complete/.test(a.readyState)){mark("EUPL.OnePage.LoadRequireJS.End");checkRequireJSLoaded()&&c();a.onload=a.onreadystatechange=null;a=undefined}};document.head.insertBefore(a,document.head.firstChild)}}function setLoadStylesOverride(a){if(!Boolean(window.__themeState__))window.__themeState__={theme:undefined,lastStyleElement:undefined,registeredStyles:[]};window.__themeState__.loadStyles=function(c,b){a.resolvedToBeRegisteredStyles.push(b)}}function mapModuleName(a,b){var c=a;if(Boolean(b)&&Boolean(b.moduleNameMapping)&&Boolean(a)&&Boolean(b.moduleNameMapping[a]))c=b.moduleNameMapping[a];return c}function getFeatureOverrides(){var a=GetCookie("FeatureOverrides_disableFeatures"),c=Boolean(a)?a.split(","):[],b=GetCookie("FeatureOverrides_enableFeatures"),d=Boolean(b)?b.split(","):[];return{disabledOverrideFeatures:c,enabledOverrideFeatures:d}}function isSPListLightSpeed(){var a="1484",b=getFeatureOverrides();return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(1484)&&b.disabledOverrideFeatures.indexOf(a)<0||b.enabledOverrideFeatures.indexOf(a)>=0}function isItemsScope(){var a="851",b=getFeatureOverrides(),d=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(851)&&b.disabledOverrideFeatures.indexOf(a)<0||b.enabledOverrideFeatures.indexOf(a)>=0,c=window.OffSwitch==null||OffSwitch.IsActive("3D2DB2F7-3E4D-4B7A-B902-FF284D08EDD0");return d&&!c}function isIEDisabledForItemsScope(){return!(window.OffSwitch==null||OffSwitch.IsActive("E4E318FE-335A-4662-8343-5158D4DBE29E"))&&Boolean(_spPageContextInfo.IsIEDisabledForItemsScope)}function getSplistEntryModule(){var a="odsp-next/SPList";return isItemsScope()&&!isIEDisabledForItemsScope()?isSPListLightSpeed()?"odsp-next/roots/splist/SPListLightSpeed":"odsp-next/roots/splist/SPList-IS":"odsp-next/SPList"}function loadModernAppInternalForFasterOnePage(a,c){if(c||!checkRequireJSLoaded()&&!checkSPModuleLoader()&&!checkLoadThemableStyles()){var b=function(){setLoadStylesOverride(a);var b=a.requireConfig;if(Boolean(b)&&!Boolean(getMarkTime("EUPL.OnePage.requireConfig.Start"))){mark("EUPL.OnePage.requireConfig.Start");b()}if(isWebpack()){loadResourcesFromModern(a,"ONEPAGE_GLOBALS",function(b){a.modernGlobalWhiteList=b});loadResourcesFromModern(a,"startPrefetch",function(b){a.startPrefetch=b;Boolean(a.startPrefetchLoadedCallBack)&&a.startPrefetchLoadedCallBack(a)})}else require([mapModuleName("odsp-next/dataSources/item/odb/ListViewDataPrefetch",a)],function(b){a.modernGlobalWhiteList=b.ONEPAGE_GLOABLS;a.startPrefetch=b.startPrefetch;Boolean(a.startPrefetchLoadedCallBack)&&a.startPrefetchLoadedCallBack(a)});if(isWebpack())loadResourcesFromModern(a,"SPListBoot",function(b){a.boot=b;Boolean(a.spListBootLoadedCallBack)&&a.spListBootLoadedCallBack(a)});else{var c=getSplistEntryModule();require([mapModuleName(c,a)],function(b){a.boot=b.SPListBoot;Boolean(a.spListBootLoadedCallBack)&&a.spListBootLoadedCallBack(a)})}};loadRequireJS(a.requireJSPath,b)}}function partialFixPageContext(a){_spPageContextInfo.listTitle=undefined;_spPageContextInfo.listid=undefined;_spPageContextInfo.listUrl=a.listUrl;_spPageContextInfo.viewId=SP.Guid.get_empty().toString("B");_spPageContextInfo.serverRedirectedUrl=undefined}function performModernOnePageNavigationForFasterOnePage(c){SP.QoS.WriteStart("ClassicToModernOnePageNavigation_Start");mark("EUPL.OnePageNavigation.Start");var a=window.__onePageContext;if(Boolean(a)){a.fallbackUrl=c.currentTarget.href;var b=GetOnePageNavUrl(c.currentTarget.getAttribute("href"));a.targetListUrl=b.listUrl;a.newBrowserLocation=b.newBrowserLocation;a.classicGlobalWhiteList=a.classicGlobalWhiteList=["fallbackToNormalNavigation","displayPageContent","SP","URI","BrowserStorage","unescapeProperly","OnePageUtil","updatePageContext","GetCookie","GetCookieEx","getFeatureOverrides","isSPListLightSpeed","isItemsScope","isIEDisabledForItemsScope","getSplistEntryModule","GCGivenGlobals","applyStylesAndBoot","isWebpack","loadResourcesFromModern","CancelEvent","prefetchCallback","clearBodyDOMElements","clearDOMElementsBeforeFallback","RemoveDOMNodes","__stylesheet__","__globalSettings__","mapModuleName","OffSwitch","Flighting","executeSuiteNav","executeSuiteNavImpl","executeSuiteNavOnce"];partialFixPageContext(b);var d=a.requireJSPath;fixUpBrowserLocation(a);clearAsyncTimer();if(Boolean(getMarkTime("EUPL.OnePage.requireConfig.Start"))){if(Boolean(a.startPrefetch))runModernAppPrefetchForFasterOnePage(a);else a.startPrefetchLoadedCallBack=runModernAppPrefetchForFasterOnePage;if(Boolean(a.boot))bootModernApp(a);else a.spListBootLoadedCallBack=bootModernApp}else{a.startPrefetchLoadedCallBack=runModernAppPrefetchForFasterOnePage;a.spListBootLoadedCallBack=bootModernApp;cleanFabricGlobals();loadModernAppInternalForFasterOnePage(a,true)}return CancelEvent(c)}else fallbackToNormalNavigation(a.fallbackUrl,{onePageContext:Boolean(a)});return true}function GetOnePageNavUrl(a){var b=undefined,c=new URI(a),e=a.toLowerCase().indexOf("/forms/"),f=/\/Lists\/.*(\/[^/]*?\.aspx)/i,d=f.test(a)?a.match(f)[1]:undefined;if(e>=0)b=a.substring(0,e);else if(Boolean(d)){if(["/newform.aspx","/editform.aspx","/dispform.aspx"].indexOf(d.toLowerCase())<0)b=a.substring(0,a.indexOf(d))}else if(a.toLowerCase().indexOf(".aspx")==-1)b=a;var g=c.getQueryAsObject(),h=c.getPath();if(Boolean(h))g.viewpath=h;c.setQueryFromObject(g);return{listUrl:Boolean(b)?URI.decodeURIComponent(b.replace(/\/+$/,"")):undefined,newBrowserLocation:c.getString()}}function spinnerOnload(a){window.setTimeout(b,1e3);function b(){var b=document.getElementById("notificationArea");if(Boolean(b))try{b.parentNode.removeChild(b)}catch(e){}b=document.createElement("div");b.id="notificationArea";b.setAttribute("style","min-width: 140px; z-index: 400; position: absolute; right: 16px;");var d='"Segoe UI Light", "Segoe UI", Tahoma, Helvetica, Arial, sans-serif';b.innerHTML="<a onclick='this.style.display=\"none\";'><img src='data:image/gif;base64,R0lGODlhGAAYAJECAP///5mZmf///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgACACwAAAAAGAAYAAACQJQvAGgRDI1SyLnI5jr2YUQx10eW5hmeB6Wpkja5SZy6tYzn+g5uMhuzwW6lFtF05CkhxGQm+HKuoDPplOlDFAAAIfkEBQoAAgAsFAAGAAQABAAAAgVUYqeXUgAh+QQFCgACACwUAA4ABAAEAAACBVRip5dSACH5BAUKAAIALA4AFAAEAAQAAAIFVGKnl1IAIfkEBQoAAgAsBgAUAAQABAAAAgVUYqeXUgAh+QQFCgACACwAAA4ABAAEAAACBVRip5dSACH5BAUKAAIALAAABgAEAAQAAAIFVGKnl1IAIfkECQoAAgAsBgAAAAQABAAAAgVUYqeXUgAh+QQJCgACACwAAAAAGAAYAAACJZQvEWgADI1SyLnI5jr2YUQx10eW5omm6sq27gvH8kzX9o3ndAEAIfkECQoAAgAsAAAAABgAGAAAAkCULxFoAAyNUsi5yOY69mFEMddHluYZntyjqY3Vul2yucJo5/rOQ6lLiak0QtSEpvv1lh8l0lQsYqJHaO3gFBQAACH5BAkKAAIALAAAAAAYABgAAAJAlC8RaAAMjVLIucjmOvZhRDHXR5bmGZ7co6mN1bpdsrnCaOf6zkOpzJrYOjHV7Gf09JYlJA0lPBQ/0ym1JsUeCgAh+QQJCgACACwAAAAAGAAYAAACQJQvEWgADI1SyLnI5jr2YUQx10eW5hme3KOpjdW6XbK5wmjn+s5Dqcya2Dox1exn9PSWJeRNSSo+cR/pzOSkHgoAIfkECQoAAgAsAAAAABgAGAAAAkCULxFoAAyNUsi5yOY69mFEMddHluYZntyjqY3Vul2yucJo5/rOQ6nMmtg6MdXsZ/T0liXc6jRbOTHR15SqfEIKACH5BAkKAAIALAAAAAAYABgAAAJAlC8RaAAMjVLIucjmOvZhRDHXR5bmGZ7co6mN1bpdsrnCaOf6zkO4/JgBOz/TrHhC9pYRpNJnqURLwtdT5JFGCgAh+QQJCgACACwAAAAAGAAYAAACPpQvEWgADI1SyLnI5jr2YUQx10eW5jme3NOpTWe5Qpu6tYzn+l558tWywW4lmk/IS6KOr2UtSILOYiYiUVAAADs='></a><span class='ms-accentText' style='font-size: 36px; font-family: "+d+"'>&nbsp;"+(typeof a.workingOnIt!="undefined"?a.workingOnIt:"")+"</span>";document.body.appendChild(b);b=document.getElementById("notificationArea");var c=[].slice.call(b.children).reduce(function(b,a){return b+a.offsetWidth},0);b.style.top=String(window.innerHeight*(1-.618))+"px";b.style.left=String(Math.max(10,(window.innerWidth-c)/2))+"px"}}function spinnerOffload(){var a=document.getElementById("notificationArea");if(Boolean(a))try{a.parentNode.removeChild(a)}catch(b){}}function UseDialogsForNewItem(a){var b=GetCtxFromFormUrl(a),d=new URI(a),c=d.getQueryParameter("Type");return Boolean(b)&&c=="1"}var g_useDialogAlwaysList;function UseDialogsForFormsPages(b){if(Boolean(b)){var d=new URI(b),a=d.getLastPathSegment();if(Boolean(a)){a=a.toLowerCase();for(var c=0;c<g_useDialogAlwaysList.length;c++)if(a==g_useDialogAlwaysList[c])return true}}return UseDialogsForFormsWithCtx(GetCtxFromFormUrl(b))}function GetCtxFromFormUrl(c){var d=null,a=Nav.getUrlKeyValue("LISTID",false,c.toUpperCase());if(a=="")a=Nav.getUrlKeyValue("LIST",false,c.toUpperCase());if(a!=""&&g_ctxDict!=null)for(var e in g_ctxDict){var b=g_ctxDict[e];if(Boolean(b.listName)&&b.listName.toUpperCase()==a.toUpperCase()){d=b;break}}return d}function UseDialogsForFormsWithCtx(a){return a==null||typeof a.NavigateForFormsPages=="undefined"?false:Flighting.VariantConfiguration.IsExpFeatureClientEnabled(437)&&Boolean(a)&&a.SiteTemplateId==64&&Number(a.listTemplate)==100?true:!Boolean(a.NavigateForFormsPages)}function _EditItemWithCheckoutAlert(c,a,b,d,g,h,f,e){if(CheckoutAlertBeforeNavigate(a,b,d,g,h,f,e))if(b=="1"&&UseDialogsForFormsPages(a))NewOrEditV4Core(c,a,true);else _EditItem2(c,a)}function _STSNavigateWithCheckoutAlert(a,g,b,e,f,d,c){CheckoutAlertBeforeNavigate(a,g,b,e,f,d,c)&&Nav.navigate(a)}function ShowInPopUI(b,a,c){var d=function(){if(a==null&&typeof b.fromRibbon=="boolean"&&b.fromRibbon&&typeof b.currentCtx!="undefined"&&b.currentCtx!=null)a=b.currentCtx;if(typeof a!="undefined"&&a!=null&&a.clvp!=null){var d=a.clvp;GetFocusInfo(b,d);d.ShowPopup(c)}else Nav.navigate(c)};EnsureScript("inplview",typeof inplview,d)}function CheckoutAlertBeforeNavigate(g,f,d,c,e,a,b){if(typeof a=="undefined"||a==null||a=="")a=currentItemCheckedOutUserId;if((typeof b=="undefined"||b==null||b=="")&&typeof ctx!="undefined")b=ctx.CurrentUserId;if(d=="1"){alert(Strings.STS.L_CannotEditPropertyForLocalCopy_Text);return false}if(a!=null&&a!=""&&b!=null&&a!=b){alert(Strings.STS.L_CannotEditPropertyCheckout_Text);return false}if(f=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text)){if(c.charAt(0)=="/"||c.substr(0,3).toLowerCase()=="%2f")c=window.location.protocol+"//"+window.location.host+c;return CheckoutviaXmlhttp(e,c)}else return false;return true}function CheckoutviaXmlhttp(c,b){var a,e;a=new XMLHttpRequest;if(a==null)return false;a.open("POST",c+"/_vti_bin/lists.asmx",false);a.setRequestHeader("Content-Type","text/xml; charset=utf-8");a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckOutFile");var d='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>'+STSHtmlEncode(b)+"</pageUrl></CheckOutFile></soap:Body></soap:Envelope>";a.send(d);return a.status==200&&a.responseText.indexOf("true")!=0}function FSupportCheckoutToLocal(a){var c=true;if(a==null||a=="")return false;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionNotSupportCheckoutToLocal.length;b++)if(a==g_ExtensionNotSupportCheckoutToLocal[b])return false;return true}function FDefaultOpenForReadOnly(a){var c=false;if(a==null||a=="")return true;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionDefaultForRead.length;b++)if(a==g_ExtensionDefaultForRead[b])return true;return false}function ShouldCallEncodeURIComponent(){var a=GetCurrentCtx();return a!=null&&a.IsClientRendering}function CheckoutDocument(b,a){if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;if(ShouldCallEncodeURIComponent())a=encodeURIComponent(a);else a=escapeProperly(unescapeProperly(a));var c="FileName="+a+"&Checkout=true";NavigateToCheckinAspx(b,c);return true}function NewOrEditV4Core(g,a,i){var j=function(){var a=CLVPFromEventReal(g);GetFocusInfo(g,a)};g!=null&&EnsureScript("inplview",typeof InitAllClvps,j);var e=a.toUpperCase().indexOf("UPLOAD.ASPX")!=-1||a.toUpperCase().indexOf("UPLOADEX.ASPX")!=-1?true:false;if(e){var f=GetCurrentCtx();if(f!=null&&SupportAjaxFolderNav(f)){var h=new URI(a);h.setQueryParameter("RootFolder",f.rootFolder);a=h.getString()}}var c=typeof IsDragDropSupported!="undefined"&&IsDragDropSupported();if(e&&c){if(IsUploadInProgress())return false;var d,b=GetCtxFromFormUrl(a);if(!fIsNullOrUndefined(b)&&!fIsNullOrUndefined(b.wpq))d="WebPart"+b.wpq;if(!fIsNullOrUndefined(d))c=TryPrepUploadDialogToDragDrop(d)}if(i)_OpenPopUpPage(a,RefreshOnDialogClose);else if(e&&c)_OpenPopUpPage(a,function(b,a){RefreshPage(Boolean(b)&&(fIsNullOrUndefined(a)||Boolean(a))?SP.UI.DialogResult.OK:SP.UI.DialogResult.cancel)});else _OpenPopUpPage(a,RefreshPage);return false}function _NewItem2(c,a){var b=GetCurrentCtx();if(b!=null&&SupportAjaxFolderNav(b)){var d=new URI(a);d.setQueryParameter("RootFolder",b.rootFolder);a=d.getString()}cancelDefault(c);if(UseDialogsForNewItem(a)||UseDialogsForFormsPages(a))return NewOrEditV4Core(c,a);else{_NewItem(a);return undefined}}function _NewItem(a){GoToPage(a)}function _EditItem2(b,a){if(UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);_EditItem(a);return false}function _EditItem(a){GoToPage(a)}function _CorrectUrlForRefreshPageSubmitForm(){var b=window.location.href;if(typeof g_MinimalDownload!="undefined"&&g_MinimalDownload){var d=ajaxNavigate.getSavedFormAction();if(d!=null&&d.length>0)b=d}var a=ajaxNavigate.getParam("ServerFilter");if(typeof a!="undefined"&&null!=a&&a.length>0){a=a.replace(/-/g,"&").replace(/&&/g,"-");var f=Nav.getUrlKeyValue("RootFolder",true,a),e=Nav.getUrlKeyValue("RootFolder",true);if(""==f&&""!=e)a+="&RootFolder="+e;var c=new URI(b,{disableEncodingDecodingForLegacyCode:true});c.setFragment("");c.setQuery(a);return c.getString()}return b}function SetFocusBack(e){if(e==0||focusAcc!=null&&focusAcc.focusInCLVPTab!=null&&focusAcc.focusInCLVPTab!=true){var a=null;if(focusAcc!=null&&focusAcc.elem!=null)a=focusAcc.elem;if(a!=null&&a.tagName!="A"){var d=a.getElementsByTagName("A"),b=d.length;if(b>0)a=d[b-1]}if(a!=null&&typeof a.setActive!="undefined")try{if(a.setActive!=null)a.setActive();else a.focus!=null&&a.focus()}catch(f){}else if(ListModule.Settings.SupportsRibbon&&focusAcc!=null&&focusAcc.fromRibbon){var c=SP.Ribbon.PageManager.get_instance();c.get_ribbon()!=null&&c.restoreFocusToRibbon()}focusAcc=null}}function _RefreshPage(a){var b=function(){typeof SetFocusBack=="function"&&SetFocusBack(a)};if(a==1)_SubmitFormPost(_CorrectUrlForRefreshPageSubmitForm());else EnsureScript("inplview",typeof InitAllClvps,b)}function AJAXRefreshView(a,b){if(a==null||!(typeof a.fakeEvent=="boolean"&&a.fakeEvent||typeof a.csrAjaxRefresh=="boolean"&&a.csrAjaxRefresh||typeof a.fromRibbon=="boolean"&&a.fromRibbon))_RefreshPage(b);else EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.DialogResult.OK",function(){b==SP.UI.DialogResult.OK&&EnsureScriptParams("inplview","inplview.HandleRefreshView",a)})}function AJAXRefreshViewOnDialogClose(a){AJAXRefreshView(a,SP.UI.DialogResult.OK)}function RefreshOnDialogClose(){_RefreshPage(SP.UI.DialogResult.OK)}function OpenPopUpPageWithDialogOptions(c){var d=function(){var a=SP.UI.ModalDialog.showModalDialog(c)},b;try{b=typeof SP.UI.ModalDialog.showModalDialog}catch(e){b="undefined"}EnsureScript("SP.UI.Dialog.js",b,d);var a=window.event;if(a!=null)if(a.stopPropagation!=null)a.stopPropagation();else a.cancelBubble=true}function AdjustUrlForRootFolder(c){var a=GetCurrentCtx(),b=new URI(c);if(a!=null&&SupportAjaxFolderNav(a)){b.setQueryParameter("SaveLocation",Boolean(a.rootFolder)?a.rootFolder:a.listUrlDir);return b.getString()}return c}function OpenPopUpPageWithTitle(a,b,e,c,d){a=AdjustUrlForRootFolder(a);var f={url:a,args:null,title:d,dialogReturnValueCallback:b,width:e,height:c};OpenPopUpPageWithDialogOptions(f)}function ShowErrorDialogCore(d,b,e,f){var a;if(Boolean(f))a=b;else a="<div>"+b+"</div>";a=a+"<div class='ms-core-form-bottomButtonBox'><button id='js-OKBtnDismissDlg' onclick='DismissErrDlg(this)'>"+Strings.STS.L_CloseButtonCaption+"</button></div>";var c=document.createElement("DIV");c.innerHTML=a;var g={html:c,title:d,dialogReturnValueCallback:e},h=function(){var b=new SP.UI.ModalDialog.showModalDialog(g),a=document.getElementById("js-OKBtnDismissDlg");Boolean(a)&&a.focus()};EnsureScript("SP.UI.Dialog.js",typeof SP.UI.ModalDialog.showModalDialog,h)}function SetupAndOpenDialogForCustomAction(a,j,g,i){if(typeof a=="undefined"||a==null||a.length==0)return;var d=a.indexOf("//",0),b=-1;if(d==-1)b=a.indexOf("/",0);else b=a.indexOf("/",d+2);var h="";if(b==-1)b=a.length-1;h=a.substring(0,b);var f={url:a,args:null,title:i,dialogReturnValueCallback:CustomActionDialogCloseCallback,width:j,height:g},k=EnsureScriptParams("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",f),e=g_CustomActionDialogHandlerId,c=function(a){if(typeof a.data=="undefined"||typeof a.data==null||a.data!="CloseCustomActionDialogRefresh"&&a.data!="CloseCustomActionDialogNoRefresh")return;if(typeof a.origin=="undefined"||typeof a.origin==null)return;var c=function(){var b=SP.UI.ModalDialog.get_childDialog();if(a.data=="CloseCustomActionDialogRefresh")b.close(0);else b.close(1)},b;try{b=typeof SP.UI.ModalDialog.get_childDialog}catch(a){b="undefined"}EnsureScript("SP.UI.Dialog.js",b,c);a.data=="CloseCustomActionDialogNoRefresh"&&RemoveCustomActionDialogPostMessageHandler(e)};g_CustomActionDialogHandlers[g_CustomActionDialogHandlerId]=c;g_CustomActionDialogHandlerId++;if(typeof window.addEventListener!="undefined")window.addEventListener("message",c,false);else typeof window.attachEvent!="undefined"&&window.attachEvent("onmessage",c)}function CustomActionDialogCloseCallback(a){a==0&&RefreshOnDialogClose()}function RemoveCustomActionDialogPostMessageHandler(b){var a=g_CustomActionDialogHandlers[b];if(typeof a=="function"){if(typeof window.removeEventListener!="undefined"&&typeof window.removeEventListener!=null)window.removeEventListener("message",a,false);else typeof window.detachEvent!="undefined"&&typeof window.detachEvent!=null&&window.detachEvent("onmessage",a);delete g_CustomActionDialogHandlers[b]}}function _OpenPopUpPage(d,a,c,b){OpenPopUpPageWithTitle(d,a,c,b,null)}function _RemoveQueryStringsAndHash(a){if(Boolean(a)){var b=a.indexOf("#");if(b>=0)a=a.substr(0,b);b=a.indexOf("?");if(b>=0)a=a.substr(0,b)}return a}function _GoToCreateNewPage(){SP.QoS.WriteStart("WexGoToCreateNewPage_Start");_SendCreateNewCSRPageAjaxPost(function(a){if(IsXhrAborted(a)){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureAborted");_OpenDefaultCreateWebPageDialog();return}else if(IsXhrReady(a)&&(a.status<200||a.status>=300)){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureHttpStatus",{xhrStatus:a.status});_OpenDefaultCreateWebPageDialog();return}else if(IsXhrReady(a)){var b;try{b=JSON.parse(a.responseText)}catch(d){}if(b==null||!b.hasOwnProperty("d")||!b.d.hasOwnProperty("AbsoluteUrl")){SP.QoS.WriteFailure("WexGoToCreateNewPage_FailureInvalidJson",{json:a.responseText,xhrStatus:a.status});_OpenDefaultCreateWebPageDialog();return}var c=b.d.AbsoluteUrl+"?Mode=Edit";SP.QoS.WriteSuccess("WexGoToCreateNewPage_Success");GoToPage(c,true)}});return}function _SendCreateNewCSRPageAjaxPost(b){var c=Nav.combineUrl(_spPageContextInfo.webServerRelativeUrl,"/_api/sitepages/pages?$select=AbsoluteUrl"),d=JSON.stringify({__metadata:{type:"SP.Publishing.SitePage"}}),a=new XMLHttpRequest;a.open("POST",c,true);a.setRequestHeader("Content-type","application/json;odata=verbose");a.setRequestHeader("accept","application/json;odata=verbose");a.setRequestHeader("Connection","Keep-alive");a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);a.setRequestHeader("cache-control","no-cache");a.setRequestHeader("DataServiceVersion","3.0");a.onreadystatechange=function(){Boolean(b)&&b(a)};a.send(d)}function _OpenDefaultCreateWebPageDialog(){_OpenCreateWebPageDialog(GetLayoutsPageUrl(_spPageContextInfo.webServerRelativeUrl,"createwebpage.aspx"))}function _OpenCreateWebPageDialog(a){if(!Boolean(a)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo.webServerRelativeUrl!=null){a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";a=a+"_layouts/15/createwebpage.aspx"}var b=ajaxNavigate.get_href();b=_RemoveQueryStringsAndHash(b);a=StURLSetVar2(a,"Url",escapeProperly(b));if(FV4UI()){var c={};commonModalDialogOpen(a,c,null,null)}else GoToPage(a)}function _EditLink2(a,b){var c=function(){var d=GetGotoLinkUrl(a);if(d==null)return false;var c=window["ctx"+String(b)];if(c!=null&&c.clvp!=null&&UseDialogsForFormsWithCtx(c)){var e=c.clvp;PreventDefaultNavigation();e.ShowPopup(d);return false}GoToLinkOrDialogNewWindow(a);return false};EnsureScript("inplview",typeof inplview,c)}function EditLink(a,b){if(FV4UI())EditLink2(a,b);else GoToLink(a)}function _GoBack(a){window.location.href=unescapeProperly(Nav.getSource(a))}function _ReplyItem(a,b,d,c){if(b.length>=504)alert(Strings.STS.L_ReplyLimitMsg_Text);else{a+="?Threading="+b;a+="&Guid="+d;a+="&Subject="+c;GoToPage(a)}}function GoBacktoCurrentIssue(a,b){a+="?ID="+b;GoToPage(a)}function _ExportToDatabase(c,d,e,b){if(g_expDatabase==null){var a=GetCookie("databaseBtnText");if(a!=null&&a!="0")try{g_expDatabase=new ActiveXObject("SharePoint.ExportDatabase")}catch(f){return}else if(a==null)GetDataBaseInstalled();else return}if(g_expDatabase!=null&&typeof g_expDatabase.DoExport!="undefined")if(browseris.ie5up&&browseris.win32)try{g_expDatabase.SiteUrl=makeAbsUrl(c);g_expDatabase.ListID=d;g_expDatabase.ViewID=e;g_expDatabase.DoExport(b)}catch(f){alert(Strings.STS.L_ExportDBFail_Text);return}else alert(Strings.STS.L_NoWSSClient_Text)}function _ExportList(a){var b=typeof navigator.msProtocols=="function"&&navigator.msProtocols.excel;!b&&g_ssImporterObj==null&&EnsureSSImporter();if(!b&&g_ssImporterObj==null)(g_fSSImporter||GetCookie("EnsureSSImporter")==null)&&EnsureSSImporter(true);if(IsSupportedMacBrowser()){if(g_fSSImporter!=null&&typeof g_ssImporterObj.IqyExportEnabled!="undefined"&&g_ssImporterObj.IqyExportEnabled&&typeof g_ssImporterObj.IqyExport!="undefined"){var c=g_ssImporterObj.IqyExport(makeAbsUrl(a));if(!c)window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(b||g_fSSImporter!=false&&typeof g_ssImporterObj.IqyImportEnabled!="undefined"&&g_ssImporterObj.IqyImportEnabled()||confirm(Strings.STS.L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}function ExportDiagram(l,e,k,f,h,g){if(g_objDiagramLaunch==null){var a=GetCookie("digInstalled");if(a!=null&&a!="0")try{g_objDiagramLaunch=new ActiveXObject("DiagramLaunch.DiagramLauncher")}catch(m){return}else if(a==null)GetDiagramLaunchInstalled();else return}if(g_objDiagramLaunch!=null&&typeof g_objDiagramLaunch.CreateDiagram!="undefined")try{var c="",i=l,d=g,b=e,j=k;g_objDiagramLaunch.CreateDiagram(c,i,d,b,f,h,j)}catch(m){alert(Strings.STS.L_DiagramLaunchFail_Text)}}function OpenTasks(g,a,f,b,e,d){var c="ms-project:ost|u|"+g+"|l|"+a+"|i|"+f+"|n|"+b+"|v|"+e+"|g|"+d;window.location.href=c}function CatchListCreateError(){alert(Strings.STS.L_EditInGrid_Text);fListErrorShown=true;return false}function RegisterTouchOverride(a,b){if(a.getAttribute("hasTouchHandler")!="true")if(window.navigator.msMaxTouchPoints!=null&&window.navigator.msMaxTouchPoints>0){AttachEvent("MSPointerDown",function(a){a.target.setAttribute("pointerType",a.pointerType.toString())},a);a.setAttribute("hasTouchHandler","true")}else if(document.documentElement!=null&&"ontouchstart"in document.documentElement){AttachEvent("touchstart",function(a){if(b(a)){a.preventDefault!=null&&a.preventDefault();a.stopPropagation!=null&&a.stopPropagation()}},a);a.setAttribute("hasTouchHandler","true")}}function EnsureListControl(){if(!fListControl){fListErrorShown=false;if(browseris.ie5up&&browseris.win32){var b='try{    ListCtrlObj = new ActiveXObject("ListNet.ListNet");    if (ListCtrlObj)        fListControl = true;} catch (e){    fListControl = false;};',a=new Function(b);a()}else{window.onerror=CatchListCreateError;ListCtrlObj=new ActiveXObject("ListNet.ListNet");if(ListCtrlObj!=null)fListControl=true}}ListCtrlObj=null;return fListControl}function IsVoteOK(a){if(1==a)alert(Strings.STS.L_NoQuestion_Text);else if(2==a)alert(Strings.STS.L_NoVoteAllowed_Text);else return true;return false}function hasHighChar(b){for(var a=0,a=0;a<b.length;a++)if(b.charCodeAt(a)>127)return true;return false}function _ClearSearchTerm(a){if(typeof MSOWebPartPageFormName!="undefined"){var c=document.forms[MSOWebPartPageFormName];if(null!=c)if(a!=null){var b=c["SearchString"+a];if(b!=null)b.value=""}}bValidSearchTerm=true}function _SubmitSearchRedirect(b){var a=document.forms.frmSiteSearch;if(a==null)if(typeof MSOWebPartPageFormName!="undefined")a=document.forms[MSOWebPartPageFormName];if(a!=null){var e;if(typeof a.elements.SearchString!="undefined")e=a.elements.SearchString;var c=e.value.trim();if(c===Strings.STS.L_SharepointSearch_Text||c==="")return false;b=b+"?k="+escapeProperly(c);var f=a.elements.SearchScope;if(f!=null){var d=f.value;if(Boolean(d))b=b+"&u="+escapeProperly(d)}window.location.href=b}return false}function ShowGridUrlInHTML(a){if(a.indexOf("?")>0)a=a+"&";else a=a+"?";a=a+"ShowInGrid=HTML";return a}function LoadGroupAndSiteLinkingBanners(){Flighting.VariantConfiguration.IsExpFeatureClientEnabled(527)&&ModuleLink.loadManifest("GroupLinking","groupLinking",function(){require(["odsp-next/roots/GroupLinking"],function(a){a.instantiateBanners()})})}function SearchOnBodyLoad(){var a=document.getElementById("idSearchString");if(a!=null&&(a.value.trim()===Strings.STS.L_SharepointSearch_Text||a.value.trim()===""))a.className="ms-sharepointsearchtext"}function SearchOnBlur(){var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===""){a.value=Strings.STS.L_SharepointSearch_Text;a.className="ms-sharepointsearchtext"}}function SearchOnFocus(){var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===Strings.STS.L_SharepointSearch_Text){a.value="";a.className="ms-searchtext"}}function SubmitSearch(){_SubmitSearchForView("")}function _SubmitSearchForView(e){var a=document.forms[0],c="SearchString"+e,d=a.elements[c].value;if(""==d){alert(Strings.STS.L_Enter_Text);a.elements[c].focus()}else{var b;b=RemovePagingArgs(a.action);if(typeof bGridViewPresent!="undefined"&&bGridViewPresent)b=ShowGridUrlInHTML(b);a.action=b;a.submit()}}function IsKeyDownSubmit(a){if(a!=null){var c,b;if(browseris.ie){c=a.keyCode;b=Number(a.altKey||a.ctrlKey)}else{c=a.which;b=typeof a.modifers!="undefined"&&typeof a.ALT_MASK!="undefined"&&typeof a.CONTROL_MASK!="undefined"?a.modifers&(a.ALT_MASK|a.CONTROL_MASK):0}if(c==13&&!Boolean(b))return true}return false}function SearchViewKeyDown(a){IsKeyDownSubmit(event)&&_SubmitSearchForView(a)}function SearchKeyDown(b,a){if(IsKeyDownSubmit(b)){_SubmitSearchRedirect(a);return false}return true}function SearchKeyDownGoSearch(a){if(IsKeyDownSubmit(a)){typeof GoSearch!="undefined"&&GoSearch();return false}return true}function _AlertAndSetFocus(b,a){a.focus();a.select();window.alert(b)}function _AlertAndSetFocusForDropdown(b,a){a.focus();window.alert(b)}function setElementValue(c,b){var a=document.getElementsByName(c)[0];if(a==null)return false;a.value=b;return true}function GetMultipleSelectedText(a){var c="";if(a!=null)for(var e=a.options.length,d=true,b=0;b<e;b++)if(a.options[b].selected){if(!d)c+=",";else d=false;c+=a.options[b].text}return c}function GetCBSelectedValues(c){if(c==null)return null;for(var a="",e=true,f=c.elements.length,d=0;d<f;d++){var b=c.elements[d];if(b.type=="checkbox"&&!b.disabled)if(b.checked){if(a!="")a+=",";a+=b.value}else e=false}return new CBSelectedValues(a,e)}function editDocumentWithProgID(a,b){if(fNewDoc){if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;if(!fNewDoc2&&!fNewDoc3)(typeof EditDocumentButton.EditDocument=="undefined"||!EditDocumentButton.EditDocument(a,b))&&alert(Strings.STS.L_EditDocumentRuntimeError_Text);else(typeof EditDocumentButton.EditDocument2=="undefined"||!EditDocumentButton.EditDocument2(window,a,b))&&alert(Strings.STS.L_EditDocumentRuntimeError_Text)}else alert(Strings.STS.L_EditDocumentProgIDError_Text)}function GetSPDDownLoadUrl(){var a=typeof navigator.userLanguage=="string"?navigator.userLanguage:null;if(!Boolean(a))a=navigator.browserLanguage;return SPDesignerDownloadUrl+"?clid="+a}function PHSucceed(b,a){phManager.SetProtocolHandlerEnabled(b,a)}function _EditInSPD(a,e){var b=GetSPDDownLoadUrl();if(a.charAt(0)=="/")a=window.location.protocol+"//"+window.location.host+a;var c=ajaxNavigate.convertMDSURLtoRegularURL(a);if(phManager.ShouldTryProtocolHandler("ms-spd")){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl("ms-spd",c,ProtocolCommand.Edit,null),function(){PHSucceed("ms-spd",true)},function(){PHSucceed("ms-spd",false);d()});return}d();function d(){if(phManager.IsProtocolHandlerEnabled("ms-spd")){window.location.href=phManager.CreateProtocolHandlerUrl("ms-spd",unescapeProperly(c),ProtocolCommand.Edit,null);return}var d=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(d!=null&&typeof d.EditDocument3!="undefined"){if(!d.EditDocument3(window,a,false,SPDesignerProgID))window.open(b);else if(e)window.onfocus=RefreshOnNextFocus}else window.open(b)}}function CustomizeSharePointListUsingInfoPath(c,d,a,f){var b=GetMSInfoPathCustomizeSharePointListProtocolUrl(c,d,a);if(typeof phManager!="undefined"&&phManager!=null)if(phManager.ShouldTryProtocolHandler("infopath")){navigator.msLaunchUri(b,function(){PHSucceed("infopath",true)},function(){PHSucceed("infopath",false);e()});return}e();function e(){try{var e=null;if(Boolean(window.ActiveXObject)||"ActiveXObject"in window)e=new ActiveXObject("SharePoint.OpenXMLDocuments.3");if(e!=null&&typeof e.CustomizeSharePointList!="undefined")if(a!=null)e.CustomizeSharePointList(c,d,a);else e.CustomizeSharePointList(c,d);else if(b!=null&&typeof phManager!="undefined"&&phManager!=null&&phManager.IsProtocolHandlerEnabled("infopath"))window.location.href=b;else throw"cannot open";}catch(g){alert(f)}}}function GetMSInfoPathCustomizeSharePointListProtocolUrl(e,d,b){var c=d;if(!(window.OffSwitch==null||OffSwitch.IsActive("9742B12B-2CFA-4B16-8AB3-4153CD7C0104")))c=d.replace(/{|}/g,"");var a=[];a.push("ms-infopath:csl|u|");a.push(e);a.push("|l|");a.push(c);if(b!=null){a.push("|c|");a.push(b)}return a.join("")}function editDocumentWithProgID2(e,a,h,g,f,b,j){var i=!(window.OffSwitch==null||OffSwitch.IsActive("A55794A6-5D97-41B5-A4E2-DE95BDC82583"));editDocumentWithProgIDNoUI(e,a,h,g,f,b,j,c,d,i);function c(){if(a==SPDesignerProgID){var b=GetSPDDownLoadUrl();window.open(b)}else alert(Strings.STS.L_EditDocumentRuntimeError_Text);window.onfocus=RefreshOnNextFocus}function d(){alert(Strings.STS.L_EditDocumentProgIDError_Text)}}function editDocumentWithProgIDNoUI(a,d,e,h,o,m,b,j,k,i){var c,f=false;e=e.replace(/(?:\.\d+)$/,"");if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=window.location.protocol+"//"+window.location.host+a;var n=SzExtension(unescapeProperly(a));if(phManager.ShouldTryProtocolHandler(b)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null,i),function(){PHSucceed(b,true)},function(){PHSucceed(b,false);g()});return}g();function g(){var c=l();if(c!=0&&!browseris.ie&&!IsNullOrUndefined(b)&&b!="")window.location.href=phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null,i);else if(c==1&&j!=null)j();else c==2&&k!=null&&k()}function l(){if(!IsNullOrUndefined(b)&&b!=""&&phManager.IsProtocolHandlerEnabled(b)){window.location.href=phManager.CreateProtocolHandlerUrl(b,a,ProtocolCommand.Edit,null);return 0}if(FSupportCheckoutToLocal(n))try{c=StsOpenEnsureEx2(e+".3");if(c!=null){if(h=="1"){if(typeof c.CheckoutDocumentPrompt=="undefined")return 1;if(!c.CheckoutDocumentPrompt(a,true,d))return 1}else{if(m=="1")f=true;if(!c.EditDocument3(window,a,f,d))return 1}var i=false;i=c.PromptedOnLastOpen();if(i)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return 0}}catch(j){}if(h=="1")if(confirm(Strings.STS.L_ConfirmCheckout_Text)){var g;if(ShouldCallEncodeURIComponent())g=encodeURIComponent(a);else g=escapeProperly(unescapeProperly(a));NavigateToCheckinAspx(o,"FileName="+g+"& true")}else return 0;c=StsOpenEnsureEx2(e);if(c!=null){try{if(!c.EditDocument2(window,a,d))return 1;if(e=="SharePoint.OpenXMLDocuments")SetWindowRefreshOnFocus();else window.onfocus=RefreshOnNextFocus;return 0}catch(j){}try{window.onfocus=null;if(SzExtension(a)=="ppt"&&d=="")d="PowerPoint.Slide";if(!c.EditDocument(a,d))return 1;SetWindowRefreshOnFocus();return 0}catch(j){return 2}}return 1}}function RefreshOnNextFocus(){SetWindowRefreshOnFocus()}function createNewDocumentWithProgID2Ex(g,b,a,d,c,e,f){createNewDocumentWithProgID2(b,a,d,c,e,f)}function createNewDocumentWithProgID2(b,a,f,e,c,d){createNewDocumentWithProgIDCore(b,a,f,c,false,d,function(){createNewDocumentWithProgIDCore(b,a,e,c,true,d)})}function createNewDocumentWithProgIDEx(f,b,a,c,d,e){createNewDocumentWithProgID(b,a,c,d,e)}function createNewDocumentWithProgID(b,a,c,d,e){createNewDocumentWithProgIDCore(b,a,c,d,true,e)}function createNewDocumentWithProgIDCore(e,d,i,m,l,b,j){var a,c,f,g=false;if(phManager.ShouldTryProtocolHandler(b)){navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(b,e,ProtocolCommand.New,d),function(){PHSucceed(b,true)},function(){PHSucceed(b,false);h()});return}h();function h(){!k()&&j!=null&&j()}function k(){if(Boolean(b)&&phManager.IsProtocolHandlerEnabled(b)){window.location.href=phManager.CreateProtocolHandlerUrl(b,e,ProtocolCommand.New,d);return true}if(m){c=Strings.STS.L_NewFormLibTb1_Text;f=Strings.STS.L_NewFormLibTb2_Text}else{c=Strings.STS.L_NewDocLibTb1_Text;f=Strings.STS.L_NewDocLibTb2_Text}try{a=StsOpenEnsureEx2(i+".2");(typeof a.CreateNewDocument2=="undefined"||!a.CreateNewDocument2(window,e,d))&&alert(c);g=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(g)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return true}catch(h){}try{a=StsOpenEnsureEx2(i+".1");window.onfocus=null;(typeof a.CreateNewDocument=="undefined"||!a.CreateNewDocument(e,d))&&alert(c);SetWindowRefreshOnFocus();return true}catch(h){l&&alert(f)}return undefined}}function createNewDocumentWithRedirect2(i,d,b,e,f,c,h,a,g){createNewDocumentWithRedirect(d,b,e,f,c,h,a,g)}function createNewDocumentWithRedirect(c,d,b,i,h,j,f,a){var e=GetCurrentCtx();Boolean(e)&&SP.QoS.WriteUserEngagement(e.ContentTypesEnabled?"ContenTypeBasedTemplateFileCreatiion":"TemplateFileCreation",{url:c,progID:b});var g=false;g=Boolean(e)&&IsNewWOPIDocumentEnabledForType(e.NewWOPIDocumentTypes,a)&&IsDefaultFileCreationSupported(null,a);if(j&&!g)if(IsClientAppInstalled(b,a,null))createNewInClient(c,d,b,i,a);else createNewInBrowser(h,d,b,f,a,c);else if(IsClientAppInstalled(b,a,null)&&f!=1)createNewInClient(c,d,b,i,a);else createNewInBrowser(h,d,b,f,a,c)}function createNewInClient(c,b,d,e,f){var a=d.replace(/(?:\.\d+)$/,"");createNewDocumentWithProgID(c,b,a,e,f)}function createNewInBrowser(a,f,h,e,i,g){if(IsDefaultFileCreationSupported(null,i))CreateNewDefaultDocument(null,null,g);else{a=a+"&SaveLocation="+makeAbsUrl(escapeProperly(f));a=AddInfoPathParametersToUrl(a,h,null,e);a=AddSourceToUrl(a);var d=new URI(a),b=false;if(Boolean(d)){var c=d.getPath(true);if(Boolean(c)&&c.toLowerCase().indexOf("createnewdocument.aspx")!=-1)b=true}if(b)_OpenPopUpPage(a,OnCloseDialogNavigate);else Nav.navigate(a)}}var DocType;function IsDefaultFileCreationSupported(a,c){if(!Boolean(a))switch(c){case"ms-word":a=DocType.Word;break;case"ms-excel":a=DocType.Excel;break;case"ms-powerpoint":a=DocType.PowerPoint;break;case"ms-visio":a=DocType.Visio;break;default:a=DocType.Invalid}var b=false;b=a==DocType.Word||a==DocType.Excel||a==DocType.PowerPoint||a==DocType.Visio;return IsWOPIRenameFeatureActive()&&b}function IsNewWOPIDocumentEnabledForType(a,b){switch(b){case"ms-word":return Boolean(a&1<<DocType.Word);case"ms-excel":return Boolean(a&1<<DocType.Excel);case"ms-powerpoint":return Boolean(a&1<<DocType.PowerPoint);case"ms-visio":return Boolean(a&1<<DocType.Visio);default:return false}}function IsWOPIRenameFeatureActive(){return Flighting.VariantConfiguration.IsExpFeatureClientEnabled(18)}function IsOfficeURLSchemes(a){return["ms-word","ms-excel","ms-powerpoint","ms-visio"].includes(a)}function addWopiPerfMarkForTarget(e,b,c){var d=Boolean(b)?b:+new Date;try{var a=new URI(e,{disableEncodingDecodingForLegacyCode:true,queryCaseInsensitive:true});a.setQueryParameter("CT",d.toString());a.setQueryParameter("OR",c);return a.getString()}catch(f){}}function addWopiPerfMark(b){var c=+new Date;try{var a=ajaxNavigate.get_href();a=addWopiPerfMarkForTarget(a,c,b);history.replaceState({reason:"WopiUserClick"},"WopiUserClick",a)}catch(d){}}function addWopiPerfMarkEx(b,c,a){if(a==null||a.length==0)return;b=+new Date;if(!IsNullOrUndefined(window.sessionStorage)){TrySetProperty(window.sessionStorage,"WOPIPerf_UserClick_"+a,b);TrySetProperty(window.sessionStorage,"WOPIPerf_UserClickOrigin",c)}}function removeWopiPerfMark(){!IsNullOrUndefined(window.sessionStorage)&&window.sessionStorage.removeItem("WOPIPerf_UserClickTime")}function CreateNewDefaultDocument(j,c,f){SP.QoS.WriteUserEngagement("TemplateFileCreation",{docType:c,docTemplate:f});var b=j==null?GetCurrentCtx():window["ctx"+j],g=SP.ClientContext.get_current(),m=+new Date,d=null,e=null,a="",p=(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(b.RealHttpRoot);if(p){var i=new SP.RemoteWeb(g,b.HttpRoot);d=i.getListById(b.listName);e=Boolean(b.clvp.rootFolder)?i.getFolderByServerRelativeUrl(b.clvp.rootFolder):d.get_rootFolder();a="Remote_"}else{var k=g.get_web();d=k.get_lists().getById(b.listName);e=Boolean(b.clvp.rootFolder)?k.getFolderByServerRelativeUrl(b.clvp.rootFolder):d.get_rootFolder()}_WriteDocEngagement(a+"Start CreateNewDefaultDocument",a+"OneDrive_Start CreateNewDefaultDocument");var h=b.NewWOPIDocumentUrl+"&Source="+Nav.getSource();h+=Boolean(c)?"&TemplateType="+String(c):"&id="+f;var r=Boolean(c)?d.createDocument(null,e,c):d.createDocumentFromTemplate(null,e,f),l=SP.Utilities.SPWOPIFrameAction,q=r.getWOPIFrameUrl(l.edit);g.executeQueryAsync(o,n);function o(){var b=q.get_value();if(Boolean(b)){_WriteDocEngagement(a+"Success CreateNewDefaultDocument",a+"OneDrive_Success CreateNewDefaultDocument");b=b.replace("action=edit","action=editnew");if(parseInt(c)==DocType.Word&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(202)||parseInt(c)==DocType.PowerPoint){b=b.replace("/WopiFrame.aspx","/doc.aspx");b=addWopiPerfMarkForTarget(b,m,"DocLibClassicUI")}GoToPage(b)}}function n(c,b){_WriteDocEngagement(a+"Fail CreateNewDefaultDocument",a+"OneDrive_Fail CreateNewDefaultDocument");_WriteDocDebugLog(a+"Debug TeamSite_Fail CreateNewDefaultDocument",a+"Debug OneDrive_Fail CreateNewDefaultDocument",SP.DebugLogger.LoggingLevel.Interesting,getLoggingInfo(b));(window.OffSwitch==null||OffSwitch.IsActive("8FDE0754-2E15-4696-ADF5-F2266A765360"))&&removeWopiPerfMark();OpenPopUpPageWithTitle(h,OnCloseDialogNavigate,null,null,null)}}function OnCloseDialogNavigate(b,a){b==SP.UI.DialogResult.OK&&Boolean(a)&&Nav.navigate(a)}function LRUCache(){this.state=[];this.ageStack=[];this.count=0}function LRUCache_InitializePrototype(){LRUCache.prototype.state=[];LRUCache.prototype.ageStack=[];LRUCache.prototype.count=0}function LRUCache_Add(a,b){if(a==null)return;var c=a.state[b];if(c!=null)a.ageStack[c]=null;else a.count++;var d=a.ageStack.length;a.state[b]=d;a.ageStack.push(b)}function LRUCache_Remove(a,b){if(a==null)return;var c=a.state[b];if(c!=null){a.ageStack[c]=null;a.state[b]=null;a.count--}}function _AddGroupToCookie(c){var a=ExpGroupFetchWebPartID(c);if(a==null)return;LRUCache_Add(g_ExpGroupWPState,a);if(g_ExpGroupTable[a]==null)g_ExpGroupTable[a]=new LRUCache;var b=ExpGroupFetchGroupString(c);if(b==null)return;LRUCache_Add(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function _RemoveGroupFromCookie(d){var a=ExpGroupFetchWebPartID(d);if(a==null)return;if(g_ExpGroupTable[a]==null)return;LRUCache_Add(g_ExpGroupWPState,a);var c=ExpGroupFetchGroupString(d);if(c==null)return;var b;for(b in g_ExpGroupTable[a].state)g_ExpGroupTable[a].state[b]!=null&&b.substring(0,c.length)==c&&LRUCache_Remove(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function ExpGroupRenderCookie(){if(g_ExpGroupWPState==null)return;for(var c=ExpGroupWPListName+"=",a=0,d=g_ExpGroupWPState.ageStack.length-1;d>=0;d--)if(g_ExpGroupWPState.ageStack[d]!=null){var b=g_ExpGroupWPState.ageStack[d];if(a==ExpGroupMaxWP){DeleteCookie(ExpGroupCookiePrefix+b);break}else if(g_ExpGroupTable[b]==null){a++;if(a>1)c+=escapeProperly(ExpGroupCookieDelimiter);c+=escapeProperly(b)}else if(g_ExpGroupTable[b].count==0)DeleteCookie(ExpGroupCookiePrefix+b);else if(a<ExpGroupMaxWP){a++;ExpGroupRenderCookieForWebPart(b);if(a>1)c+=escapeProperly(ExpGroupCookieDelimiter);c+=escapeProperly(b)}}if(a==0)DeleteCookie(ExpGroupWPListName);else document.cookie=c}function ExpGroupRenderCookieForWebPart(a){if(!g_ExpGroupTable[a].ageStack)return;for(var d=ExpGroupCookiePrefix+a+"=",e=true,c=g_ExpGroupTable[a].ageStack.length-1;c>=0;c--)if(g_ExpGroupTable[a].ageStack[c]!=null){var f=g_ExpGroupTable[a].ageStack[c],b="";if(!e)b+=escapeProperly(ExpGroupCookieDelimiter);b+=escapeProperly(f);if(d.length+b.length<=ExpGroupMaxCookieLength){d+=b;e=false}}document.cookie=d+";"}function ExpDataViewGroupOnPageLoad(){ExpGroupOnPageLoad("PageLoad")}function ExpGroupOnPageLoad(a){var b=document.getElementById("GroupByColFlag");if(b!=null){if(typeof g_ExpGroupNeedsState!="undefined")g_ExpGroupNeedsState=true;ExpGroupParseCookie(a)}}function ExpGroupParseCookie(a){var d=GetCookie(ExpGroupWPListName);if(d==null)return;if(typeof g_ExpGroupParseStage!="undefined")g_ExpGroupParseStage=true;for(var e=d.split(ExpGroupCookieDelimiter),c=e.length-1;c>=0;c--){var b=e[c];LRUCache_Add(g_ExpGroupWPState,b);if(g_ExpGroupTable[b]==null)document.getElementById("GroupByCol"+b)!=null&&ExpGroupParseCookieForWebPart(b,a)}if(typeof g_ExpGroupParseStage!="undefined")g_ExpGroupParseStage=false;if(Boolean(a)&&g_ExpGroupXSLTQueue.length>0)ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),a);else!Boolean(a)&&g_ExpGroupCAMLQueue.length>0&&ExpGroupFetchData(g_ExpGroupCAMLQueue.shift(),a)}function ExpGroupParseCookieForWebPart(c,f){var n=GetCookie(ExpGroupCookiePrefix+c);if(n==null)return;var o=n.split(ExpGroupCookieDelimiter),e,b;g_ExpGroupTable[c]=new LRUCache;for(b=o.length-1;b>=0;b--){e=o[b];LRUCache_Add(g_ExpGroupTable[c],e)}var d=[],q=document.getElementById("GroupByCol"+c).parentNode,j=q.getElementsByTagName("TBODY");for(b=0;b<j.length;b++){e=j[b].getAttribute("groupString");if(e!=null){var k=j[b].id;if(k==null)continue;var a=k.substring(4,k.length),s=a.substring(0,a.indexOf("-")),m=g_ctxDict["ctx"+s];if(m==null||!m.isXslView&&Boolean(f)||m.isXslView&&!Boolean(f)){g_ExpGroupTable[c]=null;break}if(g_ExpGroupTable[c].state[e]!=null&&d[a]==null){ExpCollGroup(a,"img_"+a,f);d[a]=true;var p=document.getElementById("tbod"+a+"_");if(p!=null){var r=p.getAttribute("isLoaded");if(r=="false")if(Boolean(f))g_ExpGroupXSLTQueue.push(a);else g_ExpGroupCAMLQueue.push(a)}}}}var g;for(g in d){var l=g.indexOf("_");if(l!=g.length-1&&l!=-1){var h=g.substring(0,l+1);if(d[h]==null){var i=ExpGroupFetchGroupString(h);if(i!=null){LRUCache_Add(g_ExpGroupWPState,i);ExpCollGroup(h,"img_"+h,f);d[i]=true}}}}}function _ExpGroupBy(s){if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var j=document.all,o=j.length,u=s.getElementsByTagName("IMG"),e=u[0],l=e.getAttribute("src"),x=l.lastIndexOf("/"),k=l.slice(x+1),h=GetThemedImageUrl("commentexpand12.png"),r=GetThemedImageUrl("commentcollapse12.png"),f="auto";if(l==h||k=="plus.gif"){f="";if(k=="plus.gif")e.src="/_layouts/15/images/minus.gif";else e.src=h}else{f="none";if(k=="minus.gif")e.src="/_layouts/15/images/plus.gif";else e.src=GetThemedImageUrl("commentcollapse12.png")}var t=e.name;e.name=e.alt;e.alt=t;var c=e;while(c!=null){c=c.parentNode;if(c!=null&&c.id!=null&&c.id.length>5&&c.id.substr(0,5)=="group")break}var b=c;while(b!=null){b=b.parentNode;if(b!=null&&b.tagName=="TABLE")break}var d=null;if(b!=null){d=b.lastChild;if(d!=null&&d.tagName=="TBODY")d=d.lastChild;if(d!=null&&d.tagName=="TR"&&d.lastChild!=null)d=d.lastChild}for(var a,g=0;g<o;g++){a=j[g];if(a==c)break}for(var q=c.id.slice(5),w=parseInt(q),i=f,m=g+1;m<o;m++){a=j[m];if(a.id.length>5&&a.id.substr(0,5)=="group"){var v=parseInt(a.id.slice(5));if(v<=w)return}b=a;while(b!=null){b=b.parentNode;if(b==c)break}if(b==c)continue;if(a.id!=null&&a.id.substring(0,5)=="group")f=i;if(a.id!=null&&a.id.substring(0,8)=="footer"+q)f=i;if(i!="none"&&a!=e&&a.tagName=="IMG"&&a.src!=null){var p="/_layouts/15/images/plus.gif",n="/_layouts/15/images/minus.gif";if(a.getAttribute("src")==h||a.src.slice(a.src.length-p.length)==p)f="none";else if(a.getAttribute("src")==r||a.src.slice(a.src.length-n.length)==n)f=""}if(a.tagName==c.tagName&&a.id!="footer")a.style.display=f;if(a.tagName=="TABLE"&&d==null||a==d)break}}function SzExtension(a){var c=new String(a),b=/^.*\.([^\.]*)$/;return c.replace(b,"$1").toLowerCase()}function SzServer(a){var c=new String(a),b=/^([^:]*):\/\/([^\/]*).*$/;return c.replace(b,"$1://$2")}var v_stsOpenDoc,v_strStsOpenDoc;function NavigateParentOrSelf(b,a){NavigateParentOrSelfCore(a,b.target=="_top")}function NavigateParentOrSelfCore(a,b){if(b&&typeof window.frameElement!="undefined"&&window.frameElement!=null&&typeof window.frameElement.navigateParent!="undefined")window.frameElement.navigateParent(a);else Nav.navigate(a)}function NavigateElementHref(a){Boolean(a.href)&&Nav.navigate(a.href)}function StsOpenEnsureEx(a){if(v_stsOpenDoc==null||v_strStsOpenDoc!=a)if(window.ActiveXObject!=null||"ActiveXObject"in window)try{v_stsOpenDoc=new ActiveXObject(a);v_strStsOpenDoc=a}catch(b){v_stsOpenDoc=null;v_strStsOpenDoc=null}return v_stsOpenDoc}function _DispDocItem(b,a){_WriteDocEngagement("Documents_DisplayDocumentItem","OneDrive_DisplayDocumentItem");return _DispDocItemEx(b,"FALSE","FALSE","FALSE",a)}function _DispDocItemExWithServerRedirect(d,c,j,g,i,f,k,a){_WriteDocEngagement("Documents_OpenAttachmentClick","OneDrive_OpenAttachmentClick");var e=a!=null&&a!="",h=IsClientAppInstalled(f,null,d)&&HasRights(16,0)||SzExtension(d.href)=="pdf";if(e){a=a.substring(1);e=a!=""}if(e)if(k=="1"||!h){_WriteDocEngagement("Documents_OpenAttachmentInBrowser","OneDrive_OpenAttachmentInBrowser");var b=a;b=AddInfoPathParametersToUrl(b,f,d,DocOpen.BROWSER);b=AddSourceToUrl(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(b);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(d,b);c.cancelBubble=true;c.returnValue=false;return false}return DispDocItemExWithEvent(d,c,j,g,i,f)}var _lightboxImageExtensions,_lightboxVideoExtensions;function _shouldOpenInLightbox(a){if(!(window.OffSwitch==null||OffSwitch.IsActive("df08250b-ba7a-495b-896f-2a5a2c99943d")))return false;else{var b,c;if((c=a.indexOf("?"))!==-1)a=a.substring(0,c);b=a.split(".").pop().toUpperCase();return _lightboxImageExtensions.indexOf(b)!==-1||_lightboxVideoExtensions.indexOf(b)!==-1}}function _openInLightbox(a){if(Boolean(history.state)&&Boolean(history.state.lightbox))return;EnsureScriptFunc("SP.js","SP.Utilities.Utility",function(){var b=new URI(ajaxNavigate.get_href()).getQueryAsObject(),c=!(window.OffSwitch==null||OffSwitch.IsActive("EA88F22A-E74E-4315-BCC9-14F41AA20A67")),d=!(window.OffSwitch==null||OffSwitch.IsActive("07A79629-CE2D-40FD-93FB-769702276A82"))?decodeURIComponent(a):decodeURI(a);a=SP.Utilities.Utility.getLayoutsPageUrl("Lightbox.aspx?url="+encodeURIComponent(c?d:a));if(Boolean(b.GroupId))a+="&GroupId="+encodeURIComponent(b.GroupId)+"&GroupSiteUrl="+(Boolean(b.GroupSiteUrl)?encodeURIComponent(b.GroupSiteUrl):"");EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.MediaLightbox",function(){SP.UI.MediaLightbox.show({lightboxUrl:a});Boolean(history.pushState)&&history.pushState({lightbox:true},null,a)})})}function _DispDocItemEx(e,c,a,b,d){return DispDocItemExWithEvent(e,null,c,a,b,d)}function DispDocItemExWithEvent(e,g,q,t,v,d,r,u){var h;itemTable=FindSTSMenuTable(e,"CTXName");if(!browseris.ie&&!browseris.msEdge&&!IsSupportedMacBrowser()&&!IsSupportedNPApiBrowserOnWin()){_WriteDocEngagement("Documents_OpenDocumentUnsupportedBrowser","OneDrive_OpenDocumentUnsupportedBrowser");if(browseris.ie)event.cancelBubble=false;h=e.href;if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else Nav.navigate(h);return false}var a,b,f=true,j="",w=document.getElementById("FileDialogViewTable");if(w!=null){_WriteDocEngagement("Documents_OpenDocumentClickInFileDialog2","OneDrive_OpenDocumentClickInFileDialog2");if(browseris.ie){event.cancelBubble=false;event.returnValue=false}return true}var k=Boolean(e.getAttribute("isEdit"));b=itemTable!=null?GetAttributeFromItemTable(itemTable,"Url","ServerUrl"):"";if(b==null||b==""){if(k)b=e.editHref;if(!Boolean(b))b=e.href}else b=SzServer(e.href)+b;var c=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"",i=SzExtension(b),n=e.getAttribute("IsFluidOpenVersionOdbOfficeFlightEnabled"),m=e.getAttribute("IsFluidOpenVersionOdbOneNoteFlightEnabled"),l=e.getAttribute("IsFluidOpenVersionOdbWhiteboardFlightEnabled");if(n||m||l){var o=GetFluidVersionDropOffLink(e,i,n&&n==="1"?true:false,m&&m==="1"?true:false,l&&l==="1"?true:false);if(!IsNullOrUndefined(o)&&o!=""){window.open(o,"_blank");return false}}var p=k&&HasRights(0,4)&&!FDefaultOpenForReadOnly(i)&&(!Boolean(currentItemCheckedOutUserId)||currentItemCheckedOutUserId==ctx.CurrentUserId);if(!Boolean(c))c=e.getAttribute("App");if(phManager.ShouldTryProtocolHandler(c)){_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandlerIE10PlusStart","OneDrive_OpenDocumentWithProtocolHandlerIE10PlusStart");navigator.msLaunchUri(phManager.CreateProtocolHandlerUrl(c,b,p?ProtocolCommand.Edit:ProtocolCommand.View,null,true),function(){PHSucceed(c,true);_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandlerIE10PlusSuccess","OneDrive_OpenDocumentWithProtocolHandlerIE10PlusSuccess")},function(){PHSucceed(c,false);_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandlerIE10PlusFailure","OneDrive_OpenDocumentWithProtocolHandlerIE10PlusFailure");s()});return CancelMyEvent(false,a,g,true)}if(q==="TRUE"&&_shouldOpenInLightbox(b)){_WriteDocEngagement("Documents_OpenDocumentWithLightbox","OneDrive_OpenDocumentWithLightbox");_openInLightbox(b);return CancelMyEvent(false,a,g,true)}if(!(window.OffSwitch==null||OffSwitch.IsActive("f3f204b1-5119-476c-bd37-cded23d9218b"))&&IsOfficeURLSchemes(c)){window.location.href=phManager.CreateProtocolHandlerUrl(c,b,p?ProtocolCommand.Edit:ProtocolCommand.View,null,true);return CancelMyEvent(false,a,g,true)}return s();function s(){if(r!=null&&!(k&&(u||browseris.chrome||!(window.OffSwitch==null||OffSwitch.IsActive("855C3AE1-A63D-41F1-B713-721B65620BE7"))&&phManager.Win7IE11()))&&!(Boolean(ctx)&&Boolean(ctx.IRMEnabled))){r();return CancelMyEvent(false,a,g,true)}phManager.SetProtocolHandlerEnabled(c,null);if(Boolean(c)&&phManager.IsProtocolHandlerEnabled(c))if(c!=null&&c!=""){_WriteDocEngagement("Documents_OpenDocumentWithProtocolHandler","OneDrive_OpenDocumentWithProtocolHandler");window.location.href=phManager.CreateProtocolHandlerUrl(c,b,p?ProtocolCommand.Edit:ProtocolCommand.View,null,true);return CancelMyEvent(false,a,g,true)}try{b=decodeURI(b)}catch(s){_WriteDocDebugLog("Documents_OpenDocumentWithActiveXDecodeFailure","Documents_OpenDocumentWithActiveXDecodeFailure",SP.DebugLogger.LoggingLevel.Interesting,s)}if(currentItemProgId==null&&itemTable!=null)currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType");if(currentItemProgId!=null)j=currentItemProgId;if(FDefaultOpenForReadOnly(i)){if(d.indexOf("SharePoint.OpenDocuments")>=0)d="SharePoint.OpenDocuments.3"}else if(!FSupportCheckoutToLocal(i))d="";if(currentItemCheckedOutUserId==null&&itemTable!=null&&typeof itemTable.COUId=="string")currentItemCheckedOutUserId=itemTable.COUId;if(currentItemCheckedoutToLocal==null&&itemTable!=null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&currentItemCheckedOutUserId==ctx.CurrentUserId&&(d==""||d.indexOf("SharePoint.OpenDocuments")>=0)&&FSupportCheckoutToLocal(i)||d=="SharePoint.OpenDocuments")d="SharePoint.OpenDocuments.3";var m=2;if(d!=""&&HasRights(16,0)){if(d.indexOf(".3")>=0)m=3;a=StsOpenEnsureEx2(d);if(a==null&&m==3){d=d.replace(".3",".2");a=StsOpenEnsureEx2(d);m=2}}if(a!=null)if(m==2||itemTable==null&&currentItemCheckedOutUserId==null||ctx.isVersions==1&&(itemTable==null||typeof itemTable.isMostCur!="string"||itemTable.isMostCur=="0")){try{_WriteDocEngagement("Documents_OpenDocumentWithO11ClientStart","OneDrive_OpenDocumentWithO11ClientStart");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&(currentItemCheckedOutUserId==ctx.CurrentUserId||ctx.CurrentUserId==null))if(currentItemCheckedoutToLocal=="1"){alert(Strings.STS.L_OpenDocumentLocalError_Text);f=false}else f=typeof a.EditDocument2!="undefined"&&a.EditDocument2(window,b,j);else f=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,b,j);_WriteDocEngagement("Documents_OpenDocumentWithO11ClientSuccess","OneDrive_OpenDocumentWithO11ClientSuccess")}catch(s){_WriteDocEngagement("Documents_OpenDocumentWithO11ClientFailure","OneDrive_OpenDocumentWithO11ClientFailure");_WriteDocDebugLog("Documents_OpenDocumentWithO11ClientFailure","OneDrive_OpenDocumentWithO11ClientFailure",SP.DebugLogger.LoggingLevel.Interesting,s);f=false}if(f)window.onfocus=RefreshOnNextFocus}else{_WriteDocEngagement("Documents_OpenDocumentWithActiveXStart","OneDrive_OpenDocumentWithActiveXStart");var l=0;if(currentItemCheckedOutUserId!="")if(currentItemCheckedOutUserId!=ctx.CurrentUserId&&ctx.CurrentUserId!=null)l=1;else if(currentItemCheckedoutToLocal==null||currentItemCheckedoutToLocal!="1")l=2;else l=4;else if(!HasRights(0,4)||FDefaultOpenForReadOnly(i))l=1;else if(ctx.isForceCheckout==true)l=3;try{if(k)f=typeof a.EditDocument3!="undefined"&&a.EditDocument3(window,b,false,j);else f=typeof a.ViewDocument3!="undefined"&&a.ViewDocument3(window,b,l,j);_WriteDocEngagement("Documents_OpenDocumentWithActiveXSuccess","OneDrive_OpenDocumentWithActiveXSuccess")}catch(s){_WriteDocEngagement("Documents_OpenDocumentWithActiveXFailure","OneDrive_OpenDocumentWithActiveXFailure");_WriteDocDebugLog("Documents_OpenDocumentWithActiveXFailure","OneDrive_OpenDocumentWithActiveXFailure",SP.DebugLogger.LoggingLevel.Interesting,s);f=false}if(f){var n=typeof a.PromptedOnLastOpen!="undefined"&&a.PromptedOnLastOpen();if(n)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus()}}else if(currentItemCheckedoutToLocal=="1"){_WriteDocEngagement("Documents_OpenDocumentLocalError","OneDrive_OpenDocumentLocalError");alert(Strings.STS.L_OpenDocumentLocalError_Text)}if(a==null||!f){if(q=="TRUE"&&t=="TRUE"&&v=="TRUE"){_WriteDocEngagement("Documents_OpenDocumentWithHtmlTransformService","OneDrive_OpenDocumentWithHtmlTransformService");if(itemTable==null)return f;if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){typeof g.preventDefault!="undefined"&&g.preventDefault();typeof g.stopPropagation!="undefined"&&g.stopPropagation()}var o=new Function("return "+itemTable.getAttribute("CTXName")+".HttpRoot;");h=o()+"/_layouts/15/htmltrverify.aspx?doc="+escapeProperly(b);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(h);else GoToPage(h)}else if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null){_WriteDocEngagement("Documents_OpenDocumentDownloadFromDialog","OneDrive_OpenDocumentDownloadFromDialog");typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(e.href)}else{_WriteDocEngagement("Documents_OpenDocumentDownload","OneDrive_OpenDocumentDownload");Nav.navigate(e.href)}return false}return CancelMyEvent(f,a,g)}}function GetFluidVersionDropOffLink(b,a,n,m,l){if(!n&&!m&&!l)return"";var r="fluid",q="note",o="whiteboard";if(IsNullOrUndefined(a)||!(a===r||a===q||a===o))return"";var k=b.getAttribute("SiteUrl"),t=IsNullOrUndefined(k)?"":"spo:"+k,v=window.btoa(t),h=b.getAttribute("VroomDriveId");h=IsNullOrUndefined(h)?"":h;var i=b.getAttribute("VroomItemId");i=IsNullOrUndefined(i)?"":i;var g=b.getAttribute("VersionLabel");g=IsNullOrUndefined(g)?"":g;var p=URI_Encoding.encodeURIComponent(k),j=URI_Encoding.encodeURIComponent(v),d=URI_Encoding.encodeURIComponent(h),f=URI_Encoding.encodeURIComponent(i),c=URI_Encoding.encodeURIComponent(g),e="";if(!IsNullOrUndefined(p)&&!IsNullOrUndefined(j)&&!IsNullOrUndefined(d)&&!IsNullOrUndefined(f)&&!IsNullOrUndefined(c))if(a===r&&n){var u=b.getAttribute("CanonicalUrl"),s=URI_Encoding.encodeURIComponent(u);e="https://www.office.com/launch/fluid/content?siteUrl="+p+"&drive="+d+"&item="+f+"&v="+c+"&file="+s}else if(a===q&&m)e="https://www.onenote.com/notes/"+j+"/"+d+"/"+f+"?fileVersion="+c;else if(a===o&&l)e="https://whiteboard.office.com/me/whiteboards/p/"+j+"/"+d+"/"+f+"/"+c;return e}function CancelMyEvent(b,e,a,d){if(browseris.ie){if(event!=null){event.cancelBubble=true;event.returnValue=false}}else if(IsSupportedMacBrowser()||IsSupportedNPApiBrowserOnWin())return c(true);if(!(window.OffSwitch==null||OffSwitch.IsActive("D05C06F8-4F27-450A-B726-A1F8971EFFF3"))&&typeof a.preventDefault!=="undefined")return c(b);return b;function c(c){if(d||e!=null&&b){typeof a.preventDefault!="undefined"&&a.preventDefault();typeof a.stopPropagation!="undefined"&&a.stopPropagation()}return!(window.OffSwitch==null||OffSwitch.IsActive("3144BEEF-26ED-4696-B2F8-213B27CE8CBE"))?c:true}}function DispDocItemEx2(b,c,l,j,k,s,m,d,f){var a,v=false,o=f!=null&&f!="",e=IsClientAppInstalled(d,null,b)&&HasRights(16,0),h=!IsNullOrUndefined(b.getAttribute("isEdit"));function p(){_WriteDocEngagement("Documents_OpenDocumentInWac","OneDrive_OpenDocumentInWac");a=f;a=AddInfoPathParametersToUrl(a,d,b,DocOpen.BROWSER);a=AddSourceToUrl(a);if(a.toLowerCase().indexOf("doc.aspx")!==-1||a.toLowerCase().indexOf("wopiframe.aspx")!==-1)a=addWopiPerfMarkForTarget(a,null,"DocLibClassicUI");if(h){var e=new URI(a);e.setQueryParameter("action","edit");a=e.getString()}if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(b,a);c.cancelBubble=true;c.returnValue=false;typeof c.preventDefault!="undefined"&&c.preventDefault();typeof c.stopPropagation!="undefined"&&c.stopPropagation();return false}if(SzExtension(b.href).indexOf("pdf")!=-1){var g=b,r=h&&Boolean(g.editHref)?g.editHref:g.href;g.href=r;Nav.navigate(r);_WriteDocEngagement("Documents_OpenDocumentPDF","OneDrive_OpenDocumentPDF");return false}if(o){itemTable=FindSTSMenuTable(b,"CTXName");var i=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(i))i=b.getAttribute("App");var u=!e&&(browseris.ie10standardUp||browseris.msEdge||browseris.chrome)&&Boolean(i)&&(m=="0"||h)&&HasRights(0,32);if(!u&&(m=="1"&&!(e&&h&&HasRights(0,32))||!e))return p();else if(e)if(d==""||d.indexOf("SharePoint.OpenDocuments")>=0)return DispDocItemExWithEvent(b,c,l,j,k,s);else{!ViewDoc(b.href,d)&&editDocumentWithProgIDNoUI(b.href,currentItemProgId,d,"0",ctx.HttpRoot,"0",i,n,n,!(window.OffSwitch==null||OffSwitch.IsActive("89FAE607-622F-4DBE-9180-9C7B55A95BDB")));var q=StsOpenEnsureEx2(d),t=!(window.OffSwitch==null||OffSwitch.IsActive("7A4E1FB0-63F5-48DC-A4CB-E115ED16BBAA"))?Boolean(q):undefined;_WriteDocEngagement("Documents_OpenDocumentInClientWithWacInstalled","OneDrive_OpenDocumentInClientWithWacInstalled");return CancelMyEvent(false,q,c,t)}}function n(){a=f;a=AddInfoPathParametersToUrl(a,d,b,-1);a=AddSourceToUrl(a);if(ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null)typeof window.frameElement.navigateParent!="undefined"&&window.frameElement.navigateParent(a);else NavigateParentOrSelf(b,a)}return DispDocItemExWithEvent(b,c,l,j,k,d,o?p:null,e)}function DispDocItemExWithOutContext(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l){DispEx(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l)}function AddSourceToUrl(a){var c=a.toLowerCase().indexOf("/wopiframe.aspx?")>0,b=a.toLowerCase().indexOf("/doc.aspx?")>0;if(c||b){document.cookie="WOPISessionContext="+Nav.getSource()+";path=/;";if(c)a=a.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?");if(b)a=a.replace(/\/_layouts\/Doc.aspx\?/,"/_layouts/15/Doc.aspx?");return a}else{var d=Nav.getSource(),e=a.length+d.length;if(e>1950)return a;else{var f=a.indexOf("?")>=0?"&":"?";return a+f+"Source="+d}}}function IsInfoPathProgId(a){return a!=null&&(a.startsWith("SharePoint.OpenXMLDocuments")||a.startsWith("SharePoint.OpenXmlDocuments"))?true:false}function AddInfoPathParametersToUrl(b,d,f,c){if(IsInfoPathProgId(d)){var e=IsClientAppInstalled(d,null,f)&&HasRights(16,0),g=b.indexOf("?")>=0?"&":"?",a=b+g+"ClientInstalled="+String(e);if(c!=-1)a=a+"&DefaultItemOpen="+String(c);return a.length>1950?b:a}else return b}function _VerifyFolderHref(a,d,m,l,f,j,b,c){var h=d.button==Sys.UI.MouseButton.rightButton,k=GetRedirectedHref(a.href,f,j,b,c,false,h,a),i=b!=null&&b!=""&&c!=null&&c.length>1;if(i){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(!(b=="OneNote.Notebook"&&f=="0"))a.href=k;else{var e=GetCurrentCtx(a);if(e!=null&&typeof getHostUrl=="function"){var g=ListItemDataFromId(e,a.parentNode.id);if(g!=null)a.href=getHostUrl(e.HttpRoot)+g.FileRef}}d.cancelBubble=true;d.returnValue=true;DetachEvent("mousedown",VerifyFolderHref,a)}return false}function _VerifyHref(a,d,c,f,b){var j=+new Date,g=d.button==Sys.UI.MouseButton.rightButton,i=GetRedirectedHref(a.href,c,f,null,b,false,g,a),h=b!=null&&b.length>1,e=IsClientAppInstalled(f,null,a)&&HasRights(16,0);if(h){if(c=="1"&&!(e&&!IsNullOrUndefined(a.getAttribute("isEdit")))||!e){if(Boolean(a.getAttribute("isEdit")))a.editHref=a.href;if(c=="1")a.href=i;d.cancelBubble=true;d.returnValue=true}DetachEvent("mousedown",VerifyHref,a)}return false}function GetSourceDocId(d){var a=unescape(d);if(Boolean(a)){var b=a.indexOf("sourcedoc="),c=a.substring(b).indexOf("&"),e=c==-1?a.substring(b):a.substring(b,b+c);return escape(e)}return null}function GetRedirectedHref(c,k,e,f,b,g,j,h){var d=b!=null&&b!=""&&(!g||f!=null&&f!=""),i=IsClientAppInstalled(e,null,h)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}var a=c;if(d)if(g||k=="1"||!i){a=b;if(!IsInfoPathProgId(e)&&c.indexOf("?")<0&&j)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(69))a=c+"?Web=1";else if(GetUrlKeyValue("sourcedoc",true,b,true)!=""||GetUrlKeyValue("d",true,b,true)!="")a=b;else a=StURLSetVar2(c,"Web","1");else if(Nav.getUrlKeyValue("Web",true,c,true)=="1")a=c;else{a=AddInfoPathParametersToUrl(a,e,h,DocOpen.BROWSER);a=AddSourceToUrl(a)}a=STSPageUrlValidation(a)}return a}function _DispEx(p,a,h,e,g,k,c,o,m,b,j,l,i,f,d){try{_WriteDocEngagement("Documents_OpenDocumentClick","OneDrive_OpenDocumentClick");WriteSearchClickLog(a);if(a.shiftKey||a.ctrlKey){_WriteDocEngagement("Documents_OpenDocumentClickInNewWindowOrTab","OneDrive_OpenDocumentClickInNewWindowOrTab");return true}var n=document.getElementById("FileDialogViewTable");if(n!=null){a.cancelBubble=false;a.returnValue=false;_WriteDocEngagement("Documents_OpenDocumentClickInFileDialog","OneDrive_OpenDocumentClickInFileDialog");return true}if(typeof ctx=="undefined"||ctx==null)ctx=new ContextInfo;CtxSetCurrentUserId(l);if(i=="1")CtxSetIsForceCheckout(true);else CtxSetIsForceCheckout(false);currentItemCheckedOutUserId=j;currentItemCheckedoutToLocal=f;currentItemProgId=m;if(d!=null&&d!=""){SetCurrentPermMaskFromString(d,null);if(c=="0"&&!HasRights(0,32))c="1"}a.cancelBubble=true;if(b!=null&&b!="")b=b.substring(1);return DispDocItemEx2(p,a,h,e,g,k,c,o,b)}catch(q){_WriteDocEngagement("Documents_OpenDocumentClickFailure","OneDrive_OpenDocumentClickFailure");_WriteDocDebugLog("Documents_OpenDocumentClickFailure","OneDrive_OpenDocumentClickFailure",SP.DebugLogger.LoggingLevel.Interesting,q);throw q;}}function IsClientAppInstalled(c,e,b){if(e!=null&&phManager.IsProtocolHandlerEnabled(e,true))return true;if(!(window.OffSwitch==null||OffSwitch.IsActive("860BFCE4-DE4A-476E-8FCE-8F7A5A0E17E4"))&&Boolean(ctx)&&Boolean(ctx.IRMEnabled))return true;if(b!=null){itemTable=FindSTSMenuTable(b,"CTXName");var a=itemTable!=null?GetAttributeFromItemTable(itemTable,"App",null):"";if(!Boolean(a))a=b.getAttribute("App");if(Boolean(a)&&phManager.IsProtocolHandlerEnabled(a,true))return true}var d=null;if(c!="")d=StsOpenEnsureEx2(c);return d!=null}function ViewDoc(d,c){var a=StsOpenEnsureEx2(c),b=false;if(a!=null)try{b=typeof a.ViewDocument2!="undefined"&&a.ViewDocument2(window,d)}catch(e){b=false}return b}function _PortalPinToMyPage3(a,c,b){a.action=c+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";if(typeof a.ReturnUrl!="undefined")a.ReturnUrl.value=window.location.href;if(typeof a.ListViewUrl!="undefined"&&typeof a.ListViewUrl.value!="undefined")a.ListViewUrl.value=MakeMtgInstanceUrl(a.ListViewUrl.value,b);a.submit()}function _PortalPinToMyPage(a,g,e,f,b,d,h,c){a.action=g+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";SetFieldValue(a,"ReturnUrl",window.location.href);SetFieldValue(a,"ListViewUrl",MakeMtgInstanceUrl(d,e));SetFieldValue(a,"ListTitle",f);SetFieldValue(a,"ListDescription",b);SetFieldValue(a,"BaseType",h);SetFieldValue(a,"ServerTemplate",c);a.submit()}function SetFieldValue(c,b,d){var a=c[b];if(a==null){a=document.createElement("INPUT");a.setAttribute("type","hidden");a.setAttribute("name",b);c.appendChild(a)}a.value=d}function _MoveToViewDate(b,a,c){var d=function(){var d;if(Boolean(c))d=SP.UI.ApplicationPages.CalendarInstanceRepository.lookupInstance(c);else d=SP.UI.ApplicationPages.CalendarInstanceRepository.firstInstance();if(d!=null)if(a!=null)typeof d.moveToViewType!="undefined"&&d.moveToViewType(a);else typeof d.moveToDate!="undefined"&&d.moveToDate(b)};if(FV4UI()&&typeof _fV4Calendar!="undefined"&&_fV4Calendar)AjaxCalendarCall(d);else MoveToViewDatePostBack(b,a)}function MoveToViewDatePostBack(c,b){var a=window.location.href;if(c!=null)a=StURLSetVar2(a,"CalendarDate",escapeProperly(c));if(b!=null)a=StURLSetVar2(a,"CalendarPeriod",b);_SubmitFormPost(a,true)}function AjaxCalendarCall(b){var a;try{a=typeof SP.UI.ApplicationPages.CalendarInstanceRepository}catch(c){a="undefined"}EnsureScript("SP.js",a,b)}function _MoveToDate(a,b){_MoveToViewDate(a,null,b)}function MoveToToday(){_MoveToViewDate("",null)}function MoveView(a){_MoveToViewDate(null,a)}function _ClickDay(a){_MoveToDate(a)}function GetIframe(){return null}function _GetMonthView(c){var b=window.location.href,a=document.getElementById("ExpandedWeeksId");if(a!=null){a.value=c;_SubmitFormPost(b,true)}}function NewItemDT(a,c,b){if(a==null)return;if(b!=null)a=StURLSetVar2(a,"CalendarTime",b);if(c!=null)a=StURLSetVar2(a,"CalendarDate",c);_NewItem(a)}function ClickTime(b,a){NewItemDT(b,null,a)}function NewItemDay(b,a){NewItemDT(b,a,null)}function ScrollToAnchorInInnerScrollPane(k,h,j){try{var l=document.getElementById(k),b=document.getElementById(l[h].value);if(typeof b=="undefined"||b==null)throw"";var d=b.parentNode.previousSibling;if(typeof d!="undefined"&&d!=null){var e=d.previousSibling;if(typeof e!="undefined"&&e!=null)b=e;else b=d}else throw"";}catch(o){for(var f=null,i=document.anchors.length,g=0;g<i;g++){f=document.anchors[g];var m=f.href;if(m.search(new RegExp(j))!=-1){b=f;break}}}if(typeof b!="undefined"&&b!=null){var c=b.parentNode;while(c!=null&&c.tagName!="TABLE")c=c.parentNode;if(typeof c!="undefined"&&c!=null){var a=c.parentNode;while(a!=null&&(a.tagName!="DIV"||a.style.overflow!="auto"))a=a.parentNode;if(typeof a!="undefined"&&a!=null){var n=b.offsetLeft;a.scrollLeft=n;a.scrollTop=c.offsetTop-a.clientHeight+c.offsetHeight}}}}function FilterChoice(d,h,E,u){var a,g=0,f=false,l="",w=d.id,v=d.name,j="",r="",s=h.getAttribute("choices"),D=s!=null?s:"",c=D.split("|"),z=0,A=h.offsetHeight,q=h.getAttribute("optHid"),C=q!=null?q:"",x=c.length-1,m=-1,p=false,o="";if(d!=null&&d.selectedIndex>=0){f=true;o=d.options[d.selectedIndex].innerText}for(a=0;a<c.length;a=a+2){var b=c[a];while(a<x-1&&c[a+1].length==0){b=b+"|";a++;if(a<x-1)b=b+c[a+1];a++}var k=c[a+1],i=b.toLocaleLowerCase(),B=E.toLocaleLowerCase();if(u.length!=0)f=true;if(i.indexOf(B)==0){var n=u.toLocaleLowerCase();if(n.length!=0&&i.indexOf(n)==0&&j.length==0)f=false;if(i.length>20)p=true;if(!f||i==o){l+='<option selected value="'+k+'">'+STSHtmlEncode(b)+"</option>";f=true;j=b;r=k;m=a}else l+='<option value="'+k+'">'+STSHtmlEncode(b)+"</option>";g++}}var t=' ondblclick="HandleOptDblClick()" onkeydown="HandleOptKeyDown()"',e="";if(p)e='<select tabIndex="-1" ctrl="'+h.id+'" name="'+v+'" id = "'+w+'"'+t;else e='<select class="ms-lookuptypeindropdown" tabIndex="-1" ctrl="'+h.id+'" name="'+v+'" id = "'+w+'"'+t;if(g==0)e+=' style="display:none;position:absolute;z-index:2;left:'+String(z)+"px;top:"+String(A)+'px" onfocusout="OptLoseFocus(this)"></select>';else e+=' style="position:absolute;z-index:2;left:'+String(z)+"px;top:"+String(A)+'px" size="'+String(g<=8?g:8)+'"'+(g==1?'multiple="true"':"")+' onfocusout="OptLoseFocus(this)">'+l+"</select>";d.outerHTML=e;var y=document.getElementById(C);if(m!=0||c[1]!="0")y.value=r;else y.value="0";return m!=0||c[1]!="0"?j:""}function _OptLoseFocus(a){var b=a.getAttribute("ctrl"),c=b!=null?b:"",d=document.getElementById(c);a.selectedIndex>=0&&_SetCtrlFromOpt(d,a);a.style.display="none"}function SetCtrlMatch(b,a){var c=b.getAttribute("optHid"),e=c!=null?c:"",d=document.getElementById(e);d.value=a.options[a.selectedIndex].value;if(d.value!="0")b.match=a.options[a.selectedIndex].innerText;else b.match=""}function _SetCtrlFromOpt(a,b){var c=a.getAttribute("optHid"),d=c!=null?c:"",e=document.getElementById(d);e.value=b.options[b.selectedIndex].value;a.value=b.options[b.selectedIndex].innerText;if(b.options[b.selectedIndex].value==0)a.match="";else a.match=a.value;typeof a.onValueSetFromPicker=="function"&&a.onValueSetFromPicker()}function HandleOptDblClick(){var a=event.srcElement,b=a.getAttribute("ctrl"),d=b!=null?b:"",c=document.getElementById(d);_SetCtrlFromOpt(c,a);SetCtrlMatch(c,a);a.style.display="none"}function HandleOptKeyDown(){var a=event.srcElement,b=a.getAttribute("ctrl"),c=b!=null?b:"",d=document.getElementById(c),e=event.keyCode;switch(e){case 13:case 9:_SetCtrlFromOpt(d,a);event.returnValue=false;a.style.display="none";return}return}function CommitInlineEditChange(tr,cancel){if(tr.cells.length>0){var c=tr.cells[0];if(c.width=="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href);else if(tr.cells.length>1){c=tr.cells[1];if(c.width=="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href)}}}function InlineEditNextTR(tr,nextTr,element,down){var inlineEditString;if(nextTr!=null){_inlineEditString=tr.getAttribute("automode")+"#";var index=null;while(element!=null&&element.nodeType==1&&element.getAttribute("automode")==null){var siblingCount=0,sibling=element.previousSibling;while(sibling!=null){siblingCount++;sibling=sibling.previousSibling}if(index==null)index=String(siblingCount);else index=String(siblingCount)+","+index;element=element.parentNode}_inlineEditString+=index;var tab=nextTr;while(tab!=null&&tab.tagName!="TABLE")tab=tab.parentNode;if(tab!=null&&nextTr!=null&&nextTr.getAttribute("iid")!=null){inlineEditString=tab.getAttribute("inlineedit");if(inlineEditString!=null){inlineEditString=inlineEditString.replace("{@ID}","{"+IdFromRow(nextTr)+"}");inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}else if(down==true&&nextTr!=null)if(nextTr.cells.length>0){inlineEditString=null;var c=nextTr.cells[0];if(c.width=="1%")inlineEditString=c.firstChild.href;else if(nextTr.cells.length>1){c=nextTr.cells[1];if(c.width=="1%")inlineEditString=c.firstChild.href}if(inlineEditString!=null){inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}}}function HandleInlineEditKeyDown(c){var d=event.srcElement;if(d.tagName!="INPUT")return;var e=event.keyCode,a=c.parentNode,b;switch(e){case 27:CommitInlineEditChange(a,true);break;case 38:b=a.previousSibling;InlineEditNextTR(a,b,d);break;case 13:case 40:b=a.nextSibling;InlineEditNextTR(a,b,d,true)}if(window.event!=null)window.event.cancelBubble=true;else c!=null&&typeof c.stopPropagation!="undefined"&&c.stopPropagation()}function EnsureSelectElement(b,c){var a=document.getElementById(c);if(a==null){a=document.createElement("SELECT");b.parentNode.appendChild(a);a.outerHTML='<select id="'+c+'" ctrl="'+b.id+'" class="ms-lookuptypeindropdown" name="'+c+'" style="display:none" onfocusout="OptLoseFocus(this)"></select>';FilterChoice(a,b,b.value,"")}else{a.parentNode.removeChild(a);b.parentNode.appendChild(a)}return document.getElementById(c)}function HandleKey(){var j=event.keyCode,b=event.srcElement,c=b.value,g=b.getAttribute("opt"),i=g!=null?g:"",a=EnsureSelectElement(b,i),d=false,f,e;switch(j){case 8:if(c.length>0)c=c.substr(0,c.length-1);d=true;break;case 16:case 17:case 18:return;case 9:case 16:case 17:case 18:return;case 13:f=b.value.toLocaleLowerCase();var h=typeof b.match=="string"?b.match:"";e=h.toLocaleLowerCase();if(e.indexOf(f)!=0)b.match=FilterChoice(a,b,b.value,"");if(a.style.display!="none"){b.value=b.match;a.style.display="none";event.returnValue=false}return;case 27:a.style.display="none";event.returnValue=false;return;case 38:if(a.style.display!="none"){if(a.selectedIndex>0)a.selectedIndex=a.selectedIndex-1;else a.selectedIndex=a.options.length-1;SetCtrlMatch(b,a);event.returnValue=false}return;case 40:if(a.style.display!="none"&&a.selectedIndex<a.options.length-1){a.selectedIndex=a.selectedIndex+1;SetCtrlMatch(b,a);event.returnValue=false;return}d=true}if(d)b.match=FilterChoice(a,b,c,"")}function ShowDropdown(c){var a=document.getElementById(c),f=a.value,b=a.getAttribute("opt"),d=b!=null?b:"",e=EnsureSelectElement(a,d);a.match=FilterChoice(e,a,"",a.value);a.focus()}function HandleChar(){var a=event.srcElement,b=a.value,c=a.getAttribute("opt"),e=c!=null?c:"",f=document.getElementById(e),d=event.keyCode;if(d==13)return;b=b+String.fromCharCode(d).toLocaleLowerCase();a.match=FilterChoice(f,a,b,"")}function HandleLoseFocus(){var d=event.srcElement,b=d.getAttribute("opt"),c=b!=null?b:"",a=document.getElementById(c);a!=null&&a.style.display!="none"&&typeof document.activeElement!="undefined"&&document.activeElement!=a&&_OptLoseFocus(a)}function HandleChange(){var a=event.srcElement,e=a.value,b=a.getAttribute("opt"),c=b!=null?b:"",d=document.getElementById(c);a.match=FilterChoice(d,a,e,"")}function IsSafeHref(a){return a.match(new RegExp("^http://","i"))!=null||a.match(new RegExp("^https://","i"))!=null||a.match(new RegExp("^ftp://","i"))!=null||a.match(new RegExp("^file://","i"))!=null||a.match(new RegExp("^mailto:","i"))!=null||a.match(new RegExp("^news:","i"))!=null||a.match(new RegExp("^pnm://","i"))!=null||a.match(new RegExp("^mms://","i"))!=null||a.match(new RegExp("^/","i"))!=null||a.match(new RegExp("^#","i"))!=null||a.match(new RegExp("^\\\\\\\\","i"))!=null}function _SuiteOnClick(a){if(a!=null)if(IsSafeHref(a))Nav.Navigate(a);else ExecuteOnClick(a,null)}function Discuss(a){if(browseris.ie5up&&browseris.win32)window.parent.location.href=a;else alert(Strings.STS.L_IE5upRequired_Text)}var g_AdditionalNavigateHierarchyQString;function GetAdditionalNavigateHierarchyQString(){return g_AdditionalNavigateHierarchyQString}function SetAdditionalNavigateHierarchyQString(a){g_AdditionalNavigateHierarchyQString=a}function ProcessDefaultNavigateHierarchy(g,e,d,b,c,j,i,h,f){if(typeof _spCustomNavigateHierarchy!="undefined")_spCustomNavigateHierarchy(g,e,d,b,c,j);else if(c==false)top.location.href=b;else{var a=document.createElement("INPUT");a.type="hidden";a.name="_spTreeNodeClicked";a.value=d;i.appendChild(a);var k="?RootFolder="+escapeProperly(b)+h+"&"+g_AdditionalNavigateHierarchyQString;_SubmitFormPost(f+k);return false}return undefined}var httpFolderTarget,httpFolderSource,httpFolderDiv;function NavigateHttpFolderCore(){var i=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(122)&&Boolean(browseris.ie11);if(i){EnsureScriptFunc("SP.js","SP.Utilities.Utility",function(){var b="menubar=no,toolbar=no,location=no,resizable=no,scrollbars=no,status=no,height=1,width=1",a=new URI(httpFolderSource);a.setPath(SP.Utilities.Utility.getLayoutsPageUrl("openinexplorer.aspx"));window.open(a.getString(),"",b)});return true}_WriteDocEngagement("StartOpenInWinExplorer","OneDrive_StartOpenInWinExplorer");var a;if(httpFolderDiv==null){httpFolderDiv=document.createElement("DIV");document.body.appendChild(httpFolderDiv);httpFolderDiv.onreadystatechange=function(){NavigateHttpFolderCore()};typeof httpFolderDiv.addBehavior!="undefined"&&httpFolderDiv.addBehavior("#default#httpFolder")}var c=false;if(typeof httpFolderDiv.readyState=="string"&&httpFolderDiv.readyState=="complete"){httpFolderDiv.onreadystatechange=null;try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){var e=typeof a.document!="undefined"?a.document:null;if(e!=null){var g=typeof e.body!="undefined"?e.body:null;if(g!=null&&typeof g.innerText=="string")g.innerText=Strings.STS.L_WebFoldersRequired_Text}}}catch(k){}var h="",b="";try{if(typeof httpFolderDiv.navigateFrame!="undefined")h=httpFolderDiv.navigateFrame(httpFolderSource,httpFolderTarget);if(h=="OK")c=true}catch(k){b=k.message}if(!c&&0==httpFolderSource.search(new RegExp("http://[a-zA-Z0-9-.]+(:80)?/"))){var j=httpFolderSource.replace(/http:\/\/([a-zA-Z0-9\-\.]+)(:80)?[\/]/,"//$1/").replace(/[\/]/g,"\\");try{a=typeof document.frames!="undefined"&&typeof document.frames.item!="undefined"?document.frames.item(httpFolderTarget):null;if(a!=null){a.onload=null;var d=typeof a.document!="undefined"?a.document:null;if(d!=null){var f=typeof d.location!="undefined"?d.location:null;if(f!=null&&typeof f.href=="string"){f.href=j;c=true}}}}catch(k){b=k.message}}if(!c){if(browseris.ie){_WriteDocEngagement("FailureOpenInWinExplorer_IE","OneDrive_FailureOpenInWinExplorer_IE");b="Fail to launch Explorer view in IE, show users sync client link. "+b}else{_WriteDocEngagement("FailureOpenInWinExplorer_OtherBrowser","OneDrive_FailureOpenInWinExplorer_OtherBrowser");b="Fail to launch Explorer view in non-IE browser, show users sync client link. "+b}SP.DebugLogger.Write("FailureLaunchExplorerView",SP.DebugLogger.LoggingLevel.Interesting,b);ShowExplorerViewError()}else _WriteDocEngagement("SuccessOpenInWinExplorer","OneDrive_SuccessOpenInWinExplorer")}return c}function ShowExplorerViewError(){ctx=GetCurrentCtx();ctx!=null&&HandleQCBSyncButtonPress(null,ctx,true)}function logAndClose(a){var b=window.top.g_childDialog;if(Boolean(b)){SP.QoS.WriteUserEngagement(a==SP.UI.DialogResult.cancel?"ExplorerView_NoCookie":"ExplorerView_PersistCookie");b.close(a)}}function AddStatusRevertToClassicHomepage(){var d='<a href="'+_spPageContextInfo.webAbsoluteUrl+'" aria-label="'+Strings.STS.L_BackToModernAriaLabel+'">',c=String.format(Strings.STS.L_MessageClassicHomepageBackToModern,d,"</a>"),b="<a href='#' onclick='RevertToClassic()' aria-label='"+Strings.STS.L_ClassicHomepageRevertAriaLabel+"'>",a=String.format(Strings.STS.L_MessageClassicHomepageRevert,b,"</a>");g_RevertToClassicMessageId=addStatus(c,a,true);setStatusPriColor(g_RevertToClassicMessageId,"gray")}function RevertToClassic(){var f=confirm(Strings.STS.L_ConfirmRevertToClassicHomepage),a;if(f){SP.QoS.WriteStart("RevertToClassicHomepage_Start");a=SP.ClientContext.get_current();var b=a.get_web();a.load(b);a.executeQueryAsync(function(){var j=b.get_welcomePage(),h=b.get_classicWelcomePage();if(!h)c(null,null,"ClassicWelcomePage property not found");else{var i=b.get_serverRelativeUrl(),f=i+"/"+j,g=b.getFileByServerRelativeUrl(f);a.load(g);a.executeQueryAsync(function(){var j=f.split("/"),m=g.get_name(),l=Strings.STS.L_ModernizedHomepagePrefix+"-"+m;j[j.length-1]=l;var k=j.join("/");g.moveTo(k);a.executeQueryAsync(function(){var c=b.getFileByServerRelativeUrl(h);a.load(c);a.executeQueryAsync(function(){c.moveTo(f);a.executeQueryAsync(function(){b.set_classicWelcomePage("");b.update();a.executeQueryAsync(function(){SP.QoS.WriteSuccess("RevertToClassicHomepage_Success");a.executeQueryAsync(function(){window.location.href=i+"/"+b.get_welcomePage()},e(c,h,g,f))},e(c,h,g,f))},d(g,f,true))},d(g,f,true))},c)},c)}},c)}function e(f,b,g,e){return function(h,i){f.moveTo(b);a.executeQueryAsync(d(g,e,false));c(h,i,null)}}function d(e,b,d){return function(f,g){d&&c(f,g,null);e.moveTo(b);a.executeQueryAsync()}}function c(g,a,e){removeStatus(g_RevertToClassicMessageId);var d='<a href="https://go.microsoft.com/fwlink/?linkid=2103711" aria-label="'+Strings.STS.L_RevertToClassicHomepageInstructionsAria+'">',c=String.format(Strings.STS.L_ErrorRevertToClassicHomepageInstructions,d,"</a>"),f=addStatus(Strings.STS.L_ErrorRevertToClassicHomepage,c,true);setStatusPriColor(f,"red");var b="RevertToClassicHomepage_Fail";if(a)SP.QoS.WriteFailure(b,{message:a.get_message(),stackTrace:a.get_stackTrace()});else SP.QoS.WriteFailure(b,{message:e})}}function NavigateHttpFolder(a,h,c){if(!Boolean(c))c=(Boolean(_spPageContextInfo)?_spPageContextInfo.webAbsoluteUrl:"")+"/_layouts/15/webdav.aspx";if("/"==a.charAt(0))a=window.location.protocol+"//"+window.location.host+a;httpFolderTarget=h;httpFolderSource=a;var b=new IframeWorker("explorerViewFrame"),f=b.getFrame();if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(167)&&f==null&&_spPageContextInfo!=null)d();else NavigateHttpFolderCore();function e(){var a;if(Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.currentUICultureName))a=_spPageContextInfo.currentUICultureName;else a="en-us";var e='<a href="'+STSHtmlEncode("http://www.microsoft.com/online/legal/v2/?docid=18&langid="+a)+'">'+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookiePrivacyStatementLink)+"</a>",d="<div>"+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookieConfirm_Text)+"</div><div class='ms-core-form-bottomLeftBox'>"+e+"</div><div class='ms-core-form-bottomButtonBox'><button id='js-PrivateComputerBtnDismissDlg' class = 'ms-button-emphasize' onclick='logAndClose(1)'>"+STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookiePrivateComputer)+"</button><button id='js-CancelBtnDismissDlg' onclick='logAndClose(0)'>"+STSHtmlEncode(Strings.STS.L_DocMoveDialogCancel)+"</button></div>",c=document.createElement("DIV");c.innerHTML=d;var f={html:c,title:STSHtmlEncode(Strings.STS.L_ExplorerViewPersistCookieDialogTitle),dialogReturnValueCallback:function(a){Boolean(a)&&NavigateHttpFolderCore()}};SP.SOD.execute("sp.ui.dialog.js","SP.UI.ModalDialog.showModalDialog",f);var b=document.getElementById("js-CancelBtnDismissDlg");b!=null&&b.focus()}function d(){RegisterSod("SPO.Identity.js","/_layouts/15/SPO.Identity.js");EnsureScript("SPO.Identity.js",typeof SPO,function(){g()})}function g(){if(typeof SPO.Identity.SPOIdentityHelper.doesSessionSupportIssuingWebDavCookies=="function")EnsureScriptFunc("SP.js","SP.ClientContext",function(){var a=SP.ClientContext.get_current(),d=SPO.Identity.SPOIdentityHelper.doesSessionSupportIssuingWebDavCookies(a);a.executeQueryAsync(function(){if(d.get_value()){b.createAndAppendFrame(c);b.checkFrameLoaded(e,ShowExplorerViewError);return}else NavigateHttpFolderCore()},function(){NavigateHttpFolderCore()})});else NavigateHttpFolderCore()}}function GetIFrameDoc(b){var a=null;if(typeof b.contentDocument!="undefined")a=b.contentDocument;if(a==null&&null!=b.contentWindow)a=b.contentWindow.document;if(a==null)a=b.ownerDocument;return a}var IframeWorker;function NavigateHttpFolderIfSupported(c,a){if(a=="_blank")if(SupportsNavigateHttpFolder()){var b=(Boolean(_spPageContextInfo)?_spPageContextInfo.webAbsoluteUrl:"")+"/_layouts/15/webdav.aspx";NavigateHttpFolder(c,a,b)}else alert(Strings.STS.L_WebFoldersError_Text);else alert(Strings.STS.L_NoExplorerView_Text)}function AutoIndexForRelationshipsConfirmation(){var a=Strings.STS.L_Lookup_AutoIndexForRelationships_Confirm_Text;return confirm(a)}function SetHomePage2(c){if(!window.confirm(SP.Res.confirmWelcomePage))return;var d=new SP.ClientContext(undefined),b=d.get_web().get_rootFolder(),a="";if(c.length>0){a=_spPageContextInfo.serverRequestPath;a=unescapeProperly(a);a=a.substr(c.length);if(a.indexOf("/")==0)a=a.substr(1)}b.set_welcomePage(a);b.update();var e=STSHtmlEncode(SP.Res.sending),f=addNotification(e,true);d.executeQueryAsync(function(){removeNotification(f);addNotification(STSHtmlEncode(SP.Res.pageIsSiteHomePage),false)},null)}function SetHomePage(b){var a=function(){SetHomePage2(b)};if(typeof SP!="undefined")EnsureScript("SP.js",typeof SP.ClientContext,a);else EnsureScript("SP.js",typeof SP,a)}function TryCopyStringToClipboard(b){if(typeof window.clipboardData!="undefined"&&typeof window.clipboardData.setData!="undefined")window.clipboardData.setData("Text",b);else if(typeof netscape!="undefined"&&typeof Components!="undefined"){netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var d=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(d==null)return false;d.data=b;var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(a==null||typeof a.addDataFlavor=="undefined"||typeof a.setTransferData=="undefined")return false;a.addDataFlavor("text/unicode");a.setTransferData("text/unicode",d,b.length*2);var e=Components.interfaces.nsIClipboard,c=Components.classes["@mozilla.org/widget/clipboard;1"].getService(e);if(c==null||typeof c.setData=="undefined")return false;c.setData(a,null,e.kGlobalClipboard)}return true}function CopyStringToClipboard(b){var a=false;try{a=TryCopyStringToClipboard(b)}catch(c){a=false}!a&&alert(SP.Res.clipboardNoAccess)}function CopyPageAddressToClipboard(){CopyStringToClipboard(window.location.href)}function showViewSelector(b,a,d){if(b==null)b=window.event;CancelEvent(b);a=EnsureValidPositioningElement(b,a);if(a!=null&&a.className=="ms-csrlistview-viewselectormenu")a=a.parentNode;var e=function(){SP.Application.UI.ViewSelectorMenuBuilder.showMenu(a,d)},c;try{c=typeof SP.Application.UI.ViewSelectorMenuBuilder.showMenu}catch(f){c="undefined"}EnsureScript("SP.js",c,e)}function EnsureValidPositioningElement(d,c){if(c!=null)return c;var b=GetEventSrcElement(d),a=b;while(a!=null&&a.tagName!="BODY"){if(a.tagName=="TD"&&(a.className=="ms-viewselector"||a.className=="ms-viewselectorhover"))return a;a=a.parentNode}return b}function EnsureCheckoutAndChangeLayoutModeToEdit(e,d,g){var a,c=function(){EnsureScriptParams("browserScript","browserScript.MSOLayout_ChangeLayoutMode",g)},f=function(){var g=a!=null?a.get_item("CheckoutUser"):null;if(!g){if(confirm(Strings.STS.L_ConfirmCheckout_Text)){var b=new SP.ClientContext(undefined),f=b.get_web().get_lists().getById(new SP.Guid(e));a=f.getItemById(d);a.get_file().checkOut();b.executeQueryAsync(c,null)}}else c()},h=function(){var b=new SP.ClientContext(undefined),c=b.get_web().get_lists().getById(new SP.Guid(e));a=c.getItemById(d);b.load(a,"CheckoutUser");b.executeQueryAsync(f,null)},b;try{b=typeof SP.ClientContext}catch(i){b="undefined"}EnsureScript("SP.js",b,h)}function _ChangeLayoutMode(a,b){EnsureScriptParams("browserScript","browserScript.MSOLayout_ChangeLayoutMode",a,b)}function OpenWebPartMenuFromLink(a,b,c,d){OpenWebPartMenu(a,b,c,d,false)}function OpenWebPartMenu(a,b,c,d,e){EnsureScriptParams("browserScript","browserScript.MSOWebPartPage_OpenMenu",a,b,c,d,e);return true}function UpdateWebPartMenuFocus(a,d,c){if(a!=null)a.className=d;var b=null;if(a!=null&&a.childNodes!=null){b=a.childNodes[0];if(b!=null&&b.tagName=="SPAN")b.className=c}}function _WebPartMenuKeyboardClick(c,a,b,d){EnsureScriptParams("browserScript","browserScript.MSOMenu_KeyboardClick",c,a,b,d)}function _ShowToolPane2Wrapper(a,b,c){EnsureScriptParams("browserScript","browserScript.MSOTlPn_ShowToolPane2Wrapper",a,b,c)}function ChangeWebPartPageView(a){EnsureScriptParams("browserScript","browserScript.MSOLayout_ToggleView",a)}function _SetupFixedWidthWebParts(){EnsureScriptParams("browserScript","browserScript.MSOWebPartPage_SetupFixedWidthWebParts")}function EnsureSelectionHandlerOnFocusDeferred(d,c,b){var a=c;while(a.tagName!="TABLE")a=a.parentNode;EnsureSelectionHandlerDeferred(d,a,b)}function EnsureSelectionHandlerDeferred(n,g,k){var d=window["ctx"+String(k)];if(!FV4UI()||d==null){g.onmouseover=null;return}if(d.BaseViewID=="MapView"&&(IsStrNullOrEmpty(g.className)||g.className.indexOf("ms-mapviewtable")==-1))return;ctxInitItemState(d);var e=g.querySelector(".ms-selectall-span");if(e!=null){$addHandler(e,"keydown",function(a){if(a.keyCode==Sys.UI.Key.space||a.keyCode==Sys.UI.Key.enter){ClkElmt(e);e.focus();a.preventDefault()}});$addHandler(e,"mousedown",function(){e.style.outline="none"});$addHandler(e,"mouseup",function(){e.style.outline="";e.firstChild.focus()})}for(var l=g.rows,h=0;h<l.length;h++){var a=l[h];if(HasCssClass(a,"ms-viewheadertr")){var b=a.cells[0];if(b!=null){var f=b.getElementsByTagName("INPUT")[0];if(f!=null)f.className="s4-selectAllCbx";else f=b.querySelector(".ms-selectall-span");if(f!=null){d.SelectAllCbx=f;if(typeof f.onfocus!="undefined")d.TableCbxFocusHandler=f.onfocus;f.onfocus=null}}}var m=a.getAttribute("iid");if(m!=null){var j=false;if(ItemIsCurrentlySelected(d,m,a)){j=true;d.CurrentSelectedItems++}if(ItemIsCurrentlyVisible(a)){d.TotalListItems++;d.LastSelectableRowIdx=h}if(a.cells.length>0){b=a.cells[0];var c=b.querySelector(".s4-itm-cbx");if(c!=null){if(!j)c.checked=false;if(typeof c._setup=="undefined"||!Boolean(c._setup)){c._setup=true;var i=TooltipOfRow(a);if(i!=null)if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(169))c.setAttribute("aria-label",i);else c.title=i;c.onblur=HideItemCbx;c.onfocus=DisplayItemCbx;c.onclick=ToggleItemRowSelection;b.onclick=ToggleItemRowSelection;if(c.nodeName=="DIV"){$addHandler(b,"keydown",function(b,a){return function(c){if(c.keyCode==Sys.UI.Key.space||c.keyCode==Sys.UI.Key.enter){ToggleItemRowSelection(c,b);a.focus()}}}(a,b));$addHandler(b,"mousedown",function(a){return function(){a.style.outline="none"}}(b));$addHandler(b,"mouseup",function(a){return function(){a.style.outline=""}}(b))}}if(a.getAttribute("automode")==null)a.onclick=SingleItemSelect}UpdateAutoMode(a);AddSpaceToEmptyTDs(a);AddBorderToLastCell(a)}}}d.TableMouseoverHandler=g.onmouseover;g.onmouseover=null;AddKeyDownEventHandler(g,k)}function AddKeyDownEventHandler(a,c){if(a.nodeName.toUpperCase()!="TABLE")return;var b=window["ctx"+String(c)];if(IsStrNullOrEmpty(a.className)||b.BaseViewID=="MapView"&&a.className.indexOf("ms-mapviewtable")==-1||b.BaseViewID!="MapView"&&a.className.indexOf("ms-listviewtable")==-1)return;if(a.getAttribute("handleDeleteInit")==null){a.setAttribute("handleDeleteInit","true");$addHandler(a,"keydown",function(a){OnListViewKeyDown(a,c)})}}function OnListViewKeyDown(a,b){var d=GetListContextFromContextNumber(String(b));if(d==null)return;if(d.inGridMode&&PageMinimized()){if(a.ctrlKey&&!a.altKey&&!a.shiftKey&&a.keyCode==="E".charCodeAt(0)){parent.postMessage("ClosingGrid","*");if(window.event!=null)window.event.cancelBubble=true;else a!=null&&a.stopPropagation()}return}var e=a.keyCode,c=a.shiftKey||a.ctrlKey;if(IsCallOutOn())return;switch(e){case Sys.UI.Key.del:HandleItemDelete(a,b);break;case Sys.UI.Key.up:SelectNextRow(b,-1,c,a);break;case Sys.UI.Key.down:SelectNextRow(b,1,c,a);break;case Sys.UI.Key.enter:if(IsEventTargetAnchor(a))return;if(a.target!=null&&!IsStrNullOrEmpty(a.target.className)&&a.target.className.indexOf("ms-lstItmLinkAnchor")>=0)OpenCallOutOrECB(b,a);else ListItem_Open(b,a)}}function OpenCallOutOrECB(e,b){var c=GetListContextFromContextNumber(String(e));if(c==null)return true;var a=b.target,d=DoesListUseCallout(c),f=GetAncestor(a,"TR"),g=IdFromRow(f);if(IsStrNullOrEmpty(g))return true;if(d)ShowCalloutMenuForTr(a,b,true);else ShowECBMenuForTr(a.parentNode,b);return true}function ListItem_Open(c,d){var a=GetListContextFromContextNumber(String(c));if(a==null)return false;var b=GetLastSelectedRow(a);if(b==null)return false;if(a.ListSchema.IsDocLib)OpenDocItem(d,a,b);else OpenListItem(b,c);return true}function OpenDocItem(i,g,b){var a=GetListItemDataFromTrInternal(g,b),c=b,h=GetEcbTdFromRow(b),f=GetEcbDivFromEcbTd(h);if(f!=null)c=f.querySelector("a.ms-draggable");if(c==null)c=b;var e=IsNullOrUndefined(a)?null:b.querySelector('A[IsFolder="TRUE"]');if(!IsNullOrUndefined(e))GoToLink(e);else{var d=g.ListSchema;DispEx(c,i,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],d.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",d.Userid,d.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}}function OpenListItem(b,c){var a=b.querySelector('a[class*="ms-listlink"]');if(a==null)return;EditLink2(a,c)}function GetListItemDataFromTr(a){if(a==null)return null;var b=GetListContextFromTr(a);return b==null?null:GetListItemDataFromTrInternal(b,a)}function GetListItemDataFromTrInternal(b,a){if(b==null||a==null)return null;var c=IdFromRow(a);return ListItemDataFromId(b,c)}function GetListContextFromTr(a){if(a==null)return null;var b=a.getAttribute("iid");if(IsStrNullOrEmpty(b))return null;var c=b.split(",");return c.length<=2?null:GetListContextFromContextNumber(c[0])}function GetListContextFromContextNumber(a){return window["ctx"+a]}function ListItemDataFromId(c,d){if(c==null||d==null||c.ListData==null)return null;var a=c.ListData.Row;if(a==null)return null;for(var e=a.length,b=0;b<e;b++)if(a[b].ID===d)return a[b];return null}function SelectNextRow(g,h,f,e){var c=GetListContextFromContextNumber(String(g)),b=GetLastSelectedRow(c),a=null;if(b!=null){a=GetNextRow(b,h);if(a!=null){var d;d=SingleItemSelectByElement(a,f);return e==null?d:CancelEvent(e)}}else MakeDefaultSelectionForListView(c);return true}function GetLastSelectedRow(c){var e=c.dictSel,b="",a=null;if(c!=null)b=c.LastSelectedItemIID;if(b!=null&&b.length>0){var d='tr[iid="'+b+'"]';a=document.querySelector(d);if(a!=null&&a.getAttribute("automode")!=null)a=null}return a}function GetIndexFromIID(a,c){if(c==null)return-1;var e=c.split(",")[1],d=0;if(a!=null&&a.ListData!=null&&a.ListData.Row!=null){var f=a.ListData.Row;d=f.length;for(var b=0;b<d;b++){var g=a.ListData.Row[b].ID;if(g===e)return b}}return-1}function GetLastSelectedRowIndex(a){var b=a.LastSelectedItemIID;return GetIndexFromIID(a,b)}function GetTrFromIID(a){if(a==null||a.length==0)return null;var b='tr[iid="'+a+'"]';return document.querySelector(b)}function SelectRowByIID(c,b){var a=GetTrFromIID(c);a!=null&&SingleItemSelectByElement(a,b)}function SelectRowByIndex(a,c,d){var b;if(a!=null&&a.ListData!=null&&a.ListData.Row!=null&&a.ListData.Row[c]!=null){b=GenerateIIDForListItem(a,a.ListData.Row[c]);b!=null&&b.length>0&&SelectRowByIID(b,d)}}function EnsureKeyBoardHandlersRegistered(a){if(a==null)return;if(a.ListData==null||a.ListData.Row==null||a.ListData.Row[0]==null)return;var b=GenerateIIDForListItem(a,a.ListData.Row[0]),d=GetTrFromIID(b);if(d==null)return;var c=GetAncestor(d,"TABLE");if(c==null)return;AddKeyDownEventHandler(c,b.split(",")[0])}function MakeDefaultSelectionForListView(a){if(a==null)return;EnsureKeyBoardHandlersRegistered(a);if(a.ListData!=null&&a.ListData.Row!=null&&a.ListData.Row[0]!=null){var b=GetTrFromIID(GenerateIIDForListItem(a,a.ListData.Row[0]));if(b==null)return;while(b!=null){if(b.className.indexOf("s4-wpcell")>=0||b.className.indexOf("s4-wpActive")>=0)break;b=b.parentNode}if(b==null)return;EnsureScriptParams("ribbon","SelectWp",b)}if(a.LastSelectedItemIID!=null&&a.LastSelectedItemIID.length>0){var e=GetTrFromIID(a.LastSelectedItemIID);if(e!=null){SingleItemSelectByElement(e,false);return}}var c=a.LastRowIndexSelected;if(c==null)c=0;else{if(a.ListData!=null&&a.ListData.Row!=null)var d=a.ListData.Row.length;if(c>=d)c=d==0?-1:d-1}a.LastRowIndexSelected=null;c!=-1&&SelectRowByIndex(a,c,false)}function GetNextRow(d,e){var a=null;if(d!=null&&d.nodeName.toLowerCase()!="tr")return null;if(e==1){a=d.nextSibling;if(a==null){var b=d.parentNode.nextSibling;if(b!=null&&b.tagName=="TABLE")b=b.nextSibling;if(b!=null&&b.tagName=="TBODY")a=b.firstChild}}else if(e==-1){a=d.previousSibling;if(a==null){var c=d.parentNode.previousSibling;if(c!=null&&c.tagName=="TABLE")c=c.previousSibling;if(c!=null&&c.tagName=="TBODY")a=c.lastChild}}if(a!=null){var f=a.getAttribute("iid");return f!=null&&f.length>0?a:GetNextRow(a,e)}return a}function HandleItemDelete(d,c){var b=window["ctx"+String(c)],a=GetLastSelectedRowIndex(b);if(a==-1)a=0;b.LastRowIndexSelected=a;EnsureScriptParams("inplview","inplview.DeleteSelectedItems",b);return false}function GetItemRow2(b){var a=b;while(a!=null&&a.nodeType==1&&a.tagName!="BODY"&&a.getAttribute("iid")==null){if(typeof a.parentNode=="undefined"||a.parentNode==null||typeof a.parentNode.tagName=="undefined"){a=null;break}a=a.parentNode}return a!=null&&a.nodeType==1&&a.tagName=="TR"?a:null}function GetItemRow(a){if(a==null)a=window.event;var b=GetEventSrcElement(a);return GetItemRow2(b)}function TooltipOfRow(e){for(var d=e.cells,b=0,b=0;b<d.length;b++){var a=d[b];if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(169)){if(HasCssClass(a,"ms-vb-title"))return GetInnerAriaLabel(a).trim()}else if(HasCssClass(a,"ms-vb-title"))return GetInnerText(a).trim()}var c=e.getAttribute("iid");if(c!=null){var f=c.split(",");if(f.length>2)return""+f[1]}return null}function GetInnerAriaLabel(b){var c=b.querySelector(".ms-listlink"),a=null;if(c!=null)a=c.getAttribute("aria-label");return typeof a!=="undefined"&&a!==null?a:GetInnerText(b)}function AlertCheckOut(){alert(Strings.STS.L_MustCheckout_Text)}function UpdateAutoModeImage(a){if(a==null)a=window.event;if(a!=null){var b=a.srcElement!=null?a.srcElement:a.currentTarget;if(b!=null&&b.tagName=="A")if(a.type=="blur")RemoveCssClassFromElement(b,"ms-inlineEditLink");else a.type=="focus"&&AddCssClassToElement(b,"ms-inlineEditLink")}}function AddAutoModeTag(f,e,g){var a=document.createElement("A");SetEvent("blur",UpdateAutoModeImage,a);SetEvent("focus",UpdateAutoModeImage,a);var c=e;while(c.tagName!="TABLE")c=c.parentNode;if(f.getAttribute("requiresCheckout")!=null)SetEvent("click",AlertCheckOut,a);else{var d=c.getAttribute("inlineedit");if(d!=null)a.href=d.replace("{@ID}","{"+IdFromRow(e)+"}")}var b=document.createElement("IMG");b.className="s4-itm-inlineedit";b.src=g;b.border=0;b.alt=Strings.STS.L_Edit_Text;a.appendChild(b);f.appendChild(a)}function GetEcbAffordanceDivFromRow(a){return a==null?null:a.querySelector("div.ms-list-itemLink")}function UpdateAutoMode(b){if(b!=null){var c=CtxFromRow(b);if(c==null||typeof c.InlineEdit=="undefined"||!Boolean(c.InlineEdit))return;if(b.cells!=null&&b.cells.length>0){var a=b.cells[0];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/15/images/edititem.gif?rev=47")}else if(b.cells.length>1){a=b.cells[1];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/15/images/edititem.gif?rev=47")}}}}}function ClickToEdit(a){var c=GetItemRow(a);if(c!=null&&c.cells.length>1){var e=c.cells[1],d=e.firstChild;if(d!=null){var b=d.firstChild;if(b!=null&&b.tagName=="IMG")b.src="/_layouts/15/images/spinnyrefresh.gif?rev=47"}}if(window.event!=null)window.event.cancelBubble=true;else a!=null&&a.stopPropagation()}function HideItemCbx(b){if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a!=null&&a.tagName=="INPUT"){a.style.top="";a.style.position="";a.onmouseout=null}}function DisplayItemCbx(b){if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a!=null&&a.tagName=="INPUT"){a.style.top="0px";a.style.position="relative";a.onmouseout=HideItemCbx}}function Log(b){var a=document.createElement("DIV");a.innerHTML=b;document.body.appendChild(a)}function _ToggleAllItems(a,b,c){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectOrDeselectAllStart);if(a==null)a=window.event;MenuHtc_hide();ToggleAllItems2(b,c,b.checked);if(window.event!=null)window.event.cancelBubble=true;else a.stopPropagation();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectOrDeselectAllEnd);return false}function ToggleAllItems2(b,f,g){var a=window["ctx"+String(f)];if(a==null){b.checked=false;return}if(a.inGridMode){SPGridToggleAllItems(a);return}var c=b;while(c.tagName!="TABLE")c=c.parentNode;var e=c.rows,d=CountTotalItems(a);if(d==0){b.checked=false;return}if(g){if(d>g_MaximumSelectedItemsAllowed){b.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);SP.DebugLogger.Write("FailureSelectAll",SP.DebugLogger.LoggingLevel.Interesting,Strings.STS.L_BulkSelection_TooManyItems);return}SelectAllItems(a,e)}else DeselectAllItems(a,e,true)}function SelectAllItems(a,b){if(a==null||b==null)return;for(var e=a.LastSelectableRowIdx,c=1;c<e;c++){var d=b[c],f=d.getAttribute("iid");if(f!=null)ItemIsCurrentlyVisible(d)&&ToggleItemRowSelection2(a,d,true,false,true)}ToggleItemRowSelection2(a,b[e],true,true,true)}function DeselectAllItems(a,b,i){if(a==null)return;var d,f=a.LastSelectableRowIdx,e=1;if(a.BaseViewID=="MapView"){e=0;var g=document.getElementById("mapviewListTable_"+a.wpq);if(g==null)return;b=g.rows;f=b.length-1}if(b==null)return;for(d=e;d<=f;d++){var h=b[d],c=h.getAttribute("iid");if(c!=null&&typeof c=="string"){var j=c.split(",");SelectListItem(a,c,j,h,false,true)}}i&&RefreshCommandUI()}function DeselectCollapsedGroup(e,b){if(b==null)return;var c=b.rows,a=GetLastSelectableRowIdx(b,ItemHasiid);if(Boolean(c)&&a!=-1){for(var d=0;d<a;d++){var f=c[d];ItemHasiid(f)&&ToggleItemRowSelection2(e,f,false,false,false)}ToggleItemRowSelection2(e,c[a],false,true,false)}}function HandleSingleGroupByRow(a,b,d){if(a==null||b==null)return;var c=b.getAttribute("iid");if(c==null)return;if(!d){a.TotalListItems--;ItemIsCurrentlySelected(a,c,b)&&ToggleItemRowSelection2(a,b,false,true,false)}else a.TotalListItems++}var g_onRefreshCommandUIHandlers;function RegisterOnRefreshCommandUIHandler(a,b){g_onRefreshCommandUIHandlers.push({key:a,fn:b})}function UnregisterOnRefreshCommandUIHandler(b){for(var a=0;a<g_onRefreshCommandUIHandlers.length;a++)if(g_onRefreshCommandUIHandlers[a].key===b){g_onRefreshCommandUIHandlers.splice(a,1);break}}function RefreshCommandUI(){for(var a=0;a<g_onRefreshCommandUIHandlers.length;a++)g_onRefreshCommandUIHandlers[a].fn();!Boolean(g_pageIsDeRibboned)&&EnsureScriptFunc("ribbon","SP.Ribbon.PageManager",function(){if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a!=null&&a.get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}})}function _CommandUIExecuteCommand(a){EnsureScriptFunc("ribbon","SP.Ribbon.PageManager",function(){if(IsFullNameDefined("SP.Ribbon.PageManager")){var b=SP.Ribbon.PageManager.get_instance();b!=null&&b.get_commandDispatcher().executeCommand(a,null)}})}function IdFromRow(c){var b=c.getAttribute("iid"),a=b.split(",");return a[1]}function CtxFromRow(d){var c=d.getAttribute("iid"),b=c.split(","),a=b[0];return window["ctx"+a]}var previousClickedItemRow;function IsCallOutOn(){return typeof CalloutManager==="object"&&typeof CalloutManager.isAtLeastOneCalloutOn==="function"&&CalloutManager.isAtLeastOneCalloutOn()}function SingleItemSelectByElement(b,a){return SingleItemSelectInternal(null,false,b,a)}function MultiItemSelect(i){var e=GetItemRow(i);if(e==null)return false;var a=CtxFromRow(e),n=e.getAttribute("iid"),c=GetIndexFromIID(a,n),k=a.LastSelectedItemIID,b=GetLastSelectedRowIndex(a),l=GetLastSelectedRow(a),m=c<b?c:b,o=c>b?c:b;if(!i.ctrlKey)if(CountSelectedItems(a)>0){var d=e;while(d.tagName!="TABLE")d=d.parentNode;for(var h=d.rows,f=0;f<h.length;f++){var j=h[f];ItemIsSelectable(j)&&ToggleItemRowSelection2(a,j,false,false,false)}}for(var g=m;g<=o;g++)SelectRowByIndex(a,g,true);FocusRow(a,k,l);return false}function OpenCalloutAndSelectItem(a,b,e,c){var d=GetAncestor(a,"TR");SingleItemSelectInternal(b,false,d,false);OpenCallout(a,b,e,c)}function SingleItemSelect(a){if(a==null)a=window.event;var c=a.shiftKey,b=a.ctrlKey;WriteSearchClickLog(a);if(c){MultiItemSelect(a);return false}else{var d=SingleItemSelectInternal(a,true,null,b);return b?false:d}}function SingleItemSelectInternal(e,g,a,k){var d=true;if(g){var j=GetEventSrcElement(e);if(j!=null&&ElementContainsLink(j))return undefined;if(IsCallOutOn())return true;a=GetItemRow(e);if(clearECBMenu(j,a==null?null:CtxFromRow(a))){CancelEvent(e);return false}}if(a==null)return false;var c=a;while(c.tagName!="TABLE")c=c.parentNode;var p=c.rows,b=CtxFromRow(a);if(g){var l=a.getAttribute("iid"),o=l.split(",");d=!ItemIsCurrentlySelected(b,l,a);if(!k&&CountSelectedItems(b)>1)d=true}if(d&&!k)if(CountSelectedItems(b)>0)for(var h=c==null?null:c.querySelectorAll("tr[class*='s4-itm-selected']"),m=h==null?0:h.length,i=0;i<m;i++){var f=h[i],n=f.getAttribute("iid");ItemIsSelectable(f)&&ItemIsCurrentlySelected(b,n,f)&&ToggleItemRowSelection2(b,f,false,false,false)}ToggleItemRowSelection2(b,a,d,true,false);UpdateSelectAllCbx(b,d);previousClickedItemRow=a;g&&CancelEvent(e);return true}function Point(a,b){this.x=a;this.y=b}function GetCellCoordinates(b){var c=0,d=0;while(b.tagName!="TD")b=b.parentNode;var a=b.previousSibling;while(a!=null){c++;a=a.previousSibling}a=b.parentNode.previousSibling;while(a!=null){d++;a=a.previousSibling}return new Point(c,d)}function ElementContainsLink(a){while(a!=null&&a.tagName!="TD"){if(a.tagName=="A")return true;a=a.parentNode}return false}function clearECBMenu(c,b){if(g_menuHtc_lastMenu==null)return false;if(c!=null){var a=c;while(a!=null&&a.tagName!="TD")a=a.parentNode;var e=GetItemRow2(a);MenuHtc_hide();var d=b!=null&&b.IsClientRendering==true;!d&&tdHasEcbMenu(a)&&OnChildItem(a)}return true}function tdHasEcbMenu(d){for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b];if(a.nodeType==1&&a.tagName=="DIV"){var c=a.getAttribute("CTXName");if(c!=null&&c!="")return true}}return false}function ToggleItemRowSelection(a,b){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemStart);if(a==null)a=window.event;if(a!=null&&a.keyCode==Sys.UI.Key.enter)return false;WriteSearchClickLog(a);MenuHtc_hide();if(b==null)b=GetItemRow(a);var c=CtxFromRow(b),f=b.getAttribute("iid");if(ctx!=null&&c.ListSchema!=null&&c.ListSchema.IsDocLib)_WriteDocEngagement("Documents_SelectItemClick","OneDrive_SelectItemClick");else _WriteDocEngagement("SelectListClick","OneDrive_SelectListClick");var d=!ItemIsCurrentlySelected(c,f,b);if(d&&CountSelectedItems(c)==g_MaximumSelectedItemsAllowed){var e=GetItemRowCbx(b);e.checked=false;alert(Strings.STS.L_BulkSelection_TooManyItems);CancelEvent(a);SP.DebugLogger.Write("FailureSelectAll",SP.DebugLogger.LoggingLevel.Interesting,Strings.STS.L_BulkSelection_TooManyItems);return true}ToggleItemRowSelection2(c,b,d,true,false);UpdateSelectAllCbx(c,d);previousClickedItemRow=b;if(window.event!=null)window.event.cancelBubble=true;else a!=null&&typeof a.stopPropagation!="undefined"&&a.stopPropagation();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemEnd);return true}function GetCtxRgiidFromIid(c){if(c==null)return null;var b=c.split(",");if(b.length!=3)return null;if(b[1]=="")return null;var d=b[0],a=window["ctx"+d];if(a==null)return null;if(typeof a.dictSel=="undefined")a.dictSel=[];if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return new CtxRgiid(a,b)}function GetWebPartDiv(a){while(a!=null&&(a.tagName!="DIV"||a.getAttribute("WebPartID")==null)&&a.parentNode!=null)a=a.parentNode;return a}function GetCurrentCtx(d){var b=document.getElementById("_wpSelected");if(b==null&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null)return ctx;if(b==null)return null;var a=b.getAttribute("value");if(a==null||a==""){if(Boolean(d))b=GetWebPartDiv(d)}else{a=a.substr(12);b=document.getElementById(a)}if(b==null)return null;var c;if(typeof _spWebPartComponents!="undefined"&&_spWebPartComponents!=null&&_spWebPartComponents[a]&&_spWebPartComponents[a].storageId)c=_spWebPartComponents[a].storageId;else c=b.getAttribute("WebPartID");if(c==null)return null;c=c.toUpperCase();var e=g_ViewIdToViewCounterMap["{"+c+"}"];if(e==null)return null;var f=window["ctx"+e];return f}function DeselectAllWPItems(){var a=GetCurrentCtx(),b;if(a==null||(b=a.clvp)==null||b.tab==null)return;var d=b.tab,c=getSelectAllCbxFromTable(d);if(c==null)return;c.checked=false;CountSelectedItems(a)>0&&DeselectAllItems(a,d.rows,false)}function callOpenBreadcrumbMenu(a,g,j,i,c,d,e,f,m,n,h,k){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSBreadcrumbStart);if(a==null)a=window.event;a.cancelBubble=true;typeof a.stopPropagation!="undefined"&&a.stopPropagation();var l=function(){SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch(g,j,i,c,d,e,f,m,n,h,k)},b;try{b=typeof SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch}catch(o){b="undefined"}EnsureScript("SP.js",b,l);IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSBreadcrumbEnd)}function AddSpaceToEmptyTDs(b){var c;if(browseris.ie7down&&b!=null){if(b.getAttribute("addEmptySpace")==null)b.setAttribute("addEmptySpace","true");else return;for(c=0;c<b.childNodes.length;c++){var a=b.childNodes[c];if(a.nodeType==1&&a.tagName=="TD"&&a.width!="1%")if(a.innerHTML=="")a.innerHTML="&#8203;";else if(a.innerText==""){while(a!=null&&a.nodeType==1&&a.innerHTML!="")a=a.firstChild;if(a!=null&&a.nodeType==1&&a.innerHTML==""&&(a.tagName=="SPAN"||a.tagName=="DIV"||a.tagName=="NOBR"))a.innerHTML="&#8203;"}}}}function AddBorderToLastCell(c){if(c.getAttribute("setEdgeBorder")!=null)return;var a=c.cells;if(a!=null&&a.length>0){if(browseris.ie7down)a[0].className+="";var b=a[a.length-1];if(b!=null)if(b.className!="")b.className+=" ms-vb-lastCell";else b.className="ms-vb-lastCell"}c.setAttribute("setEdgeBorder","true")}function AddGallery_TypeOf(c){if(c!=null){var b=typeof c;if(b=="object")if(b.constructor!=null){var a=c.constructor.toString(),d=a.indexOf(" "),e=a.indexOf("("),f=a.substr(d+1,e-d-1);return f}return b}return null}function IsLanguageSupportedInSilverlight(a){return a==1025||a==1037||a==1054||a==1081?false:true}function IsSilverlightInstalled(b){if(typeof b=="undefined")b=null;var a=false,l=null;try{var f=null,k=false;if(window.ActiveXObject!=null)try{f=new ActiveXObject("AgControl.AgControl");if(b===null)a=true;else if(typeof f.IsVersionSupported!="undefined"&&f.IsVersionSupported(b))a=true;f=null}catch(m){k=true}else k=true;if(k){var j=typeof navigator.plugins!="undefined"?navigator.plugins["Silverlight Plug-In"]:null;if(j!=null)if(b===null)a=true;else{var i=typeof j.description=="string"?j.description:"";if(i==="1.0.30226.2")i="2.0.30226.2";var c=i.split(".");while(c.length>3)c.pop();while(c.length<4)c.push(0);var e=b.split(".");while(e.length>4)e.pop();var d,h,g=0;do{d=parseInt(e[g]);h=parseInt(c[g]);g++}while(g<e.length&&d===h);if(d<=h&&!isNaN(d))a=true}}}catch(m){a=false}return a}function IsAddGalleryProviderEnabled(d,c){var a,b=true;try{if(window.XMLHttpRequest!=null){a=new XMLHttpRequest;a.open("HEAD",d+c+".deny.xml",false);a.send();if(a.status==200)b=false}}catch(e){}return b}function SilverlightBasedCreateHandler(a){var k=new Date,f,b,c,i,h;if(typeof _spPageContextInfo!="undefined"){if(_spPageContextInfo.siteServerRelativeUrl!=null){b=_spPageContextInfo.siteServerRelativeUrl;if(b.charAt(b.length-1)!="/")b=b+"/"}else return true;if(_spPageContextInfo.webServerRelativeUrl!=null){c=_spPageContextInfo.webServerRelativeUrl;if(c.charAt(c.length-1)!="/")c=c+"/";f=c+"_layouts/15/AddGallery.aspx"}else return true;if(Boolean(_spPageContextInfo.webLanguage))i=_spPageContextInfo.webLanguage;else return true;if(Boolean(_spPageContextInfo.currentLanguage))h=_spPageContextInfo.currentLanguage;else return true}else return true;if(FV4UI()&&IsSilverlightInstalled("3.0.40624.0")&&IsLanguageSupportedInSilverlight(i)&&IsLanguageSupportedInSilverlight(h)){if(a==null)a="All";if(AddGallery_TypeOf(a)!="string")return true;a=a.toLowerCase();if(a=="page"||a=="publishingpage")return true;var d=[];d=a.split(":");if(d.length==2&&d[0]=="provider")if(!IsAddGalleryProviderEnabled(b+"_layouts/15/AddGalleryProviders/",d[1]))return true;var g=function(b,c){if(FV4UI()){if(Boolean(b))if(Boolean(c))window.location=c;else window.location.reload()}else{var a=typeof b=="string"?b:null;if(a!=null&&a!="")window.location.href=a;else window.location.reload()}},j=function(){var i={scope:a,currentWeb:c,currentSiteCollection:b,clickDateTime:k},e=a=="page"?660:1012,d=a=="page"?360:600;if(FV4UI())var j={width:e,height:d,resizable:true,status:false,menubar:false,help:false,url:f,dialogReturnValueCallback:g,args:i},l=SP.UI.ModalDialog.showModalDialog(j);else{var h;if(window.showModalDialog!=null)h="dialogWidth:"+String(e)+"px;dialogHeight:"+String(d)+"px;resizable:yes;status:no;menubar:no;help:no";else h="width="+String(e)+",height="+String(d)+",resizable=yes,status=no,menubar=no,help=no";var m=commonShowModalDialog(f,h,g,i)}},e;try{e=typeof SP.UI.ModalDialog.showModalDialog}catch(l){e="undefined"}EnsureScript("SP.UI.Dialog.js",e,j);return false}return true}function LaunchCreateHandler(a){if(typeof __CreateHandler!="undefined"&&__CreateHandler!=null)return __CreateHandler(a);else try{return SilverlightBasedCreateHandler(a)}catch(c){return true}}var isdlg,preventResizeHandler;function PageActionClick(){EnsureScript("ribbon",TypeofFullName("SP.Ribbon.PageStateActionButton"),function(){SP.Ribbon.PageStateActionButton.sendCommand()})}function ShowWebPartAdder(a){LoadWPAdderOnDemand();ExecuteOrDelayUntilEventNotified(function(){var b=window.WPAdder;if(b!=null){b._showCategoryColumn(true);b._setZone(a);b.show()}},"_spEventWebPartAdderReady")}function GenerateXMLArray(b,c){var a=[];if(b!=null){var d="<"+c+">",e="</"+c+">";for(var f in b){a.push(d);a.push(b[f]);a.push(e)}}return a.join("")}function StURLNormalize(a){if(a.substr(0,2)=="\\\\"||a.substr(0,2)=="//")a="file:"+a;if(a.substr(0,5)=="file:")a=a.replace(/\\/g,"/");return a}function QuickLaunchInitDroppable(){if(Boolean(g_QuickLaunchControlIds)){for(var a=[],c=0;c<g_QuickLaunchControlIds.length;c++){var g=g_QuickLaunchControlIds[c],e=document.getElementById(g);if(Boolean(e)){var b=e.querySelectorAll(".ms-quicklaunch-dropNode");if(Boolean(b))for(var d=0;d<b.length;d++){var f=b[d];a.push(f)}}}a.length>0&&EnsureScriptParams("DragDrop.js","InitMenuItemAsDroppable",a)}}var g_listItemCache;function GetListItemByIID(b){if(typeof g_listItemCache[b]!=="undefined")return g_listItemCache[b];var d=GetCtxRgiidFromIid(b),a=d.ctx,e=d.rgiid[1];if(typeof a==="undefined"||a===null||typeof a.ListData==="undefined"||a.ListData===null||typeof a.ListData.Row==="undefined"||a.ListData.Row===null)throw"Error: ctx ListData could not be found";for(var c=0;c<a.ListData.Row.length;c++)if(a.ListData.Row[c].ID===e)return g_listItemCache[b]=a.ListData.Row[c];return g_listItemCache[b]=null}function FixRibbonAndPageLayout(e){var c=GetCachedElement("s4-ribbonrow");if(Boolean(c)){c.className=c.className.replace(RegExp("s4-ribbonrowhidetitle"),"");var d=GetCachedElement("s4-titlerow"),j=document.body;if(Boolean(d)){d.className=d.className.replace(RegExp("s4-titlerowhidetitle"),"");if(e)d.style.display="block";else d.style.display="none"}var g=c.querySelector(".ms-core-webpartadder");if(Boolean(g))if(GetCurrentEltStyle(g,"position")=="absolute"){var a=document.getElementById("Ribbon");if(Boolean(a)){var b;if(e)b=AbsTop(a)+a.offsetHeight;else{var f=a.querySelector(".ms-cui-tabContainer");if(Boolean(f))b=AbsTop(f)+f.offsetHeight;else b=AbsTop(a)+a.offsetHeight}b-=AbsTop(c);g.style.top=b.toString()+"px"}}}var i=g_spribbon.isInited;g_spribbon.isInited=true;var h=g_spribbon.isMinimized;g_spribbon.isMinimized=e;(h!=e||!i)&&FixRibbonAndWorkspaceDimensions()}var g_fRibbonAnimationEnabled,g_fSkipAnimation,g_fSkipNextTabExpandAnimation;function PrepareRibbonForAnimation(e,f){g_fRibbonAnimationEnabled=ajaxNavigate.get_search().indexOf("IsDlg=1")==-1&&SPAnimation.Settings.IsAnimationEnabled();if(!g_fRibbonAnimationEnabled)return;var c=document.getElementById("Ribbon"),b=c.childNodes[2],g=pxToNum(g_spribbon.maximizedHeight)-pxToNum(g_spribbon.minimizedHeight);if(e){if(b!=null){var a=SPAnimationUtility.BasicAnimator.CloneElement(b,false,true,false,false),d=a.firstChild;SPAnimationUtility.BasicAnimator.PositionAbsoluteExact(d,0,0,null,null);SPAnimationUtility.BasicAnimator.Move(d,0,-g,function(){a.parentNode!=null&&a.parentNode.removeChild(a);b.style.visibility=""},null)}}else{if(g_fSkipNextTabExpandAnimation){g_fSkipAnimation=true;g_fSkipNextTabExpandAnimation=false}else g_fSkipAnimation=f&&Boolean(b);!g_fSkipAnimation&&c.className.indexOf("ms-cui-animatingRibbon")==-1&&CSSUtil.AddClass(c,"ms-cui-animatingRibbon")}}function AnimateRibbonMinimizedChanged(b){if(!g_fRibbonAnimationEnabled||b)FixRibbonAndPageLayout(b);else if(!g_fSkipAnimation){var c=document.getElementById("Ribbon"),d=c.childNodes[2],e=pxToNum(g_spribbon.maximizedHeight)-pxToNum(g_spribbon.minimizedHeight);PrepareRibbonForAnimation(b,false);if(d!=null){var a=d.firstChild;a.style.top=String(-e)+"px";fRightToLeft?a.style.right="0px":a.style.left="0px";SPAnimationUtility.BasicAnimator.Move(a,0,0,function(){var d=document.getElementById("Ribbon").childNodes[2];if(d!=null){var e=d.firstChild;if(e!=null&&a.id=="Ribbon.BlankTab"&&e.id=="Ribbon.BlankTab")g_fSkipNextTabExpandAnimation=true}if(a.parentNode==null||a.parentNode.parentNode==null||a.parentNode.parentNode.nodeType!=1)b=true;CSSUtil.RemoveClass(c,"ms-cui-animatingRibbon");FixRibbonAndPageLayout(b)},null)}}}function UpdateAnimationUserControl(c){var b=document.getElementById("TurnOnAnimation"),a=document.getElementById("TurnOffAnimation"),e=document.getElementById("linkTurnOnAnimation"),d=document.getElementById("linkTurnOffAnimation");if(SPAnimation.Settings.IsAnimationEnabled()){if(b!=null)b.style.display="none";if(a!=null)a.style.display="";c&&d!=null&&d.focus()}else{if(b!=null)b.style.display="";if(a!=null)a.style.display="none";c&&e!=null&&e.focus()}}function ToggleAnimationStatus(){if(SPAnimation.Settings.IsAnimationEnabled())SPAnimation.Settings.DisableAnimation();else SPAnimation.Settings.EnableAnimation();UpdateAnimationUserControl(true)}function setupPageDescriptionCallout(){var c=document.getElementById("ms-pageDescription");if(Boolean(c)){var a=GetInnerText(c),b=document.getElementById("ms-pageDescriptionDiv");if(Boolean(a)){a=a.trim();setInnerText(c,a);b.title=a;b.setAttribute("role","button");!OffSwitch.IsActive("6DE0A6C4-5A29-4DE3-9996-05545DD0FE2F")&&$addHandler(b,"keydown",function(a){DescriptionDivKeyDown(a)});a=a.replace(/(\n|\r|\t| )/g,"");if(Boolean(a)){SPAnimationUtility.BasicAnimator.FadeIn(b,null,null);EnsureScriptFunc("callout.js","Callout",function(){CalloutManager.createNew({ID:"ms-pageDescriptionCallout",launchPoint:b,openOptions:{event:"click",showCloseButton:true},content:c.innerHTML})})}}}}function DescriptionDivKeyDown(a){if(a.keyCode==Sys.UI.Key.space||a.keyCode==Sys.UI.Key.enter){a.target.click();a.preventDefault()}}function SendAjaxFormPostWithFormDigest(d,b,c){var a=new XMLHttpRequest;a.open("POST",d,true);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");b!=null&&a.setRequestHeader("Content-length",b.length);a.setRequestHeader("Connection","Keep-alive");a.setRequestHeader("x-requestdigest",document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value);a.setRequestHeader("x-requested-with","XMLHttpRequest");a.onreadystatechange=function(){if(IsXhrReady(a))c!=null&&c(a)};a.send(b)}function numToPx(a){return String(a)+"px"}function GetSuiteHelpLink(c){var a=null;if(c!=null)a=JSON.parse(c);var b=null;if(a!=null)if(typeof a.HelpLink!="undefined"&&typeof a.HelpLink.Url=="string")b=a.HelpLink.Url;return b}function SuiteLinksEmptyOrSuiteHelpLinkIsCached(){var b=OpenSuiteLinksJson(),a=false;if(b=="{}")a=true;else a=!IsStrNullOrEmpty(GetSuiteHelpLink(b));return a}function UpdateCompanyDisplayName(b){if(Boolean(b.CompanyDisplayName)){var a;a=Strings.STS.L_Mybrary_Branding_TextWithName2;a=String.format(a,b.CompanyDisplayName);SP.SOD.notifyEventAndExecuteWaitingJobs("AddMybraryBranding",[a]);var d=document.getElementById("skyDriveText");d!=null&&setInnerText(d,a);var c=document.getElementById("skyDriveFolder");c!=null&&setInnerText(c,b.CompanyDisplayName)}}function IsPageRenderedInDialog(){return ajaxNavigate.get_search().match(new RegExp("[?&]IsDlg=1"))!=null}function GetRESTValueFromCurrentSite(c,b){if(typeof b!="function")return;var d=window._spPageContextInfo;if(!Boolean(c)||!Boolean(d)){b(null);return}if(c.indexOf("/")!=0)c="/"+c;var f=d.webServerRelativeUrl=="/"?"":d.webServerRelativeUrl,e=escapeUrlForCallback(f)+"/_api"+c,a=new XMLHttpRequest;a.open("GET",e,true);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.setRequestHeader("ACCEPT","application/json; odata = verbose");a.onreadystatechange=function(){if(IsXhrGoodAndReady(a))try{typeof JSON!="undefined"&&b(JSON.parse(a.responseText))}catch(d){var c="GetRESTValueFromCurrentSite: Failed to parse REST data from Server. Rest path: "+e+" , Error: "+d;b(null,c)}else a.readyState==4&&b(null,"Received a bad response from the server: "+a.responseText)};a.send()}function RenderDLPStatusBar(a,c){if(Boolean(a)){var b="<a href='"+Encoding.HtmlEncode(c)+"' target='_blank' onclick='Nav.goToLink(this); return false;'";b+=(!Boolean(c)?"class='ms-hide'":"")+">";var d="</a>",e=String.format(Encoding.HtmlEncode(a),b,d),f=addStatus("",e,false,true);setStatusPriColor(f,"blue")}}function ProcessDLPStatus(){if(!IsPageRenderedInDialog()&&(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(103)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(306))&&document.cookie.indexOf("mobile=1")==-1&&document.location.href.indexOf("mobile=1")==-1){var a="";GetRESTValueFromCurrentSite("/Web/DataLeakagePreventionStatusInfo",function(a,e){var d="",b="";if(Boolean(a)&&Boolean(a.d)){var c=false;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(103)){var i=a.d.ContainsConfidentialInfo,g=a.d.ContainsConfidentialInfoLearnMoreUrl;if(Boolean(i)){RenderDLPStatusBar(Strings.STS.L_DLPLite_StatusBar_SiteWithConfidentialInfo_Text,g);c=true}}if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(306)){var h=a.d.ExternalSharingTipsEnabled,f=a.d.ExternalSharingTipsLearnMoreUrl;if(Boolean(h)){RenderDLPStatusBar(Strings.STS.L_DLPLite_StatusBar_SiteShareableWithExternalUsers_Text,f);c=true}}c&&LogRUMExtendedAction("DLPLiteBannersRendered",0,null,+new Date,0)}else if(Boolean(e)){d="UnexpectedError";b=e}else{d="UnexpectedError";b="JSON data not in expected format: dataObj.d.DataLeakagePreventionStatusInfo"}Boolean(b)&&SP.SOD.executeFunc("sp.core.js","SP.SimpleLogger",function(){var a=GetSimpleLogger();if(a==null)return;var c={EventType:d,Message:b};a.WriteLog("DLPLite",c)})})}}function GetLayoutsPageUrl(c,f,a){var e=!c.endsWith("/")?"/":"",d=[c,e,_spPageContextInfo.layoutsUrl,"/",f],b=new URI(d.join(""));Boolean(a)&&b.setQuery(a);return b.getString()}function GetAdvancedPermissionPageUrl(d,b,c){var a=[];if(Boolean(b)){a.push("?List=",b);Boolean(c)&&a.push("&obj=",b,",",c,",LISTITEM")}return GetLayoutsPageUrl(d,"user.aspx",a.join(""))}var _searchClickLogTerm,_searchClickLogSeq;function WriteSearchClickLog(f){try{var c=GetItemRow(f),a=CtxFromRow(c),e=c.getAttribute("iid"),b=GetIndexFromIID(a,e)+a.ListData.FirstRow,d=typeof a.completedSearchTerm!="undefined"&&a.completedSearchTerm!=null;if(typeof a.ListTemplateType!="undefined"&&d){if(_searchClickLogTerm!=a.completedSearchTerm){_searchClickLogSeq=0;_searchClickLogTerm=a.completedSearchTerm}if(a.ListTemplateType==700)SP.QoS.WriteUserEngagement("OneDriveInPlaceSearchItemClick",{index:b,seq:_searchClickLogSeq++});else SP.QoS.WriteUserEngagement("SitesInPlaceSearchItemClick",{index:b,seq:_searchClickLogSeq++})}}catch(g){}}function CanSupportRoamingApps(){return BrowserDetection.userAgent.win&&!BrowserDetection.userAgent.armProcessor&&(BrowserDetection.userAgent.ie||BrowserDetection.userAgent.firefox3up||BrowserDetection.userAgent.chrome)}function DisplayCreateListDialog(f){var h="createList_control",e="createList_progBar",d="createList_createButton",c="createList_nameInput",b="createList_nameError",a,i=function(k){PreventDefaultNavigation(k);var i=document.getElementById(c+"_onetidIOFile"),h;if(Boolean(i))h=i.value.trim();var g=document.getElementById(b);if(Boolean(g))if(!Boolean(h)){setInnerText(g,Strings.STS.L_SPClientRequiredValidatorError);g.style.display="";a.autoSize()}else{setInnerText(g,"");g.style.display="none";a.autoSize();var j=document.getElementById(e);CSSUtil.RemoveClass(j,"ms-hide");document.getElementById(d).disabled=true;Boolean(f)&&f(h)}},g=function(){var g=document.createElement("form");g.id="ms-creatlistdialog-root";var k={createListControlId:h,progressBarId:e,loadingCirlceImage:"/_layouts/15/images/loadingcirclests16.gif?rev=47",createButtonId:d,text_fileName:Encoding.HtmlEncode(Strings.STS.L_FileName_Text),text_requiredField:Encoding.HtmlEncode(Strings.STS.L_RequiredField_Tooltip),listNameInputId:c,listNameErrorId:b,text_createButton:Encoding.HtmlEncode(Strings.STS.L_CreateButtonCaption),text_cancelButton:Encoding.HtmlEncode(Strings.STS.L_CancelButtonCaption)},j="{%version 2.0}                        <div id='{=createListControlId}'>                            <div class='ms-formlabel'>                            <h3 class='ms-standardheader'>                                <nobr>{=text_fileName}<span title='{=text_requiredField}' class='ms-accentText'> *</span></nobr>                            </h3></div>                            <input type='text' id='{=listNameInputId}_onetidIOFile' class='{=listNameInputId} ms-fullWidth'></input>                            <div class='{=listNameErrorId} ms-formvalidation ms-csrformvalidation' id='{=listNameErrorId}' style='display:none'></div>                        </div>                        <div class='ms-core-form-bottomButtonBox'>                            <img id='{=progressBarId}' class='ms-hide' onclick='javascript:style.display=\"none\";' src='{=loadingCirlceImage}'></img>                            <input type='submit' id='{=createButtonId}' class='ms-button-emphasize' value='{=text_createButton}' onclick='{+createBtn_click}'></input>                            <input type='button' id='createList_createButton_toolBarTbl_RightRptControls_diidIOGoBack' class='ms-ButtonHeightWidth' value='{=text_cancelButton}' onclick='{+cancelBtn_click}'></input>                        </div>",f=new Renderer;f.SetTemplate("main",j);f.RegisterHandler("createBtn_click",i);f.RegisterHandler("cancelBtn_click",function(){a.close(SP.UI.DialogResult.cancel)});g.innerHTML=f.Render("main",k);return g};EnsureScriptFunc("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",function(){var b=g(),c={html:b,title:Encoding.HtmlEncode(Strings.STS.L_CreateList_Text),autoSize:true,autoSizeStartWidth:450};a=new SP.UI.ModalDialog.showModalDialog(c)})}function DeleteListWithRedirect(c,b){!Boolean(c);var a=Boolean(b)?b:"NoSource";a=a+"_DeleteList_";DeleteListWithREST(c,function(){SP.QoS.WriteSuccess(a+"Success");if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(401))STSNavigate(GetLayoutsPageUrl(_spPageContextInfo.webAbsoluteUrl,"group.aspx"));else STSNavigate(_spPageContextInfo.webAbsoluteUrl)},function(b){SP.QoS.WriteFailure(a+"Failure");var d=Strings.STS.L_DragDropNotWorkingErrorTitle,c="";if(Boolean(b)&&Boolean(b.responseText))c=b.responseText;ShowErrorDialogCore(d,c)});return false}function DeleteListWithREST(e,a,b){if(confirm(Strings.STS.L_DeleteList_Confirmation))if(Boolean(e)&&Boolean(_spPageContextInfo)&&Boolean(_spPageContextInfo.webAbsoluteUrl)){var f=SP.UI.Notify.showLoadingNotification(true),g=_spPageContextInfo.webAbsoluteUrl+"/_api/web/Lists/GetById(id='"+e+"')/Recycle",c=function(d){var c=new XMLHttpRequest;c.open("POST",g,true);c.onload=function(){if(c.status===200)Boolean(a)&&a();else Boolean(b)&&b(c);SP.UI.Notify.removeNotification(f)};c.setRequestHeader("accept","application/json; odata=verbose");c.setRequestHeader("Content-Type","application/json;odata=verbose");c.setRequestHeader("x-requestdigest",d);c.send()},d=GetRequestDigest(_spPageContextInfo.webAbsoluteUrl,c);Boolean(d)&&c(d)}else throw"DeleteListWithREST(): listId is null";}var _lastRequestDigestUpdate,_requestDigest,_updateInterval;function GetRequestDigest(c,b){if(!Boolean(_lastRequestDigestUpdate)){var a=document.getElementsByName("__REQUESTDIGEST")[0];if(typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.updateFormDigestPageLoaded!="undefined"&&a!=null&&a.tagName.toLowerCase()=="input"&&a.type.toLowerCase()=="hidden"&&Boolean(a.value)){_lastRequestDigestUpdate=_spPageContextInfo.updateFormDigestPageLoaded;_requestDigest=document.forms[MSOWebPartPageFormName].__REQUESTDIGEST.value}else _lastRequestDigestUpdate=new Date}var d=new Date;if(d.getTime()-_lastRequestDigestUpdate.getTime()>=_updateInterval||!Boolean(_requestDigest)){UpdateRequestDigest(c,b);return null}return _requestDigest}function UpdateRequestDigest(c,b){var d=new Date,a=new XMLHttpRequest;a.open("POST",c+"/_api/contextinfo",true);a.setRequestHeader("Content-Type","application/json;odata=verbose");a.setRequestHeader("Accept","application/json; odata = verbose");a.onload=function(){if(a.status===200){var c=JSON.parse(a.responseText);_requestDigest=c.d.GetContextWebInformation.FormDigestValue;_lastRequestDigestUpdate=new Date;Boolean(b)&&b(_requestDigest)}};a.send()}function CreatePanel(h){ClosePanel();if(!(window.OffSwitch==null||OffSwitch.IsActive("42A482A3-3F3B-4CC4-BA83-5C1A5D56F1E1")))O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.CloseFlexPaneForProvider&&O365Shell.FlexPane.CloseFlexPaneForProvider("Settings");var f=document.createElement("DIV");f.id="ms-OldPanel-PanelBackdrop";f.className="ms-OldPanel-PanelBackdrop";f.onclick=ClosePanel;document.body.appendChild(f);var e=document.createElement("DIV");e.id="ms-OldPanel-PanelContainer";e.className="ms-OldPanel-PanelContainer";e.style.height="calc(100% - 50px)";var g=document.createElement("IFRAME");g.className="ms-OldPanel-Frame";g.src=h;if(SP.Res)g.title=SP.Res.PanelTitle;e.appendChild(g);var d=document.createElement("DIV");d.id="ms-OldPanel-CloseButton";d.className="ms-OldPanel-CloseButton";SP.Res&&d.setAttribute("aria-label",SP.Res.ClosePanel);d.onclick=ClosePanel;var c=document.createElement("SPAN");c.id="ms-OldPanel-CloseButtonOuterSpan";c.style.padding="8px";c.style.width="16px";c.style.height="16px";c.style.display="inline-block";var a=document.createElement("SPAN");a.id="ms-OldPanel-CloseButtonInnerSpan";a.className="s4-clust";a.style.width="16px";a.style.height="16px";a.style.overflow="hidden";a.style.position="relative";a.style.display="inline-block";var b=document.createElement("IMG");b.id="ms-OldPanel-CloseButtonImage";b.className="ms-dlgCloseBtnImg";b.alt=Strings.STS.L_OldPanel_CloseText;b.src="/_layouts/15/images/fgimg.png?rev=44";b.style.left="0px";b.style.top="-645px";b.style.position="absolute";a.appendChild(b);c.appendChild(a);d.appendChild(c);e.appendChild(d);document.body.appendChild(e)}function ClosePanel(){var b=document.getElementById("ms-OldPanel-PanelContainer");b!==null&&b!==undefined&&document.body.removeChild(b);var a=document.getElementById("ms-OldPanel-PanelBackdrop");a!==null&&a!==undefined&&document.body.removeChild(a)}var g_NotificationEngine,g_notiExpireTimerId,g_standardNotiCt,g_statusNotiCt,SPNotifications,g_SPNotificationEventID_Count,addNotification,removeNotification;function NotificationEngine(){this.Initialize()}function SPNotification(c,g,f,d,a,e,b){this.Initialize(c,g,f,d,a,e,b)}function SPNotificationContainer(d,a,c,b){this.Initialize(d,a,c,b)}function SPStatusNotificationData(c,d,a,b){this.txt=c;this.dt=d;this.img=a;this.sip=b}function addSharingNotification(h,i,b,e,d,c,f){var a;if(e)a=STSHtmlEncode(Strings.STS.L_SharingNotificationAccessRequestsMode);else if(d)a=STSHtmlEncode(Strings.STS.L_SharingNotificationGuestLink);else if(c)a=STSHtmlEncode(Strings.STS.L_SharingNotificationExternalUsers);else if(b!==null&&b.length>0)a=STSHtmlEncode(StBuildParam(Strings.STS.L_SharingNotificationPrefixText,b.join(Strings.STS.L_SharingNotificationUserSeparator)));else a=STSHtmlEncode(Strings.STS.L_SharingNotificationEmptyText);if(f)parent.postMessage("success:"+a,"*");else{var g=new SPStatusNotificationData("",a,i,null),j=new SP.UI.Notify.Notification(SPNotifications.ContainerID.Status,STSHtmlEncode(h),false,null,null,g,"assertive");window.setTimeout(function(){j.Show(false)},200)}}var cGCMinimumWidth,cGCMinimumHeight,cGCMaxGCResizeCount,glGCObjectHeight,glGCObjectWidth,glGCResizeCounter;function GCComputeSizing(e){if(TestGCObject(e)){var g=document.documentElement.currentStyle.direction=="rtl",h=typeof document.compatMode!="undefined"&&document.compatMode=="BackCompat",d=h?document.documentElement.scrollWidth:document.documentElement.clientWidth,f=h?document.documentElement.scrollHeight:document.documentElement.clientHeight,b=0,c=0;if(g){b=-180;c=120}else{b=32;c=-2}var a=e.parentNode;while(a!=document.body){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent;if(a==null)break;if(g)if(a.offsetLeft>0)break}b+=e.parentNode.offsetLeft;c+=e.parentNode.offsetTop;glGCObjectHeight=f-c;if(glGCObjectHeight>f)glGCObjectHeight=f;if(glGCObjectHeight<cGCMinimumHeight)glGCObjectHeight=cGCMinimumHeight;if(g)glGCObjectWidth=d+b;else glGCObjectWidth=d-b;if(glGCObjectWidth>d)glGCObjectWidth=d;if(glGCObjectWidth<cGCMinimumWidth)glGCObjectWidth=cGCMinimumWidth}}function GCResizeGridControl(a){if(TestGCObject(a)){var c=glGCObjectHeight,b=glGCObjectWidth;GCComputeSizing(a);if(c!=glGCObjectHeight)a.height=String(glGCObjectHeight);if(b!=glGCObjectWidth)a.width=String(glGCObjectWidth)}}function GCWindowResize(a){if(TestGCObject(a)){glGCResizeCounter=0;GCResizeGridControl(a)}}function GCOnResizeGridControl(a){if(TestGCObject(a))if(glGCResizeCounter<cGCMaxGCResizeCount){glGCResizeCounter++;GCResizeGridControl(a)}}function _GCActivateAndFocus(a){if(TestGCObject(a)){typeof a.SetActive!="undefined"&&a.SetActive();typeof a.Focus!="undefined"&&a.Focus()}}function _GCNavigateToNonGridPage(){var c,a=window.location.href,e=a.match(new RegExp("ShowInGrid="));if(null!=e){c=/ShowInGrid=\w*/;a=a.replace(c,"")}var b=a.indexOf("?");if(b!=-1){var d=a.indexOf("?",b+1);if(d!=-1)a=a.slice(0,d);a=a+"&"}else a=a+"?";a=a+"ShowInGrid=False";window.location.replace(STSPageUrlValidation(a))}function GCAddNewColumn(a,b){if(TestGCObject(a)){var h=window.location.href,e=typeof a.Name!="undefined"?a.Name:"",g=typeof a.SelectedColumnUniqueName!="undefined"?a.SelectedColumnUniqueName:"",i=typeof a.RightToLeft!="undefined"?a.RightToLeft:"",f=typeof a.ViewGUID!="undefined"?a.ViewGUID:"",d=typeof a.ServerTemplate!="undefined"?a.ServerTemplate:"",c="FldNew.aspx";if(d=="102")c="QstNew.aspx";b=b+"/_layouts/15/"+c+"?List="+e+"&View="+f+"&Source="+h+"&RelativeToField="+g+"&LTR="+i;window.location.href=b}}function GCEditDeleteColumn(a,b){if(TestGCObject(a)){var g=window.location.href,e=typeof a.Name!="undefined"?a.Name:"",f=typeof a.SelectedColumnUniqueName!="undefined"?a.SelectedColumnUniqueName:"",d=typeof a.ServerTemplate!="undefined"?a.ServerTemplate:"",c="FldEdit.aspx";if(d=="102")c="QstEdit.aspx";b=b+"/_layouts/15/"+c+"?List="+e+"&Field="+f+"&Source="+g;window.location.href=b}}var objGCGlobal;function GCShowTaskPane(){if(objGCGlobal!=null){objGCGlobal.DisplayTaskPane=true;objGCGlobal=null}}function GCShowHideTaskPane(a){if(TestGCObject(a))if(typeof a.DisplayTaskPane!=undefined){var b=a.DisplayTaskPane;a.DisplayTaskPane=!b;if(!b){objGCGlobal=a;window.setTimeout("GCShowTaskPane()",5)}}}function GCShowHideTotalsRow(a){if(TestGCObject(a))if(typeof a.DisplaySheetTotals!="undefined"){var b=a.DisplaySheetTotals;a.DisplaySheetTotals=!b}}function GCGridNewRow(a){if(TestGCObject(a))typeof a.SelectNewRow!="undefined"&&a.SelectNewRow()}function GCRefresh(a){if(TestGCObject(a))typeof a.Refresh!="undefined"&&a.Refresh()}function GCNewFolder(a){if(TestGCObject(a))typeof a.NewFolder!="undefined"&&a.NewFolder()}var isNewEcb,isDocLibContextMenu;function checkNewEcbFlights(a){isNewEcb=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(249);isDocLibContextMenu=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(383)&&SPThemeUtils.UseClientSideTheming();if(isDocLibContextMenu)isNewEcb=isDocLibContextMenu;if(a!=null)if(!Boolean(a.isClientRendering)&&a.ListData==null){isNewEcb=false;isDocLibContextMenu=false}}var WSS_MENUITEMSEQUENCE_REPLY,WSS_MENUITEMSEQUENCE_VIEWPROPERTIES,WSS_MENUITEMSEQUENCE_EDITPROPERTIES,WSS_MENUITEMSEQUENCE_EDITSERIESITEM,WSS_MENUITEMSEQUENCE_EDITINOIS,WSS_MENUITEMSEQUENCE_EDITINAPPLICATION,WSS_MENUITEMSEQUENCE_OPENFOLDER,WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT,WSS_MENUITEMSEQUENCE_DISCARDCHECKOU,WSS_MENUITEMSEQUENCE_PUBLISHITEM,WSS_MENUITEMSEQUENCE_CANCELPUBLISH,WSS_MENUITEMSEQUENCE_EXPORTCONTACT,WSS_MENUITEMSEQUENCE_SENDMENU,WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM,WSS_MENUITEMSEQUENCE_DOCTRANMENU,WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL,WSS_MENUITEMSEQUENCE_VERSIONS,WSS_MENUITEMSEQUENCE_MODERATEITEM,WSS_MENUITEMSEQUENCE_WORKFLOWS,WSS_MENUITEMSEQUENCE_ADDTOMYLINKS,WSS_MENUITEMSEQUENCE_ADDTOCATEGORY,WSS_MENUITEMSEQUENCE_SUBSCRIBE,WSS_MENUITEMSEQUENCE_DISCUSS,WSS_MENUITEMSEQUENCE_PUBLISHBACK,WSS_MENUITEMSEQUENCE_CREATEDWS,WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS,WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON,WSS_MENUITEMSEQUENCE_DELETEITEM,WSS_MENUITEMSEQUENCE_DELETEDOCITEM,WSS_MENUITEMSEQUENCE_MOVECOPYITEM,WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION,WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION,WSS_MENUITEMSEQUENCE_UPGRADESOLUTION,WSS_MENUITEMSEQUENCE_ENCRYPTITEM,WSS_MENUITEMSEQUENCE_EDITINBROWSER,WSS_MENUITEMSEQUENCE_OPENSEP,WSS_MENUITEMSEQUENCE_GETLINK,WSS_MENUITEMSEQUENCE_DOWNLOADACOPY,WSS_MENUITEMSEQUENCE_SHARE,WSS_MENUITEMSEQUENCE_ACTIONSEP,WSS_MENUITEMSEQUENCE_ADVANCEDSEP,WSS_MENUITEMSEQUENCE_ADVANCED,WSS_MENUITEMSEQUENCE_COPY;function setNewEcbCmdSequence(){if(isNewEcb){WSS_MENUITEMSEQUENCE_EDITINOIS=100;WSS_MENUITEMSEQUENCE_EDITINAPPLICATION=110;WSS_MENUITEMSEQUENCE_EDITINBROWSER=115;WSS_MENUITEMSEQUENCE_OPENFOLDER=116;WSS_MENUITEMSEQUENCE_OPENSEP=120;WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL=200;WSS_MENUITEMSEQUENCE_DOWNLOADACOPY=210;WSS_MENUITEMSEQUENCE_SHARE=300;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(251)){WSS_MENUITEMSEQUENCE_SHARE=200;WSS_MENUITEMSEQUENCE_DOWNLOADORIGINAL=300;WSS_MENUITEMSEQUENCE_DOWNLOADACOPY=310}WSS_MENUITEMSEQUENCE_GETLINK=315;WSS_MENUITEMSEQUENCE_ACTIONSEP=320;WSS_MENUITEMSEQUENCE_EDITPROPERTIES=400;WSS_MENUITEMSEQUENCE_DELETEITEM=500;WSS_MENUITEMSEQUENCE_DELETEDOCITEM=510;WSS_MENUITEMSEQUENCE_COPY=550;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(329))WSS_MENUITEMSEQUENCE_MOVECOPYITEM=560;WSS_MENUITEMSEQUENCE_VERSIONS=600;WSS_MENUITEMSEQUENCE_VIEWPROPERTIES=650;WSS_MENUITEMSEQUENCE_ADVANCEDSEP=690;WSS_MENUITEMSEQUENCE_ADVANCED=700;WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS=800;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(252))WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS=650;WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT=1e3;WSS_MENUITEMSEQUENCE_REPLY=1100;WSS_MENUITEMSEQUENCE_EDITSERIESITEM=1230;WSS_MENUITEMSEQUENCE_DISCARDCHECKOU=1310;WSS_MENUITEMSEQUENCE_PUBLISHITEM=1320;WSS_MENUITEMSEQUENCE_CANCELPUBLISH=1330;WSS_MENUITEMSEQUENCE_EXPORTCONTACT=1350;WSS_MENUITEMSEQUENCE_SENDMENU=1400;WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM=1440;WSS_MENUITEMSEQUENCE_DOCTRANMENU=1500;WSS_MENUITEMSEQUENCE_MODERATEITEM=1850;WSS_MENUITEMSEQUENCE_WORKFLOWS=1900;WSS_MENUITEMSEQUENCE_ADDTOMYLINKS=11e3;WSS_MENUITEMSEQUENCE_ADDTOCATEGORY=11050;WSS_MENUITEMSEQUENCE_SUBSCRIBE=11100;WSS_MENUITEMSEQUENCE_DISCUSS=11130;WSS_MENUITEMSEQUENCE_PUBLISHBACK=11140;WSS_MENUITEMSEQUENCE_CREATEDWS=11140;WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON=11170;WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION=11210;WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION=11220;WSS_MENUITEMSEQUENCE_UPGRADESOLUTION=11230}}var g_menuLaunchPoint;function CUIInfo(a,c,b){a.CUICommand=c;a.CUIEnabledCommands=b}function resetExecutionState(){IsMenuShown=false;itemTable=null;imageCell=null;onKeyPress=false;currentCtx=null;currentEditMenu=null;currentItemID=null;downArrowText=null;resetItemGlobals()}function resetItemGlobals(){currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;currentItemOpenApp=null;currentItemCanModify=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null;currentItemIsMountPoint=null}var ecbManager;function IsMenuEnabled(){return browseris.ie55up||browseris.nav6up||browseris.safari125up}function setupMenuContext(a){currentCtx=a}function setupMenuContextName(strCtx){var lctx;try{eval("lctx = "+strCtx+";")}catch(e){eval("lctx = g_ctxDict['"+strCtx+"'];")}setupMenuContext(lctx)}function isFolderObj(a){return Boolean(a)&&a.FSObjType==="1"&&a["File_x0020_Type.mapapp"]==""}function hasFolderSelected(b){var a;for(a in b.dictSel){var d=GetTrFromIID(a),c=GetListItemDataFromTr(d);if(isFolderObj(c))return true}return false}function OnLinkDeferCall(a){if(!IsMenuEnabled())return false;a.onfocusout=OutItem;a.onkeydown=PopMenu;var b=FindSTSMenuTable(a,"CTXName");if(b==null)return false;OnItem(b);return false}function StartDeferItem(a){if(a!=itemTable){itemTableDeferred=a;var c=a.tagName=="TABLE";if(c){a.onmouseout=EndDeferItem;a.onclick=DeferredOnItem;a.oncontextmenu=DeferredOnItem}else{var b=a.parentNode;if(b.getAttribute("IsCallout")!="TRUE"){b.onmouseout=EndDeferItem;b.oncontextmenu=DeferredOnItem}}}}function IsAjaxMenu(d){var a=d.getAttribute("eventtype");if(a!=null&&(a==5||a==3||a==4))return false;var c=d.className;if(c!=null&&c.length>0){var b=c.split(" ");if(b!=null&&b.length>1&&b[b.length-1]=="itx")return true}return false}function DeferredOnItem(b){var a=itemTableDeferred;if(a!=null){MenuHtc_hide();OnItem(a);if(IsAjaxMenu(a))CreateAjaxMenu(b);else CreateMenu(b);return false}return undefined}function EndDeferItem(){var a=itemTableDeferred;if(a!=null){itemTableDeferred=null;var c=a.tagName=="TABLE";if(c){a.onmouseout=null;a.onclick=null;a.oncontextmenu=null}else{var b=a.parentNode;b.onmouseout=null;b.onclick=null;b.oncontextmenu=null}}}function GetLastChildElement(b){for(var a=b.childNodes.length-1;a>=0;a--)if(b.childNodes[a].nodeType==1)return b.childNodes[a];return null}function CreateHiddenCtxMenu(b,a){return List_CreateCtxImg_Helper(b,a,false)}function CreateCtxImg(b,a){return List_CreateCtxImg_Helper(b,a,true)}function IsInCtxImg(a){while(a!=null&&a.tagName!="TD"&&a.tagName!="BODY"&&a.className.indexOf("s4-ctx")==-1)a=a.parentNode;return a!=null&&a.className.indexOf("s4-ctx")!=-1?a:null}function OnItemDeferCall(h){if(!IsMenuEnabled())return false;if(IsMenuOn()){StartDeferItem(h);return false}if(itemTable==h)return undefined;itemTable!=null&&OutItem();itemTable=h;currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");var c=itemTable.tagName=="TABLE",k=new Function("setupMenuContextName('"+itemTable.getAttribute("CTXName")+"');");k();var g=currentCtx,j=IsAjaxMenu(itemTable);if(c){if(browseris.nav6up)itemTable.className="ms-selectedtitlealternative";else itemTable.className="ms-selectedtitle";if(j)itemTable.className=itemTable.className+" itx"}var a=itemTable.parentNode;while(a.tagName!="TD"&&a.tagName!="BODY")a=a.parentNode;var b=null;if(!c)if(g.IsClientRendering!=true)b=CreateCtxImg(a,OutItem);var d=j?CreateAjaxMenu:CreateMenu;if(c){itemTable.onclick=d;itemTable.oncontextmenu=d}else{var i=false;if(b!=null)if(b.onclick==null)b.onclick=d;else i=true;if(!i)a.oncontextmenu=d;else if(b!=null)a.oncontextmenu=b.onclick}if(c)itemTable.onmouseout=OutItem;else if(a.getAttribute("IsECB")!="TRUE"||itemTable.onmouseover!=null)a.onmouseout=OutItem;if(c){var f;f=GetFirstChildElement(GetFirstChildElement(itemTable));if(f!=null)imageCell=GetLastChildElement(f);if(g.listTemplate==200){if(itemTable.getAttribute("menuType")=="Orphaned")downArrowText=Strings.STS.L_Reschedule_Text}else downArrowText=Strings.STS.L_Edit_Text;var e=GetFirstChildElement(imageCell);e.src=g.imagesPath+"menudark.gif";e.alt=downArrowText;e.style.visibility="visible";imageCell.className="ms-menuimagecell"}return false}function OutItem(b){var a=null;if(b!=null&&typeof b.callOut!="undefined"&&Boolean(b.callOut)&&typeof ecbManager!="undefined"&&typeof ecbManager.callOutPar!="undefined"&&ecbManager.callOutPar!=null)a=ecbManager.callOutPar;if(!IsMenuOn()&&(itemTable!=null||a!=null)){var d=itemTable!=null&&itemTable.tagName=="TABLE";if(d){if(IsAjaxMenu(itemTable))itemTable.className="ms-unselectedtitle itx";else itemTable.className="ms-unselectedtitle";itemTable.onclick=null;itemTable.oncontextmenu=null;itemTable.onmouseout=null}else{if(a==null)a=GetAncestorByTagNames(itemTable,["TD","TH"]);if(a!=null&&a.getAttribute!=null&&a.getAttribute("IsCallout")=="TRUE")if(typeof CalloutManager==="object"&&typeof calloutManager!="undefined"&&typeof calloutManager.containsOneCalloutOpen=="function"&&calloutManager.containsOneCalloutOpen(a)){ecbManager.callOutPar=a;return true}var c=null;if(b==null)b=window.event;if(b!=null){c=typeof b.toElement!="undefined"&&b.toElement!=null?b.toElement:b.relatedTarget;if(a!=null&&c!=null&&IsContained(c,a))return true}if(a!=null){a.onclick=null;a.oncontextmenu=null;a.onmouseout=null;RemoveCtxImg(a)}}if(d&&imageCell!=null){GetFirstChildElement(imageCell).style.visibility="hidden";imageCell.className=""}resetExecutionState()}return undefined}function IsMenuOn(){if(!IsMenuShown)return false;var a=false;if(isDocLibContextMenu)a=ContextMenu.IsOpen();else a=MenuHtc_isOpen(currentEditMenu);if(!a)IsMenuShown=false;return a}function _PopMenuFromChevron(a){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortStart);if(a==null)a=window.event;var g=Boolean(a.srcElement)?a.srcElement:a.target;if(a!=null)if(Boolean(a.target))g_menuLaunchPoint=a.target;else if(Boolean(a.srcElement))g_menuLaunchPoint=a.srcElement;if(g_menuLaunchPoint!=null){while(g_menuLaunchPoint.tagName!="A"&&g_menuLaunchPoint.tagName!="BODY")g_menuLaunchPoint=g_menuLaunchPoint.parentNode;g_menuLaunchPoint.setAttribute("aria-expanded","true")}var c=g.parentNode;while(c.tagName!="TD"&&c.tagName!="TH"&&c.tagName!="BODY")c=c.parentNode;var d,b;if(c.tagName=="TD"){d=c.getElementsByTagName("DIV");var f=null;for(b=0;b<d.length;b++)if(d[b].getAttribute("CtxNum")!=null)f=d[b];f!=null&&OnItemDeferCall(f)}else if(c.tagName=="TH"){d=c.getElementsByTagName("DIV");var e=null;for(b=0;b<d.length;b++)if(d[b].getAttribute("CtxNum")!=null)e=d[b];e!=null&&OnMouseOverFilterDeferCall(e)}IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortEnd);return false}function PopMenu(a){checkNewEcbFlights(null);setNewEcbCmdSequence();if(!IsMenuEnabled())return true;if(a==null)a=window.event;var b;if(a==null)return true;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){onKeyPress=true;var d=Boolean(a.srcElement)?a.srcElement:a.target,c=FindSTSMenuTable(d,"CTXName");if(c==null)return false;OnItemDeferCall(c);if(IsAjaxMenu(c))CreateAjaxMenu(a);else CreateMenu(a);onKeyPress=false;return false}else return true}function CreateMenuEx(g,a,e,h){checkNewEcbFlights(g);setNewEcbCmdSequence();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickStart);if(a==null)return undefined;IsMenuShown=true;document.body.onclick=null;resetItemGlobals();var d;d=BuildMenu(g,e);d.setAttribute("hideicons","true");currentEditMenu=d;if(!isDocLibContextMenu){a.onmouseout=null;var b=null,c=null;if(a.tagName=="SPAN"&&HasCssClass(a,"js-callout-ecbMenu"))b=a;else if(a.tagName=="BUTTON"&&HasCssClass(a,"js-qcb-button"))b=a;else{c=FindCtxImg(a);if(c==null){b=GetAncestorByTagNames(a,["TD","TR"]);if(b==null)b=a;else c=FindCtxImg(a)}}c!=null&&typeof c.shown=="boolean"&&c.shown==false&&ShowCtxImg(c,true,b);OMenu(d,b,null,h,-1,false,false,e);if(itemTable!=null&&itemTable.tagName!="DIV"){var f=itemTable.getAttribute("CTXName");if(f==undefined||f=="")itemTable=GetSelectedElement(a,"TABLE","DIV")}if(b.tagName=="TD")b.onclick=SingleItemSelect;d._onDestroy=OutItem;if(e!=null)e.cancelBubble=true;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickEnd)}return false}function BuildMenuWithInit(b){resetItemGlobals();setDocType();currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");currentItemCheckedOutUserId=typeof itemTable.COUId=="string"?itemTable.COUId:null;currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");var a=isDocLibContextMenu;isDocLibContextMenu=false;var c=BuildMenu(b);isDocLibContextMenu=a;return c}function BuildMenu(a,f){var b=null,e=null,c=null,d=null;if(isDocLibContextMenu)c={evt:{clientX:Boolean(f)?f.clientX:0,clientY:Boolean(f)?f.clientY:0},items:[]};else{b=CMenu(currentItemID+"_menu");if(b==null)return null}if(a!=null&&a.listBaseType==1)_WriteDocEngagement("DocLibECB_Open","OneDrive_DocLibECB_Open");else _WriteDocEngagement("ECB_Open","OneDrive_ECB_Open");if(isNewEcb)if(isDocLibContextMenu)d={seq:String(WSS_MENUITEMSEQUENCE_ADVANCED),id:"ID_AdvancedMenu",text:Strings.STS.L_Advanced_Text,submenu:true,glyph:"&#62",items:[]};else e=CreateAdvancedMenu(b,a);if(Boolean(a.isVersions))AddVersionMenuItems(b,a);else if(a.listTemplate==121)AddSolutionsCatalogMenuItems(b,e,a,c,d);else if(a.listBaseType==1)AddDocLibMenuItems(b,e,a,c,d);else if(a.listTemplate==200)AddMeetingMenuItems(b,e,a,c,d);else AddListMenuItems(b,e,a,c,d);InsertFeatureMenuItems(b,e,a,c,d);if(isDocLibContextMenu){AddSubMenu(c,d);AddLoggingToContextMenuDef(c,a);AddSeparators(b,a,c,d);var g=new ContextMenu(c);g.open();return g.root()}else{if(isNewEcb){AddSeparators(b,a);CleanupAdvancedMenu(b,e,a)}AddLogging(b,a);SP.SOD.notifyEventAndExecuteWaitingJobs("CleanupContextMenu",[b,a]);return b}}function IsOneDrive(a){return a!=null&&(Boolean(a.RealSiteTemplateId)?a.RealSiteTemplateId===21:a.SiteTemplateId===21)}function CreateAdvancedMenu(b){var a=CASubM(b,Strings.STS.L_Advanced_Text,"","",String(WSS_MENUITEMSEQUENCE_ADVANCED));a.IsSubMenu=true;a.id="ID_AdvancedMenu";return a}function CleanupAdvancedMenu(d,b){for(var a=[],c=0;c<b.childNodes.length;c++)b.childNodes[c].style.display.indexOf("none")==-1&&a.push(b.childNodes[c]);if(a.length<2)b.style.display="none";a.length==1&&AChld(d,a[0])}function AddSeparators(b,c,a){if(isDocLibContextMenu)InsertSeparatorToContextMenuDefinition(a.items,String(WSS_MENUITEMSEQUENCE_OPENSEP));else CIMSep(b,String(WSS_MENUITEMSEQUENCE_OPENSEP));if(currentItemFSObjType!="1"||!Boolean(c.RealHttpRoot))if(isDocLibContextMenu)InsertSeparatorToContextMenuDefinition(a.items,String(WSS_MENUITEMSEQUENCE_ACTIONSEP));else CIMSep(b,String(WSS_MENUITEMSEQUENCE_ACTIONSEP));if(currentItemFSObjType=="1"||!Boolean(c.RealHttpRoot))if(isDocLibContextMenu)InsertSeparatorToContextMenuDefinition(a.items,String(WSS_MENUITEMSEQUENCE_ADVANCEDSEP));else CIMSep(b,String(WSS_MENUITEMSEQUENCE_ADVANCEDSEP))}function AddLogging(b,c){for(var a=0;a<b.childNodes.length;a++)AddLoggingHelper(b.childNodes[a],c)}function AddLoggingToContextMenuDef(b,d){for(var a=0;a<b.items.length;a++)if(Boolean(b.items[a].submenu))for(var c=0;c<b.items[a].items.length;c++)AddLoggingHelper(b.items[a].items[c],d);else AddLoggingHelper(b.items[a],d)}function AddLoggingHelper(a,f){if(!Boolean(a)||!Boolean(a.id))return;var d=Boolean(isDocLibContextMenu)?a.onclick:a.getAttribute("onmenuclick"),c=a.id.replace(/[^a-zA-Z0-9_\-]/gi,"_"),b,e="";if(a.id.indexOf("ID_CA_")!=-1){e=c;c="CustomAction"}if(f!=null&&f.listBaseType==1)b="_WriteDocEngagement('DocLibECB_Click_"+c+"', 'OneDrive_DocLibECB_Click_"+c;else b="_WriteDocEngagement('ECB_Click_"+c+"', 'OneDrive_ECB_Click_"+c;if(Boolean(e))b+="', { CustomAction : '"+e+"'});";else b+="');";if(d!=null)if(isDocLibContextMenu)if(browseris.ie||browseris.chrome)a.onclick=new Function(b+d);else a.onclick=new Function("event",b+d);else a.setAttribute("onmenuclick",b+d)}function isInvalidAjaxMenuElement(a){var b=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(162);checkNewEcbFlights(currentCtx);return a===null||typeof a==="undefined"||onKeyPress==false&&IsInCtxImg(a)==null&&a.className.indexOf("js-callout-action")===-1&&a.className.indexOf("ms-lstItmLinkAnchor")===-1&&!b&&(!isNewEcb||!Boolean(currentCtx)||!Boolean(currentCtx.listBaseType==1))&&(a.tagName=="A"||Boolean(a.parentNode.tagName=="A"))}var ecbItems;function CreateMenu(a,b,c){if(!IsContextSet())return undefined;var f=currentCtx;if(a==null)a=window.event;var e=GetElementByClassName(document.body,"ms-listviewtable");if(!Boolean(e))isDocLibContextMenu=false;var d=a.srcElement!=null?a.srcElement:a.target;if(itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null||onKeyPress==false&&IsInCtxImg(d)==null&&(d.tagName=="A"||d.parentNode.tagName=="A"))return undefined;if(typeof b=="number"&&typeof c=="number"&&b>=0&&c>=0){a={};a.clientX=b;a.clientY=c}return CreateMenuEx(f,itemTable,a)}function AddSendSubMenu(k,r,a,p,q){var y=Boolean(a.CurrentSelectedItems>1),l=[];l.Copy=Strings.STS.L_SubmitFileCopyWarning_Text;l.Move=Strings.STS.L_SubmitFileMoveWarning_Text;l.Link=Strings.STS.L_SubmitFileLinkWarning_Text;var d=Strings.STS.L_Send_Text,C=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),f,n,i;if(currentItemFileUrl!=null){n=unescapeProperly(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("587EBAE9-3F96-405E-B02F-E1BE9A756777"))&&ShouldCallEncodeURIComponent()){f=encodeURIComponent(currentItemFileUrl);f=encodeScriptQuote(f)}else f=escapeProperly(n);i=SzExtension(n);if(i!=null&&i!="")i=i.toLowerCase()}var u=itemTable.getAttribute("SRed"),x=itemTable.getAttribute("DefaultIO");if(x=="0"&&!HasRights(0,32))x="1";var t=currentItemProgId!="SharePoint.WebPartPage.Document"&&!Boolean(a.RealHttpRoot)&&HasDownloadRights(u)&&i!="aspx",s=currentItemFSObjType!="1"&&a.listBaseType==1&&HasDownloadRights(u);if(!t&&!s)return;if(!isDocLibContextMenu){var e=null;if(!Boolean(a.RealHttpRoot)){e=CASubM(k,d,"","",String(WSS_MENUITEMSEQUENCE_SENDMENU));CUIInfo(e,"SendTo",["SendTo","PopulateSendToMenu"]);e.IsSubMenu=true;e.id="ID_Send";e.style.display="none"}var c;if(t){if(typeof a.SendToLocationName!="undefined"&&a.SendToLocationName!=null&&a.SendToLocationName!=""&&typeof a.SendToLocationUrl!="undefined"&&a.SendToLocationUrl!=null&&a.SendToLocationUrl!=""){var b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+f+"&FldUrl="+escapeProperly(a.SendToLocationUrl);b=AddSourceToUrl(b)+"')";c=CAMOpt(e,a.SendToLocationName,b,"");CUIInfo(c,"SendToRecommendedLocation",["SendToRecommendedLocation"])}if(typeof itemTable.getAttribute("HCD")!="undefined"&&itemTable.getAttribute("HCD")=="1"){d=Strings.STS.L_ExistingCopies_Text;b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/updatecopies.aspx?SourceUrl="+f;b=AddSourceToUrl(b)+"')";var g=a.imagesPath+"existingLocations.gif";c=CIMOpt(e,d,b,g);c.id="ID_ExistingCopies";CUIInfo(c,"SendToExistingCopies",["SendToExistingCopies"])}}}if(!Boolean(a.RealHttpRoot)){if(isNewEcb&&!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(329)&&a.listTemplate==700)AddMoveCopyMenuItem(k,r,a,p,q);else if(!y&&!hasFolderSelected(a)){d=Strings.STS.L_OtherLocation_Text;if(isNewEcb)d=Strings.STS.L_Copy_Text;b="NavigateToSendToOtherLocationV4(event, '"+a.HttpRoot+"/_layouts/15/copy.aspx?SourceUrl="+f;b=AddSourceToUrl(b)+"')";g=a.imagesPath+"sendOtherLoc.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(p,q,"ID_OtherLocation",d,b,g,String(WSS_MENUITEMSEQUENCE_COPY));else{if(isNewEcb)c=InsertMenuOption(k,r,d,b,g,String(WSS_MENUITEMSEQUENCE_COPY));else c=CAMOpt(e,d,b,g);c.id="ID_OtherLocation";CUIInfo(c,"SendToOtherLocation",["SendToOtherLocation"])}if(typeof a.OfficialFileNames=="string"&&a.OfficialFileNames!=""){var o=a.OfficialFileNames.split("__HOSTSEPARATOR__");if(o!=null)for(var m=0;m<o.length;m++){var B=o[m],j=B.split(",");d=j[0];var A=0,z="Copy";if(j.length==3){d=j[0].replace(/%2c/g,",").replace(/%25/g,"%");A=j[1];z=j[2]}b='if(confirm("'+StBuildParam(l[z],STSScriptEncode(d))+"\")!=0) SubmitFormPost('"+a.HttpRoot+"/_layouts/15/SendToOfficialFile.aspx?ID="+escapeProperly(d)+"&Index="+String(A)+"&SourceUrl="+f;b=AddSourceToUrl(b)+"')";g="";c=CAMOpt(e,d,b,g);var w="SendToOfficialFile"+String(m);CUIInfo(c,w,[w])}}}!isNewEcb&&CAMSep(e)}if(s&&!y){var h=a;if(h.listTemplate!=119){Boolean(e)&&AddWorkspaceMenuItem(e,null,h);var v=null;if(Boolean(h.RealHttpRoot)&&(v=ListModule.Util.makeMountedFolderQueryStrParams(false,false))!=null)b="Nav.navigate('"+h.RealHttpRoot+"/_layouts/15/download.aspx?SourceUrl="+f+v+"&FldUrl="+escapeProperly(h.SendToLocationUrl);else b="Nav.navigate('"+h.HttpRoot+"/_layouts/15/download.aspx?SourceUrl="+f+"&FldUrl="+escapeProperly(h.SendToLocationUrl);b=AddSourceToUrl(b)+"'); if (typeof CalloutManager !== 'undefined' && Boolean(CalloutManager) && Boolean(CalloutManager.closeAll)) CalloutManager.closeAll()";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(p,q,"ID_DownloadACopy",Strings.STS.L_Download_Text,b,"",String(WSS_MENUITEMSEQUENCE_DOWNLOADACOPY));else{if(isNewEcb)c=InsertMenuOption(k,r,Strings.STS.L_Download_Text,b,"",String(WSS_MENUITEMSEQUENCE_DOWNLOADACOPY));else c=CAMOpt(k,Strings.STS.L_DownloadACopy_Text,b,"");CUIInfo(c,"DownloadCopy",["DownloadCopy"]);c.id="ID_DownloadACopy"}}}}function AddDocTransformSubMenu(m,k){if(typeof rgDocTransformers=="undefined"||rgDocTransformers==null)return;var n=rgDocTransformers,b=null,c=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),e;if(currentItemFileUrl!=null)e=escapeProperly(unescapeProperly(currentItemFileUrl));var h=c.lastIndexOf(".");if(h>0)for(var j=c.substring(h+1,c.length).toLowerCase(),f=false,a=0;a<rgDocTransformers.length;a++)if(rgDocTransformers[a].ConvertFrom==j){var g=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),l=new RegExp("/|"+g+"|/");if(g!=null&&!l.test(rgDocTransformers[a].ExcludedContentTypes)){if(!f){b=CASubM(m,Strings.STS.L_DocTran_Text,ctx.imagesPath+"ConvertDocument.gif",Strings.STS.L_DocTran_Text,String(WSS_MENUITEMSEQUENCE_DOCTRANMENU));b.IsSubMenu=true;b.Id="ID_ConvertDocument";f=true}var d="Nav.navigate('"+k.HttpRoot+"/_layouts/15/"+escapeProperlyCore(rgDocTransformers[a].TransformUIPage,true)+"?FileName="+e+"&TID="+rgDocTransformers[a].Id;d=AddSourceToUrl(d)+"')";var i;i=CAMOpt(b,rgDocTransformers[a].Name,d,"");i.Id="ID_Transform"+rgDocTransformers[a].Id}}}function AddMeetingMenuItems(f,j,e,h,i){if(itemTable.getAttribute("menuType")=="Orphaned"){var d,g=GetAttributeFromItemTable(itemTable,"ItemId","Id"),a=Strings.STS.L_Move_Text,c="GoToMtgMove('"+e.listUrlDir+"',"+g+",'"+itemTable.getAttribute("DateTime")+"','"+itemTable.getAttribute("DateTimeISO")+"')",b="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Move",a,c,b);else{if(isNewEcb)d=InsertMenuOption(f,j,a,c,b);else d=CAMOpt(f,a,c,b);d.id="ID_Move"}a=Strings.STS.L_Keep_Text;c="MtgKeep('"+e.HttpPath+"','"+e.listName+"',"+g+")";b="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Keep",a,c,b);else{if(isNewEcb)d=InsertMenuOption(f,j,a,c,b);else d=CAMOpt(f,a,c,b);d.id="ID_Keep"}a=Strings.STS.L_Delete_Text;c="MtgDelete('"+e.HttpPath+"','"+e.listName+"',"+g+")";b=e.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Delete",a,c,b);else{if(isNewEcb)d=InsertMenuOption(f,j,a,c,b);else d=CAMOpt(f,a,c,b);d.id="ID_Delete"}}}function AddListMenuItems(f,i,b,g,h){if(typeof Custom_AddListMenuItems!="undefined")if(Custom_AddListMenuItems(f,b))return;if(currentItemFileUrl==null){currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");UpdateRibbonUrl()}var j;if(currentItemFileUrl!=null)if(ShouldCallEncodeURIComponent()){j=encodeURIComponent(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("2AE13CDE-8329-47B8-AA4B-4AE3B97AC677")))j=j.replace(/'/g,"\\u0027")}else j=escapeProperly(unescapeProperly(currentItemFileUrl));var n=currentItemID;if(currentItemIsEventsExcp==null){currentItemIsEventsExcp=false;currentItemIsEventsDeletedExcp=false;currentItemEvtType=parseInt(itemTable.getAttribute("EventType"));if(currentItemEvtType!=null&&(currentItemEvtType==2||currentItemEvtType==3||currentItemEvtType==4)){currentItemIsEventsExcp=true;if(currentItemEvtType==3)currentItemIsEventsDeletedExcp=true;if(currentItemID.indexOf(".")!=-1)n=currentItemID.split(".")[0]}}var e,a,d;if(b.listBaseType==3&&b.listTemplate==108){var c=Strings.STS.L_Reply_Text;if(itemTable.getAttribute("Ordering").length>=504)a="alert('"+Strings.STS.L_ReplyLimitMsg_Text+"')";else{a="Nav.navigate('"+b.newFormUrl+"&Threading="+escapeProperly(itemTable.getAttribute("Ordering"))+"&Guid="+escapeProperly(itemTable.getAttribute("ThreadID"))+"&Subject="+escapeProperly(itemTable.getAttribute("Subject"));a=AddSourceToUrl(a)+"')"}d=b.imagesPath+"reply.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Reply",c,a,d,String(WSS_MENUITEMSEQUENCE_REPLY));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_REPLY));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_REPLY));e.id="ID_Reply"}}AddSharedNamespaceMenuItems(f,i,b,g,h);var m=itemTable.getAttribute("CId");if(m!=null&&m.indexOf("0x0106")==0&&HasRights(16,0)){c=Strings.STS.L_ExportContact_Text;a="Nav.navigate('"+b.HttpPath+"&Cmd=Display&CacheControl=1&List="+b.listName+"&ID="+currentItemID+"&Using="+escapeProperly(b.listUrlDir)+"/vcard.vcf')";d=b.imagesPath+"exptitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_ExportContact",c,a,d,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_EXPORTCONTACT));CUIInfo(e,"ExportContact",["ExportContact"]);e.id="ID_ExportContact"}}!isNewEcb&&CAMSep(f);b.verEnabled==1&&AddVersionsMenuItem(f,i,b,j,g,h);if(HasRights(0,4)&&b.isModerated==true&&HasRights(0,16)&&HasRights(0,135168)&&b.listBaseType!=4&&currentItemID.indexOf(".0.")<0){c=Strings.STS.L_ModerateItem_Text;a="NavigateToApproveRejectAspx(event, '"+b.HttpRoot+"/_layouts/15/approve.aspx?List="+b.listName+"&ID="+n;a=AddSourceToUrl(a)+"')";d=b.imagesPath+"apprj.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_ModerateItem",c,a,d,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));CUIInfo(e,"Moderate",["Moderate"]);e.id="ID_ModerateItem"}}!isNewEcb&&CAMSep(f);var k=Number(b.SiteTemplateId)===64&&Number(b.listTemplate)===100&&(window.OffSwitch==null||OffSwitch.IsActive("E5476C60-BE39-4AD0-B185-AB24370E049E"));!k&&AddWorkflowsMenuItem(f,i,b,g,h);var l=typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled;if(currentItemID.indexOf(".0.")<0&&HasRights(128,0)&&!b.ExternalDataList&&l&&!currentItemIsMountPoint&&!k){c=Strings.STS.L_Subscribe_Text;a="NavigateToSubNewAspxV4(event, '"+b.HttpRoot+"', 'List="+b.listName+"&ID="+currentItemID+"')";d="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Subscribe",c,a,d,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));e.id="ID_Subscribe";CUIInfo(e,"Subscribe",["Subscribe"])}}if(l||!b.ExternalDataList&&HasRights(0,4))!isNewEcb&&CAMSep(f);!k&&AddManagePermsMenuItem(f,i,b,b.listName,currentItemID,g,h);if(currentItemID.indexOf(".0.")<0&&HasRights(0,8)&&!currentItemIsEventsExcp){if(b.listBaseType==4)c=Strings.STS.L_DeleteResponse_Text;else c=Strings.STS.L_DeleteItem_Text;a="DeleteListItem()";d=b.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_DeleteItem",c,a,d,String(WSS_MENUITEMSEQUENCE_DELETEITEM));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_DELETEITEM));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_DELETEITEM));e.id="ID_DeleteItem";CUIInfo(e,"Delete",["Delete"])}}var o=currentItemProgId!=null&&currentItemProgId!="";if(currentItemFSObjType=="1"&&!o&&HasRights(0,4)&&b.ContentTypesEnabled&&b.listTemplate!=108){c=Strings.STS.L_CustomizeNewButton_Text;a="Nav.navigate('"+b.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+b.listName+"&RootFolder="+j;a=AddSourceToUrl(a)+"')";d="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_CustomizeNewButton",c,a,d,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else{if(isNewEcb)e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else e=CAMOpt(f,c,a,d,null,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));CUIInfo(e,"ChangeNewButton",["ChangeNewButton"]);e.id="ID_CustomizeNewButton"}}_ContextForShowingShareDialog=b;a="DisplaySharingDialogFromEcb('"+currentItemID+"')";c=Strings.STS.L_Share_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_Share",c,a,d,String(WSS_MENUITEMSEQUENCE_SHARE));else{e=InsertMenuOption(f,i,c,a,d,String(WSS_MENUITEMSEQUENCE_SHARE));e.id="ID_Share"}}function ReplaceUrlTokens(d,e,h){var c;if(d==null||d==""){d="";return d}if(currentItemID!=null)d=d.replace(/{ItemId}/g,currentItemID);var a=null,b=null,f=d.indexOf("?");if(-1!=f&&f+2<d.length){a=d.substr(f+1);b=d.substr(0,f+1)}else b=d;if(currentItemFileUrl!=null){if(null!=a){var k=false,i=false;i=b==="{SiteUrl}/_layouts/15/WopiFrame.aspx?"||b==="{SiteUrl}/_layouts/15/Doc.aspx?";if(Boolean(h)&&i&&a.indexOf("sourcedoc={ItemUrl}")===0){var l=new URI(h),j=l.getQueryParameter("sourcedoc");if(Boolean(j)){a=a.replace(/{ItemUrl}/g,encodeURIComponent(j));k=true}}if(!k){if(ShouldCallEncodeURIComponent()){c=encodeURIComponent(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("971D5D0F-41FC-4160-85F9-E2EE88507E98")))c=c.replace(/'/g,"%27")}else c=escapeProperly(unescapeProperly(currentItemFileUrl));a=a.replace(/{ItemUrl}/g,c)}}b=b.replace(/{ItemUrl}/g,currentItemFileUrl)}if(e.HttpRoot!=null){if(null!=a){c=escapeProperly(unescapeProperly(e.HttpRoot));a=a.replace(/{SiteUrl}/g,c)}b=b.replace(/{SiteUrl}/g,e.HttpRoot)}if(e.listName!=null){if(null!=a){c=escapeProperly(e.listName);a=a.replace(/{ListId}/g,c)}b=b.replace(/{ListId}/g,e.listName)}if(e.listUrlDir!=null){if(null!=a){if(ShouldCallEncodeURIComponent())c=encodeURIComponent(e.listUrlDir);else c=escapeProperly(unescapeProperly(e.listUrlDir));a=a.replace(/{ListUrlDir}/g,c)}b=b.replace(/{ListUrlDir}/g,e.listUrlDir)}var g=Nav.getSource();b=b.replace(/{Source}/g,g);if(a!=null)if(b.length+a.length+g.length>1950)a=a.replace(/{Source}/g,"");else a=a.replace(/{Source}/g,g);return null==a?b:b+a}var SYSTEM_ACCOUNT_ID;function UseCustomAction(c,a,f,g,j,k,e,d,h){var b=false,i=true;if(a!=null){a=a.toLowerCase();if(c=="FileType")b=j==a.toLowerCase();else if(c=="ProgId")b=k==a.toLowerCase();else if(c=="ContentType")b=e!=null&&e.indexOf(a.toLowerCase())==0;else if(c=="List")if(null!=d&&d==a)b=true;else if(null!=h&&h==a)b=true}if(b)i=!HasRights(f,g)||IsTrimmedBySystem(f,g);return b&&!i}function InsertFeatureMenuItems(A,L,b,H,J){!isNewEcb&&CAMSep(A);var k=GetAttributeFromItemTable(itemTable,"Ext","FileType"),l=GetAttributeFromItemTable(itemTable,"Type","HTMLType"),i=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),o=null,m=null,s=ecbItems,E=Boolean(b.CurrentSelectedItems>1);if(b!=null){o=String(b.listTemplate);if(null!=b.listName&&0<b.listName.length){m=b.listName.toLowerCase();s=s+"_"+m}}if(k!=null)k=k.toLowerCase();if(l!=null)l=l.toLowerCase();if(i!=null)i=i.toLowerCase();var p,q=document.getElementById(s),h=new Array(0),a=null,e=0,w=[];if(q!=null&&!E)for(var r=0;r<q.childNodes.length;r++){var d=q.childNodes[r],I=GetInnerText(d.childNodes[5]),K=GetInnerText(d.childNodes[6]),F=parseInt(GetInnerText(d.childNodes[3])),G=parseInt(GetInnerText(d.childNodes[4]));if(!UseCustomAction(I,K,F,G,k,l,i,o,m))continue;a={};a.Title=GetInnerText(d.childNodes[0]);a.ImageUrl=GetInnerText(d.childNodes[1]);a.Action=GetInnerText(d.childNodes[2]);a.Sequence=parseInt(GetInnerText(d.childNodes[7]));var j=GetInnerText(d.childNodes[8]);a.ProductId=j.length>0?j:null;a.FromTenantApp=false;if(j!=null&&j.length>0)w[j]=true;h.push(a)}var x=GetTenantAppData();if(x!=null){var z=x.apps;for(e=0;e<z.length;e++)for(var u=z[e],v=0;v<u.customActions.length;v++)try{a=u.customActions[v];if(!UseCustomAction(a.registrationType,a.registrationId,parseInt(a.rightsHigh),parseInt(a.rightsLow),k,l,i,o,m))continue;if(typeof w[a.productId]!="undefined")continue;var g={};g.Title=a.title;g.ImageUrl=a.imageUrl;g.Action=a.action;g.Sequence=parseInt(a.sequence);g.ProductId=a.productId;g.FromTenantApp=true;g.AppTitle=u.title;h.push(g)}catch(M){throw M;}}var C=itemTable.getAttribute("SRed"),B=HandleWopiActions(h);for(e=0;e<h.length;e++){a=h[e];if(currentItemFSObjType=="1"&&a.Title==Strings.STS.L_CalloutFollowAction)continue;if(a.Title==Strings.STS.L_CalloutFollowAction&&(b.listTemplate==171||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)&&currentItemIsMountPoint||Boolean(b.RealHttpRoot)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null||!window.IsSPSocialSwitchEnabled||IsSPSocialSwitchEnabled()!=true))continue;if(a.Sequence==898&&Boolean(b.RealHttpRoot))continue;var f=ReplaceUrlTokens(a.Action,b,C),c=null;if(a.FromTenantApp){if(f.startsWith("javascript:LaunchApp"))c=f;else if(f.substr(0,11)!="javascript:")c="window.open('"+STSScriptEncode(f)+"', '_blank')"}else if(f.substr(0,11)=="javascript:")c=f;else c="window.open('"+STSScriptEncode(f)+"', '_blank')";if(h[e].Sequence==WSS_MENUITEMSEQUENCE_EDITINBROWSER){var t=GetSourceDocId(f);if(t!=null&&t.length>0)c="addWopiPerfMarkEx(null, 1,'"+t+"'); "+c}if(c!=null){var n="";if(isNewEcb)if(IsWopiViewAction(a))if(B)n="none";var y="ID_CA_"+a.Title;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(H,J,y,a.Title,c,a.ImageUrl,String(a.Sequence),"display:"+n);else{var D=a.ImageUrl==null?null:ReplaceUrlTokens(a.ImageUrl,b);p=InsertMenuOption(A,L,a.Title,c,D,String(a.Sequence));p.id=y;if(n!="")p.style.display=n}}}}function HandleWopiActions(b){if(!isNewEcb)return false;for(var c=false,a=0;a<b.length;a++){if(IsWopiViewAction(b[a])||IsWopiEditAction(b[a])){b[a].Sequence=WSS_MENUITEMSEQUENCE_EDITINBROWSER;if(Boolean(currentItemAppName)&&currentItemAppName!=" ")b[a].Title=StBuildParam(Strings.STS.L_OpenInBrowser_Text,currentItemAppName)}if(IsWopiEditAction(b[a]))c=true}return c}function IsWopiViewAction(a){return a.Action.indexOf("WopiFrame")!=-1&&a.Action.indexOf("action=view")!=-1}function IsWopiEditAction(a){return(a.Action.indexOf("WopiFrame")!=-1||a.Action.indexOf("Doc.aspx")!=-1)&&a.Action.indexOf("action=edit")!=-1}function HasDownloadRights(a){return HasRights(0,32)||(a==null||a=="")&&!HasRights(65536,0)}function HasRights(a,b){if(currentItemPermMaskH==null){if(itemTable==null)return true;var c=GetAttributeFromItemTable(itemTable,"Perm","PermMask");if(c==null)return true;var d=itemTable.getAttribute("Author");SetCurrentPermMaskFromString(c,d)}return!currentItemCanModify&&(EqualRights(a,b,0,4)||EqualRights(a,b,0,8)||EqualRights(a,b,1073741824,0))?false:(b&currentItemPermMaskL)==b&&(a&currentItemPermMaskH)==a}function EqualRights(a,c,b,d){return a==b&&c==d}function CheckIfHasRights(a,b,c,d){return(b&d)==b&&(a&c)==a}function IsTrimmedBySystem(b,c){var a=false;if(CheckIfHasRights(0,4,b,c)&&itemTable!=null){if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");a=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&ctx.CurrentUserId!=String(SYSTEM_ACCOUNT_ID)}return a}function GetPermMaskH(b){var a=b.length;return a<=10?0:parseInt(b.substring(2,a-8),16)}function GetPermMaskL(b){var a=b.length;return a<=10?parseInt(b):parseInt(b.substring(a-8,a),16)}function SetCurrentPermMaskFromString(b,a){currentItemPermMaskH=GetPermMaskH(b);currentItemPermMaskL=GetPermMaskL(b);currentItemCanModify=a==null||HasRights(0,2048)||ctx.CurrentUserId==a||ctx.CurrentUserId==null||typeof ctx.WriteSecurity=="number"&&ctx.WriteSecurity==1}function UpdateRibbonUrl(){if(!(window.OffSwitch==null||OffSwitch.IsActive("19BBD588-AD5E-4187-B25E-44AA99396C92"))&&ShouldCallEncodeURIComponent())if(Boolean(itemTable.getAttribute("onmouseover"))){currentItemFileUrl=currentItemFileUrl.replace(/%23/g,"#");currentItemFileUrl=currentItemFileUrl.replace(/%26/g,"&");currentItemFileUrl=decodeURI(currentItemFileUrl)}}function AddSharedNamespaceMenuItems(h,m,a,k,l){var p=GetRootFolder(a);setupMenuContext(a);if(currentItemFileUrl==null){currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");UpdateRibbonUrl()}if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(currentItemContentTypeId==null)currentItemContentTypeId=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedoutToLocal==null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedoutToLocal!="1")currentItemCheckedoutToLocal="0";bIsCheckout=0;if(a.isForceCheckout==true&&currentItemCheckedOutUserId==""&&currentItemFSObjType!="1")bIsCheckout=1;var q;if(currentItemFileUrl!=null)q=escapeProperly(unescapeProperly(currentItemFileUrl));if(Boolean(a.RealHttpRoot))return;if(!Boolean(ctx.CurrentSelectedItems>1)){var r=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID),d,c,b,e;if(a.listBaseType==1)if(isNewEcb)c=Strings.STS.L_Properties_Text;else c=Strings.STS.L_ViewProperties_Text;else if(a.listBaseType==4)c=Strings.STS.L_ViewResponse_Text;else c=Strings.STS.L_ViewItem_Text;var i="";if(currentItemContentTypeId!=null&&currentItemContentTypeId!="")i="&ContentTypeID="+currentItemContentTypeId;var g="&";if(a.displayFormUrl.indexOf("?")==-1)g="?";var j=a.displayFormUrl+g+"ID="+currentItemID+i;j=AddSourceToUrl(j)+p;if(301==a.listTemplate)b="EditItem('"+j+"')";else b="EditItem2(event, '"+STSScriptEncode(j)+"')";var f;if(a.listBaseType==1)f="ID_ViewProperties";else f="ID_ViewItem";var n="",o=HasRights(0,4)&&!r&&!currentItemIsEventsDeletedExcp;if(o)if(isNewEcb&&a.listBaseType==1)n="none";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES),"display:"+n);else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));CUIInfo(d,"ViewProperties",["ViewProperties"]);d.id=f;d.style.display=n}if(o){if(a.listBaseType==1)if(isNewEcb)c=Strings.STS.L_Rename_Text;else c=Strings.STS.L_EditProperties_Text;else if(a.listBaseType==4)c=Strings.STS.L_EditResponse_Text;else c=Strings.STS.L_EditItem_Text;g="&";if(a.editFormUrl.indexOf("?")==-1)g="?";if(a.listBaseType==1){b="EditItemWithCheckoutAlert(event, '"+a.editFormUrl+g+"ID="+currentItemID+i;b=AddSourceToUrl(b)+p+"',"+String(bIsCheckout)+",'"+currentItemCheckedoutToLocal+"','"+STSScriptEncode(currentItemFileUrl)+"','"+a.HttpRoot+"')"}else if(FV4UI())b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+g+"ID="+currentItemID+i+"')";else{b="EditItem('"+a.editFormUrl+g+"ID="+currentItemID+i;b=AddSourceToUrl(b)+"')"}e=a.imagesPath+"edititem.gif";if(a.listBaseType==1)f="ID_EditProperties";else f="ID_EditItem";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_EDITPROPERTIES));d.id=f;CUIInfo(d,"EditProperties",["EditProperties"])}if(a.listBaseType==1)if(isNewEcb){c=Strings.STS.L_Properties_Text;f="ID_ViewProperties";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(250))b="EditItem('"+j+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,f,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));else{d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_VIEWPROPERTIES));d.id=f}}if(a.listTemplate==106&&currentItemID.indexOf(".0.")>0){var t=currentItemID.indexOf(".0."),s=currentItemID.substr(0,t);c=Strings.STS.L_EditSeriesItem_Text;b="EditItem2(event, '"+STSScriptEncode(a.editFormUrl)+g+"ID="+s+i;b=AddSourceToUrl(b)+"')";e=a.imagesPath+"recurrence.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(k,l,"ID_EditSeriesItem",c,b,e,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));else{if(isNewEcb)d=InsertMenuOption(h,m,c,b,e,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));else d=CAMOpt(h,c,b,e,null,String(WSS_MENUITEMSEQUENCE_EDITSERIESITEM));CUIInfo(d,"EditSeriesItem",["EditSeriesItem"]);d.id="ID_EditSeriesItem"}}}}}function AddSolutionsCatalogMenuItems(d,c,i,a,b){if(HasRights(0,4))if(currentItemFSObjType!="1"){var g=true,e=GetAttributeFromItemTable(itemTable,"Url",null);if(e.length>4){var k=e.substr(e.length-4).toLowerCase();if(k==".wsp"){var f=GetAttributeFromItemTable(itemTable,"SolutionHash",null),j=GetAttributeFromItemTable(itemTable,"Hash",null),l=GetAttributeFromItemTable(itemTable,"SolutionItemID",null),h=GetAttributeFromItemTable(itemTable,"Status",null),m=GetAttributeFromItemTable(itemTable,"id",null);if(f!="")if(h=="")AddSolutionMenuActivate(d,c,a,b);else if(f==j){g=false;AddSolutionMenuDeactivate(d,c,a,b)}else AddSolutionMenuUpgrade(d,c,a,b)}}g&&AddSolutionMenuDelete(d,c,i,a,b)}}function AddSolutionMenuHelper(g,j,b,i,c,d,e,h){var a,f="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "'+i+'")';if(isNewEcb)a=InsertMenuOption(g,j,b,f,c,String(d));else a=CAMOpt(g,b,f,c,null,String(d));CUIInfo(a,e,[e]);a.id=h}function AddSolutionMenuActivate(e,d,a,b){if(typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true)if(isDocLibContextMenu){var c="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "ACT")';InsertItemToContextMenuDefinition(a,b,"ID_ActivateSolution",Strings.STS.L_ActivateSolution_Text,c,"",String(WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION))}else AddSolutionMenuHelper(e,d,Strings.STS.L_ActivateSolution_Text,"ACT","",WSS_MENUITEMSEQUENCE_ACTIVATESOLUTION,"ActivateSolution","ID_ActivateSolution")}function AddSolutionMenuDeactivate(e,d,a,b){if(typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true)if(isDocLibContextMenu){var c="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "DEA")';InsertItemToContextMenuDefinition(a,b,"ID_DeactivateSolution",Strings.STS.L_DeactivateSolution_Text,c,"",String(WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION))}else AddSolutionMenuHelper(e,d,Strings.STS.L_DeactivateSolution_Text,"DEA","",WSS_MENUITEMSEQUENCE_DEACTIVATESOLUTION,"DeactivateSolution","ID_DeactivateSolution")}function AddSolutionMenuUpgrade(e,d,a,b){if(typeof window.SPUserCanManageSolutions=="boolean"&&window.SPUserCanManageSolutions==true)if(isDocLibContextMenu){var c="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "UPG")';InsertItemToContextMenuDefinition(a,b,"ID_UpgradeSolution",Strings.STS.L_UpgradeSolution_Text,c,"",String(WSS_MENUITEMSEQUENCE_UPGRADESOLUTION))}else AddSolutionMenuHelper(e,d,Strings.STS.L_UpgradeSolution_Text,"UPG","",WSS_MENUITEMSEQUENCE_UPGRADESOLUTION,"UpgradeSolution","ID_UpgradeSolution")}function AddSolutionMenuDelete(h,k,c,i,j){var b,g;currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFileUrl!=null)g=escapeProperly(unescapeProperly(currentItemFileUrl));var d=Strings.STS.L_DeleteDocItem_Text,f="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")f="true";var a;if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(c.RealHttpRoot))a="DeleteDocLibItemCSOM('"+currentItemID+"', "+f+")";else a="DeleteDocLibItem('"+c.HttpPath+"&Cmd=Delete&List="+c.listName+"&ID="+currentItemID+"&owsfileref="+g+"&NextUsing="+Nav.getSource()+"',"+f+")";var e=c.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(i,j,"ID_DeleteDocItem",d,a,e,"310");else{if(isNewEcb)b=InsertMenuOption(h,k,d,a,e,"310");else b=CAMOpt(h,d,a,e,null,"310");b.id="ID_DeleteDocItem";CUIInfo(b,"Delete",["Delete"])}}function RunSolutionOperation(a,g){if(a==null&&!IsContextSet())return;var b=currentCtx!=null?currentCtx:typeof a.currentCtx=="object"?a.currentCtx:null,e=currentItemID!=null?currentItemID:typeof a.currentItemID=="string"?a.currentItemID:"";if(b==null)return;var f=b.listUrlDir,i=Nav.getSource(),c=f+"/Forms/Activate.aspx?Op="+g+"&ID="+e+"&Source="+i;if(b.listBaseType==1)c=c+GetRootFolder(b);var h=function(){},j=function(){var a={url:c,args:null,width:650,height:450,dialogReturnValueCallback:h},b=SP.UI.ModalDialog.showModalDialog(a)},d;try{d=typeof SP.UI.ModalDialog.showModalDialog}catch(k){d="undefined"}EnsureScript("SP.UI.Dialog.js",d,j)}function AddDocLibMenuItems(e,g,a,h,i){if(typeof window.Custom_AddDocLibMenuItems!="undefined")if(window.Custom_AddDocLibMenuItems(e,a))return;var j=Boolean(ctx.CurrentSelectedItems>1),t=GetRootFolder(a),d,c,b,f;if(currentItemIsMountPoint==null)currentItemIsMountPoint=IsSelectedItemMountPoint(a);AddSharedNamespaceMenuItems(e,g,a,h,i);var k;if(currentItemFileUrl!=null)if(ShouldCallEncodeURIComponent()){k=encodeURIComponent(currentItemFileUrl);if(!(window.OffSwitch==null||OffSwitch.IsActive("6BA2FDF8-BFCE-44AF-BCDC-DA55BB740F7E")))k=k.replace(/'/g,"\\u0027")}else k=escapeProperly(unescapeProperly(currentItemFileUrl));var o=itemTable.getAttribute("SRed"),l=currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID);if(HasRights(0,4)&&HasRights(16,0)&&!l&&HasDownloadRights(o)&&!j&&!currentItemIsMountPoint&&!(isNewEcb&&_shouldOpenInLightbox(currentItemFileUrl)))if(!Boolean(a.isWebEditorPreview)&&a.listBaseType==1)if(a.listTemplate!=119){setDocType();if(currentItemAppName!=""&&currentItemOpenControl!="")if(!(a.IsAppWeb&&currentItemProgId==SPDesignerProgID)){c="";if(currentItemAppName!=" ")if(isNewEcb)c=StBuildParam(Strings.STS.L_OpenIn_Text,currentItemAppName);else c=StBuildParam(Strings.STS.L_EditIn_Text,currentItemAppName);else{var r=StsOpenEnsureEx2(currentItemOpenControl+".3");if(r!=null)if(isNewEcb)c=Strings.STS.L_OpenInApplication_Text;else c=Strings.STS.L_EditInApplication_Text}if(c!=""){if(Boolean(a.RealHttpRoot)&&currentItemFileUrl.length>0&&currentItemFileUrl.charAt(0)=="/")currentItemFileUrl=getHostUrl(a.HttpRoot)+currentItemFileUrl;b="editDocumentWithProgID2('"+STSScriptEncode(currentItemFileUrl)+"', '"+currentItemProgId+"', '"+currentItemOpenControl+"', '"+String(bIsCheckout)+"', '"+a.HttpRoot+"', '"+currentItemCheckedoutToLocal+"', '"+currentItemOpenApp+"')";f=a.imagesPath+currentItemIcon;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_EditIn_"+currentItemAppName,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));d.id="ID_EditIn_"+currentItemAppName;if(!isNewEcb)d.style.cssText="display:none";CUIInfo(d,"EditDocument",["EditDocument"])}}}}if(isNewEcb&&!j){if(_shouldOpenInLightbox(currentItemFileUrl)){c=Strings.STS.L_OpenInApplication_Text;b='_openInLightbox("'+currentItemFileUrl+'");';f="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_OPENINLIGHTBOX",c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_EDITINAPPLICATION));d.id="ID_OPENINLIGHTBOX"}}if(currentItemFSObjType=="1"&&currentItemProgId===""){c=Strings.STS.L_OpenInApplication_Text;var n=itemTable.querySelector('a[class*="ms-listlink"]');if(isDocLibContextMenu&&Boolean(n)){b="Nav.navigate('"+n.href+"');";InsertItemToContextMenuDefinition(h,i,"ID_OpenFolder",c,b,"",String(WSS_MENUITEMSEQUENCE_OPENFOLDER))}}_ContextForShowingShareDialog=a;b="DisplaySharingDialogFromEcb('"+currentItemID+"')";c=Strings.STS.L_Share_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Share",c,b,f,String(WSS_MENUITEMSEQUENCE_SHARE));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_SHARE));d.id="ID_Share"}b="DisplaySharingDialogFromEcb('"+currentItemID+"', 1); SP.QoS.WriteUserEngagement('SharingUserClickedGetLinkContextMenuItem');";c=Strings.STS.L_GetLink_Text;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_GetLink",c,b,f,String(WSS_MENUITEMSEQUENCE_GETLINK));else{d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_GETLINK));d.id="ID_GetLink"}SP.QoS.WriteStart("SharingAddedGetLinkContextMenuItem")}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);if(HasRights(0,4)&&!currentItemIsMountPoint)if(j&&!hasFolderSelected(a)||!j&&currentItemFSObjType!="1")a.listBaseType==1&&AddCheckinCheckoutMenuItem(e,g,a,k,h,i);(a.verEnabled==1||a.isModerated)&&!j&&currentItemFSObjType!="1"&&!currentItemIsMountPoint&&AddVersionsMenuItem(e,g,a,k,h,i);if(HasRights(0,4)&&!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot))if(a.isModerated==true&&HasRights(0,16)&&((currentItemModerationStatus==String(2)||!a.EnableMinorVersions)&&currentItemCheckedOutUserId==""||currentItemFSObjType=="1")){c=Strings.STS.L_ModerateItem_Text;b="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/15/approve.aspx?List="+a.listName+"&ID="+currentItemID;b=AddSourceToUrl(b)+GetRootFolder(a)+"')";f=a.imagesPath+"apprj.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_ModerateItem",c,b,f,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_MODERATEITEM));CUIInfo(d,"Moderate",["Moderate"]);d.id="ID_ModerateItem"}}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);if(!currentItemIsMountPoint&&!Boolean(a.RealHttpRoot)){!j&&AddWorkflowsMenuItem(e,g,a,h,i);(!isNewEcb||currentItemFSObjType=="1")&&AddMoveCopyMenuItem(e,g,a,h,i)}if(currentItemFSObjType!="1"){if(a.PortalUrl!=null&&!Boolean(a.RealHttpRoot)&&!j){c=Strings.STS.L_AddToMyLinks_Text;b="Portal_Tasks('PinToMyPage')";f="";if(!isDocLibContextMenu){if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_ADDTOMYLINKS));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_ADDTOMYLINKS));CUIInfo(d,"AddToMyLinks",["AddToMyLinks"]);d.id="ID_AddToMyLinks";d.style.display="none"}}}else a.listBaseType==1&&HasRights(16,0)&&!Boolean(a.RealHttpRoot)&&!j&&AddWorkOfflineMenuItem(e,g,a,currentItemFileUrl,h,i);if(HasRights(128,0)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.alertsEnabled=="boolean"&&_spPageContextInfo.alertsEnabled&&!j){c=Strings.STS.L_Subscribe_Text;b="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";f="";if(!isDocLibContextMenu){if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_SUBSCRIBE));CUIInfo(d,"Subscribe",["Subscribe"]);d.id="ID_Subscribe";d.style.display="none"}}if(currentItemFSObjType!="1"&&!currentItemIsMountPoint){AddSendSubMenu(e,g,a,h,i);if(!Boolean(a.RealHttpRoot)){AddGotoSourceItemMenuItem(e,g,a,itemTable,currentItemFSObjType,h,i);AddDocTransformSubMenu(e,a)}}!currentItemIsMountPoint&&!isNewEcb&&CAMSep(e);AddManagePermsMenuItem(e,g,a,a.listName,currentItemID,h,i);if(HasRights(0,8)&&!l&&!currentItemIsMountPoint){c=Strings.STS.L_DeleteDocItem_Text;var m="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")m="true";if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.RealHttpRoot))b="DeleteDocLibItemCSOM('"+currentItemID+"', "+m+")";else b="DeleteDocLibItem('"+a.HttpPath+"&Cmd=Delete&List="+a.listName+"&ID="+currentItemID+"&owsfileref="+k+"&NextUsing="+Nav.getSource()+"',"+m+")";b+="; if (typeof CalloutManager !== 'undefined' && Boolean(CalloutManager) && Boolean(CalloutManager.closeAll)) CalloutManager.closeAll()";f=a.imagesPath+"delitem.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_DeleteDocItem",c,b,f,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_DELETEDOCITEM));d.id="ID_DeleteDocItem";CUIInfo(d,"Delete",["Delete"])}}if(HasRights(0,4)&&currentItemFSObjType=="1"&&a.ContentTypesEnabled&&a.listTemplate!=108&&!currentItemIsMountPoint&&!j){c=Strings.STS.L_CustomizeNewButton_Text;b="Nav.navigate('"+a.HttpRoot+"/_layouts/15/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+k;b=AddSourceToUrl(b)+"')";f="";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_CustomizeNewButton",c,b,f,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else{if(isNewEcb)d=InsertMenuOption(e,g,c,b,f,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));else d=CAMOpt(e,c,b,f,null,String(WSS_MENUITEMSEQUENCE_CUSTOMIZENEWBUTTON));CUIInfo(d,"ChangeNewButton",["ChangeNewButton"]);d.id="ID_CustomizeNewButton"}}if(Boolean(a.ListSchema)&&Boolean(a.ListSchema.RmsSupportedExtensions)){var s=itemTable.getAttribute("ext").toLowerCase(),p=a.ListSchema.RmsSupportedExtensions.toLowerCase().split(","),q=p.indexOf(s)>-1;q&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(524)&&HasRights(0,4)&&!currentItemIsMountPoint&&!j&&!l&&currentItemFSObjType!="1"&&a.listBaseType==1&&AddEncryptMenuItem(e,g,a,k,h,i)}}var _ContextForShowingShareDialog;function DisplaySharingDialogFromEcb(a,b){if(_ContextForShowingShareDialog!=null){typeof CalloutManager!=="undefined"&&Boolean(CalloutManager)&&Boolean(CalloutManager.closeAll)&&CalloutManager.closeAll();DisplaySharingDialogForListItem(_ContextForShowingShareDialog,a,b)}}function AddManagePermsMenuItem(g,e,a,d,f,b,c){if(!HasRights(0,131072)||currentItemIsEventsExcp||a.ExternalDataList||currentItemEvtType==5)return;AddSharedWithMenuItem(g,e,a,d,f,b,c)}function AddAdvancedPermissionsMenuItem(f,i,e,j,k,g,h){var b=Strings.STS.L_MngPerms_Text,d="_NavigateToManagePermsPage('"+e.HttpRoot+"', '"+e.listName+"', '"+currentItemID+"');",c=e.imagesPath+"permissions16.png";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(g,h,"ID_AdvPerms",b,d,c,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));else{var a;if(isNewEcb)a=InsertMenuOption(f,i,b,d,c,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));else a=CAMOpt(f,b,d,c,null,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));a.id="ID_AdvPerms";CUIInfo(a,"AdvancedPermissions",["AdvancedPermissions"])}}function AddSharedWithMenuItem(j,o,a,n,p,k,l){var c=Strings.STS.L_SharedWithDialogTitle,i="",h="";if(Boolean(a.ListData))for(var m in a.ListData.Row){var g=a.ListData.Row[m];if(g.ID==currentItemID){i=g.FSObjType;h=g.HTML_x0020_File_x0020_Type;break}}var f="DisplaySharedWithDialogCore('{0}','{1}','{2}',{3},{4},'{5}','{6}', '{7}', '{8}', '{9}');";f=String.format(f,a.HttpRoot,n,p,false,false,i,h,false,a.RealHttpRoot);var e="EnsureScriptFunc('sharing.js', 'DisplaySharedWithDialogCore', function () { "+f+" })",d=a.imagesPath+"permissions16.png";if(isDocLibContextMenu)!IsOneDrive(a)&&InsertItemToContextMenuDefinition(k,l,"ID_MngPerms",c,e,d,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));else{var b;if(isNewEcb)b=InsertMenuOption(j,o,c,e,d,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));else b=CAMOpt(j,c,e,d,null,String(WSS_MENUITEMSEQUENCE_MANAGEPERMISSIONS));b.id="ID_MngPerms";CUIInfo(b,"ManagePermissions",["ManagePermissions"]);if(isNewEcb&&IsOneDrive(a))b.style.display="none"}}function AddGotoSourceItemMenuItem(f,l,k,g,i,h,j){if(i!="1"){var b=g.getAttribute("CSrc");if(typeof b!="undefined"&&b!=null&&b!=""){var c=Strings.STS.L_GoToSourceItem_Text,e="NavigateToSourceItem(event, '"+STSScriptEncode(b)+"')",d=k.imagesPath+"goToOriginal.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,j,"ID_GoToSourceItem",c,e,d,String(WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM));else{var a;if(isNewEcb)a=InsertMenuOption(f,l,c,e,d,String(WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM));else a=CAMOpt(f,c,e,d,null,String(WSS_MENUITEMSEQUENCE_GOTOSOURCEITEM));a.id="ID_GoToSourceItem";CUIInfo(a,"GotoSourceItem",["GotoSourceItem"])}}}}function CheckoutSingleItemFromECB(a,b){if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.RealHttpRoot))EnsureScriptParams("inplview","inplview.CheckoutSelectedItems",a);else EnsureScriptParams("inplview","inplview.CheckOutSingleItem",a,b)}function CheckoutItemFromECB(a,b){if(a.CurrentSelectedItems>1)EnsureScriptParams("inplview","inplview.CheckoutSelectedItems",a);else EnsureScriptParams("inplview","inplview.CheckOutSingleItem",a,b)}function AddCheckinCheckoutMenuItem(f,j,a,g,h,i){var e,c,d,b;if(!HasRights(0,4))return;if(currentItemCheckedOutUserId==String(SYSTEM_ACCOUNT_ID)&&a.CurrentUserId!=String(SYSTEM_ACCOUNT_ID))return;if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(424)&&window.groupContextData!=null)return;if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedOutUserId!=""){if(currentItemCheckedOutUserId==a.CurrentUserId||a.CurrentUserId==null||HasRights(0,256)){c=Strings.STS.L_Checkin_Text;if(!FV4UI())b="NavigateToCheckinAspx('"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+g+"')";else b="CheckInSingleItemFromECB(event, currentCtx, itemTable)";d=a.imagesPath+"checkin.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Checkin",c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));e.id="ID_Checkin";CUIInfo(e,"CheckIn",["CheckIn"])}c=Strings.STS.L_DiscardCheckou_Text;b="UnDoCheckOutwithNotification('"+a.HttpRoot+"', '"+g+"', currentCtx, '"+STSScriptEncode(currentItemID)+"')";d=a.imagesPath+"unchkout.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_DiscardCheckou",c,b,d,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_DISCARDCHECKOU));e.id="ID_DiscardCheckou";CUIInfo(e,"DiscardCheckOut",["DiscardCheckOut"])}}}else if(typeof g_disableCheckoutInEditMode=="undefined"||!g_disableCheckoutInEditMode){c=Strings.STS.L_Checkout_Text;currentItemOpenControl==""&&setDocType();var r="",p=itemTable.getAttribute("SRed"),n=false;if(!(window.OffSwitch==null||OffSwitch.IsActive("a3950ecb-aaf6-4570-90ba-dab29a5d177c"))){var o=itemTable.getAttribute("ext");if(!IsNullOrUndefined(o))n=IsCheckoutDisabledForFluid(o.toLowerCase())}if(HasDownloadRights(p)&&!n){if(!FV4UI())b="CheckoutDocument('"+a.HttpRoot+"', '"+g+"', '"+r+"')";else b="CheckoutSingleItemFromECB(currentCtx, itemTable)";d=a.imagesPath+"checkout.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_Checkout",c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CHECKINCHECKOUT));e.id="ID_Checkout";CUIInfo(e,"CheckOut",["CheckOut"])}}if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(a.EnableMinorVersions){if(currentItemUIString==null)currentItemUIString=GetAttributeFromItemTable(itemTable,"UIS","UIString");var q=parseInt(currentItemUIString)%512,k=null;if((currentItemModerationStatus==String(1)||currentItemModerationStatus==String(3))&&a.isModerated||!a.isModerated&&q!=0){c=Strings.STS.L_PublishItem_Text;if(Boolean(a.RealHttpRoot)&&(k=ListModule.Util.makeMountedFolderQueryStrParams(true,false))!=null)b="PublishMajorVersion(event, '"+a.RealHttpRoot+"', 'List="+a.listName+"&FileName="+g+"&Publish=true"+k+"')";else b="PublishMajorVersion(event, '"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+g+"&Publish=true')";d=a.imagesPath+"pubmajor.gif";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,"ID_PublishItem",c,b,d,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_PUBLISHITEM));CUIInfo(e,"Publish",["Publish"]);e.id="ID_PublishItem"}}else{var m,l=false;if(!a.isModerated||currentItemModerationStatus==String(0)){c=Strings.STS.L_UnPublishItem_Text;m="ID_UnPublishItem";d=a.imagesPath+"unpub.gif"}else{c=Strings.STS.L_CancelPublish_Text;m="ID_CancelPublish";d=a.imagesPath+"unapprv.gif";l=true}if(Boolean(a.RealHttpRoot)&&(k=ListModule.Util.makeMountedFolderQueryStrParams(true,false))!=null)b="UnPublish('"+a.RealHttpRoot+"', 'FileName="+g+"&UnPublish=true"+k+"',"+String(l)+")";else b="UnPublish('"+a.HttpRoot+"', 'FileName="+g+"&UnPublish=true',"+String(l)+")";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(h,i,m,c,b,d,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));else{if(isNewEcb)e=InsertMenuOption(f,j,c,b,d,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));else e=CAMOpt(f,c,b,d,null,String(WSS_MENUITEMSEQUENCE_CANCELPUBLISH));if(l)CUIInfo(e,"CancelApproval",["CancelApproval"]);else CUIInfo(e,"Unpublish",["Unpublish"]);e.id=m}}}}}function IsCheckoutDisabledForFluid(a){var e="fluid",d="note",c="whiteboard",b=false;if(!IsNullOrUndefined(a)&&(a===e||a===d||a===c))if(!(window.OffSwitch==null||OffSwitch.IsActive("a1e74fec-2d37-4882-a72f-65cf91864503"))&&a===e)b=true;else if(!(window.OffSwitch==null||OffSwitch.IsActive("bd014610-9965-4181-a1aa-2214578bc2fc"))&&a===d)b=true;else if(!(window.OffSwitch==null||OffSwitch.IsActive("574281a4-c806-436d-add2-acc96a2e8c4e"))&&a===c)b=true;return b}function AddWorkflowsMenuItem(h,k,c,i,j){if(HasRights(0,4)&&!c.ExternalDataList&&window.groupContextData==null){var g=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(g==null||g.substr(0,8)!="0x010801"){var d=c.imagesPath+"workflows.png",e,f=(""+currentItemID).indexOf(".0.");if(f>0)e=currentItemID.substr(0,f);else e=currentItemID;var a="Nav.navigate('"+c.HttpRoot+"/_layouts/15/Workflow.aspx?ID="+e+"&List="+c.listName;a=AddSourceToUrl(a)+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(i,j,"ID_Workflows",Strings.STS.L_Workflows_Text,a,d,String(WSS_MENUITEMSEQUENCE_WORKFLOWS));else{var b;if(isNewEcb)b=InsertMenuOption(h,k,Strings.STS.L_Workflows_Text,a,d,String(WSS_MENUITEMSEQUENCE_WORKFLOWS));else b=CAMOpt(h,Strings.STS.L_Workflows_Text,a,d,null,String(WSS_MENUITEMSEQUENCE_WORKFLOWS));CUIInfo(b,"ViewWorkflows",["ViewWorkflows"]);b.id="ID_Workflows"}}}}function AddMoveCopyMenuItem(d,g,c,e,f){if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(329)&&c.listTemplate==700){var b="SP.SOD.execute('movecopy.js','LaunchMoveCopyDialogWithContextId',"+c.ctxId+")",a;if(isDocLibContextMenu)InsertItemToContextMenuDefinition(e,f,"ID_MoveCopy",Strings.STS.L_MoveCopy_MenuItemTitle,b,"",String(WSS_MENUITEMSEQUENCE_MOVECOPYITEM));else{if(isNewEcb)a=InsertMenuOption(d,g,Strings.STS.L_MoveCopy_MenuItemTitle,b,"",String(WSS_MENUITEMSEQUENCE_MOVECOPYITEM));else a=CAMOpt(d,Strings.STS.L_MoveCopy_MenuItemTitle,b,"",null,String(WSS_MENUITEMSEQUENCE_MOVECOPYITEM));CUIInfo(a,"MoveCopy",["MoveCopy"]);a.id="ID_MoveCopy"}}}function AddEncryptMenuItem(e,h,d,i,f,g){var a,b=Strings.STS.L_Encrypt_Text,c="NavigateToFileIRMAspx(event, '"+d.HttpRoot+"', 'list="+d.listName+"&ID="+currentItemID+"&FileLevel=true')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(f,g,"ID_Encrypt",b,c,"",String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));else{if(isNewEcb)a=InsertMenuOption(e,h,b,c,"",String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));else a=CAMOpt(e,b,c,"",null,String(WSS_MENUITEMSEQUENCE_ENCRYPTITEM));CUIInfo(a,"Encrypt",["Encrypt"]);a.id="ID_Encrypt"}}function AddWorkspaceMenuItem(d,h,c,f,g){var a,b,e=GetAttributeFromItemTable(itemTable,"SUrl","SourceUrl");if(e!=null&&e!=""&&e!="%20"){if(HasRights(0,135168)){b="Nav.navigate('"+c.HttpRoot+"/_layouts/15/publishback.aspx?list="+c.listName+"&item="+currentItemID+GetRootFolder(c)+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(f,g,"ID_PublishBack",Strings.STS.L_PublishBack_Text,b,"",String(WSS_MENUITEMSEQUENCE_PUBLISHBACK));else{if(isNewEcb)a=InsertMenuOption(d,h,Strings.STS.L_PublishBack_Text,b,"",String(WSS_MENUITEMSEQUENCE_PUBLISHBACK));else a=CAMOpt(d,Strings.STS.L_PublishBack_Text,b,"",null,String(WSS_MENUITEMSEQUENCE_PUBLISHBACK));CUIInfo(a,"PublishBack",["PublishBack"]);a.id="ID_PublishBack"}}}else if(HasRights(0,8388608)&&HasRights(0,135168)&&HasRights(0,67108864)){b="Nav.navigate('"+c.HttpRoot+"/_layouts/15/createws.aspx?list="+c.listName+"&item="+currentItemID+GetRootFolder(c)+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(f,g,"ID_CreateDWS",Strings.STS.L_CreateDWS_Text,b,"",String(WSS_MENUITEMSEQUENCE_CREATEDWS));else{if(isNewEcb)a=InsertMenuOption(d,h,Strings.STS.L_CreateDWS_Text,b,"",String(WSS_MENUITEMSEQUENCE_CREATEDWS));else a=CAMOpt(d,Strings.STS.L_CreateDWS_Text,b,"",null,String(WSS_MENUITEMSEQUENCE_CREATEDWS));CUIInfo(a,"CreateDocumentWorkspace",["CreateDocumentWorkspace"]);a.id="ID_CreateDWS"}}}function AddVersionsMenuItem(i,m,a,h,k,l){if(currentItemID!=null){var j=currentItemID.toString();if(j.indexOf(".0.")>=0)return}var f=currentItemID;if(currentItemIsEventsExcp)if(currentItemID.indexOf(".")!=-1)f=currentItemID.split(".")[0];if(!HasRights(0,64))return;var d=Strings.STS.L_Versions_Text,c,g=null;if(Boolean(a.RealHttpRoot)&&(g=ListModule.Util.makeMountedFolderQueryStrParams(false,false))!=null)c="NavigateToVersionsAspxV4(event, '"+a.RealHttpRoot+"', 'list="+a.listName+"&ID="+f+"&FileName="+h+g+"')";else c="NavigateToVersionsAspxV4(event, '"+a.HttpRoot+"', 'list="+a.listName+"&ID="+f+"&FileName="+h+"')";var e=a.imagesPath+"versions.gif",b;if(isDocLibContextMenu)(!Flighting.VariantConfiguration.IsExpFeatureClientEnabled(254)||!_shouldOpenInLightbox(currentItemFileUrl))&&InsertItemToContextMenuDefinition(k,l,"ID_Versions",d,c,e,String(WSS_MENUITEMSEQUENCE_VERSIONS));else{if(isNewEcb)b=InsertMenuOption(i,m,d,c,e,String(WSS_MENUITEMSEQUENCE_VERSIONS));else b=CAMOpt(i,d,c,e,null,String(WSS_MENUITEMSEQUENCE_VERSIONS));CUIInfo(b,"ViewVersions",["ViewVersions"]);b.id="ID_Versions";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(254)&&_shouldOpenInLightbox(currentItemFileUrl))b.style.display="none"}}function AddWorkOfflineMenuItem(i,l,a,m,j,k){var f=GetStssyncData("documents",Strings.STS.L_WorkOffline_Text,a.imagesPath+"tbsprsht.gif",a.imagesPath);if(f!=null){var b=f.BtnText,e=f.BtnImagePath;if(b!=null){var h="";if(typeof a.SiteTitle=="string"&&a.SiteTitle!=null)h=STSScriptEncode(a.SiteTitle);var g="";if(typeof a.ListTitle=="string"&&a.ListTitle!=null)g=STSScriptEncode(a.ListTitle);var d="javascript:ExportHailStorm('documents','"+a.HttpRoot+"','"+STSScriptEncode(a.listName)+"','"+STSScriptEncode(h)+"','"+g+"','"+STSScriptEncode(a.listUrlDir)+"','','"+STSScriptEncode(unescapeProperly(a.listUrlDir))+"'";d+=",'"+STSScriptEncode(unescapeProperly(m))+"','"+currentItemID+"')";if(isDocLibContextMenu)InsertItemToContextMenuDefinition(j,k,"ID_WorkOffline",b,d,e,null);else{var c;if(isNewEcb)c=InsertMenuOption(i,l,b,d,e);else c=CAMOpt(i,b,d,e);CUIInfo(c,"ConnectFolderToClient",["ConnectFolderToClient"]);c.id="ID_WorkOffline"}}}}function AddVersionMenuItems(b,a){typeof AddVersionMenuItemsCore=="function"&&AddVersionMenuItemsCore(b,a)}function NavigateToApproveRejectAspx(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else Nav.navigate(a)}function PublishMajorVersion(d,b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function _NavigateToSubNewAspx(b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);Nav.navigate(a)}function NavigateToSubNewAspxV4(d,b,c){var a=b+"/_layouts/15/SubNew.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else Nav.navigate(a)}function NavigateToVersionsAspx(b,c){var a=b+"/_layouts/15/Versions.aspx?"+c;a=AddSourceToUrl(a);Nav.navigate(a)}function NavigateToVersionsAspxV4(d,b,c){var a=b+"/_layouts/15/Versions.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else Nav.navigate(a)}function NavigateToFileIRMAspx(d,b,c){var a=b+"/_layouts/15/rms.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function NavigateToSendToOtherLocationV4(b,a){if(FV4UI())ShowInPopUI(b,currentCtx,a);else Nav.navigate(a)}function UnDoCheckOutwithNotification(a,e,c,d){var b=UnDoCheckOut(a,e,c,d);if(b){var f=Strings.STS.L_Notification_DiscardCheckOut;addNotification(f,true)}}function UnDoCheckOut(b,c,a){var d=null;if(!confirm(Strings.STS.L_UndoCheckoutWarning_Text))return false;if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.RealHttpRoot))EnsureScriptParams("inplview","inplview.DiscardCheckoutSelectedItems",a);else NavigateToCheckinAspx(b,"FileName="+c+"&DiscardCheckout=true");return true}function UnPublish(c,d,b){var a=Strings.STS.L_UnPublishWarning_Text;if(b)a=Strings.STS.L_CancleApproval_TEXT;if(!confirm(a))return;NavigateToCheckinAspx(c,d)}function NavigateToCheckinAspx(b,c){var a=b+"/_layouts/15/Checkin.aspx?"+c;a=AddSourceToUrl(a);SubmitFormPost(a)}function _NavigateToManagePermsPage(a,c,b){NavigateToManagePermsPageEx(a,c,b,false)}function NavigateToManagePermsPageEx(c,b,d,f){var e=",LISTITEM",a=c+"/_layouts/15/User.aspx?obj="+b+","+d+e+"&List="+b;a=AddSourceToUrl(a);if(f)typeof window.frameElement.navigateParent=="function"&&window.frameElement.navigateParent(a);else Nav.navigate(a)}function NavigateToSourceItem(e,a){var d=a.match(/[^\/]*\/\/[^\/]*/g),c=d[0];a=escapeProperly(a);var b=c+"/_layouts/15/copyutil.aspx?GoToDispForm=1&Use=url&ItemUrl="+a;b=AddSourceToUrl(b);Nav.navigate(b)}function setDocType(){var b=GetAttributeFromItemTable(itemTable,"Icon","DocIcon"),a=Boolean(b)?b.split("|"):[];currentItemIcon=a[0];currentItemAppName=a[1];currentItemOpenControl=a[2];currentItemOpenApp=a[3]==null?"":a[4]==null?a[3]:a[3]+"|"+a[4];currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType")}function DeleteListItem(){if(!IsContextSet())return;var b=currentCtx,e=currentItemID,c=Strings.STS.L_STSRecycleConfirm_Text;if(!Boolean(b.RecycleBinEnabled)||b.ExternalDataList)c=Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)c=b.CascadeDeleteWarningMessage+c;if(confirm(c)){var g=Strings.STS.L_Notification_Delete,f=addNotification(g,true),a=b.clvp;if(b.ExternalDataList&&a!=null){a.DeleteItemCore(e);a.pendingItems=[];typeof a.cctx.executeQueryAsync!="undefined"&&a.cctx.executeQueryAsync(function(){if(a.rgehs!=null&&typeof a.rgehs.length=="number"){if(a.rgehs.length==1&&a.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(a.rgehs[0].get_serverErrorValue());return}removeNotification(f);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(f);typeof a.rgehs!="undefined"&&a.ShowErrorDialog(function(){})})}else{var d=b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+e+"&NextUsing="+Nav.getSource();if(null!=currentItemContentTypeId)d+="&ContentTypeId="+currentItemContentTypeId;SubmitFormPost(d)}}}function DeleteDocLibItem(a,d){if(!IsContextSet())return;var b=currentCtx;if(Boolean(b.CurrentSelectedItems>=1))EnsureScriptParams("inplview","inplview.DeleteSelectedItems",b);else{var c=GenerateDeleteConfirmationMessage(d);if(confirm(c)){if(currentItemFSObjType=="1"&&currentItemContentTypeId!=null)a+="&ContentTypeId="+currentItemContentTypeId;var e=Strings.STS.L_Notification_Delete;addNotification(e,true);SubmitFormPost(a,false,true)}}}function DeleteDocLibItemCSOM(d,c){if(!IsContextSet())return;var a=currentCtx;if(Boolean(a.CurrentSelectedItems>1))EnsureScriptParams("inplview","inplview.DeleteSelectedItems",a);else{var b=GenerateDeleteConfirmationMessage(c);confirm(b)&&EnsureScriptParams("inplview","inplview.DeleteSelectedItemsCore",a,[d],RefreshOnDialogClose,null,true)}}function GenerateDeleteConfirmationMessage(c){var b=currentCtx,a;if(currentItemFSObjType=="1")if(currentItemContentTypeId!=null&&currentItemContentTypeId.substr(0,8).toLowerCase()=="0x0120d5")a=Boolean(b.RecycleBinEnabled)?Strings.STS.L_STSRecycleConfirm2_Text:Strings.STS.L_STSDelConfirm2_Text;else a=Boolean(b.RecycleBinEnabled)?Strings.STS.L_STSRecycleConfirm1_Text:Strings.STS.L_STSDelConfirm1_Text;else if(currentItemIsMountPoint){a=Strings.STS.L_RemoveMountPointConfirmation;SP.QoS.WriteStart("RemoveMountPoint_ECB_SingleMountPoint")}else a=Boolean(b.RecycleBinEnabled)?Strings.STS.L_STSRecycleConfirm_Text:Strings.STS.L_STSDelConfirm_Text;if(Boolean(b.HasRelatedCascadeLists)&&b.CascadeDeleteWarningMessage!=null)a=b.CascadeDeleteWarningMessage+a;if(c&&currentItemFSObjType!="1")a=Strings.STS.L_NotifyThisIsCopy_Text+a;return a}function EditMenuDefaultForOnclick(){if(!IsContextSet())return;var a=currentCtx;if(Boolean(a.isVersions))Nav.navigate(itemTable.getAttribute("verUrl"));else if(a.listTemplate==200){var b=currentItemID;MtgNavigate(b)}else EditListItem()}function EditListItem(){if(event.srcElement.tagName=="A"||event.srcElement.parentNode.tagName=="A")return;if(!IsContextSet())return;var b=currentCtx,c="&";if(b.editFormUrl.indexOf("?")==-1)c="?";var a=b.editFormUrl+c+"ID="+currentItemID;a=AddSourceToUrl(a);if(b.listBaseType==1)a=a+GetRootFolder(b);STSNavigate2(event,a)}function _DoNavigateToTemplateGallery(a,b){document.cookie="MSOffice_AWS_DefSaveLoc="+a;Nav.navigate(b)}function Portal_Tasks(j){if(!IsContextSet())return;var b=currentCtx,g=unescapeProperly(currentItemFileUrl),c=0,d=0;c=g.lastIndexOf("/");d=g.lastIndexOf(".");if(c<0||d<0||c>d)return;var i=g.substr(c+1,d-c-1),f="";c=b.HttpRoot.indexOf("://");if(c>0){d=b.HttpRoot.indexOf("/",c+3);if(d>0)f=b.HttpRoot.substring(0,d);else f=b.HttpRoot}var e="";if(currentItemFileUrl.charAt(0)=="/"||currentItemFileUrl.substr(0,3).toLowerCase()=="%2f")e=f+currentItemFileUrl;else e=currentItemFileUrl;var a="";if(setElementValue("ListViewURL",e)==false)a=a+"&ListViewURL="+escapeProperly(e);if(setElementValue("ListTitle",i)==false)a=a+"&ListTitle="+escapeProperly(i);if(setElementValue("ListDescription","")==false)a=a+"&ListDescription=";if(setElementValue("ReturnUrl",window.location.href)==false)a=a+"&ReturnUrl="+escapeProperly(window.location.href);if(b.PortalUrl.substr(0,4)!="http")b.PortalUrl=f+b.PortalUrl;var h=b.PortalUrl+"_vti_bin/portalapi.aspx?cmd="+j;h=h+"&IconUrl="+b.imagesPath+currentItemIcon+a;SubmitFormPost(h)}function IsContextSet(){return currentCtx==null?false:typeof currentCtx.isExplictLogin=="boolean"&&currentCtx.isExplictLogin?true:currentCtx.HttpPath==null||currentItemID==null?false:true}function ChangeContentType(d){var b=document.getElementById(d),a=window.location.href,e=a.indexOf("?");if(a.indexOf("?")<=0)a=a+"?ContentTypeId="+b.value;else if(a.indexOf("&ContentTypeId=")<=0)a=a+"&ContentTypeId="+b.value;else{var c=/&ContentTypeId=[^&]*/i;a=a.replace(c,"&ContentTypeId="+b.value)}Nav.navigate(a)}function CIMSep(c,e){var a=CMSep();if(null==a)return null;for(var b=0;b<c.childNodes.length;b++){var d=c.childNodes[b].getAttribute("sequence");if(d)if(Number(d)>Number(e)){c.childNodes[b].parentNode.insertBefore(a,c.childNodes[b]);return a}}AChld(c,a);return a}function InsertMenuOption(f,e,b,d,c,a){return e!=null&&(a==null||Number(a)>WSS_MENUITEMSEQUENCE_ADVANCED)?CIMOpt(e,b,d,c,null,a):CIMOpt(f,b,d,c,null,a)}function InsertItemToContextMenuDefinition(c,b,h,f,g,i,e,d){if(!Boolean(c)&&!Boolean(b))return;if(d=="display:none")return;var a={seq:e,id:h,text:f,onclick:g,tooltip:f};if(Boolean(d))a.mstyle=d;if(Boolean(b)&&(e==null||Number(e)>WSS_MENUITEMSEQUENCE_ADVANCED))b.items.splice(locationOf(a,b.items,seqCompare)+1,0,a);else Boolean(c)&&c.items.splice(locationOf(a,c.items,seqCompare)+1,0,a)}function InsertSeparatorToContextMenuDefinition(a,d){var c={seq:d,separator:true},b=locationOf(c,a,seqCompare)+1;b>0&&b<a.length&&a.splice(b,0,c)}function locationOf(f,c,e,b,d){if(c.length===0||!Boolean(c[0].seq))return-1;b=Boolean(b)?b:0;d=Boolean(d)?d:c.length;var a=b+d>>1,g=e(f,c[a]);if(d-b<=1)return g==-1?a-1:a;switch(g){case-1:return locationOf(f,c,e,b,a);case 0:return a;case 1:return locationOf(f,c,e,a,d)}}var seqCompare;function AddSubMenu(b,a){if(a.items.length==0)return;else if(a.items.length==1)b.items.splice(locationOf(a.items[0],b.items,seqCompare)+1,0,a.items[0]);else b.items.splice(locationOf(a,b.items,seqCompare)+1,0,a)}function _TopHelpButtonClick(a){if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(37)){var b=document.getElementById("helppanelCntdiv");if(b!=null){LoadCssOnDemand("helppanel",LoadHelpPanelJs);return}}if(typeof navBarHelpOverrideKey!="undefined")return HelpWindowKey(navBarHelpOverrideKey);if(a!=null)HelpWindowKey(a);else HelpWindowKey("HelpHome")}function LoadHelpPanelJs(){EnsureScriptParams("helppanel.js","openHelpPanel")}function GetSPHelpUrl(d){var c,a;if(typeof d=="undefined")c="?Lcid="+Strings.STS.L_Language_Text;else c="?Lcid="+Strings.STS.L_Language_Text+d;var b;if(typeof ctx=="undefined"||ctx==null)if(typeof currentCtx!="undefined"&&currentCtx!=null)ctx=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctx=ctxFilter;if(typeof ctx!="undefined"&&ctx!=null&&typeof ctx.HttpRoot!="undefined"&&ctx.HttpRoot!=null){a=ctx.HttpRoot;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/15/help.aspx"}if(b==null&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl!=null){a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/15/help.aspx"}if(b==null)b="/_layouts/15/help.aspx";return b+c}function ShowHelpWindow(a){if(a!=null){var b=window.open(a,"STSHELP_15","height=500,location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no,width=400");b.focus()}}function HelpWindowHelper(a){if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(37)&&a=="&Key=SPOADMIN"){var c=document.getElementById("helppanelCntdiv");if(c!=null){LoadCssOnDemand("helppanel",LoadHelpPanelJs);return}}if(SuiteLinksEmptyOrSuiteHelpLinkIsCached())GetSuiteLinks(null,function(b){SP.SOD.executeFunc("suitelinks.js","GetSPOHelpUrl",function(){var c=GetSPOHelpUrl(b,a);ShowHelpWindow(c)})});else{var b=GetSPHelpUrl(a);ShowHelpWindow(b)}}function _HelpWindowKey(a){if(a!==null&&a!=="")HelpWindowHelper("&Key="+a+"&ShowNav=true");else if(typeof navBarHelpOverrideKey!="undefined")HelpWindowHelper("&Key="+navBarHelpOverrideKey+"&ShowNav=true");else HelpWindowHelper("&Key=HelpHome&ShowNav=true")}function _HelpWindowUrl(a){HelpWindowHelper("&Url="+a)}function _HelpWindow(){HelpWindowKey("HelpHome")}function _ToggleFullScreenMode(){var a=HasCssClass(document.body,"ms-fullscreenmode");SetFullScreenMode(!a)}function SetFullScreenMode(c){var d=document.body,b=document.getElementById("fullscreenmode"),a=document.getElementById("exitfullscreenmode");if(d!=null){SetCookieEx("WSS_FullScreenMode",c,true,window);if(PageMinimized())c=true;if(c){AddCssClassToElement(d,"ms-fullscreenmode");if(b!=null&&a!=null){b.style.display="none";a.style.display=""}}else{RemoveCssClassFromElement(d,"ms-fullscreenmode");if(b!=null&&a!=null){b.style.display="";a.style.display="none"}}if("undefined"!=typeof document.createEvent&&"function"==typeof window.dispatchEvent){var e=document.createEvent("Event");e.initEvent("resize",false,false);window.dispatchEvent(e)}else"undefined"!=typeof document.createEventObject&&document.body.fireEvent("onresize");CallWorkspaceResizedEventHandlers()}}function FullScreenModeOnKeyDown(a){if(a==null)a=window.event;var b;if(a==null)return true;if(browseris.nav6up)b=a.which;else b=a.keyCode;a.altKey&&b==122&&_ToggleFullScreenMode();return true}function InitFullScreenMode(){AttachEvent("keydown",FullScreenModeOnKeyDown,document.body);SetFullScreenMode(GetCookieEx("WSS_FullScreenMode",window)=="true")}function EditSelectedImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_EditSelectedImages()}function DeleteImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DeleteImages()}function SendImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_SendImages()}function DownloadImages(){if(!IsImgLibJssLoaded()){alert(Strings.STS.L_NotOurView_Text);return}_DownloadImages()}function MtgToggleTimeZone(){var b=document.getElementById("TimeZoneSection"),a=document.getElementById("TimeZoneLink");if(b.style.display=="none"){b.style.display="";a.innerHTML="&lt;&lt;";a.title=Strings.STS.L_HideTZ_Text;SetMtgCookie("MtgTimeZone","1","")}else{b.style.display="none";a.innerHTML="&gt;&gt;";a.title=Strings.STS.L_ShowTZ_Text;SetMtgCookie("MtgTimeZone","0","")}}function GetPageUrl(b){var a=undefined;if(b&&typeof g_webUrl!="undefined")a=g_webUrl;else if(typeof g_pageUrl!="undefined")a=g_pageUrl;return unescapeProperly(a)}function MtgNavigate(a){if(typeof g_instanceId!="undefined"&&a==g_instanceId)return;if(typeof g_fPageGlobal!="undefined")var c=!g_fPageGlobal;if(typeof g_thispagedata!="undefined")var b=g_thispagedata;window.location.href=GetPageUrl(c)+"?InstanceID="+a+"&"+b}function GoToMtgMove(d,c,b,a){window.location.href=d+"/movetodt.aspx?FromInstanceID="+c+"&FromInstanceDate="+escapeProperly(b)+"&FromInstanceDateISO="+escapeProperly(a)+"&Source="+escapeProperly(window.location.href)}function MtgKeep(b,c,a){confirm(Strings.STS.L_MtgKeepConfirm_Text)&&SubmitFormPost(b+"&Cmd=MtgKeep&List="+escapeProperly(c)+"&EditInstanceID="+a+"&NextUsing="+escapeProperly(window.location.href))}function MtgDelete(c,d,a){if(confirm(Strings.STS.L_MtgDeleteConfirm_Text)){var b=a==g_instanceId;SubmitFormPost(c+"&Cmd=MtgMove&List="+escapeProperly(d)+"&FromInstanceID="+a+"&ToInstanceID=-3&NextUsing="+escapeProperly(b?GetPageUrl(true):window.location.href))}}function SetMtgCookie(a,b,c){document.cookie=a+"="+b+";path="+c}function SetAsLastTabVisited(){typeof g_pageUrl!="undefined"&&typeof g_webUrl!="undefined"&&SetMtgCookie("MtgLastTabVisited",escapeProperly(unescapeProperly(g_pageUrl)),escapeProperlyCore(unescapeProperly(g_webUrl),true))}function MtgRedirect(){var a=GetCookie("MtgLastTabVisited");if(a==null)if(typeof g_webUrl!="undefined")a=g_webUrl;else a="../../";else a=escapeProperlyCore(a,true);window.location.href=a}function MakeMtgInstanceUrl(a,c){if(c!="undefined"&&c!=""){var b=a.indexOf("?");if(b==-1||a.indexOf("InstanceID=",b)==-1)a=a+(b==-1?"?":"&")+"InstanceID="+c}return a}var filterTable,bIsFilterMenuShown,bIsFilterDataLoaded,filterImageCell,currentFilterMenu,loadingFilterMenu,ctxFilter,bIsFilterKeyPress,filterStr,strFieldName,bMenuLoadInProgress,strFilteredValue,bIsMultiFilter,fnOnFilterMouseOut;function resetFilterMenuState(){if(bMenuLoadInProgress)return;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterTable=null;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;fnOnFilterMouseOut!=null&&fnOnFilterMouseOut();fnOnFilterMouseOut=null}function setupFilterMenuContext(a){ctxFilter=a}function IsFilterMenuOn(){var a=false;if(!bIsFilterMenuShown)return false;a=bMenuLoadInProgress||MenuHtc_isOpen(currentFilterMenu)||MenuHtc_isOpen(loadingFilterMenu);if(!a)bIsFilterMenuShown=false;return a}function IsFilterMenuEnabled(b){if(b==null)return true;var a=CtxFromElement(b);return a!=null&&typeof a.fullListSearch!="undefined"&&Boolean(a.fullListSearch)?false:true}function OnMouseOverFilterDeferCall(elm){if(!IsFilterMenuEnabled(elm))return false;if(IsFilterMenuOn()||bMenuLoadInProgress)return false;if(window.location.href.search(new RegExp("[\\?&]Filter=1"))!=-1)return false;if(typeof elm.FilterDisable!="undefined"&&elm.FilterDisable=="TRUE")return false;if(IsFieldNotFilterable(elm)&&IsFieldNotSortable(elm))return false;if(filterTable==elm)return true;filterTable!=null&&OnMouseOutFilter();filterTable=elm;var isTable=filterTable.tagName=="TABLE",curCtx;try{curCtx=eval("ctx"+filterTable.getAttribute("CtxNum"))}catch(e){}if(typeof curCtx=="undefined")return false;var createCtx=new Function("setupFilterMenuContext(ctx"+filterTable.getAttribute("CtxNum")+");");createCtx();if(isTable){filterTable.className="ms-selectedtitle";SetEvent("click",CreateFilterMenu,filterTable);SetEvent("contextmenu",CreateFilterMenu,filterTable);SetEvent("mouseout",OnMouseOutFilter,filterTable)}else{var par=filterTable.parentNode;SetEvent("click",CreateFilterMenu,par);SetEvent("contextmenu",CreateFilterMenu,par);SetEvent("mouseout",OnMouseOutFilter,par);CreateCtxImg(par,OnMouseOutFilter)}if(isTable){var titleParent=filterTable.childNodes[0],titleRow=titleParent.childNodes[0];filterImageCell=titleRow.childNodes[titleRow.childNodes.length-1];var filterArrow=filterImageCell.childNodes[0];filterArrow.src=ctxFilter.imagesPath+"menudark.gif";filterArrow.alt=Strings.STS.L_OpenMenu_Text;filterArrow.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function OnMouseOutFilter(a){if(!IsFilterMenuOn()&&filterTable!=null&&!bMenuLoadInProgress){var c=filterTable.tagName=="TABLE",b=filterTable.parentNode;if(c||b==null){filterTable.className="ms-unselectedtitle";filterTable.onclick=null;filterTable.oncontextmenu=null;filterTable.onmouseout=null}else{if(a==null)a=window.event;if(a!=null){var d=typeof a.toElement!="undefined"&&a.toElement!=null?a.toElement:a.relatedTarget;if(b!=null&&d!=null&&IsContained(d,b))return}b.onclick=null;b.oncontextmenu=null;b.onmouseout=null;RemoveCtxImg(b);if(g_menuLaunchPoint!=null){g_menuLaunchPoint.setAttribute("aria-expanded","false");g_menuLaunchPoint.focus();g_menuLaunchPoint=null}}if(c&&filterImageCell!=null&&filterImageCell.childNodes.length>0){filterImageCell.childNodes[0].style.visibility="hidden";filterImageCell.className=""}resetFilterMenuState()}}function PopFilterMenu(a){var b;if(a==null)a=window.event;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsFilterMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){var c=Boolean(a.srcElement)?a.srcElement:a.target;if(!IsFilterMenuEnabled(c))return true;var d=FindSTSMenuTable(c,"CTXNum");if(d==null)return false;OnMouseOverFilterDeferCall(d);CreateFilterMenu(a);return false}else return true}function CreateFilterMenu(a){if(filterTable==null||filterTable.tagName=="TABLE"&&filterImageCell==null)return true;var b=filterTable.tagName=="DIV"?filterTable.parentNode:filterTable,c=FindCtxImg(b);c!=null&&c.shown==false&&ShowCtxImg(c,true,b);if(a==null)a=window.event;bIsFilterMenuShown=true;if(a!=null)if(Boolean(a.target))g_menuLaunchPoint=a.target;else if(Boolean(a.srcElement))g_menuLaunchPoint=a.srcElement;window.origBodyOnClickHandler=document.body.onclick;window.document.body.onclick=null;currentFilterMenu=CMenu("filter_menu");loadingFilterMenu=CMenu("filter_menu_loading");currentFilterMenu.setAttribute("CompactMode","true");addSortMenuItems(currentFilterMenu,loadingFilterMenu);if(filterStr==null)addFilterMenuItems(currentFilterMenu,loadingFilterMenu);else addAdHocFilterMenuItems(currentFilterMenu,loadingFilterMenu);if(HasCssClass(b,"ms-headerCellStylePressed")||HasCssClass(b,"ms-headerCellStyleHover")){RemoveCssClassFromElement(b,"ms-headerCellStylePressed");RemoveCssClassFromElement(b,"ms-headerCellStyleHover");AddCssClassToElement(b,"ms-headerCellStyleMenuOpen")}a!=null&&a.stopPropagation!=null&&a.stopPropagation();return false}function IsFieldNotSortable(a){return a.getAttribute("Sortable")=="FALSE"||a.getAttribute("SortDisable")=="TRUE"||a.getAttribute("FieldType")=="MultiChoice"?true:false}function addSortMenuItems(b,a){if(IsFieldNotSortable(filterTable)){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var e="",f="",d="",g=GetThemedLocalizedImageUrl("SortUpGlyph.png"),h=GetThemedLocalizedImageUrl("SortDownGlyph.png");if(filterStr==null){var c=ctxFilter.queryString;if(null==c||c=="")c=filterTable.getAttribute("SortFields");else{var z=Nav.getUrlKeyValue("SortField",true,c),w=filterTable.getAttribute("SortFields"),v=Nav.getUrlKeyValue("SortField",true,w);if(z!=v){c=SetUrlKeyValue("SortField",v,false,c);c=SetUrlKeyValue("SortDir",Nav.getUrlKeyValue("SortDir",true,w),false,c)}}var l=new URI(c,{disableEncodingDecodingForLegacyCode:true});if(l.getQuery().length>0)c=l.getQuery();var r=c.indexOf("&SortDir");if(r==-1){CAMOptFilter(b,a,Strings.STS.L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var q=c.indexOf("&",r+1),t=GetUrlWithNoSortParameters(c);t=RemovePagingArgs(t);l=new URI(t,{disableEncodingDecodingForLegacyCode:true});var k="?"+l.getQuery();if(k.length>1)k+="&";var C=k;if(q<0)q=c.length;k+=c.substr(0,r)+"&SortDir=Asc"+c.substr(q);l.setQuery(k);e="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";k=C;k+=c.substr(0,r)+"&SortDir=Desc"+c.substr(q);l.setQuery(k);f="HandleFilter(event, '"+STSScriptEncode(l.getString())+"', 1);";if(e.indexOf("?")>=0)e.substr(e.indexOf("?")+1).indexOf("?")>=0;d=filterTable.getAttribute("FieldType");strFieldName=filterTable.getAttribute("Name")}else{var s=" ",j=filterStr.lastIndexOf(s);d=filterStr.substring(j+1);if(d.substring(0,2)=="x:")d=d.substring(2);var o=filterStr.substring(0,j);j=o.lastIndexOf(s);strFieldName=o.substring(j+1);if(strFieldName.substring(0,1)=="@")strFieldName=strFieldName.substring(1);o=filterStr.substring(0,j);j=o.lastIndexOf(s);if(j>0)strFieldName=o.substring(0,j);var B=filterTable.tagName=="TABLE",i=null;if(B){var y=filterTable.childNodes[0],A=y.childNodes[0],x=A.childNodes[0];i=x.childNodes[0];if(i.tagName=="TABLE"){var n=i.childNodes[0];n=n.childNodes[0];n=n.childNodes[1];i=n.childNodes[0]}}else i=filterTable.firstChild;if(i.tagName=="DIV")i=i.childNodes[0];var m=i.href;m=m.replace(/%20/g," ");if(m.indexOf("'ascending'")>0){e=m;f=m.replace("'ascending'","'descending'")}else{f=m;e=m.replace("'descending'","'ascending'")}}d=d.toLowerCase();if(d=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="integer"||d=="number"||d=="currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(d=="text"||d=="user"||d=="string"){CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}else if(d=="calculated"){var p=filterTable.getAttribute("ResultType");if(p=="Number"||p=="Currency"){CAMOptFilter(b,a,Strings.STS.L_SmallestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_LargestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="dateTime"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else if(p=="boolean"){CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_AOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_ZOnTop_Text,f,h,true,"fmi_desc")}}else if(d=="attachments"){CAMOptFilter(b,a,Strings.STS.L_BlanksOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_AttachmentsOnTop_Text,f,h,true,"fmi_desc")}else if(d=="lookup"){var u=filterTable.getAttribute("Name");if(u=="Last_x0020_Modified"||u=="Created_x0020_Date"){CAMOptFilter(b,a,Strings.STS.L_OldestOnTop_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_NewestOnTop_Text,f,h,true,"fmi_desc")}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}}else{CAMOptFilter(b,a,Strings.STS.L_Ascending_Text,e,g,true,"fmi_asc");CAMOptFilter(b,a,Strings.STS.L_Descending_Text,f,h,true,"fmi_desc")}CAMSep(b);CAMSep(a)}function CAMOptFilter(h,g,d,f,c,b,e){var a;a=CAMOpt(h,d,f,c);a.id=e;if(!b){a.setAttribute("enabled","false");a.disabled=true}a=CAMOpt(g,d,f,c);a.id=e+"_p";if(!b){a.setAttribute("enabled","false");a.disabled=true}}function ShowFilterLoadingMenu(){!bIsFilterDataLoaded&&filterTable!=null&&FilterOMenu(loadingFilterMenu,filterTable)}function IsFieldNotFilterable(a){return a.getAttribute("Filterable")=="FALSE"||a.getAttribute("FilterDisable")=="TRUE"||a.getAttribute("FieldType ")=="Note"||a.getAttribute("FieldType ")=="URL"?true:false}function addFilteringDisabledMenuItem(a){FilterOMenu(a,filterTable);a._onDestroy=OnMouseOutFilter}function addFilterMenuItems(n,k){if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(n);return}var e=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(e==null)return;var c=ctxFilter.queryString;if(null==c||c=="")c=e.getAttribute("FilterLink");(c==null||c=="")&&window.alert("Unexpected");if(c=="?"){var r=ajaxNavigate.getParam("InplviewHash"+ctxFilter.view);if(Boolean(r))c+=InplViewUtil.DecodeHashAsQueryString(r)}var h=escapeProperly(filterTable.getAttribute("Name"));strFilteredValue=null;var a="",d=0,b,f;do{d++;var s=false;b=c.match(new RegExp("FilterField"+String(d)+"=[^&#]*"));if(!Boolean(b))b=c.match(new RegExp("FilterFields"+String(d)+"=[^&#]*"));f=c.match(new RegExp("&FilterValue"+String(d)+"=[^&#]*"));if(!Boolean(f)){f=c.match(new RegExp("&FilterValues"+String(d)+"=[^&#]*"));s=true}if(b!=null&&f!=null){if(strFilteredValue==null){strFilteredValue=getFilterValueFromUrl(b.toString()+f.toString(),h);bIsMultiFilter=s}a=a+"&"+b.toString()+f.toString();var q=c.match(new RegExp("&FilterOp"+String(d)+"=[^&#]*"));if(q!=null)a=a+q.toString();var i=c.match(new RegExp("&FilterLookupId"+String(d)+"=[^&#]*"));if(i!=null)a=a+i.toString();var m=c.match(new RegExp("&FilterData"+String(d)+"=[^&#]*"));if(m!=null)a=a+m.toString();if(i!=null&&m==null&&strFilteredValue!=null){addFilteringDisabledMenuItem(n);return}}}while(null!=b);var p=strFilteredValue!=null,t=StBuildParam(Strings.STS.L_DontFilterBy_Text,filterTable.getAttribute("DisplayName")),u="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,h,"",0,ctxFilter.queryString,true))+"')",l;if(p)l=GetThemedImageUrl("DeleteFilterGlyph.png");else l=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");CAMOptFilter(n,k,t,u,l,p,"fmi_clr");var v=CAMOpt(k,Strings.STS.L_Loading_Text,"");v.setAttribute("enabled","false");setTimeout("ShowFilterLoadingMenu()",500);k._onDestroy=OnMouseOutFilter;b=c.match(new RegExp("MembershipGroupId=[^&]*"));if(b!=null)a=a+"&"+b.toString();b=c.match(new RegExp("InstanceID=[^&]*"));if(b!=null)a=a+"&"+b.toString();if(a!=null&&a.length>0){if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ReconcileQstringFilters(a.substring(1),ctxFilter.overrideFilterQstring)}else if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ctxFilter.overrideFilterQstring;var j="",g;if(ctxFilter!=null&&(g=ctxFilter.clvp)!=null&&g.rootFolder!=null&&g.rootFolder.length>0)j="&RootFolder="+URI_Encoding.encodeURIComponent(g.rootFolder);else{b=c.match(new RegExp("RootFolder=[^&]*"));if(b!=null)j="&"+b.toString()}var o="";b=a.match(new RegExp("OverrideScope=[^&]*"));if(ctxFilter!=null&&typeof ctxFilter.overrideScope!="undefined"&&b==null)o="&OverrideScope="+escapeProperlyCore(ctxFilter.overrideScope,false);if(browseris.safari){e.src="/_layouts/15/blank.htm";e.style.offsetLeft="-550px";e.style.offsetTop="-550px";e.style.border="0px";e.style.display="block"}e.src=ctxFilter.HttpRoot+"/_layouts/15/filter.aspx?ListId="+ctxFilter.listName+j+o+"&FieldInternalName="+h+"&ViewId="+ctxFilter.view+"&FilterOnly=1&Filter=1"+a;bMenuLoadInProgress=true}function _OnIframeLoad(){bMenuLoadInProgress=false;if(filterTable!=null&&filterTable.getAttribute("Name")!=null){var b=null;b=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(b!=null){var c=GetIFrameDoc(b),e=filterTable.getAttribute("Name");if(c!=null){var h=c.getElementById("diidFilterCustomTable");if(h!=null&&(typeof b.contentWindow!="undefined"&&null!=b.contentWindow&&typeof b.contentWindow.CustomPopulateFilterMenu!="undefined"&&null!=b.contentWindow.CustomPopulateFilterMenu||typeof c.defaultView!="undefined"&&null!=c.defaultView&&typeof c.defaultView.CustomPopulateFilterMenu!="undefined"&&null!=c.defaultView.CustomPopulateFilterMenu))if(null!=b.contentWindow)b.contentWindow.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else c.defaultView.CustomPopulateFilterMenu(currentFilterMenu,h,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else{var i=c.getElementById("diidFilter"+e);e=escapeProperly(e);if(i!=null){var k=i.childNodes.length;if(k>500)addFilterOptionMenuItem();else for(var d=i.childNodes,a=1;a<k;a++){var g;if(d[a].innerText)g=d[a].innerText;else if(d[a].textContent)g=d[a].textContent;else g=d[a].innerHTML;var m="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,e,d[a].value,a,ctxFilter.queryString,true))+"')",j=CAMOpt(currentFilterMenu,g,m);ctxFilter.IsClientRendering&&j.setAttribute("checked","false");if(strFilteredValue!=null){var f=[];if(bIsMultiFilter)f=URI.parseMultiColumnValue(strFilteredValue,";#",true);else f.push(strFilteredValue);for(var l in f)f[l]!=null&&f[l]==d[a].value&&j.setAttribute("checked","true")}}}else{alert(Strings.STS.L_FilterThrottled_Text);return}}bIsFilterDataLoaded=true;if(loadingFilterMenu!=null)loadingFilterMenu._onDestroy=null;if(currentFilterMenu!=null){currentFilterMenu._onDestroy=OnMouseOutFilter;FilterOMenu(currentFilterMenu,filterTable)}}}}}function addFilterOptionMenuItem(){var a=ajaxNavigate.get_href();a=URI.stURLSetVar2(a,"Filter","1");a=URI.stURLSetVar2(a,"View",ctxFilter.view);a="javascript:SubmitFormPost('"+STSScriptEncode(a)+"')";CAMOpt(currentFilterMenu,Strings.STS.L_FilterMode_Text,a)}function OnMouseOverAdHocFilterDeferCall(g,f){filterStr=f;if(IsFilterMenuOn())return false;filterTable!=null&&OnMouseOutFilter();filterTable=g;var d=filterTable.tagName=="TABLE";if(d){filterTable.className="ms-selectedtitle";SetEvent("click",CreateFilterMenu,filterTable);SetEvent("contextmenu",CreateFilterMenu,filterTable);SetEvent("mouseout",OnMouseOutFilter,filterTable)}else{var a=filterTable.parentNode;SetEvent("click",CreateFilterMenu,a);SetEvent("contextmenu",CreateFilterMenu,a);SetEvent("mouseout",OnMouseOutFilter,a);CreateCtxImg(a,OnMouseOutFilter)}if(d){var e=filterTable.childNodes[0],c=e.childNodes[0];filterImageCell=c.childNodes[c.childNodes.length-1];var b=filterImageCell.childNodes[0];b.src="/_layouts/15/images/menudark.gif?rev=47";b.alt=Strings.STS.L_OpenMenu_Text;b.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function addAdHocFilterMenuItems(b,a){if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(b);return}var c=CAMOpt(a,Strings.STS.L_Loading_Text,"");c.setAttribute("enabled","false");FilterOMenu(a,filterTable);a._onDestroy=OnMouseOutFilter;typeof DoCallBack=="function"&&DoCallBack("__filter={"+filterStr+"}");filterStr=null}function UpdateFilterCallback(b){var j="</OPTION>",a=-1;a=b.indexOf(j,a+1);var d=b.lastIndexOf(">",a),l=StBuildParam(Strings.STS.L_DontFilterBy_Text,strFieldName),i,e="",c,f;if(d<a-1){c=b.lastIndexOf('"',a);if(c>0){f=b.lastIndexOf('"',c-1);if(f>0)e=b.substring(f+1,c)}}if(d==a-1)i=GetThemedImageUrl("DisabledDeleteFilterGlyph.png");else i=GetThemedImageUrl("DeleteFilterGlyph.png");var g;if(a>0){g=CAMOpt(currentFilterMenu,l,e,i);g.setAttribute("enabled",d==a-1?"false":"true");c=a;var m='<OPTION href="';a=b.indexOf(j,a+8);while(a>0){d=b.indexOf(m,c+8);d=b.indexOf('"',d+20);if(d>0&&d<a){var k=b.indexOf(">",d),h=b.substring(k+1,a);e="";c=b.lastIndexOf('"',d);if(c>0){f=b.lastIndexOf('"',c-1);if(f>0){e=b.substring(f+1,c);e=e.replace(/&amp;/g,"&")}}if(h.length>40)h=h.substring(0,40)+"...";if(h.length>0){g=CAMOpt(currentFilterMenu,h,e);k>d+1&&g.setAttribute("checked","true")}}c=a;a=b.indexOf(j,a+8)}}else{g=CAMOpt(currentFilterMenu,Strings.STS.L_OpenMenu_Text,Strings.STS.L_NotFilterable_Text,"");g.setAttribute("enabled","false");FilterOMenu(currentFilterMenu,filterTable);return}loadingFilterMenu._onDestroy=null;FilterOMenu(currentFilterMenu,filterTable);currentFilterMenu._onDestroy=OnMouseOutFilter}function FilterOMenu(c,a){if(a==null)return;var b=a.tagName=="DIV"?a.parentNode:a;OMenu(c,b,null,null,-1)}function _OnClickFilter(c,b){if(!IsFilterMenuEnabled(c)){alert(Strings.STS.L_SortNotAllowed);return false}if(FV4UI()){if(browseris.ie){b.cancelBubble=true;b.returnValue=false}else b.stopPropagation();EnsureScriptParams("inplview","inplview.OnClickFilterV4",c);return false}var d=FindSTSMenuTable(c,"CTXNum");if(d!=null&&d.getAttribute("SortFields")!=null){var e=d.getAttribute("SortFields"),a=GetUrlWithNoSortParameters(e);a=RemovePagingArgs(a);if(a.indexOf("?")<0)a+="?";else a+="&";SubmitFormPost(a+e)}if(!bIsFileDialogView)b.cancelBubble=true;return false}function ToggleSelectionAllUsers(b){var a=document.getElementById("spToggleUserSelectionCheckBox_"+b.toString());if(a!=null){var g="spUserSelectionCheckBox_"+b.toString(),f=document.getElementsByName(g);a.checked=!a.checked;for(var d=0;d<f.length;d++){var e=f[d];if(!e.disabled)e.checked=a.checked}var h="cbxUserSelectAll"+b.toString(),c=document.getElementById(h);if(c!=null)if(a.checked)c.src="/_layouts/15/images/checkall.gif";else c.src="/_layouts/15/images/unchecka.gif"}}function _UserSelectionOnClick(j,c){var h="cbxUserSelectAll"+c.toString(),b=document.getElementById(h),a=document.getElementById("spToggleUserSelectionCheckBox_"+c.toString());if(!j.checked){if(a!=null)a.checked=false;if(b!=null)b.src="/_layouts/15/images/unchecka.gif"}else{for(var g="spUserSelectionCheckBox_"+c.toString(),f=document.getElementsByName(g),e=true,d=0;d<f.length;d++){var i=f[d];if(!i.checked){e=false;break}}if(e){if(null!=b)b.src="/_layouts/15/images/checkall.gif";if(null!=a)a.checked=true}}}function initPageRequestManagerForDFWP(){var a=Sys.WebForms.PageRequestManager.getInstance();typeof a.add_beginRequest!="undefined"&&a.add_beginRequest(hideMRBForRequest)}function hideMRBForRequest(d,c){if(typeof c.get_postBackElement!="undefined"){var a=c.get_postBackElement();if(a==null||a.value==null||a.value=="")return;var b=$get(a.value);if(b==null)return;hideMRB(b.parentNode)}}function hideMRB(d){var a;if(d==null)return;var b=d.childNodes,f=b.length;for(a=0;a<f;a++){var c=b[a];if(c.tagName=="IMG"){var e=new RegExp("ManualRefresh","i");if(c.id!=undefined&&e.test(b[a].id)){hideElement(c);break}}}}function hideElement(a){if(a==null)return;a.style.visibility="hidden";a.style.display="none"}var g_errMsg,L_SSCDlgInvalidCharacter_TEXT,g_btnCreateId,g_txtTitleId,g_CusValTxtTitle;function format(b){for(var a=1,c=arguments.length;a<c;a++)b=b.replace("{"+String(a-1)+"}",arguments[a]);return b}function SSC_ValidateRequiredFields(){var d=false,a=document.getElementById(g_txtTitleId).value,e=document.getElementById("LabelPreviewSiteUrl");e.innerHTML=STSHtmlEncode(a);var c=document.getElementById("error_txtTitle");if(a.length>0){var b=IndexOfIllegalCharInUrlLeafName(a);if(b==-1)b=a.indexOf("+");if(b!=-1){var f=a.charAt(b);c.innerHTML=format(L_SSCDlgInvalidCharacter_TEXT,f)}else{c.innerHTML="";d=true}}else c.innerHTML="";if(d)document.getElementById(g_btnCreateId).disabled=false;else document.getElementById(g_btnCreateId).disabled=true;document.getElementById(g_CusValTxtTitle).innerHTML="";window.setTimeout("UpdateSSCDialogPageSize();",1)}function SSC_MakeErrorStatusWithMessage(b){var a=null;if(b!=null&&typeof b!="undefined"){removeAllStatus(false);a=addStatus("",b,true);if(a!=null){setStatusPriColor(a,"red");window.setTimeout("UpdateSSCDialogPageSize();",1)}}return a}function SSC_MakeErrorStatus(){return SSC_MakeErrorStatusWithMessage(g_errMsg)}function RibbonBlock(){}var _ribbon;function _ribbonClear(){_ribbon=function(a){return a}()}function _ribbonInitFunc1Wrapped(p0,p1,p2,p3,p4,p5,p8,p9,p10,p11,p12,p13,p14,p15,p18,p20,p21,p24,p27,p28,p29){var temp;try{temp=new CUI.RibbonBuildOptions}catch(e){return}var options=new CUI.RibbonBuildOptions;options.lazyTabInit=true;options.shallowTabs=true;options.lazyMenuInit=true;options.attachToDOM=p12;options.initialScalingIndex=p13;options.validateServerRendering=p14;options.showQATId=p0;options.showJewelId=p1;options.minimized=_ribbon.buildMinimized;options.shownTabs=p8;options.shownContextualGroups=p9;options.initiallyVisibleContextualGroups=p20;options.normalizedContextualGroups=p24;options.trimmedIds=p10;options.enabledVisibilityContexts=p11;options.fixedPositioningEnabled=p18;options.clientID=p5;options.trimEmptyGroups=true;options.dataExtensions=p21;options.scalingHint=p27;options.initialTabSelectedByUser=_ribbon.initialTabSelectedByUser;options.launchedByKeyboard=_ribbon.launchedByKeyboard;options.percentPositivePattern=p28;options.decimalSeparator=p29;try{temp=eval(p15)}catch(e){return}var builder;builder=new CUI.RibbonBuilder(options,document.getElementById(p5),eval(p15));var dataSource=new CUI.DataSource(p2,p3,p4);builder.set_dataSource(dataSource);var handlerFunction=Function.createDelegate(builder,builder.buildRibbonFromData);builder.fetchAndProcessRibbonData(_ribbon.initialTabId,function(b){var a=g_ExecuteOrWaitJobs["sp.bodyloaded"];if(a!=null&&typeof a!="undefined"&&a.notified)handlerFunction(b.queryData,_ribbon.initialTabId);else _spBodyOnLoadFunctions.push(function(){handlerFunction(b.queryData,_ribbon.initialTabId)})})}function _ribbonStartInitWrapped(initialTabId,buildMinimized,e,p26,p16){if(typeof _ribbon=="undefined"||_ribbon==null)return;if(Boolean(e))_ribbon.initialTabSelectedByUser=true;var firstTabId=null,evt=Boolean(e)?e:window.event;if(Boolean(evt))if(!Boolean(evt.preventDefault))evt.returnValue=false;else evt.preventDefault();if(Boolean(_ribbon)&&typeof _ribbon.initStarted!="undefined"&&_ribbon.initStarted)return;_ribbon.initStarted=true;typeof CUI!="undefined"&&typeof CUI.PMetrics!="undefined"&&CUI.PMetrics.perfMark(CUI.PMarker.perfCUIRibbonInitStart);if(Boolean(initialTabId)){firstTabId=_ribbon.initialTabId;_ribbon.initialTabId=initialTabId}if(typeof buildMinimized!="undefined")_ribbon.buildMinimized=buildMinimized;if(Boolean(initialTabId)&&typeof _ribbonOnStartInit!="undefined"){_ribbonOnStartInit(_ribbon);var oldTab=document.getElementById(firstTabId+"-title");if(Boolean(oldTab))oldTab.className="ms-cui-tt";var newTab=document.getElementById(initialTabId+"-title");if(Boolean(newTab))newTab.className="ms-cui-tt ms-cui-tt-s"}eval(p16)}var _spRibbonInstantiateByRibbonControl;function RibbonControlInitWrapped(){_spRibbonInstantiateByRibbonControl=true;ExecuteOrDelayUntilScriptLoaded(_registerCommonComponents,"sp.ribbon.js")}function _registerCUIEComponentWrapped(b,c,d){var a=SP.Ribbon.CommandUIExtensionPageComponent.get_instance();a.set_dataUrl(b);a.set_dataLCID(c);a.set_dataVersion(d);SP.Ribbon.CommandUIExtensionPageComponent.registerWithPageManager()}function _ribbonKeyboardTitleShortcutWrapped(f,g,h){var a=Boolean(f)?f:window.event;if(Boolean(a)){var b=a.ctrlKey?"t":"f";b+=a.altKey?"t":"f";b+=a.shiftKey?"t":"f";try{b+=String.fromCharCode(_processKeyCodes(a.keyCode))}catch(i){return}if(b==g||a.ctrlKey&&a.keyCode==117){if(Boolean(document.selection)&&document.selection.type=="Control"){for(var d=document.selection.createRange(),c=d.length;c>0;c--)d.remove(c-1);d.select()}var e=document.getElementById(h);if(Boolean(e)){e.firstChild.focus();if(Boolean(a.preventDefault))a.preventDefault();else a.returnValue=false;if(Boolean(a.stopPropagation))a.stopPropagation();else a.cancelBubble=true}}}}function _ribbonOnWindowResizeForHeaderScalingWrapped(d,b,c){if(_ribbon.initStarted)return;var a=document.getElementById(b);Boolean(a)&&_ribbonScaleHeader(a.firstChild.childNodes[1],c)}function _ribbonInitResizeHandlers(a,b,c,d){if(typeof _ribbonScaleHeader=="function"&&c){_ribbonScaleHeader(document.getElementById(b).firstChild.childNodes[1],d);if(Boolean(window.addEventListener))window.addEventListener("resize",a,false);else Boolean(window.attachEvent)&&window.attachEvent("onresize",a)}}function _ribbonAddEventListener(a){if(Boolean(document.addEventListener))document.addEventListener("keydown",a,false);else document.attachEvent("onkeydown",a)}function FNEmpWz(a){return null!=a&&""!=a}function AChld(b,a){null!=b&&null!=a&&b.appendChild(a)}function AImg(a,c,b){if(null==a)return;FNEmpWz(c)&&a.setAttribute("iconSrc",c);if(FNEmpWz(b))a.setAttribute("iconAltText",b);else a.setAttribute("iconAltText","")}function CMenu(b){var a=document.getElementById(b);if(null!=a){a._initialized=false;a._oContents=null;a.innerHTML="";return a}a=document.createElement("MENU");if(null==a)return null;if(null!=b)a.id=b;a.className="ms-SrvMenuUI";var d=document.body;if(typeof g_clientIdDeltaPlaceHolderUtilityContent!="undefined"&&Boolean(g_clientIdDeltaPlaceHolderUtilityContent)){var c=document.getElementById(g_clientIdDeltaPlaceHolderUtilityContent);if(Boolean(c))d=c}AChld(d,a);return a}function CMItm(b){var a=document.createElement("SPAN");if(null==a)return null;a.setAttribute("type",b);return a}function CMOpt(f,g,e,d,c,b){var a=CMItm("option");if(null==a)return null;a.setAttribute("text",f);a.setAttribute("onMenuClick",g);null!=b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CAMOpt(h,f,g,e,c,d,b){var a=CMOpt(f,g,e,c,d,b);if(null==a)return null;AChld(h,a);return a}function CIMOpt(c,h,i,g,f,d){var a=CMOpt(h,i,g,f,d);if(null==a)return null;for(var b=0;b<c.childNodes.length;b++){var e=c.childNodes[b].getAttribute("sequence");if(e)if(Number(e)>Number(d)){c.childNodes[b].parentNode.insertBefore(a,c.childNodes[b]);return a}}AChld(c,a);return a}function CMSep(){var a=CMItm("separator");setInnerText(a,"");return a}function CAMSep(b){var a=CMSep();if(null==a)return null;AChld(b,a);return a}function CSubM(f,e,d,c,b){var a=CMItm("submenu");if(null==a)return null;a.setAttribute("text",f);null!=b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CASubM(g,f,e,c,d,b){var a=CSubM(f,e,c,d,b);if(null==a)return null;AChld(g,a);return a}function FRdy(a){if(null==a)return false;if(a.readyState==null)return true;switch(a.readyState){case"loaded":case"interactive":case"complete":return true;default:return false}return false}function OMenu(j,k,g,h,e,d,c,f){var b=j,a;if(typeof b=="string"){var i=b;a=document.getElementById(i)}else a=b;null!=a&&OMenuInt(a,k,g,h,e,d,c,f);return false}function OMenuInt(a,h,b,g,e,d,c,f){(null!=a&&!MenuHtc_isOpen(a)||null!=a&&null!=b)&&MenuHtc_show(a,h,b,g,e,d,c,f)}function OMenuEvnt(){var a=event.srcElement;if(null!=a&&FRdy(document)){var e=a.relativeTo,c=a.forceRefresh,d=a.flipTop,b=a.yOffsetTop;e!=null&&a.removeAttribute("relativeTo");c!=null&&a.removeAttribute("forceRefresh");d!=null&&a.removeAttribute("flipTop");b!=null&&a.removeAttribute("yOffsetTop");a.onreadystatechange=null;OMenuInt(a,e,c,d,b)}}var kfnDisableEvent,g_menuHtc_lastMenu,g_uniqueNumber,g_MenuEndOfDOM;function RenderECBBackwardCompatibilityMode(a){g_MenuEndOfDOM=a}function IsAccessibilityFeatureEnabledProxy(){var a=false;if(typeof IsAccessibilityFeatureEnabled!="undefined")a=IsAccessibilityFeatureEnabled();return a}function MenuHtc_show(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt){MenuHtc_hide();MenuHtc_init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=IsElementRtl(oMaster._oParent);if((BrowserDetection.userAgent.ie||BrowserDetection.userAgent.nav)&&IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa!=null){var foa=oParent.foa;menu=byid(foa);if(menu==null)menu=eval(foa)}if(menu!=null)typeof menu.onblur!="undefined"&&menu.onblur!=null&&menu.onblur();RenderAccessibleMenu(oMaster,fForceRefresh);g_menuHtc_lastMenu=oMaster}else{SetBodyEventHandlers(null);AssureId(oParent);var result=ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,yOffset,fShowClose,fShowCheckBoxes,evt);g_menuHtc_lastMenu=oMaster;SetBodyEventHandlers(HandleDocumentBodyClick)}if(BrowserDetection.userAgent.ie)if(window.event!=null)window.event.cancelBubble=true;return false}function MenuHtc_hide(){ClearTimeOutToHideMenu();var a=g_menuHtc_lastMenu;if(a!=null)if(a._accessibleMenu!=null)CloseAccessibleMenu(a);else HideMenu(a);g_menuHtc_lastMenu=null}function MenuHtc_isOpen(a){if(null==a||null==a._initialized)return false;var b=IsOpen(a);return b}function MenuHtc_item(a,c,b){MenuHtc_init(a);var d=GetItem(a,c,b);return d}function TrapMenuClick(a){if(a!=null)a.cancelBubble=true;return false}function SetBodyEventHandlers(a){SetEvent("click",a,document.body)}function HandleDocumentBodyClick(){if(g_menuHtc_lastMenu!=null){var a=g_menuHtc_lastMenu;a!=null&&HideMenu(a)}return false}function GetEventPopup(b){var a=GetEventSrcElement(b);while(a!=null){if(a.master!=null)return a;a=a.parentNode}return null}function GetUniqueNumber(){g_uniqueNumber++;return g_uniqueNumber}function MenuHtc_init(a){if(a._initialized)return;a._initialized=true;a._wzPrefixID="mp"+String(GetUniqueNumber());if(a.id==null)a.id=a._wzPrefixID+"_id";a._nLevel=0;a._arrPopup=[];a._arrSelected=[];if(typeof a._onDestroy=="undefined")a._onDestroy=null;a._fLargeIconMode=false;a._fCompactItemsWithoutIcons=false}function PrepContents(a){var c;a._fLargeIconMode=a.getAttribute("largeIconMode")=="true";a._fHideIcons=a.getAttribute("hideicons")=="true";a._fCompactItemsWithoutIcons=a.getAttribute("CompactMode")=="true";if(!BrowserDetection.userAgent.safari){c=document.createElement("span");a._oContents=c;c.style.display="none";var b=a.innerHTML;if(b.indexOf("<IE:MENUITEM ")<0&&b.indexOf("<MENUITEM ")>=0){b="<?XML:NAMESPACE PREFIX = IE />"+b;b=b.replace(/<MENUITEM/g,"<IE:MENUITEM");b=b.replace(/<\/MENUITEM/g,"</IE:MENUITEM")}c.innerHTML=b}else{c=a.cloneNode(true);a._oContents=c;c.style.display="none"}a._wzMArrPath="/_layouts/15/images/MArr.gif";a._wzMArrPathRtL="/_layouts/15/images/MArrRtL.gif"}function FixUpMenuStructure(j){for(var f=j._oRoot,h=f.childNodes,g=null,a=null,d=false,c=0;c<h.length;c++){var b=h[c];if(b.nodeType!=1)continue;var e=false,k=b.style!=null&&b.style.display=="none",l=FIsIHidden(b);if(k||l)e=true;else if(FIsIType(b,"separator"))if(a!=null||c==0)e=true;else{a=b;d=true}else{var i=b.getAttribute("menuGroupId");if(i!=g&&a==null&&c!=0){a=document.createElement("ie:menuitem");a.setAttribute("type","separator");f=j._oRoot;f.insertBefore(a,b)}else if(FIsIType(b,"submenu")&&a!=null&&!d){b.parentNode.removeChild(a);a=null}else a=null;g=i;d=false}if(e){b.parentNode.removeChild(b);c--}else b.removeAttribute("hidden")}a!=null&&a.parentNode.removeChild(a)}function IsElementRtl(a){while(a!=null&&a.tagName!=null){var b=a.getAttribute("dir");if((b==null||b=="")&&a.style!=null)b=a.style.direction;if(b=="rtl")return true;else if(b=="ltr")return false;a=a.parentNode}return false}function getElementOverFlowStyle(a){try{return typeof a.currentStyle!=undefined&&a.currentStyle!=null?a.currentStyle.overflow.toLowerCase():document.defaultView.getComputedStyle(a,null).getPropertyValue("overflow").toLowerCase()}catch(b){return""}}function AdjustScrollPosition(d,e,b){var a=d;while(a!=null&&a!=e&&a!=d.offsetParent&&a.tagName!=null&&a.tagName.toLowerCase()!="body"&&a.tagName.toLowerCase()!="html"&&!(getElementOverFlowStyle(a)=="hidden")){if(a.scrollWidth>a.clientWidth&&a.offsetWidth>=a.clientWidth&&a.clientWidth!=0)if(!IsElementRtl(a)){if(a.scrollLeft>0)b.x-=a.scrollLeft}else if(BrowserDetection.userAgent.ie8standardUp)b.x+=a.scrollLeft;else if(BrowserDetection.userAgent.firefox)b.x-=a.scrollLeft;else{var c=getElementOverFlowStyle(a);if(BrowserDetection.userAgent.ie||BrowserDetection.userAgent.safari&&(c=="auto"||c=="scroll"))b.x+=a.scrollWidth-a.clientWidth-a.scrollLeft}if(a.scrollTop>0)b.y-=a.scrollTop;a=a.parentNode}}function ElementPosition_InitializePrototype(){ElementPosition.prototype.x=undefined;ElementPosition.prototype.y=undefined;ElementPosition.prototype.width=undefined;ElementPosition.prototype.height=undefined}function ElementPosition(c,d,b,a){this.x=c;this.y=d;this.width=b;this.height=a}function MenuHtc_GetElementPosition(a,d){var b=new ElementPosition(0,0,0,0);if(null!=a.offsetParent){var c=a;while(c!=null&&c!=d){b.x+=c.offsetLeft;b.y+=c.offsetTop;AdjustScrollPosition(c,d,b);var e=c.tagName.toLowerCase();if(e!="body"&&e!="html"&&c.clientTop!=null&&c.clientLeft!=null&&c!=a){b.x+=c.clientLeft;b.y+=c.clientTop}c=c.offsetParent}}else if(0!=a.offsetLeft||0!=a.offsetTop){b.x=a.offsetLeft;b.y=a.offsetTop}else{if(Boolean(a.x))b.x=a.x;if(Boolean(a.y))b.y=a.y}if(0!=a.offsetWidth&&0!=a.offsetHeight){b.width=a.offsetWidth;b.height=a.offsetHeight}else if(null!=a.style&&typeof a.style.pixelWidth!="undefined"&&0!=a.style.pixelWidth&&typeof a.style.pixelHeight!="undefined"&&0!=a.style.pixelHeight){b.width=a.style.pixelWidth;b.height=a.style.pixelHeight}return b}function MenuTag(b,a){this.tagName=b;this.className=a}function MenuTag_InitializePrototype(){MenuTag.prototype.tagName=undefined;MenuTag.prototype.className=undefined}function CreateMenuTag(a){var b=null;if(a.tagName!=null){b=document.createElement(a.tagName);if(a.className!=null)b.className=a.className}return b}function TransferEventToMenu(b,c){var a;if(BrowserDetection.userAgent.ie)a={srcElement:b,keyCode:c.keyCode};else a={target:b,which:c.which};PopupKeyDown(a)}function MenuHtcInternal_Show(c,b,B,k,y,x,m){var q,A,z,p;!Boolean(c._oContents)&&PrepContents(c);var i="ms-core-menu-box";if(c._fLargeIconMode)i+="Big";if(!Boolean(c._fHideIcons))i+=" ms-core-menu-hasIcons";i+=" ms-core-defaultFont ms-shadow";q=new MenuTag("div",i);p=new MenuTag("ul","ms-core-menu-list");var t=c._arrPopup,r=c._arrSelected,e=c._nLevel,a=t[e];if(!Boolean(c._oContents)||IsOpen(c))return;if(null==a&&!Boolean(c._oRoot)){c._nLevel=0;e=0;c._oRoot=c._oContents}var h=e==0;k=k&&h;if(null==a){a=CreateMenuTag(q);a.setAttribute("role","menu");a.title="";t[e]=a;a.isMenu=true;a.master=c;a.level=e;var j=CreateMenuTag(p);a.style.top="0px";a.style.position="fixed";a.style.visibility="hidden";if(c._fIsRtL){a.style.right="0px";a.setAttribute("dir","rtl")}else{a.style.left="0px";a.setAttribute("dir","ltr")}a.contentEditable=false;a.appendChild(j);if(g_MenuEndOfDOM==true)document.body.appendChild(a);else if(b.tagName=="TABLE")b.parentNode.appendChild(a);else b.appendChild(a);FixUpMenuStructure(c);var n=0,u=c._oRoot;e=c._nLevel;for(var w=u.childNodes.length,l=0;l<w;l++){var f=u.childNodes[l];if(f.nodeType!=1)continue;if(!FIsIType(f,"label")){var g=CreateMenuItem(c,f,MakeID3(c,e,n),null,x);null!=g&&j.appendChild(g);n++}}if(c.id=="filter_menu"||y){g=document.createElement("div");g.id=MakeID3(c,e,n);g.className="ms-core-menu-closebutton";f=document.createElement("button");g.appendChild(f);f.id="fmi_cls";f.innerHTML=Strings.STS.L_CloseButtonCaption;f.onclick=MenuHtc_hide;j.appendChild(g)}a.oncontextmenu=kfnDisableEvent;a.ondragstart=kfnDisableEvent;a.onselectstart=kfnDisableEvent;if(b._onmouseover==null&&typeof b.onmouseover!="undefined")b._onmouseover=b.onmouseover;if(b._onmouseout==null&&typeof b.onmouseout!="undefined")b._onmouseout=b.onmouseout;if(b._onmousedown==null&&typeof b.onmousedown!="undefined")b._onmousedown=b.onmousedown;if(b._onclick==null&&typeof b.onclick!="undefined")b._onclick=b.onclick;if(b._oncontextmenu==null&&typeof b.oncontextmenu!="undefined")b._oncontextmenu=b.oncontextmenu;if(h)if(b._onkeydown==null&&typeof b.onkeydown!="undefined")b._onkeydown=b.onkeydown;if(BrowserDetection.userAgent.nav){SetEvent("keypress",function(){return false},a);SetEvent("keyup",function(){return false},a);SetEvent("keydown",function(a){PopupKeyDown(a);a.cancelBubble=true;return false},a);SetEvent("mousedown",function(a){TrapMenuClick(a);return false},a);SetEvent("mouseover",function(a){PopupMouseOver(a);return false},a);SetEvent("mouseout",function(a){PopupMouseLeave(a);return false},a);SetEvent("click",function(a){PopupMouseClick(a);TrapMenuClick(a);return false},a);SetEvent("mouseover",function(a){PopupMouseOverParent(a);return false},b);SetEvent("mouseout",function(a){PopupMouseLeaveParent(a);return false},b);SetEvent("mousedown",function(a){TrapMenuClick(a);return false},b);SetEvent("click",function(a){TrapMenuClick(a);return false},b);SetEvent("contextmenu",function(a){TrapMenuClick(a);return false},b);if(h)b.onkeydown=function(b){TransferEventToMenu(a,b);return false}}else{SetEvent("keydown",new Function("PopupKeyDown(event); event.cancelBubble = true; return false;"),a);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOver(event); return false;"),a);SetEvent("mouseout",new Function("PopupMouseLeave(event); return false;"),a);SetEvent("click",new Function("PopupMouseClick(event); TrapMenuClick(event); return false;"),a);SetEvent("mouseover",new Function("PopupMouseOverParent(event); return false;"),b);SetEvent("mouseout",new Function("PopupMouseLeaveParent(event); return false;"),b);SetEvent("mousedown",new Function("TrapMenuClick(event); return false;"),b);SetEvent("click",new Function("TrapMenuClick(event); return false;"),b);SetEvent("contextmenu",new Function("TrapMenuClick(event); return false;"),b);if(h)b.onkeydown=function(){TransferEventToMenu(a,event);return false}}if(h){var s=c.getAttribute("onunloadtext");null!=s&&SetEvent("unload",new Function(s),a)}}else{var v=r[e];null!=v&&UnselectItem(v)}r[e]=null;var d;if(BrowserDetection.userAgent.ie&&m==null){var o=document.body.scrollLeft;d=document.createElement("iframe");AssureId(d);d.src="/_layouts/blank.htm";d.style.position="absolute";d.style.display="none";d.scrolling="no";d.frameBorder=0;if(g_MenuEndOfDOM==true)document.body.appendChild(d);else if(b.tagName=="TABLE")b.parentNode.appendChild(d);else b.appendChild(d);a.style.zIndex="1493";a._backgroundFrameId=d.id;if(o!=document.body.scrollLeft)document.body.scrollLeft=o}a.style.width=String(a.offsetWidth)+"px";if(c._fIsRtL)a.style.right="";a.style.position="absolute";SetMenuPosition(c,b,a,k,h,m);a.style.visibility="visible";NavigateToMenu(c);if(BrowserDetection.userAgent.ie&&m==null){SetBackFrameSize(null,a);a.onresize=new Function("SetBackFrameSize(event, null);");d.style.display="block";d.style.zIndex=String(1490)}}function GetWindowPosition(){var a=new ElementPosition(0,0,0,0);a.width=window.screen.width;a.height=window.screen.height;if(Boolean(self.innerHeight)){a.width=self.innerWidth;a.height=self.innerHeight}else if(null!=document.documentElement&&Boolean(document.documentElement.clientHeight)){a.width=document.documentElement.clientWidth;a.height=document.documentElement.clientHeight}else if(null!=document.body){a.width=document.body.clientWidth;a.height=document.body.clientHeight}return a}function SetMenuPosition(M,D,c,L,w,E){var x=GetWindowPosition(),j=x.width,m=x.height,e=c.offsetWidth,h=c.offsetHeight,K=false,J=false;if(e>j-50){K=true;e=j-50<0?0:j-50}if(h>=m-50){J=true;h=m-50<0?0:m-50}if(K){c.style.width=String(e)+"px";c.style.overflowX="scroll"}if(J){c.style.height=String(h)+"px";c.style.overflowY="scroll"}e=c.offsetWidth;h=c.offsetHeight;var y=x.x,P=x.y,v=j,b=0,r=0,O=D,k;if(E!=null)k=new ElementPosition(E.clientX,E.clientY,0,0);else k=MenuHtc_GetElementPosition(O,null);b=k.x;r=k.y;var g;if(w){g=k.width;r+=k.height}else g=k.width+1;var N=!L&&!document.body.WZ_ATTRIB_FLIPPED,u,C,z,A;if(!M._fIsRtL){var s,q;if(w){z=b;s=b+e;q=b+g-e}else{z=b+g;s=b+g+e;q=b-e}A=q;u=s>v&&q>y;C=!(q<y&&s<v)}else{var p,t;if(w){p=b+g-e;t=b+e;A=b}else{p=b-e;t=b+g+e;A=b+g}z=p;u=p<y&&t<v;C=!(t>v&&p>y)}var i=N?u:C,B=i?A:z,f,n;if(typeof window.pageXOffset!="undefined"){f=window.pageXOffset;n=window.pageYOffset}else{var l=document.body.parentNode;if(!IsElementRtl(document.body)){f=document.body.scrollLeft;f+=l.scrollLeft}else if(BrowserDetection.userAgent.ie8standard){f=-document.body.scrollLeft;f+=-l.scrollLeft}else{var F=getElementOverFlowStyle(document.body);if(BrowserDetection.userAgent.ie||BrowserDetection.userAgent.safari&&(F=="auto"||F=="scroll"))f=-document.body.scrollWidth+document.body.clientWidth+document.body.scrollLeft;f+=-l.scrollWidth+l.offsetWidth+l.scrollLeft}n=document.body.scrollTop;n+=l.scrollTop}if(e>=j)B=f;else if(B-f+e>=j)B=f+j-e;var o;if(h>=m)o=n;else if(r+h-n>=m)o=n+m-h;else o=r;if(BrowserDetection.userAgent.safari)o+=window.pageYOffset;else o+=document.documentElement.scrollTop;c.setAttribute("flipped",String(L?i&&u:i));var a=B,d=o;if(BrowserDetection.userAgent.safari)d-=window.pageYOffset;else d-=document.documentElement.scrollTop;if(g_MenuEndOfDOM==false)if(!w){if(M._fIsRtL)if(BrowserDetection.userAgent.ie)if(i)a=a-b;else a=a-b+1;else if(i)a=a-b;else a=a-b+3;else if(BrowserDetection.userAgent.ie)if(i)a=a-b+1;else a=a-b;else if(i)a=a-b+3;else a=a-b;if(d==0)d=D.offsetTop-c.offsetParent.firstChild.scrollTop;else d=d-r+D.offsetTop-c.offsetParent.firstChild.scrollTop;if(BrowserDetection.userAgent.ie8standard)d=d-1}else if(c.offsetParent!=null&&c.offsetParent.tagName.toLowerCase()!="body"){var G,H,I=MenuHtc_GetElementPosition(c.offsetParent);G=I.x;H=I.y;d=d-H;a=a-G}else{a=a+document.documentElement.scrollLeft;if(!(window.OffSwitch==null||OffSwitch.IsActive("EF26F6C6-E8FF-4DD4-8CEC-D649DBCC3F0D"))){if(c.style.position==null||c.style.position!="absolute")d=d+document.documentElement.scrollTop}else d=d+document.documentElement.scrollTop}c.style.left=String(a)+"px";c.style.top=String(d)+"px";c.LeftForBackIframe=a;c.TopForBackIframe=d}function SetBackFrameSize(f,a){if(a==null)a=GetEventSrcElement(f);var e=a.offsetWidth,d=a.offsetHeight,c,b=document.getElementById(a._backgroundFrameId);if(b!=null){c=a.LeftForBackIframe;b.style.left=String(c)+"px";c=a.TopForBackIframe;b.style.top=String(c)+"px";b.style.width=String(e)+"px";b.style.height=String(d)+"px"}}function HideMenu(b,d){ClearTimeOutToHideMenu();if(d==null)d=0;if(d==2){if(typeof b._onDestroy=="function"){b._onDestroy();b._onDestroy=null}return}if(IsOpen(b)&&!IsAccessibilityFeatureEnabledProxy()){var a=b._oParent;if(a!=null){a.onclick=a._onclick;a.onmouseover=a._onmouseover;a.onmouseout=a._onmouseout;a.onmousedown=a._onmousedown;a.oncontextmenu=a._oncontextmenu;a.onkeydown=a._onkeydown}SetBodyEventHandlers(typeof window.origBodyOnClickHandler=="undefined"?null:window.origBodyOnClickHandler);UpdateLevel(b,0);var f=b._arrPopup,c=f[0];if(c!=null){var e=document.getElementById(c._backgroundFrameId);e!=null&&e.parentNode.removeChild(e);c.parentNode!=null&&c.parentNode.removeChild(c);f[0]=null;if(d==0)if(typeof b._onDestroy=="function"){b._onDestroy();b._onDestroy=null}}g_menuHtc_lastMenu=null;RenderECBBackwardCompatibilityMode(false)}}function IsOpen(a){var b=a._accessibleMenu;if(a._accessibleMenuInProgress||null!=b&&!b.closed)return true;var c=a._arrPopup;if(null==c)return false;var d=a._nLevel,e=c[d];return e?true:false}function FindLabel(d){var a=Boolean(d)?d.childNodes:null;if(null!=a)for(var b=0;b<a.length;b++){var c=a[b];if(c.nodeType!=1)continue;if(FIsIType(c,"label"))return c}return null}function ShowRoot(a,f,d,b,h,e,c,g){UpdateLevel(a,0);if(d){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;b=b!=false;MenuHtcInternal_Show(a,f,0,b,e,c,g)}function ShowSubMenu(a,c,b){if(null==b)return;if(b.submenuRoot==null)return;if(b.submenuRoot==a._oRoot)return;UpdateLevel(a,c);a._oRoot=b.submenuRoot;var d=a._nLevel;a._nLevel=d+1;MenuHtcInternal_Show(a,b,-1)}function ShowSubMenuEvnt(a){if(a!=null){var f=a._arrPopup,b=a._nLevel,c=f[b];if(null!=c){c.removeAttribute("timeoutID");var d=a._arrSelected,e=d[b];ShowSubMenu(a,b,e)}}}function SetShowSubMenuEvnt(a){var b=a._arrPopup,c=a._nLevel,d=b[c];if(null!=d){ClearTimeOut("timeoutID");document.body.setAttribute("timeoutID",String(window.setTimeout(function(){ShowSubMenuEvnt(a)},100)))}}function ClearTimeOut(a){var b=document.body.getAttribute(a);b!=null&&window.clearTimeout(Number(b));document.body.removeAttribute(a)}function ClearShowSubMenuEvnt(){ClearTimeOut("timeoutID")}function GetEventSrcItem(e,b){var d,a,c;d="li";if(b!=null&&FIStringEquals(b.tagName,"div")&&b.className.indexOf("ms-core-menu-box")!=-1)return null;c=e._wzPrefixID;for(a=b;a!=null&&!FIStringEquals(a.tagName,"body");a=a.parentNode)if(FIStringEquals(a.tagName,d)&&a.id.substring(0,c.length)==c)return a;return null}function UpdateLevel(c,h){var f,b,a,g,d=c._nLevel;while(d>h){f=c._arrSelected;b=c._arrPopup;if(b!=null)a=b[d];if(null!=a){ClearShowSubMenuEvnt(a);var e=document.getElementById(a._backgroundFrameId);e!=null&&e.parentNode.removeChild(e);a.parentNode.removeChild(a)}b[d]=null;f[d]=null;g=c._oRoot;c._oRoot=g.parentNode;d--;c._nLevel=d}b=c._arrPopup;if(b!=null)a=b[d];null!=a&&ClearShowSubMenuEvnt(a)}function PopupMouseOver(e){var d=GetEventPopup(e);if(d!=null){var a=d.master,c=d.level;if(c<0)return;var g=a._arrSelected,b=GetEventSrcItem(a,GetEventSrcElement(e));if(null!=b){var h=g[c],f=a._nLevel;if(b!=h){if(FIsIType(b,"separator"))return;ToggleMenuItem(a,c,b);FIsIType(b,"submenu")&&EngageSelection(a,true,true,false)}else c<f&&UnselectCurrentOption(a)}ClearTimeOutToHideMenu()}}function PopupMouseLeave(b){var a;a=GetEventPopup(b);if(a!=null){UnselectCurrentOption(a.master);SetTimeOutToHideMenu()}return false}function PopupMouseOverParent(){if(g_menuHtc_lastMenu!=null){ClearTimeOutToHideMenu();var a=g_menuHtc_lastMenu._oParent;if(a!=null)typeof a._onmouseover=="function"&&a._onmouseover()}}function PopupMouseLeaveParent(){if(g_menuHtc_lastMenu!=null){var a=g_menuHtc_lastMenu._oParent;if(a!=null)typeof a._onmouseout=="function"&&a._onmouseout();SetTimeOutToHideMenu()}}function ClearTimeOutToHideMenu(){document.body.getAttribute("HideMenuTimeOut")!=null&&ClearTimeOut("HideMenuTimeOut")}function SetTimeOutToHideMenu(){ClearTimeOut("HideMenuTimeOut");document.body.setAttribute("HideMenuTimeOut",String(window.setTimeout(MenuHtc_hide,5e3)))}function PopupMouseClick(a){var h=GetEventPopup(a),b=h.master,c=h.level;if(c<0)return;var g=b._arrSelected,i=g[c],e=GetEventSrcItem(b,GetEventSrcElement(a));if(i!=e)if(null!=e)g[c]=e;UpdateLevel(b,c);var d=null,f=false;if(BrowserDetection.userAgent.nav){if(null!=a&&null!=a.target){f=a.target.className=="hierarchy";d=a.target.getAttribute("onExpand")}}else if(null!=a&&null!=a.srcElement){f=a.srcElement.className=="hierarchy";d=a.srcElement.getAttribute("onExpand")}EngageSelection(b,true,false,false,f,d)}function PopupKeyDown(c){var d=GetEventPopup(c),b=d.master,f=d.level;if(f<0)return;var a=GetEventKeyCode(c),e=c.shiftKey;if(b._fIsRtL)if(a==37)a=39;else if(a==39)a=37;if(a==9)a=!e?40:38;ClearShowSubMenuEvnt(d);switch(a){case 38:MoveMenuSelection(b,-1);break;case 40:MoveMenuSelection(b,1);break;case 37:case 27:CloseCurrentLevel(b,a==27);break;case 39:case 32:case 13:EngageSelection(b,a==13||a==32,false,true)}c.returnValue=false}function SetNewId(a){a.id="msomenuid"+String(GetUniqueNumber());return a.id}function AssureId(a){if(a.id==null||a.id=="")a.id="msomenuid"+String(GetUniqueNumber());return a.id}function NavigateToMenu(b){if(IsAccessibilityFeatureEnabledProxy())return;var c=null,e=b._nLevel,d=b._arrPopup;c=d[e];try{var a=c.firstChild.firstChild;a=a.getElementsByTagName("A")[0];if(a!=null)if(typeof a.setActive!="undefined"&&a.setActive!=null)a.setActive();else typeof a.focus!="undefined"&&a.focus!=null&&a.focus()}catch(f){}}function ExecuteOnClick(fnOnClick,oMaster){try{if(BrowserDetection.userAgent.safari)if(FIStringEquals(typeof fnOnClick,"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();else{if(FIStringEquals(typeof fnOnClick,"string"))fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt,ctxVar=null;if(typeof currentCtx!="undefined"&&currentCtx!=null)ctxVar=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctxVar=ctxFilter;if(BrowserDetection.userAgent.ie)evt={srcElement:oTemp,fakeEvent:1,currentCtx:ctxVar};else evt={target:oTemp,fakeEvent:1,currentCtx:ctxVar};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp)}}catch(e){}}function EngageSelection(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){var nLevel=oMaster._nLevel,arrSelected=oMaster._arrSelected,oItem=arrSelected[nLevel];if(null==oItem||oItem.optionDisabled)return;if(FIsIType(oItem,"submenu"))if(fDelayExpandSM)SetShowSubMenuEvnt(oMaster);else{ShowSubMenu(oMaster,nLevel,oItem);fEnterSM&&MoveMenuSelection(oMaster,1)}else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false")if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(null!=fnOnClick){var noHideMenu=oItem.getAttribute("keepmenuopenonclick")=="true",executed=false;if(oMaster.id=="filter_menu"||noHideMenu){ExecuteOnClick(fnOnClick,oMaster);executed=true;RefreshOpenedSortMenu(oMaster,nLevel);RefreshClearAndFilterMenu(oMaster,oItem,nLevel);var idValue=oMaster._wzPrefixID+"_"+String(nLevel)+"_";if(oItem.id!=idValue+String(1)&&oItem.id!=idValue+String(0)&&!oMaster.hideMenu)noHideMenu=true}if(!noHideMenu){HideMenu(oMaster,1);!executed&&ExecuteOnClick(fnOnClick,oMaster);HideMenu(oMaster,2)}}else{var oItemAnchor=oItem.firstChild,fnClick=oItemAnchor.onclick;null!=fnClick&&fnClick()}}else eval(fCommand)}}function RefreshClearAndFilterMenu(p,i,s){var h=parseInt(i.id.substr(i.id.lastIndexOf("_")+1)),y=p._oRoot,d=y.childNodes,q=true,e="",o=null,r=0,c=-1;if(d[h].id!="fmi_asc"&&d[h].id!="fmi_desc"&&d[h].id!="fmi_clr"){var g=document.getElementById(i.id+"_ICON");if(i.getAttribute("checked")=="true"){i.setAttribute("checked","false");if(g!=null){g.checked=false;window.setTimeout(function(){g.checked=false},0)}}else{i.setAttribute("checked","true");if(g!=null){g.checked=true;window.setTimeout(function(){g.checked=true},0)}}}else if(d[h].id=="fmi_asc"||d[h].id=="fmi_desc")q=false;if(ctxFilter!=null){var v=typeof filterTable.getAttribute=="function"?filterTable.getAttribute("Name"):null,k=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum")),f=null;if(typeof k.contentDocument!="undefined")f=k.contentDocument;if(f==null&&null!=k.contentWindow)f=k.contentWindow.document;if(f==null)f=k.ownerDocument;var t=f.getElementById("diidFilter"+v);if(t==null)return;o=t==null?null:t.childNodes;r=o==null?0:o.length}else r=d.length;for(var l=0,j=1;l<d.length&&j<r;l++,j++){e=p._wzPrefixID+"_"+String(s)+"_"+String(l);var a=document.getElementById(e);if(c<0){if(a.getAttribute("isclearfilter")=="true")c=l;else{var b=a.firstChild;if(b!=null)b=b.firstChild;if(b!=null)b=b.nextSibling;if(b!=null&&b.id=="fmi_clr")c=l}j=0;continue}if(ctxFilter!=null){if(typeof ctxFilter.view!="undefined"&&typeof ctxFilter.queryString!="undefined")var w=FilterFieldV3(ctxFilter.view,escapeProperly(v),o[j].value,j,ctxFilter.queryString,true);var x="javascript:HandleFilter(event, '"+STSScriptEncode(w)+"')";a.setAttribute("onMenuClick",x)}if(h==c){a.setAttribute("checked","false");var u=document.getElementById(e+"_ICON");if(u!=null)u.checked=false}if(a.getAttribute("checked")=="true")q=false}if(c<0)return;e=p._wzPrefixID+"_"+String(s)+"_"+String(c);a=document.getElementById(e);if(a==null)return;var m=document.getElementById(e+"_ICON"),n=document.getElementById(MakeID3(p,s,c));if(!q){a.setAttribute("enabled","true");a.disabled=false;a.optionDisabled=false;if(ctxFilter!=null){a.setAttribute("iconSrc",GetThemedImageUrl("DeleteFilterGlyph.png"));if(m!=null)m.src=GetThemedImageUrl("DeleteFilterGlyph.png")}n!=null&&RemoveCssClassFromElement(n,"ms-core-menu-itemDisabled")}else{a.setAttribute("enabled","false");a.disabled=true;a.optionDisabled=true;if(ctxFilter!=null){a.setAttribute("iconSrc",GetThemedImageUrl("DisabledDeleteFilterGlyph.png"));if(m!=null)m.src=GetThemedImageUrl("DisabledDeleteFilterGlyph.png")}n!=null&&Menu_AddCssClassToElement(n,"ms-core-menu-itemDisabled")}}function RefreshOpenedSortMenu(i,j){if(ctxFilter==null)return;var e="",d="";if(typeof ctxFilter.queryString!="undefined")var a=ctxFilter.queryString;if(a==null)a="";var k=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+k.getQuery();a=RemovePagingArgs(a);var f=typeof filterTable.getAttribute=="function"?filterTable.getAttribute("SortFields"):null,c=a.indexOf("&SortDir="),b=a.indexOf("&",c+1);if(c==-1){c=f.indexOf("&SortDir=");b=f.indexOf("&SortField=");e=a+f.substr(b,c-b)+"&SortDir=Asc";d=a+f.substr(b,c-b)+"&SortDir=Desc"}else if(c!=-1){e=a.substr(0,c)+"&SortDir=Asc";d=a.substr(0,c)+"&SortDir=Desc";if(b!=-1){e+=a.substr(b);d+=a.substr(b)}}e="HandleFilter(event, '"+STSScriptEncode(e)+"', 1);";d="HandleFilter(event, '"+STSScriptEncode(d)+"', 1);";var g=i._wzPrefixID+"_"+String(j)+"_"+String(0),h=document.getElementById(g);h.setAttribute("onMenuClick",e);g=i._wzPrefixID+"_"+String(j)+"_"+String(1);h=document.getElementById(g);h.setAttribute("onMenuClick",d)}function CloseCurrentLevel(oMaster,fAllowHideRoot){var nLevel=oMaster._nLevel,arrSelected,obj;if(nLevel>0){UpdateLevel(oMaster,nLevel-1);nLevel=oMaster._nLevel;arrSelected=oMaster._arrSelected;obj=arrSelected[nLevel];if(obj!=null){typeof obj.onclick!="undefined"&&obj.onclick!=null&&SetEvent("click",obj._onclick,obj);obj=obj.getElementsByTagName("a")[0];if(obj!=null)if(typeof obj.setActive!="undefined"&&obj.setActive!=null)obj.setActive();else typeof obj.focus!="undefined"&&obj.focus!=null&&obj.focus()}}else if(fAllowHideRoot){HideMenu(oMaster);var oParent=oMaster._oParent;while(oParent!=null&&oParent.tagName=="SPAN"&&oParent.getAttribute("contentEditable")=="true")oParent=oParent.parentNode;if(oParent!=null){var focusElement=oParent,foastr=oParent.getAttribute("foa");if(foastr!=null){var foa=eval(foastr);if(foa==null)foa=byid(foastr);if(foa!=null)focusElement=foa}else if(focusElement.tagName!="A"){var anchorList=focusElement.getElementsByTagName("a"),anchorListLen=anchorList.length;if(anchorListLen>0)focusElement=anchorList[anchorListLen-1]}if(focusElement!=null)try{if(typeof focusElement.setActive!="undefined"&&focusElement.setActive!=null)focusElement.setActive();else typeof focusElement.focus!="undefined"&&focusElement.focus!=null&&focusElement.focus()}catch(e){}}}}function UnselectCurrentOption(c){var a=c._nLevel;if(a>=0){var b=c._arrSelected,d=b[a];if(FIsIType(d,"option")){UnselectItem(d);b[a]=null}}}function MakeID3(a,c,b){return a._wzPrefixID+"_"+String(c)+"_"+String(b)}function GetItem(a,b,d){var c=a._arrPopup,e=c[b];return Boolean(e)?document.getElementById(MakeID3(a,b,d)):null}function MoveMenuSelection(d,h){var a=-1,l=d._oRoot,c=l.childNodes.length,g=d._nLevel,j=d._arrSelected,i=j[g],b=null;if(null!=i){var e=Boolean(i)?i.id:null;if(null!=e){var f=parseInt(e.substring(e.lastIndexOf("_")+1,e.length));if(f==c)f=-1;if(f+h==c){a=c;b=GetItem(d,g,c)}if(b==null)a=(f+h)%c}}if(a<0)a=h>0?0:c-1;if(b==null){var k=a;do{b=GetItem(d,g,a);a=(a+h)%c}while(a!=k&&(null==b||b.style.display=="none"||!(FIsIType(b,"option")||FIsIType(b,"submenu"))))}ToggleMenuItem(d,g,b)}function ToggleMenuItem(f,d,c){var e=f._arrSelected,a=e[d];if(null==c||null!=a&&c.id==a.id)return;if(null!=a){UnselectItem(a);a.onkeydown=null;a.onmousedown=null;a.onmouseover=null;a.onmouseout=null;a.oncontextmenu=null}UpdateLevel(f,d);SelectItem(c);e[d]=c;try{var b=c.firstChild;if(b!=null)if(typeof b.setActive!="undefined"&&b.setActive!=null)b.setActive();else typeof b.focus!="undefined"&&b.focus!=null&&b.focus()}catch(g){}}function SelectItemStatic(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV"){a.setAttribute("selectedStatic","true");a.className+=" ms-core-menu-staticItemSelected"}}function SelectItem(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV")a.className+=" ms-core-menu-itemSelected"}function UnselectItem(a){if(null==a)return;if(a.tagName!="HR"&&a.tagName!="DIV")a.className=a.className.replace("ms-core-menu-itemSelected","")}function SetImageSize(c,b,a){if(a==null)if(c._fLargeIconMode)a=32;else a=16;b.width=String(a);b.height=String(a)}function CreateMenuOption(o,j,a,y,C,E){var b=null,h,c,n,B,e,k,q,G=null,f,m,D,l,A,s,i,v,t,d,u,F=new MenuTag("span",null),x=new MenuTag("div",null);h=CreateMenuTag(x);c=CreateMenuTag(x);n=CreateMenuTag(F);B=CreateMenuTag(x);b=document.createElement("a");b.className="ms-core-menu-link";j.getAttribute("isindented")=="true"&&Menu_AddCssClassToElement(b,"ms-core-menu-indent");b.id=y+"_Anchor";b.appendChild(h);b.appendChild(c);b.appendChild(n);b.appendChild(B);b.href="javascript:;";b.setAttribute("onclick","return false;");if(o._fCompactItemsWithoutIcons&&null==a.getAttribute("iconSrc"))c.className="ms-core-menu-labelCompact";else c.className="ms-core-menu-label";c.id=a.id;if(a.getAttribute("enabled")=="false"){j.disabled=true;Menu_AddCssClassToElement(j,"ms-core-menu-itemDisabled");var p=document.createElement("span");p.appendChild(document.createTextNode(Strings.STS.L_DisabledMenuItem));p.className="ms-accessible ms-core-menu-disabledText";c.appendChild(p);b.setAttribute("aria-disabled","true")}e=EvalAttributeValue(a,"text","textScript");if(e==null||e==""){k=a.firstChild;if(k!=null&&k.nodeType==3)e=k.nodeValue}q=EvalAttributeValue(a,"description","descriptionScript");if(q!=null&&e!=null&&o._fLargeIconMode){f=document.createElement("span");f.className="ms-core-menu-title";m=document.createTextNode(e);D=document.createElement("br");l=document.createElement("span");A=document.createTextNode(q);l.className="ms-core-menu-itemDescription";c.appendChild(f);f.appendChild(m);c.appendChild(D);c.appendChild(l);l.appendChild(A)}else if(e!=null){f=document.createElement("span");f.className="ms-core-menu-title";s=a.getAttribute("hierarchy");if(s!=null){i=document.createElement("span");v=a.getAttribute("onExpand");v!=null&&i.setAttribute("onExpand",v);i.className="hierarchy";c.appendChild(i);i.innerHTML=s;c.appendChild(f);f.innerHTML=e}else{m=document.createTextNode(e);c.appendChild(f);f.appendChild(m)}}if(e!=null)b.title=e;t=document.createElement("span");t.innerHTML=Boolean(C)?C:"";c.appendChild(t);if(Boolean(o._fHideIcons))h.className="ms-hide";else if(o._fLargeIconMode)h.className="ms-core-menu-iconLarge";else h.className="ms-core-menu-icon";var w=null,g=null,r=false,z=false;if(a.getAttribute("checked")=="true"){z=true;r=true}else if(a.getAttribute("checked")=="false"&&(typeof currentFilterMenu!="undefined"&&currentFilterMenu!=null&&currentFilterMenu.id=="filter_menu"||E||a.getAttribute("showcheckbox")=="true"))r=true;else{w=EvalAttributeValue(a,"iconSrc","iconScript");g=a.getAttribute("iconAltText")}if(r){d=document.createElement("INPUT");d.setAttribute("type","checkbox");z&&d.setAttribute("checked","yes");d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON";d.setAttribute("style","padding-left:0px")}else if(Boolean(w)){d=document.createElement("img");d.src=w;d.alt=Boolean(g)?g:"";d.title=Boolean(g)?g:"";h.appendChild(d);d.id=y+"_ICON"}u=a.getAttribute("accessKeyText");if(null!=u)n.innerHTML=u;else n.className="ms-accessible";SetIType(j,"option");j.appendChild(b)}function CreateMenuSeparator(b,a){a.innerHTML='<hr class="ms-core-menu-separatorHr" />';SetIType(a,"separator")}function CreateSubmenu(c,a,e,g){var f=FindLabel(e);CreateMenuOption(c,a,e,g,Boolean(f)?f.innerHTML:null);var d=null,b=document.createElement("img");if(a.className.indexOf("ms-core-menu-hasArrow")==-1)a.className+=" ms-core-menu-hasArrow";d=a.childNodes[0].childNodes[3];d.className="ms-core-menu-arrowBox";b.className="ms-core-menu-arrow";d.appendChild(b);b.src=!c._fIsRtL?c._wzMArrPath:c._wzMArrPathRtL;b.alt=Strings.STS.L_SubMenu_Text;b.title="";SetIType(a,"submenu");a.submenuRoot=e}function MergeAttributes(c,b){if(!BrowserDetection.userAgent.nav&&typeof c.mergeAttributes!="undefined"&&c.mergeAttributes!=null)c.mergeAttributes(b);else{var d=b.attributes,f=0;if(typeof d.length!="undefined"&&d.length!=null)f=d.length;for(var e=0;e<f;e++){var a=d[e];a!=null&&a.specified&&a.nodeName!="id"&&a.nodeName!="ID"&&a.nodeName!="name"&&c.setAttribute(a.nodeName,a.nodeValue)}b.getAttribute("type")!=null&&c.setAttribute("type",b.getAttribute("type"));if(b.submenuRoot!=null)c.submenuRoot=b.submenuRoot}}function CreateMenuItem(e,b,f,i,h){var a,g,d,c;if(FIsIType(b,"label"))return null;a=document.createElement("li");MergeAttributes(a,b);a.id=f;if(FIsIType(b,"separator")){CreateMenuSeparator(e,a);a.className="ms-core-menu-separator";return a}a.className="ms-core-menu-item";null==GetIType(b)&&SetIType(b,"option");if(FIsIType(b,"submenu"))CreateSubmenu(e,a,b,f);else FIsIType(b,"option")&&CreateMenuOption(e,a,b,f,i,h);if(a.disabled==true||a.getAttribute("enabled")=="false"){Menu_AddCssClassToElement(a,"ms-core-menu-itemDisabled");a.disabled=false;g=a.childNodes.length;for(d=0;d<g;d++){c=a.childNodes[d];if(c.nodeType!=1||c.tagName=="A")continue;c.disabled=true}a.optionDisabled=true}return a}function GetItems(b){var a=b._oContents;null==a&&PrepContents(b);a=b._oContents;return a.childNodes}function GetIType(a){return Boolean(a)?a.getAttribute("type"):null}function FIsIType(b,a){return FIStringEquals(GetIType(b),a)}function SetIType(a,b){null!=a&&a.setAttribute("type",b)}function FIStringEquals(a,b){return a!=null&&b!=null&&a.toLowerCase()==b.toLowerCase()}function RenderAccessibleMenu(a,c){if(c){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;!Boolean(a._oContents)&&PrepContents(a);if(!Boolean(a._oContents))return;if(!Boolean(a._oRoot)){a._nLevel=0;a._oRoot=a._oContents}FixUpMenuStructure(a);var d=a._fIsRtL?"rtl":"ltr";g_menuHtc_html="<html dir='"+d+"'><head><title>"+Strings.STS.L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";RenderMenuLevel(a,a._oRoot,true);g_menuHtc_html=g_menuHtc_html+"</ul></body></html>";a._accessibleMenuInProgress=true;var b=window.open("/_layouts/blank.htm","_blank","status=no,toolbar=no,menubar=no,location=no");a._accessibleMenu=b;b.document.write(g_menuHtc_html);b.document.close();b.onunload=MenuHtc_hide;b.focus()}function CloseAccessibleMenu(a,b){if(b==null)b=0;if(a!=null){a._accessibleMenuInProgress=false;if(b==0||b==1){var c=a._accessibleMenu;if(c!=null){c.close();try{c.opener!=null&&c.opener.document.documentElement.focus()}catch(d){}a._accessibleMenu=null}}if(b==0||b==2)if(typeof a._onDestroy=="function"){a._onDestroy();a._onDestroy=null}}}function GetMenuItemText(d,b,a){if(a==""){a=EvalAttributeValue(b,"text","textScript");var c=EvalAttributeValue(b,"description","descriptionScript");if(c!=null&&c!=""&&d._fLargeIconMode){if(a!="")a=a+": ";a=a+c}}if(b.getAttribute("checked")=="true")a="* "+a;if(b.title!=null&&b.title!="")a=a+": "+b.title;return a}function GetMenuItemEnabled(a,b){return!b?false:a.getAttribute("enabled")=="false"?false:a.getAttribute("disabled")!=null&&a.getAttribute("disabled")!=""?false:true}var g_menuHtc_html;function RenderMenuLevel(d,j,g){for(var h=j.childNodes,i=h.length,e=0;e<i;e++){var a=h[e];if(a.nodeType!=1)continue;if(a.style.display=="none")continue;var b;if(FIsIType(a,"option")){b=GetMenuItemText(d,a,a.innerHTML.trim());if(!GetMenuItemEnabled(a,g))g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+b+"</span></li>";else g_menuHtc_html=g_menuHtc_html+'<li><a href="#" id="'+a.id+'" onMenuClick="'+a.getAttribute("onMenuClick")+'" onclick="javascript:opener.ExecuteOnAccessibleClick(this.getAttribute(\'onMenuClick\')); return false;">'+b+"</a></li>"}else if(FIsIType(a,"submenu")){b=GetMenuItemText(d,a,"");g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+b;for(var f=0;f<a.childNodes.length;f++){var c=a.childNodes[f];if(c.nodeType!=1)continue;if(c.style.display=="none")continue;if(FIsIType(c,"label")){g_menuHtc_html=g_menuHtc_html+" "+c.innerHTML;break}}g_menuHtc_html=g_menuHtc_html+"</span><ul>";RenderMenuLevel(d,a,GetMenuItemEnabled(a,g));g_menuHtc_html=g_menuHtc_html+"</ul></li>"}}}function ExecuteOnAccessibleClick(b){var a=g_menuHtc_lastMenu;if(a!=null){CloseAccessibleMenu(a,1);ExecuteOnClick(b,a);CloseAccessibleMenu(a,2)}}function FIsIHidden(oItem){if(null!=oItem){var hiddenFunc=oItem.getAttribute("hidden");return null==hiddenFunc?false:eval(hiddenFunc)}else return false}function EvalAttributeValue(oNode,sAttribute1,sAttribute2){var result=oNode.getAttribute(sAttribute2);if(result!=null&&result.toLowerCase().indexOf("javascript:")==0)result=String(eval(result.substring(11)));else result=null;if(result==null||result=="")result=oNode.getAttribute(sAttribute1);if(result==null)result="";return result}function Menu_AddCssClassToElement(a,b){var d=a.className;if(d!=null){if(!c(a,b))a.className=a.className+" "+b}else a.className=b;function c(c,e,f){var d=c.className;if(d==null)return false;for(var a=d.split(" "),b=0;b<a.length;b++)if(a[b]==e){if(f){a.splice(b,1);c.className=a.join(" ")}return true}return false}}var MMU_chDelim,MMU_chDelimEnc,MMU_postbackPrefix,MMU_chDelim2,MMU_chDelim2Enc;function MHash_InitializePrototype(){MHash.prototype._keys=undefined;MHash.prototype._values=undefined;MHash.prototype.Add=MHash_Add;MHash.prototype.Count=MHash_Count;MHash.prototype.Keys=MHash_Keys;MHash.prototype.Values=MHash_Values;MHash.prototype.Exists=MHash_Exists;MHash.prototype.Item=MHash_Item}function MHash(){this._keys=[];this._values=[]}function MHash_Add(b,a){this._keys.push(b);this._values.push(a)}function MHash_Count(){return this._keys.length}function MHash_Keys(){return this._keys}function MHash_Values(){return this._values}function MHash_Exists(c){for(var d=this.Count(),b=this.Keys(),a=0;a<d;a++)if(b[a]==c)return true;return false}function MHash_Item(c){for(var d=this.Count(),b=this.Keys(),a=0;a<d;a++)if(b[a]==c)return this.Values()[a];return null}function ParseContext_InitializePrototype(){ParseContext.prototype.TemplateClientId=undefined;ParseContext.prototype.MenuClientId=undefined;ParseContext.prototype.TimeoutMessage=undefined}function ParseContext(c){try{var b=c.split(";"),a=b[0];this.TemplateClientId=a;a=b[1];this.MenuClientId=a;a=b[2];this.TimeoutMessage=a.replace(/%semi%/g,";").replace(/%quot%/g,"'")}catch(d){alert(Strings.STS.L_Loading_Error_Text)}}var MMU_reDelimEnc,MMU_reDelim2Enc,MMU_reDelimDec,MMU_reDelim2Dec;function MMU_EncVal(a){return a.replace(MMU_reDelimDec,MMU_chDelimEnc).replace(MMU_reDelim2Dec,MMU_chDelim2Enc)}function MMU_DecVal(a){return a.replace(MMU_reDelim2Enc,MMU_chDelim2).replace(MMU_reDelimEnc,MMU_chDelim)}function MMU_ParseNV(h){var g=new MHash,c=h.split(MMU_chDelim);if(c!=null)for(var f=0;f<c.length;f++){var a=c[f],b=a.indexOf("=");if(b==0)continue;var e=null,d=null;if(b<0)e=a;else{e=a.substr(0,b);if(b<a.length-1)d=MMU_DecVal(a.substr(b+1));else d=""}g.Add(e,d)}return g}function MMU_ParseNVAttr(b,d){var a=b.getAttribute(d);if(a==null&&b.childNodes.length>0){var c=b.childNodes[0];if(c.nodeType==1)a=c.getAttribute(d)}return a==null?new MHash:MMU_ParseNV(a)}function MMU_ResetMenuState(j,h,i,g,b){for(var f=j.childNodes,e=0;e<f.length;e++){var a=f[e];if(a.nodeType!=1)continue;var c=a.getAttribute("id");if(a!=null&&c!=null&&c.length>0){if(a.childNodes.length>0){MMU_ResetMenuState(a,h,i,g,b);continue}if(i.Exists(c))a.style.display="none";else{a.style.display="";var d=a.getAttribute("enabledOverride");if(d!=null&&d.length>0)a.setAttribute("enabled",d);else if(h.Exists(c))a.setAttribute("enabled","false");else{a.setAttribute("enabled","true");if(g.Exists(c))a.setAttribute("checked","true");else a.setAttribute("checked","false")}}MMU_ReplTokValAttr(a,"onMenuClick",b);MMU_ReplTokValAttr(a,"text",b);MMU_ReplTokValAttr(a,"description",b);MMU_ReplTokValVal(a,b)}}}function MMU_ReplTokValAttr(c,b,f){var a=c.getAttribute(b),d=c.getAttribute(b+"_Original");if(a!=null&&d==null&&f.Count()>0)c.setAttribute(b+"_Original",a);else if(a!=null&&d!=null&&a!=d)a=d;if(a==null||a.length<=0)return;var e=MMU_ReplTokVal(a,f);e!=a&&c.setAttribute(b,e)}function MMU_ReplTokValVal(c,e){if(c.nextSibling==null)return;var a=c.nextSibling.nodeValue,b=c.getAttribute("valOrig");if(a!=null&&b==null&&e.Count()>0){b=a;c.setAttribute("valOrig",b)}else if(a!=null&&b!=null&&a!=b)a=b;var d=MMU_ReplTokVal(a,e);if(a!=null&&d!=null&&d!=a)c.nextSibling.nodeValue=d}function MMU_ReplTokVal(a,b){if(a!=null&&a.indexOf("%")>=0&&b!=null&&b.Count()>0)for(var d=b.Keys(),e=b.Values(),f=d.length,c=0;c<f;c++){var g=d[c],h=e[c];a=a.replace("%"+g+"%",h)}return a}var g_MMU_HighlightedEcbTable,g_MMU_HighlightedEcbTableOpen,g_MMU_OpenTimeoutHandle;function MMU_Open(menu,ecbLink,e,fAlignRight,alignId,delay){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSMMUOpenStart);try{if(menu==null||ecbLink==null)return;if(ecbLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}ClearHighlightedEcbTableOpen();if(fAlignRight==null)fAlignRight=true;MMU_ResetMenuState(menu,MMU_ParseNVAttr(ecbLink,"menuItemsDisabled"),MMU_ParseNVAttr(ecbLink,"menuItemsHidden"),MMU_ParseNVAttr(ecbLink,"menuItemsChecked"),MMU_ParseNVAttr(ecbLink,"menuTokenValues"));var elemAlign=null;if(alignId!=null&&alignId.length>0)elemAlign=document.getElementById(alignId);if(elemAlign==null)elemAlign=document.getElementById(ecbLink.id+"_t");if(elemAlign==null)elemAlign=ecbLink;MMU_EcbHighlight(MMU_GetHighlightElement(ecbLink),true);var openMenuScript="MenuHtc_show(document.getElementById('"+menu.id+"'), document.getElementById('"+elemAlign.id+"'), true, "+String(fAlignRight)+", null);";openMenuScript+="SetEcbMouseOutAndDestroy('"+menu.id+"');";if(delay!=null&&delay>0){openMenuScript+=" g_MMU_OpenTimeoutHandle = null;";g_MMU_OpenTimeoutHandle=window.setTimeout(openMenuScript,delay,"javascript")}else eval(openMenuScript);if(e!=null)try{e.cancelBubble=true}catch(exIgnored){}}catch(ex){alert(Strings.STS.L_Loading_Error_Text)}IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSMMUOpenEnd)}function SetEcbMouseOutAndDestroy(a){if(g_MMU_HighlightedEcbTable!=null){g_MMU_HighlightedEcbTable.onmouseout=null;g_MMU_HighlightedEcbTableOpen=g_MMU_HighlightedEcbTable;document.getElementById(a)._onDestroy=ClearHighlightedEcbTableOpen}}function ClearHighlightedEcbTableOpen(){if(g_MMU_HighlightedEcbTableOpen!=null){MMU_EcbHighlight(g_MMU_HighlightedEcbTableOpen,false);g_MMU_HighlightedEcbTableOpen=null}}function MMU_EcbLinkOnFocusBlurDeferCall(d,c,a){if(a)c.onblur=a?new Function("MMU_EcbLinkOnFocusBlurDeferCall(null, this, false)"):null;if(g_MMU_HighlightedEcbTableOpen!=null)return;var b=document.getElementById(c.id+"_t");b!=null&&MMU_EcbHighlight(b,a)}function MMU_EcbTableMouseOverOutDeferCall(b,a){if(a){if(b==g_MMU_HighlightedEcbTableOpen)return;b.onmouseout=a?new Function("MMU_EcbTableMouseOverOut(this, false)"):null}MMU_EcbHighlight(b,a)}function MMU_EcbHighlight(a,b){if(a==null&&!b)a=g_MMU_HighlightedEcbTableOpen;if(a==null)return;if(b==null)b=false;var d=a.getAttribute("hoverActive"),c=a.getAttribute("hoverInactive");if(d==null)d="ms-selectedtitle";if(c==null)c="ms-unselectedtitle";if(b){a.className=d;g_MMU_HighlightedEcbTable=a}else a.className=c;var f=a.getAttribute("menuformat"),e=document.getElementById(a.id+"i");if(e!=null&&f!=null&&f=="ArrowOnHover")e.style.visibility=b?"visible":"hidden";if(!b)g_MMU_HighlightedEcbTable=null}function MMU_PopMenuIfShowingDeferCall(){}function MMU_HandleArrowSplitButtonKeyDown(a,c,b){return!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13?undefined:Boolean(b)?MMU_EcbLinkOnKeyDown(byid(c),b,a):undefined}function MMU_HandleArrowOnHoverKeyDown(c,b,a){return!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13?undefined:null!=b?MMU_EcbLinkOnKeyDown(c,b,a):undefined}function MMU_GetHighlightElement(b){var a=null;a=document.getElementById(b.id+"_t");return a!=null?a:b}var g_MMU_theFormActionAtPageLoad,g_MMU_Form0ActionAtPageLoad,g_MMU_Form0ActionAtPreMenuOpen;function MMU_CallbackPreMenuOpen(templateClientId,menuClientId,callbackEventReference,timeoutLength,timeoutMessage,e){try{var menuTemplate=document.getElementById(templateClientId),menuLink=document.getElementById(menuClientId);if(menuLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}MMU_StopPendingTimerEventsFromCallback();MMU_RemoveCallbackItemsFromMenuTemplate(menuTemplate);var menu=document.getElementById(menuClientId);menu.setAttribute("callbackInProgress","true");loadingMessageMenuItem=CAMOpt(menuTemplate,Strings.STS.L_Loading_Text,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true");loadingMessageMenuItem.setAttribute("enabled","false")}var callbackContext=templateClientId+";"+menuClientId+";"+timeoutMessage.replace(/;/g,"%semi%").replace(/\'/g,"%quot%");callbackEventReference=callbackEventReference.replace(/__CALLBACKCONTEXT__/g,callbackContext);eval(callbackEventReference);g_MMU_RequestTimeoutTimeoutHandle=window.setTimeout("MMU_CallbackErrHandler('timeout', '"+callbackContext+"')",timeoutLength,"javascript")}catch(ex){alert(Strings.STS.L_Loading_Error_Text)}}var g_MMU_RequestTimeoutTimeoutHandle;function MMU_RemoveCallbackItemsFromMenuTemplate(b){try{for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c.nodeType==1&&c.getAttribute("callbackitem")=="true"){b.removeChild(c);--a}}}catch(d){alert(Strings.STS.L_Loading_Error_Text)}}function MMU_StopPendingTimerEventsFromCallback(){if(g_MMU_OpenTimeoutHandle!=null){window.clearTimeout(g_MMU_OpenTimeoutHandle);g_MMU_OpenTimeoutHandle=null}if(g_MMU_RequestTimeoutTimeoutHandle!=null){window.clearTimeout(g_MMU_RequestTimeoutTimeoutHandle);g_MMU_RequestTimeoutTimeoutHandle=null}}var loadingMessageMenuItem;function MMU_UpdateMenuTemplateWithErrorItem(a,b){MMU_RemoveCallbackItemsFromMenuTemplate(a);var c=CAMOpt(a,b,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true");loadingMessageMenuItem.setAttribute("enabled","false")}}function MMU_UpdateOpenedMenuWithErrorItem(c,a,b){MMU_UpdateMenuTemplateWithErrorItem(a,b);HideMenu(a);MMU_Open(a,c)}function MMU_CallbackHandler(l,k){MMU_StopPendingTimerEventsFromCallback();var j=new ParseContext(k),c=document.getElementById(j.TemplateClientId);if(c==null){alert(Strings.STS.L_Loading_Error_Text);return}var b=document.getElementById(j.MenuClientId);if(b==null){alert(Strings.STS.L_Loading_Error_Text);return}var g="",i="",h="",f="",e="",a=l.split(MMU_chDelim);if(a==null||a.length!=5){if(typeof MMU_GenerateErrorMenuItem!="undefined")e=MMU_GenerateErrorMenuItem(Strings.STS.L_Loading_Error_Text)}else{var d=new RegExp(MMU_chDelimEnc,"g");g=a[0].replace(d,MMU_chDelim);i=a[1].replace(d,MMU_chDelim);h=a[2].replace(d,MMU_chDelim);f=a[3].replace(d,MMU_chDelim);e=a[4].replace(d,MMU_chDelim)}b.setAttribute("menuItemsDisabled",g);b.setAttribute("menuItemsHidden",i);b.setAttribute("menuItemsChecked",h);b.setAttribute("menuTokenValues",f);MMU_RemoveCallbackItemsFromMenuTemplate(c);c.innerHTML=c.innerHTML+e;HideMenu(c);MMU_Open(c,b);b.setAttribute("callbackInProgress","")}function MMU_CallbackErrHandler(f,e){try{alert(Strings.STS.L_Loading_Error_Text);var a=new ParseContext(e),d=document.getElementById(a.TemplateClientId);if(d==null){alert(Strings.STS.L_Loading_Error_Text);return}var b=document.getElementById(a.MenuClientId);if(b==null){alert(Strings.STS.L_Loading_Error_Text);return}b.setAttribute("callbackInProgress","");var c=Strings.STS.L_Loading_Error_Text;if(f=="timeout"&&a.TimeoutMessage!=null&&a.TimeoutMessage.length>0)c=a.TimeoutMessage;MMU_UpdateOpenedMenuWithErrorItem(b,d,c)}catch(g){alert(Strings.STS.L_Loading_Error_Text)}}function combineDocuments(r,q,m){fNewDoc=false;var a;if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var b=true,e,g;try{var f=document.all.chkCombine,j=document.all.chkUrl,h=document.all.chkProgID;if(undefined!=f){var d=f,l=j,k=h;if(typeof d.length!="undefined"){for(a=0;b&&a<d.length;a++)if(d[a].checked){b=false;e=l[a].getAttribute("href");g=k[a].getAttribute("href")}}else{var n=f;if(b&&null!=n){var p=j,o=h;b=false;e=p.getAttribute("href");g=o.getAttribute("href")}}}}catch(s){}if(!b){var i=false,c;try{c=new ActiveXObject(g);fNewDoc=c!=null}catch(s){}if(!fNewDoc)alert(Strings.STS.L_NewFormLibTb3_Text);else{try{i=typeof c.MergeDocuments!="undefined"&&c.MergeDocuments(e,document.all.chkCombine,makeAbsUrl(m))}catch(t){}if(!i)alert(Strings.STS.L_NewFormLibTb3_Text);else window.onfocus=RefreshOnFocus}}else alert(Strings.STS.L_NewFormLibTb4_Text)}function repairLinks(g,h,i){if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var b=0,d=document.all.SubmitRepairDocs;d.value="";for(var c=document.getElementsByTagName("input"),a=0;a<c.length;a++)if(c[a].id=="chkRepair")if(c[a].checked){d.value+=c[a].getAttribute("docID");d.value+=" ";b++}if(b>0&&b<=500){var e=document.all.SubmitRepairRedirectList;e.value=h;e=document.all.SubmitRepairRedirectFolder;e.value=g;var f=document.all.SubmitRepairDocsForm;f.action=i+"/submitrepair.aspx";f.submit()}else alert(b==0?Strings.STS.L_NewFormLibTb5_Text:Strings.STS.L_NewFormLibTb6_Text)}function repairAllLinks(c,d,e){if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var a=document.all.SubmitRepairDocs;a.value="*";a=document.all.SubmitRepairRedirectList;a.value=d;a=document.all.SubmitRepairRedirectFolder;a.value=c;var b=document.all.SubmitRepairDocsForm;b.action=e+"/submitrepair.aspx";b.submit()}function NavigateToManageCopiesPage(a,b){Nav.navigate(a+"/_layouts/15/managecopies.aspx?ItemUrl="+b+"&Source="+Nav.getSource())}function AddVersionMenuItemsCore(c,b){if(currentItemID!=null){var f=currentItemID;if(f.indexOf(".0.")>=0)return}if(!HasRights(0,64))return;var a,e=itemTable.getAttribute("isCur"),h=itemTable.getAttribute("Level"),g=itemTable.getAttribute("canViewProperty");if(currentItemFSObjType==null)currentItemFSObjType=String(parseInt(GetAttributeFromItemTable(itemTable,"OType","FSObjType")));if(g!="0"&&!Boolean(b.RealHttpRoot)){a=CAMOpt(c,Strings.STS.L_ViewVersion_Text,"javascript:ViewVersion()","");a.id="ID_ViewVersion"}if(HasRights(0,4)){a=CAMOpt(c,Strings.STS.L_RestoreVersion_Text,"javascript:RestoreVersion()","");a.id="ID_RestoreVersion"}if(HasRights(0,128)&&e!="1"){a=CAMOpt(c,Strings.STS.L_DeleteVersion_Text,"javascript:DeleteVersion()","");a.id="ID_DeleteVersion"}if(HasRights(0,16)&&HasRights(0,4))if((b.isModerated||b.EnableMinorVersions)&&currentItemFSObjType!="1"&&h==String(1)&&e=="1"){var d=Strings.STS.L_DenyVersion_Text;if(b.EnableMinorVersions)d=Strings.STS.L_UnPublishVersion_Text;a=CAMOpt(c,d,"javascript:TakeOfflineVersion()","");a.id="ID_TakeOfflineVersion"}}function ViewVersion(){if(!IsContextSet())return;Nav.navigate(itemTable.getAttribute("verUrl"))}function RestoreVersion(){if(!IsContextSet())return;var a=currentCtx;if(itemTable.getAttribute("isMostCur")!="0")alert(Strings.STS.L_Version_NoRestore_Current_ERR);else{var b=a.HttpPath+"&op=Restore&ver="+itemTable.getAttribute("verId");if(confirm(Boolean(a.verEnabled)?Strings.STS.L_Version_Restore_Confirm_Text:Strings.STS.L_Version_RestoreVersioningOff_Confirm_Text)){null!=window.frameElement&&typeof window.frameElement.overrideDialogResult!="undefined"&&window.frameElement.overrideDialogResult(1);SubmitFormPost(b)}}}function TakeOfflineVersion(){if(!IsContextSet())return;var b=currentCtx,a=Strings.STS.L_Version_deny_Confirm_Text;if(b.EnableMinorVersions)a=Strings.STS.L_Version_unpublish_Confirm_Text;if(itemTable.getAttribute("isCur")!="1"||itemTable.getAttribute("Level")!=String(1))alert(Strings.STS.L_Version_NoOffline_NonCurrent_ERR);else confirm(a)&&SubmitFormPost(b.HttpPath+"&op=TakeOffline")}function DeleteVersion(){if(!IsContextSet())return;var a=currentCtx;if(itemTable.getAttribute("isCur")!="0")alert(Strings.STS.L_Version_NoDelete_Current_ERR);else{var b=a.HttpPath+"&op=Delete&ver="+itemTable.getAttribute("verId");confirm(Boolean(a.RecycleBinEnabled)?Strings.STS.L_Version_Recycle_Confirm_Text:Strings.STS.L_Version_Delete_Confirm_Text)&&SubmitFormPost(b)}}function DeleteAllVersions(b,a){if(b<=1)alert(Strings.STS.L_Version_NoDeleteAll_None_ERR);else confirm(Boolean(a.RecycleBinEnabled)?Strings.STS.L_Version_RecycleAll_Confirm_Text:Strings.STS.L_Version_DeleteAll_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAll")}function DeleteAllMinorVersions(b,a){if(b<=1)alert(Strings.STS.L_Version_NoDeleteAll_None_ERR);else confirm(Boolean(a.RecycleBinEnabled)?Strings.STS.L_Version_RecycleAllMinor_Confirm_Text:Strings.STS.L_Version_DeleteAllMinor_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAllMinor")}function GetServerRelativeUrlFromURL(b){var a,c=b.indexOf("//");if(-1!=c){var d=b.indexOf("/",c+2);if(-1!=d)a=b.substr(d);else a="/"}else a=b;return a}function GetTargetHandler(a){if(null==a)return"";var d=a.length;if(0==d||"/"!=a[0])return"";var c=a.indexOf("?"),b=a.indexOf("#");if(-1==c)c=d;if(-1==b)b=d;return a.substr(0,Math.min(c,b))}var _spFullDownloadList;function IsFailoverTarget(c){var d=c.lastIndexOf("/");if(-1!=d){var a=c.substr(d+1);if(0!=a.length){var b=a.lastIndexOf(".");if(-1==b)return false;var e=a.substr(b+1);if("aspx"!=e.toLowerCase())return true;var f=a.substr(0,b).toLowerCase();if(Boolean(_spFullDownloadList)&&Array.contains(_spFullDownloadList,f))return true}}return false}function GetQuery(a){return new URI(a,{disableEncodingDecodingForLegacyCode:true}).getQuery()}function IsFailoverQuery(a){a=a.toLowerCase();return a.indexOf("wikipagemode=edit")!=-1?true:a.indexOf("usemds=false")!=-1?true:false}function SPUpdatePage(a){if("undefined"==typeof g_MinimalDownload||!g_MinimalDownload||IsAccessibilityFeatureEnabled()||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(556)&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(44))return true;a=GetAbsoluteUrl(a);if(BrowserDetection.userAgent.ie&&BrowserDetection.userAgent.iever<10){var n=a.indexOf("?");if(-1==n)n=a.length;var m=a.indexOf("#");if(-1==m)m=a.length;var w=Math.min(n,m);a=encodeURI(decodeURI(a.substr(0,w)))+a.substr(w)}var c=true,v="/_layouts/15/start.aspx",o=v.length,u=window.location.pathname,r=u.length,b=a.indexOf("#");if(-1!=b){var q=a.substr(0,b).toLowerCase().indexOf("/_layouts/15/start.aspx");if(-1!=q)if(a.length>b+2&&"/"==a[b+1])if(a.length>b+3&&"/"==a[b+2])a=a.substr(b+2);else a=a.substr(0,q)+a.substr(b+1)}if(r>=o&&v==u.substr(r-o))if(a.charAt(0)=="/"){if(!IsFailoverTarget(GetTargetHandler(a))){Nav.ajaxNavigate.update(a);c=false}}else{if(a.indexOf("/")==-1){var f=Nav.ajaxNavigate.get_href(),t=f.indexOf("?");if(t!=-1)f=f.substr(0,t);var p=f.lastIndexOf("/");if(p!=-1)a=f.substr(0,p+1)+a}var g=a.indexOf("//");if(-1!=g){var j=a.indexOf("/",g+2);if(-1!=j){var e=a.substr(g+2,j-(g+2)),i="",l=e.indexOf(":");if(-1!=l){i=e.substr(l+1);if(i=="80")i="";e=e.substr(0,l)}if(window.location.hostname==e&&window.location.port==i)if(!IsFailoverTarget(GetTargetHandler(a.substr(j)))){Nav.ajaxNavigate.update(a.substr(j));c=false}}else if(window.location.hostname==a.substr(g+2)){Nav.ajaxNavigate.update("");c=false}}else c=true}else if("undefined"!==typeof g_WebServerRelativeUrl){var k=document.createElement("a");k.href=a;a=k.href;k.href=g_WebServerRelativeUrl;var h=k.href;if(a.length>=h.length&&h.toLowerCase()==a.substr(0,h.length).toLowerCase()){var d=h;if("/"==d[d.length-1])d+="/_layouts/15/start.aspx".substr(1);else d+="/_layouts/15/start.aspx";if(!IsFailoverTarget(GetTargetHandler(GetServerRelativeUrlFromURL(a)))){d+="#/"+GetServerRelativeUrlFromURL(a);window.location.href=d;c=false}}}if(!c){g_MDNav=false;var s=window.event;s!=null&&cancelDefault(s)}return c}function _AddSilverlightWebPart(d,b,a){var c=new _AddSilverlightWebPartPopupUI(d,b,a);c.show()}function _AddSilverlightWebPartPopupUI_InitializePrototype(){_AddSilverlightWebPartPopupUI.prototype.item=undefined;_AddSilverlightWebPartPopupUI.prototype.zoneNum=undefined;_AddSilverlightWebPartPopupUI.prototype.zoneIndex=undefined;_AddSilverlightWebPartPopupUI.prototype.show=_AddSilverlightWebPartPopupUI_show;_AddSilverlightWebPartPopupUI.prototype.dialogCallback=_AddSilverlightWebPartPopupUI_dialogCallback}function _AddSilverlightWebPartPopupUI(c,b,a){this.item=c;this.zoneNum=b;this.zoneIndex=a}function _AddSilverlightWebPartPopupUI_show(){var b=this,c=function(){var a={};if(typeof _spExternalApplicationRegistrationInformation!="undefined"){if(typeof _spExternalApplicationRegistrationInformation.dialogUrl!="undefined")a.url=_spExternalApplicationRegistrationInformation.dialogUrl;if(typeof _spExternalApplicationRegistrationInformation.dialogWidth!="undefined")a.width=_spExternalApplicationRegistrationInformation.dialogWidth;if(typeof _spExternalApplicationRegistrationInformation.dialogHeight!="undefined")a.height=_spExternalApplicationRegistrationInformation.dialogHeight}a.dialogReturnValueCallback=Function.createDelegate(b,b.dialogCallback);SP.UI.ModalDialog.showModalDialog(a)},a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(d){a="undefined"}EnsureScript("SP.js",a,c)}function _AddSilverlightWebPartPopupUI_dialogCallback(c,b){if(c==1){var a=WPAdder._getHiddenField("wpVal");if(null!=a){a.value=b.applicationXml;null==a.value;a.value=b.url}WPAdder.addItemToPage(this.item,this.zoneNum,this.zoneIndex)}}function _ConfigSilverlightWebpart(b,a,c,f,d){var e=new _ConfigSilverlightWebpartPopupUI(b,a,c,f,d);e.show()}function _ConfigSilverlightWebpartPopupUI_InitializePrototype(){_ConfigSilverlightWebpartPopupUI.prototype.urlElementId=undefined;_ConfigSilverlightWebpartPopupUI.prototype.appXmlElementId=undefined;_ConfigSilverlightWebpartPopupUI.prototype.dialogUrl=undefined;_ConfigSilverlightWebpartPopupUI.prototype.dialogWidth=undefined;_ConfigSilverlightWebpartPopupUI.prototype.dialogHeight=undefined;_ConfigSilverlightWebpartPopupUI.prototype.show=_ConfigSilverlightWebpartPopupUI_show;_ConfigSilverlightWebpartPopupUI.prototype.dialogCallback=_ConfigSilverlightWebpartPopupUI_dialogCallback}function _ConfigSilverlightWebpartPopupUI(b,a,c,e,d){this.urlElementId=b;this.appXmlElementId=a;this.dialogUrl=c;this.dialogWidth=e;this.dialogHeight=d}function _ConfigSilverlightWebpartPopupUI_show(){var a=this,c=function(){var b={};b.url=a.dialogUrl;b.width=a.dialogWidth;b.height=a.dialogHeight;var c={};c.url=document.getElementById(a.urlElementId).value;c.applicationXml=document.getElementById(a.appXmlElementId).value;b.args=c;b.dialogReturnValueCallback=Function.createDelegate(a,a.dialogCallback);SP.UI.ModalDialog.showModalDialog(b)},b;try{b=typeof SP.UI.ModalDialog.showModalDialog}catch(d){b="undefined"}EnsureScript("SP.js",b,c)}function _ConfigSilverlightWebpartPopupUI_dialogCallback(c,b){if(c==1){var a=document.getElementById(this.urlElementId);if(null!=a){a.value=b.url;if(a.value==null)a.value=""}a=document.getElementById(this.appXmlElementId);if(null!=a){a.value=b.applicationXml;if(a.value==null)a.value=""}}}function LaunchApp(a,e,f,b,d,c){return LaunchAppInternal(a,e,f,b,d,c)}var _launchNotificationId;function LaunchAppInternal(c,d,e,b,g,f){var h=typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl,a=escapeUrlForCallback(h)+"/_layouts/15/appredirect.aspx";if(typeof d!="undefined"&&d!=null&&typeof e!="undefined"&&e!=null)a+="?client_id="+escapeProperly(d)+"&redirect_uri="+escapeProperly(e);else if(typeof c!="undefined"&&c!=null)a+="?instance_id="+escapeProperly(c);else throw"appOAuthId, launchUrl, appInstanceId are null";if(g)a+="&tsapp=1";if(typeof b!="undefined"&&b!=null&&(!window._spModuleLink||!f))SetupAndOpenDialogForCustomAction(a,b.width,b.height,b.title);else window.location.href=a}var _tenantAppData;function GetTenantAppData(){var b=typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl=="/"?"":_spPageContextInfo.webServerRelativeUrl;if(_tenantAppData!=null)return _tenantAppData;if(typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.tenantAppVersion!="undefined"&&_spPageContextInfo.tenantAppVersion=="none"){_tenantAppData={isCorpSite:false,apps:[]};return _tenantAppData}if(typeof _spPageContextInfo!="undefined"&&typeof _spPageContextInfo.currentLanguage!="undefined"){var a=new XMLHttpRequest;a.open("GET",escapeUrlForCallback(b)+"/_layouts/15/tenantappinfo.ashx?etag="+escapeProperly(String(_spPageContextInfo.tenantAppVersion))+"&lcid="+escapeProperly(""+String(_spPageContextInfo.currentLanguage)),false);a.send("");if(a.status<400&&a.getResponseHeader("Content-Type").indexOf("application/json")!=-1)try{_tenantAppData=JSON.parse(a.responseText)}catch(c){}}return _tenantAppData}var Accessibility;function Accessibility_module_def(){Accessibility.CreateTabLoopContainer=function(d){var b=document.createElement("input"),c=document.createElement("div"),a=document.createElement("input");b.type="button";b.style.position="absolute";b.style.top="-9001px";a.type="button";a.style.position="absolute";a.style.top="-9001px";b.onfocus=Accessibility.FocusLastTabStop.bind(this,c);a.onfocus=Accessibility.FocusFirstTabStop.bind(this,c);d.appendChild(b);d.appendChild(c);d.appendChild(a);return c};Accessibility.FocusFirstTabStop=function(a){if(!Boolean(a))return;var b=Accessibility.GetFirstTabStop(a);if(Boolean(b))b.focus();else a.focus()};Accessibility.FocusLastTabStop=function(a){if(!Boolean(a))return;var b=Accessibility.GetLastTabStop(a);if(Boolean(b))b.focus();else a.focus()};Accessibility.GetFirstTabStop=function(a){if(!Boolean(a))return null;if(Accessibility.IsTabStop(a))return a;if(a.style.display.toLowerCase()=="none"||a.style.visibility.toLowerCase()=="hidden")return null;for(var d=a.children,e=d.length,b=0;b<e;b++){var f=d[b],c=this.GetFirstTabStop(f);if(Boolean(c))return c}return null};Accessibility.GetLastTabStop=function(a){if(!Boolean(a))return null;if(a.style.display.toLowerCase()=="none"||a.style.visibility.toLowerCase()=="hidden")return null;for(var e=Accessibility.IsTabStop(a)?a:null,d=a.children,f=d.length,b=0;b<f;b++){var g=d[b],c=this.GetLastTabStop(g);if(Boolean(c))e=c}return e};Accessibility.IsTabStop=function(a){if(!Boolean(a))return false;var b=a.tagName.toLowerCase();return b!="a"&&b!="input"&&b!="area"&&b!="button"&&b!="select"&&b!="textarea"&&b!="object"?false:a.tabIndex==-1?false:a.style.display.toLowerCase()=="none"||a.style.visibility.toLowerCase()=="hidden"?false:a.offsetWidth==0&&a.offsetHeight==0?false:a.disabled?false:b=="input"&&a.type.toLowerCase()=="hidden"?false:true}}var DOM_afterglass;function DOM_afterglass_module_def(){DOM_afterglass.GetAncestor=e;DOM_afterglass.GetAncestorByTagNames=d;DOM_afterglass.GetParentLinkFromEvent=DOM.GetParentLinkFromEvent;DOM_afterglass.GetPosition=f;DOM_afterglass.GetOffset=h;DOM_afterglass.GetSelectedElement=DOM.GetSelectedElement;DOM_afterglass.IsContained=g;DOM_afterglass.IsEventRightClickOnAnchor=c;DOM_afterglass.IsEventTargetAnchor=a;function b(c,d,b,a){this.left=c;this.top=d;this.width=b;this.height=a}b.prototype={left:0,top:0,width:0,height:0};function e(a,b){while(a!=null&&a.tagName!=b)a=a.parentNode;return a}function d(b,c){if(b==null)return null;var a=b.parentNode;while(a!=null){if(IE8Support.arrayIndexOf(c,a.tagName)>=0)break;a=a.parentNode}return a}function g(a,d){if(a==d)return true;for(var c=d.getElementsByTagName(a.tagName),b=0;b<c.length;b++)if(a==c[b])return true;return false}function h(c){var b=c.getBoundingClientRect(),a={left:b.left,top:b.top,bottom:b.bottom,right:b.right};if(typeof window.pageXOffset=="number")a.left+=window.pageXOffset;else if(Boolean(document.documentElement)&&typeof document.documentElement.scrollLeft=="number")a.left+=document.documentElement.scrollLeft;if(typeof window.pageYOffset=="number")a.top+=window.pageYOffset;else if(Boolean(document.documentElement)&&typeof document.documentElement.scrollTop=="number")a.top+=document.documentElement.scrollTop;return a}function f(c){if(c==null)return null;var d=0,e=0,i=0,h=0,k=null,g=null;g=c.offsetParent;var f=c,a=c;while(a.parentNode!=null){a=a.parentNode;if(a.offsetParent!=null){var j=true;if(typeof a.scrollTop=="number"&&a.scrollTop>0)e-=a.scrollTop;if(typeof a.scrollLeft=="number"&&a.scrollLeft>0)d-=a.scrollLeft}if(a==g){d+=c.offsetLeft;if(typeof a.clientLeft=="number"&&a.nodeName!="TABLE")d+=a.clientLeft;e+=c.offsetTop;if(typeof a.clientTop=="number"&&a.nodeName!="TABLE")e+=a.clientTop;c=a;if(c.offsetParent==null){if(typeof c.offsetLeft=="number")d+=c.offsetLeft;if(typeof c.offsetTop=="number")e+=c.offsetTop}g=c.offsetParent}}if(typeof f.offsetWidth=="number")i=f.offsetWidth;if(typeof f.offsetHeight=="number")h=f.offsetHeight;return new b(d,e,i,h)}function c(b){return b==null?false:b.type=="contextmenu"?a(b):false}function a(b){var a=DOM.GetEventSrcElement(b);return a!=null&&a.tagName.toUpperCase()=="A"?true:false}}var GetAncestor,GetAncestorByTagNames,GetParentLinkFromEvent,GetPosition,GetSelectedElement,IsContained,IsEventRightClickOnAnchor,IsEventTargetAnchor,ListModule_afterglass;function ListModule_afterglass_module_def(){ListModule.Util.countSelectedItems=i;ListModule.Util.countTotalItems=n;ListModule.Util.createAjaxMenu=p;ListModule.Util.ctxFromElement=I;ListModule.Util.fetchEcbInfo=t;ListModule.Util.findSTSMenuTable=k;ListModule.Util.focusRow=v;ListModule.Util.getEcbDivFromEcbTd=j;ListModule.Util.getEcbTdFromRow=o;ListModule.Util.getItemRowCbx=c;ListModule.Util.getLastSelectableRowIdx=e;ListModule.Util.getRootFolder=J;ListModule.Util.getRootFolder2=q;ListModule.Util.getUrlWithNoSortParameters=y;ListModule.Util.groupNameFromRow=l;ListModule.Util.groupStringFromGroupName=A;ListModule.Util.headerMenuMouseDown=F;ListModule.Util.itemHasIid=u;ListModule.Util.itemIsCurrentlySelected=B;ListModule.Util.itemIsCurrentlyVisible=f;ListModule.Util.itemIsSelectable=m;ListModule.Util.onItemSelectionChanged=g;ListModule.Util.selectListItem=s;ListModule.Util.setFocusOnRowDelayed=h;ListModule.Util.showEcbMenuForTr=H;ListModule.Util.toggleItemRowSelection2=C;ListModule.Util.updateCtxLastSelectableRow=z;ListModule.Util.updateSelectAllCbx=G;ListModule.Util.registerOnItemSelectionChangedHandler=x;ListModule.Util.unregisterOnItemSelectionChangedHandler=w;ListModule.Util.onFocusFilter=K;ListModule.Util.findCtxImg=a;ListModule.Util.showCtximg=d;ListModule.Util.removeCtxImg=L;ListModule.Util.positionCtxImg=r;ListModule.Util.createCtxImg_Helper=E;ListModule.Util.FilterField=M;ListModule.Util.getFilterValueFromUrl=D;function q(d){var b=Nav.getUrlKeyValue("RootFolder",false),c=d.clvp;if(c!=null&&c.rootFolder!=null)b=c.rootFolder;if(b==""||typeof bValidSearchTerm!="undefined"&&bValidSearchTerm){var a;if(typeof itemTable!="undefined"&&itemTable!=null)a=ListModule.Util.getAttributeFromItemTable(itemTable,"DRef","FileDirRef");if(a!=null&&a!="")if(a.substring(0,1)=="/")b=a;else b="/"+a;else b=d.listUrlDir}return b}function J(b){var a=q(b);return"&RootFolder="+URI_Encoding.encodeURIComponent(a)}function A(a){if(a==null||a=="")return null;var c=document.getElementById("titl"+a+"_");if(c==null)return null;var b=c.getAttribute("groupString");return b!=""?b:null}function n(a){if(a.TotalListItems==null)a.TotalListItems=0;return a.TotalListItems}function i(a){if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return a.CurrentSelectedItems}function e(c,d){if(c==null||d==null)return-1;for(var b=c.rows,a=b.length-1;a>=0;a--){var e=b[a];if(Boolean(d(e)))return a}return-1}function z(a,c){if(a==null||c==null)return;a.LastSelectableRowIdx=0;var b=e(c,m);if(b!=-1)a.LastSelectableRowIdx=b}function m(a){return a==null||!u(a)||!f(a)?false:true}function f(a){return a==null||a.parentNode==null?false:CSSUtil.getCurrentStyle(a.parentNode,"display")=="none"||CSSUtil.getCurrentStyle(a,"display")=="none"?false:true}function B(b,c,d){if(b==null||!Boolean(c))return false;var a=ListModule.Util.getSelectedItemsDict(b);return a==null||a[c]==null||d.className.indexOf("s4-itm-selected")<0?false:true}function u(a){return a==null||a.getAttribute("iid")==null?false:true}function F(a){if(a!=null&&a.tagName=="TH")if(CSSUtil.HasClass(a,"ms-headerCellStyleHover")){CSSUtil.RemoveClass(a,"ms-headerCellStyleHover");CSSUtil.AddClass(a,"ms-headerCellStylePressed")}}function I(e){if(!Boolean(e))return typeof standaloneCtx!="undefined"?standaloneCtx:null;var f=null,j=null;f=DOM_afterglass.GetAncestor(e,"TABLE");var b=f.getElementsByTagName("SCRIPT");if(b==null)return null;var a;if(b.length>0)a=b[0];while(!TypeUtil.IsNullOrUndefined(a)&&!TypeUtil.IsNullOrUndefined(a.id)&&a.id.indexOf("scriptBodyWPQ")==-1)a=a.previousSibling;var c=null,d=null;if(!TypeUtil.IsNullOrUndefined(a)&&!TypeUtil.IsNullOrUndefined(a.id)){c=a.id;var h=c.indexOf("WPQ");if(h!=-1)d=c.substr(h)}if(!TypeUtil.IsNullOrUndefined(d)&&typeof g_ctxDict!="undefined"&&g_ctxDict!=null)for(var i in g_ctxDict){var g=g_ctxDict[i];if(g.wpq==d)return g}return null}function k(a,c){var b=a.getAttribute(c);while(a!=null&&(b==null||b=="")){a=DOM_afterglass.GetSelectedElement(a.parentNode,"TABLE","DIV");if(a!=null)b=a.getAttribute(c)}return a}function D(b,f){var a=null,c,d,e;if(typeof b=="undefined"||b==null)return a;c=b.indexOf("=");if(c==-1)return a;d=b.indexOf("&");if(d==-1)return a;if(d<c)return a;b=Encoding.CanonicalizeUrlEncodingCase(b);e=b.substring(c+1,d);if(e==f){c=b.indexOf("=",d+1);if(c==-1)return a;a=b.substr(c+1);a=URI.decodeURIComponent(a);return a}return a}function y(e){var a=Nav.ajaxNavigate.get_href(),h=new URI(a,{disableEncodingDecodingForLegacyCode:true});h.setFragment("");a=h.getString();var b,f=0,d,g;do{d=e.indexOf("=",f);if(d==-1)return a;b=e.substring(f,d);if(b!="")a=URI.removeQueryParameter(a,b);if(typeof b=="string"&&b.length>"FilterField".length&&b.substring(0,"FilterField".length)=="FilterField"){var c=b.substring("FilterField".length);a=URI.removeQueryParameter(a,"FilterValue"+c);a=URI.removeQueryParameter(a,"FilterLookupId"+c);a=URI.removeQueryParameter(a,"FilterOp"+c);a=URI.removeQueryParameter(a,"FilterData"+c)}g=e.indexOf("&",d+1);if(g==-1)return a;f=g+1}while(b!="");return a}function C(b,a,h,e,f){var d=a.getAttribute("iid"),c=d.split(",");if(c[1]=="")return false;s(b,d,c,a,h,f);g(b,l(a),e,a);return true}function s(a,d,g,e,f,h){var b=c(e);if(b==null)return;b.checked=f;if(typeof a.dictSel=="undefined")a.dictSel=[];if(f){CSSUtil.AddClass(e,"s4-itm-selected");if(a.dictSel[d]==null){a.CurrentSelectedItems++;a.dictSel[d]={id:g[1],fsObjType:g[2]}}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","true")}else{CSSUtil.RemoveClass(e,"s4-itm-selected");if(a.dictSel[d]!=null){delete a.dictSel[d];a.CurrentSelectedItems--}b.nodeName.toUpperCase()!="INPUT"&&b.setAttribute("aria-checked","false")}!h&&v(a,d,e)}function c(a){var b=null;if(a!=null&&a.cells!=null&&a.cells.length>0){var c=a.cells[0];b=c.querySelector(".s4-itm-cbx")}return b}function v(a,d,e){if(a==null)return;a.LastSelectedItemIID=d;var b=c(e);if(b!=null){a.RowFocusTimerID!=null&&clearTimeout(a.RowFocusTimerID);a.RowFocusTimerID=setTimeout(function(){h(a,b)},11)}}function g(f,b,d,c){var a=f;function e(){if(typeof a.onItemSelectionChangedHandlers!="undefined")for(var f=0;f<a.onItemSelectionChangedHandlers.length;f++)a.onItemSelectionChangedHandlers[f].fn();var g=[];if(typeof _ribbon!="undefined"&&_ribbon!=null){var e=a.clvp;if(e!=null)if(d)e.EnsureEcbInfo(RefreshCommandUI,"RefreshCommandUI",g,b,c);else e.EnsureEcbInfo(null,null,null,b,c)}}EnsureScript("inplview",typeof InitAllClvps,e)}function l(e){var c=e.parentNode,a=c.id;if(a==null||a==""){var b=c.previousSibling;if(b!=null&&b.childNodes.length==0&&b.tagName==c.tagName)a=b.id}if(a==null||a=="")return null;var d=a.substr(4,a.length-6);return d!=""?d:null}function h(e,a){var b=1,c=2,f=3;function g(d,a){if(d==null)return b;if(a==null)a=document.body;var i=DOM.AbsTop(d),j=DOM.AbsTop(a),k=a.scrollTop,h=j+k,l=d.offsetHeight,g=i-h,e=h+a.offsetHeight-(i+l);return g>=0&&e>=0?b:Math.abs(g)<Math.abs(e)?c:f}if(a==null||e==null)return;try{a.focus()}catch(i){}if(BrowserDetection.userAgent.webKit){var d=g(a,document.getElementById("s4-workspace"));if(d!=b){var h=d==c?true:false;a.scrollIntoView(h)}}e.RowFocusTimerID=null}function G(a,c){if(a==null||a.SelectAllCbx==null)return;a.SelectAllCbx.checked=false;if(c){var d=n(a),b=i(a);if(b==d&&b>0)a.SelectAllCbx.checked=true}}function x(a,b,c){if(a===null)return;if(typeof a.onItemSelectionChangedHandlers=="undefined")a.onItemSelectionChangedHandlers=[];a.onItemSelectionChangedHandlers.push({key:b,fn:c})}function w(a,c){if(a===null)return;if(typeof a.onItemSelectionChangedHandlers=="undefined")return;for(var b=0;b<a.onItemSelectionChangedHandlers.length;b++)if(a.onItemSelectionChangedHandlers[b].key==c){a.onItemSelectionChangedHandlers.splice(b,1);break}}function b(a){return GetThemedImageUrl(a)}function K(a){if(window.location.href.search(new RegExp("[\\?&]Filter=1"))!=-1)return false;if(!IsFilterMenuEnabled(a))return false;a.onfocusout=OnMouseOutFilter;a.onkeydown=PopFilterMenu;var b=a.getAttribute("FilterString");if(b!=null)filterStr=b;var c=k(a,"CTXNum");if(c==null)return false;OnMouseOverFilter(c);return false}function a(g){for(var c=null,e=g.childNodes,f=e.length,d=0;d<f;d++){var b=e[d];if(b.nodeType==1&&b.className.indexOf("s4-ctx")!=-1){c=b;break}else{c=a(b);if(c!=null)break}}return c}function r(b,a){var j=0,c=0,f=CSSUtil.HasClass(b.parentNode,"ms-positionRelative"),o=DOM_afterglass.GetPosition(a),s=DOM_afterglass.GetPosition(b.offsetParent);if(!BrowserDetection.userAgent.chrome&&CSSUtil.getCurrentEltStyleByNames(a,["border-collapse","borderCollapse"])=="collapse"){var k=a.offsetHeight-a.clientHeight;o.height+=k;o.top-=k}var n=DOM_afterglass.GetOffset(f?a:a),m=DOM_afterglass.GetOffset(f?b.parentNode:b.offsetParent);j=n.top-m.top;if(f){var g,h;if(!IsElementRtl(a)){g=CSSUtil.getCurrentEltStyleByNames(a,["padding-right","paddingRight"]);h=CSSUtil.getCurrentEltStyleByNames(a,["border-right-width","borderRightWidth"])}else{g=CSSUtil.getCurrentEltStyleByNames(a,["padding-left","paddingLeft"]);h=CSSUtil.getCurrentEltStyleByNames(a,["border-left-width","borderLeftWidth"])}var r=CSSUtil.pxToFloat(g),q=CSSUtil.pxToFloat(h);c=-r-q}else{c=n.left-m.left;if(!IsElementRtl(a))c=c+a.offsetWidth-b.offsetWidth;j+=b.offsetParent.scrollTop;c+=b.offsetParent.scrollLeft}var l=String(c)+"px",d=b.style;d.top=String(j)+"px";if(!IsElementRtl(a)&&f)d.right=l;else d.left=l;var i=N(a,true,false,false);if(BrowserDetection.userAgent.ie9standardUp){var e=DOM_afterglass.GetAncestorByTagNames(a,["TR","TH"]);if(e!=null&&e.nextSibling!=null){var p=e.nextSibling.offsetTop-e.offsetTop-e.offsetHeight;i+=p}}d.height=String(i)+"px";d.lineHeight=String(Math.max(i-2,0))+"px";d.margin="0px"}function N(c,d,g,h){var e=BrowserDetection.userAgent.ie9standardUp;if(!e&&d&&!g&&!h)return c.clientHeight;var b=window.getComputedStyle(c,null),a=CSSUtil.pxToFloat(b.height);if(e||d){var f=CSSUtil.pxToFloat(b.paddingTop)+CSSUtil.pxToFloat(b.paddingBottom);if(e)a=Math.max(c.clientHeight,a+f)-f;if(d)a+=f}if(g)a+=CSSUtil.pxToFloat(CSSUtil.getCurrentStyle(c,"border-top-width"))+CSSUtil.pxToFloat(CSSUtil.getCurrentStyle(c,"border-bottom-width"));var i=0;if(h)a+=CSSUtil.pxToFloat(b.marginTop)+CSSUtil.pxToFloat(b.marginBottom);return a}function d(a,f,b){var d=null,c=null;if(a!=null)d=a.getElementsByTagName("A")[0];if(d!=null)c=d.getElementsByTagName("IMG")[0];if(c!=null){var e=b.tagName=="TH";if(f==true){CSSUtil.AddClass(a,"s4-ctx-show");e&&CSSUtil.AddClass(b,"ms-headerCellStyleHover");r(a,b);c.style.visibility="visible";a.shown=true;ChevronContainer=b;if(a.onmouseover==null)a.onmouseover=function(){!CSSUtil.HasClass(a,"s4-ctx-show-hover")&&CSSUtil.AddClass(a,"s4-ctx-show-hover")};a.onmouseout=function(c){if(!IsMenuOn()&&!IsCallOutOn()&&!IsFilterMenuOn()){if(c==null)c=window.event;var b=Boolean(c.relatedTarget)?c.relatedTarget:c.toElement;while(b!=null&&b.tagName!="BODY"){if(b==this)return;b=b.parentNode}b!=null&&CSSUtil.RemoveClass(a,"s4-ctx-show-hover")}}}else{c.style.visibility="hidden";CSSUtil.RemoveClass(a,"s4-ctx-show");CSSUtil.RemoveClass(a,"s4-ctx-show-hover");a.shown=false;a.onmouseout=null;ChevronContainer=null;if(e){CSSUtil.RemoveClass(b,"ms-headerCellStyleHover");CSSUtil.RemoveClass(b,"ms-headerCellStylePressed");CSSUtil.RemoveClass(b,"ms-headerCellStyleMenuOpen")}}}}function E(f,m,l){var c=a(f);if(c!=null&&typeof c.shown=="boolean"&&c.shown==true)return c;if(c==null){c=document.createElement("DIV");c.className="s4-ctx";var e=[];e.push("<span>\u00a0</span>");e.push("<a onfocus='");if(f.tagName=="TD")e.push("OnChildItem(this.parentNode.parentNode); return false;'");else if(f.tagName=="TH")e.push("OnChildColumn(this.parentNode.parentNode); return false;'");else e.push("return false;'");e.push("href='javascript:;' onclick='PopMenuFromChevron(event); return false;' title='");e.push("'></a>");e.push("<span>\u00a0</span>");c.innerHTML=e.join("");delete e;f.appendChild(c)}if(typeof c.shown=="undefined"){for(var k=c.getElementsByTagName("SPAN"),n=k.length,i=0;i<n;i++)if(BrowserDetection.userAgent.ie&&BrowserDetection.userAgent.iever==6)k[i].style.lineHeight="1px";var h=c.getElementsByTagName("A")[0];h.onfocusout=m;var g=h.getElementsByTagName("img")[0],j=g==null;if(j)g=document.createElement("img");g.style.visibility="hidden";if(f.getAttribute("IsECB")=="TRUE"||f.getAttribute("IsCallout")=="TRUE"||f.getAttribute("role")=="gridcell")g.src=!IsElementRtl(f)?b("ecbbutton.png"):b("ecbbuttonrtl.png");else g.src=b("ecbarw.png");g.setAttribute("ms-jsgrid-click-passthrough","true");j&&h.appendChild(g)}l&&d(c,true,f);return c}function L(c){var b=a(c);b!=null&&d(b,false,c)}function M(l,k,i,t,r,H,D){var g,a=Boolean(r)?r:Encoding.CanonicalizeUrlEncodingCase(Nav.ajaxNavigate.get_href()),v=new URI(a,{disableEncodingDecodingForLegacyCode:true});a="?"+v.getQuery();var e,q;if((typeof ctxFilter=="undefined"||ctxFilter==null)&&Boolean(D))ctxFilter=D;var b=a.match(new RegExp("[&?]Paged=TRUE[^&]*"));if(b!=null){var c=/&p_[^&]*/gi;a=a.replace(c,"");c=/&PageFirstRow=[^&]*/gi;a=a.replace(c,"");c=/&PageLastRow=[^&]*/gi;a=a.replace(c,"");c=/&PagedPrev=TRUE[^&]*/i;a=a.replace(c,"");b=a.match(new RegExp("[?]Paged=TRUE[^&]*"));if(b!=null){g=a.substr(b.index).indexOf("&");if(g!=-1)a=a.substr(0,b.index+1)+a.substr(g+b.index+1);else a=a.substr(0,b.index)}else{c=/&Paged=TRUE[^&]*/i;a=a.replace(c,"")}}var u=Nav.getUrlKeyValue("View",true);if(u==""){a=URI.stURLSetVar2(a,"View",l);u=l}if(URI.completeDecode(l.toUpperCase())!=URI.completeDecode(u.toUpperCase())){var I=/\?[^?]*/i;g=a.indexOf("?");if(g!=-1)a=a.replace(I,"?View="+l);else a=a+"?View="+l}var s=true;b=a.match(new RegExp("FilterField([0-9]+)="+k+"&"));if(!Boolean(b)){b=a.match(new RegExp("FilterFields([0-9]+)="+k+"&"));s=false}if(!Boolean(b))if(0==t){a=a.replace("Filter=1&","");a=a.replace("?Filter=1","")}else{g=a.indexOf("?");if(g!=-1)a=a+"&";else a=a+"?";var m=0;do{m++;q=a.match(new RegExp("FilterField"+String(m)+"=[^&]*"));if(!Boolean(q))q=a.match(new RegExp("FilterFields"+String(m)+"=[^&]*"))}while(q!=null);a=a+"FilterField"+String(m)+"="+k+"&FilterValue"+String(m)+"="+URI_Encoding.encodeURIComponent(i);a=a.replace("Filter=1&","")}else{e=parseInt(b[1]);var f=a.match(new RegExp("FilterValue"+String(e)+"=[^&]*"));if(!Boolean(f))f=a.match(new RegExp("FilterValues"+String(e)+"=[^&]*"));var C=a.match(new RegExp("&FilterOp"+String(e)+"=[^&]*")),z=a.match(new RegExp("&FilterLookupId"+String(e)+"=[^&]*")),B=a.match(new RegExp("&FilterData"+String(e)+"=[^&]*")),j="&"+b[0]+f[0];if(0==t){if(a.indexOf(j)==-1){var G=b[0];j=G+f[0]+"&"}a=a.replace(j,"");if(C!=null)a=a.replace(String(C[0]),"");if(z!=null)a=a.replace(String(z[0]),"");if(B!=null)a=a.replace(String(B[0]),"");a=URI.restructureFilterUrl(a,e);a=a.replace("Filter=1&","");a=a.replace("?Filter=1","");a=a.replace("&Filter=1","")}else{var o;if(a.indexOf(j)==-1){j="?"+b[0]+f[0];o="?"}else o="&";var p;if(typeof ctxFilter=="undefined"||ctxFilter==null||typeof ctxFilter.IsClientRendering=="undefined"||!Boolean(ctxFilter.IsClientRendering))p=o+"FilterField"+b[1]+"="+k+"&FilterValue"+b[1]+"="+URI_Encoding.encodeURIComponent(i);else{var w=false,d=String(f[0].substr(f[0].indexOf("=")+1)),h=[],n=[];if(s){d=URI.decodeURIComponent(d);if(i!=d){h.push(d);h.push(i)}}else{n=URI.parseMultiColumnValue(URI.decodeURIComponent(d),";#",true);for(var A in n){if(n[A]==i){w=true;continue}h.push(n[A])}!w&&h.push(i)}d=URI_Encoding.encodeURIComponent(URI.convertMultiColumnValueToString(h,null,false));var x="FilterField",y="&FilterValue";if(h.length>1){x="FilterFields";y="&FilterValues"}p=o+x+b[1]+"="+k+y+b[1]+"="+d;if(d==""&&s){p="";a=URI.restructureFilterUrl(a,e)}}a=a.replace(j,p);a=a.replace("Filter=1&","");a=a.replace("&Filter=1","")}}var F=b;b=a.match(new RegExp("FilterField([0-9]+)="));if(!Boolean(b))b=a.match(new RegExp("FilterFields([0-9]+)="));if(b==null&&t==0&&typeof ctxFilter!="undefined"&&ctxFilter!=null&&(!Boolean(ctxFilter.IsClientRendering)||F!=null&&!Boolean(r)))a=a+"&FilterClear=1";else a=a.replace("&FilterClear=1","");v.setQuery(a);a=v.getString();if(H){var E=a.indexOf("?");E=a.substr(E+1).indexOf("?");return a}else _SubmitFormPost(a);return null}function H(i,d,l,a,b){var h=currentCtx;if(DOM_afterglass.IsEventRightClickOnAnchor(d)&&(Boolean(h)&&!Boolean(h.listBaseType==1)||!ListModule.Settings.SupportsRightClickECB))return true;var e=DOM_afterglass.GetAncestor(i,"TR"),m=o(e),c=j(m);if(c==null)return true;ListModule.Settings.SupportsOldDesktopMenus&&e.className.indexOf("s4-itm-selected")<0&&SingleItemSelectByElement(e,false);itemTable=c;if(ListModule.Settings.SupportsOldDesktopMenus){currentItemID=ListModule.Util.getAttributeFromItemTable(c,"ItemId","Id");currentCtx=g_ctxDict[c.getAttribute("CTXName")]}var f=typeof a!="number"||typeof b!="number"||a<0||b<0;if(f)a=b=undefined;var g=!ListModule.Settings.SupportsOldDesktopMenus;if(g||IsAjaxMenu(c)){var k=g||f&&FIsMouseCursorInsideElement(d,i);return p(d,k,l,a,b)}return CreateMenu(d,a,b)}function o(b){var a=null;if(b!=null)a=b.querySelector('td[IsECB="TRUE"]');return a}function j(a){return a!=null?a.querySelector("div.ms-vb.itx"):null}function p(b,j,k,f,g){if(ListModule.Settings.SupportsOldDesktopMenus&&(!IsContextSet()||itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null))return false;if(b==null)b=window.event;var c=null;if(typeof f=="number"&&typeof g=="number"&&f>=0&&g>=0){c={};c.clientX=f;c.clientY=g}else if(j&&b!=null&&b.clientX!=null&&b.clientY!=null&&b.clientX!=0&&b.clientY!=0){c={};c.clientX=b.clientX;c.clientY=b.clientY}var e,d,h;if(ListModule.Settings.SupportsOldDesktopMenus){e=DOM_afterglass.GetParentLinkFromEvent(b);if(isInvalidAjaxMenuElement(e)){e=Boolean(b.srcElement)?b.srcElement:b.target;if(isInvalidAjaxMenuElement(e))return true}var a=itemTable,i=a.parentNode;if(i!=null&&parseInt(i.getAttribute("creatingAjax"))==1)return false;a.parentNode.setAttribute("creatingAjax","1");d=currentCtx;h=function(f,e){if(e!=undefined)if(typeof d.IsClientRendering!="undefined"&&d.IsClientRendering){e.FileRef!=undefined&&a.setAttribute("Url",e.FileRef);e.FileDirRef!=undefined&&a.setAttribute("DRef",e.FileDirRef);e.File_x0020_Type!=undefined&&a.setAttribute("Ext",e.File_x0020_Type);e.HTML_x0020_File_x0020_Type!=undefined&&a.setAttribute("Type",e.HTML_x0020_File_x0020_Type);e.FSObjType!=undefined&&a.setAttribute("OType",e.FSObjType);e.CheckedOutUserId!=undefined&&a.setAttribute("COUId",e.CheckedOutUserId);e._HasCopyDestinations!=undefined&&a.setAttribute("HCD",e._HasCopyDestinations);e._CopySource!=undefined&&a.setAttribute("CSrc",e._CopySource);e._ModerationStatus!=undefined&&a.setAttribute("MS",e["_ModerationStatus."]);e.ContentType!=undefined&&a.setAttribute("CType",e.ContentType);e.ContentTypeId!=undefined&&a.setAttribute("CId",e.ContentTypeId);e._UIVersion!=undefined&&a.setAttribute("UIS",e._UIVersion);e._SourceUrl!=undefined&&a.setAttribute("SUrl",e._SourceUrl);e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]!=undefined&&a.setAttribute("Icon",e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"]);if(Boolean(d.ListSchema.IsDocLib)){e["serverurl.progid"]!=undefined&&a.setAttribute("sred",e["serverurl.progid"]);e["ctxt.ListSchema.DefaultItemOpen"]!=undefined&&a.setAttribute("defaultio",d.ListSchema.DefaultItemOpen);e.IsCheckedoutToLocal!=undefined&&a.setAttribute("cout",e.IsCheckedoutToLocal)}OnItemDeferCall(a);CreateMenuEx(f,a,Boolean(c)?c:b,false);a.parentNode.removeAttribute("creatingAjax")}else{a.parentNode.replaceChild(e,a);e.onclick=typeof a.onclick!="undefined"?a.onclick:undefined;e.onmousehover=OnItem;OnItemDeferCall(e);CreateMenuEx(f,e,Boolean(c)?c:b,false);e.parentNode.removeAttribute("creatingAjax")}}}else{e=DOM.GetEventSrcElement(b);d=ListModule.Util.ctxFromElement();h=function(a,b){var d=new ContextMenu({evt:c,items:[{text:"View Item",href:ListModule.Util.createViewEditUrl(a,b,false,true)},{text:"Edit Item",href:ListModule.Util.createViewEditUrl(a,b,true,true)}]});d.open()}}t(d,itemTable.id,itemTable.tagName,h);DOM.CancelEvent(b);return false}function t(a,e,l,g){var b=[],i=false,f=null,d=null;if(Boolean(a.RealHttpRoot)){d=URI_Encoding.escapeUrlForCallback(a.RealHttpRoot);f=ListModule.Util.makeMountedFolderQueryStrParams(true,false)}else d=URI_Encoding.escapeUrlForCallback(a.HttpRoot);b.push(d);d[d.length-1]!="/"&&b.push("/");b.push("_layouts/15/inplview.aspx?Cmd=Ctx&List=");b.push(a.listName);a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null&&b.push("&CascDelWarnMessage=1");if(a.view!=null){b.push("&View=");b.push(a.view)}b.push("&ViewCount=");b.push(a.ctxId);if(typeof a.isXslView!="undefined"&&a.isXslView){b.push("&IsXslView=TRUE");b.push("&Field=");if(itemTable!=null)b.push(ListModule.Util.getAttributeFromItemTable(itemTable,"Field","Field"));else b.push("LinkFilename");if(typeof a.IsClientRendering!="undefined"&&a.IsClientRendering){b.push("&IsCSR=TRUE");if(Boolean(a.listName)){var n="ECBItems_"+a.listName.toLowerCase();if(document.getElementById(n)==null){b.push("&CustomAction=TRUE");i=true}else if(Boolean(a.ExternalDataList)){h(a,e,a.ListData,g);return}}}}b.push("&ID=");b.push(e);var k=Nav.getUrlKeyValue("RootFolder",true,Nav.ajaxNavigate.get_href());if(k.length>0){b.push("&RootFolder=");b.push(k)}else if(Boolean(a.rootFolder)){b.push("&RootFolder=");b.push(a.rootFolder)}f!=null&&b.push(f);b.push("&ListViewPageUrl=");var o=new URI(Nav.ajaxNavigate.get_href(),{disableEncodingDecodingForLegacyCode:true});d=o.getStringWithoutQueryAndFragment();b.push(d);if(typeof a.overrideScope!="undefined"){b.push("&OverrideScope=");b.push(URI_Encoding.encodeURIComponent(a.overrideScope))}if(typeof a.searchTerm!="undefined"&&a.searchTerm!=null){b.push("&InplaceSearchQuery=");b.push(URI_Encoding.encodeURIComponent(a.searchTerm,true))}else if(typeof a.completedSearchTerm!="undefined"&&a.completedSearchTerm!=null){b.push("&InplaceSearchQuery=");b.push(URI_Encoding.encodeURIComponent(a.completedSearchTerm,true))}typeof a.fullListSearch!="undefined"&&a.fullListSearch!=null&&a.fullListSearch==true&&b.push("&InplaceFullListSearch=true");var m=b.join(""),c,j=XMLHttpRequest;if(a.clvp!=null&&a.clvp.xmlHttpCtr!=null)j=a.clvp.xmlHttpCtr;c=new j;c.open("POST",m,true);c.onreadystatechange=function(){if(c.readyState!=4)return;if(c.status==601)alert(c.responseText);else if(c.status==503)alert(Strings.STS.L_ServerBusyError);else if(typeof a.IsClientRendering!="undefined"&&a.IsClientRendering){var d=c.responseText;if(i){var q="<CustomAction/>",m=d.indexOf(q);if(m>=0){var t=document.createElement("DIV");t.innerHTML=d.substring(0,m);document.body.appendChild(t);d=d.substring(m+q.length)}}var j=null;if(Boolean(a.ExternalDataList))j=a.ListData;else j=JSON.parse(d);if(a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null)a.CascadeDeleteWarningMessage=j.CascadeDeleteWarningMessage;h(a,e,j,g)}else{var b=c.responseText,o=document.createElement("DIV");o.style.visibility="hidden";if(a.HasRelatedCascadeLists==1&&a.CascadeDeleteWarningMessage==null){var r="<CascadeDeleteWarningMessage>",s="</CascadeDeleteWarningMessage>";if(b.startsWith(r)){var p=b.indexOf(s);if(p!==-1){a.CascadeDeleteWarningMessage=b.substring(r.length,p);b=b.substring(p+s.length)}}}o.innerHTML=b;for(var n=o.getElementsByTagName(l),f,k=0;k<n.length;k++){f=n[k];if(f.id==e)break}if(k==n.length)f=null;if(f!=null)g(a,f);else{alert(Strings.STS.L_ItemGone);RefreshPage(1)}}};c.send(null);function h(e,f,b,d){for(var c=undefined,a=0;a<b.Row.length;a++)if(b.Row[a].ID==f){c=b.Row[a];break}c!=undefined&&d(e,c)}}}var _ListHeaderMenu_OnMouseDown,CountSelectedItems,CountTotalItems,CreateAjaxMenu,CtxFromElement,FetchEcbInfo,FindSTSMenuTable,FocusRow,GetEcbDivFromEcbTd,GetEcbTdFromRow,GetItemRowCbx,getFilterValueFromUrl,GetLastSelectableRowIdx,GetRootFolder,GetRootFolder2,GetUrlWithNoSortParameters,GroupNameFromRow,GroupStringFromGroupName,ItemHasiid,ItemIsCurrentlySelected,ItemIsCurrentlyVisible,ItemIsSelectable,OnItemSelectionChanged,SelectListItem,SetFocusOnRowDelayed,ShowECBMenuForTr,ToggleItemRowSelection2,UpdateCtxLastSelectableRow,UpdateSelectAllCbx,_OnFocusFilter,FindCtxImg,ShowCtxImg,RemoveCtxImg,PositionCtxImg,List_CreateCtxImg_Helper,FilterFieldV3,RegisterOnItemSelectionChangedHandler,UnregisterOnItemSelectionChangedHandler,DocumentType;function DocumentInformation(e,b,d,c,a){this.type=e;this.idToken=b;this.imgSrc=d;this.imgAlt=c;this.textLabel=a}var c_newdocWOPIID,c_newDocDivHtml,c_onClickCreateDoc,c_newDocCalloutWidth,NewDocumentInfo;function InitializeNewDocumentInfo(){var a={};a[DocumentType.Word]=new DocumentInformation(DocumentType.Word,"Word","/_layouts/15/images/lg_icdocx.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentWordImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentWord:"");a[DocumentType.Excel]=new DocumentInformation(DocumentType.Excel,"Excel","/_layouts/15/images/lg_icxlsx.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcel:"");a[DocumentType.PowerPoint]=new DocumentInformation(DocumentType.PowerPoint,"PowerPoint","/_layouts/15/images/lg_icpptx.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentPowerPointImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentPowerPoint:"");a[DocumentType.OneNote]=new DocumentInformation(DocumentType.OneNote,"OneNote","/_layouts/15/images/lg_icont.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentOneNoteImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentOneNote:"");a[DocumentType.Visio]=new DocumentInformation(DocumentType.Visio,"Visio","/_layouts/15/images/lg_icvdx.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisioImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentVisio:"");a[DocumentType.ExcelForm]=new DocumentInformation(DocumentType.ExcelForm,"ExcelForm","/_layouts/15/images/lg_icxlsx.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelFormImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentExcelForm:"");a[DocumentType.Folder]=new DocumentInformation(DocumentType.Folder,"Folder","/_layouts/15/images/mb_folder.png?rev=47",typeof Strings!="undefined"?Strings.STS.L_NewDocumentFolderImgAlt:"",typeof Strings!="undefined"?Strings.STS.L_NewDocumentFolder:"");return a}function NewDocumentCallout_OnOpenedCallback(d){var c=GetNewDocumentCalloutMainID(d),b=document.getElementById(c);if(Boolean(b)){var a=b.parentNode;if(Boolean(a)&&HasCssClass(a,"js-callout-body")){a.style.marginLeft="0px";a.style.marginRight="0px";b.style.marginLeft="20px";b.style.marginRight="20px"}}}function CreateDocItem(a,e,i){var c=c_newdocWOPIID+"div"+a.idToken+"-",f=ListModule.Util.addWPQtoId(c,e),g=ListModule.Util.addWPQtoId(c+"img-",e),h=ListModule.Util.addWPQtoId(c+"txt-",e);if(a.type==DocumentType.SuiteExtensionApp){var d=document.createElement("div");d.innerHTML=String.format(c_newDocDivHtml,f,g,"","",h,i,"");var j=d.children[0],b=j.children[0],k=j.children[1];try{b.src=a.imgSrc}catch(l){}b.alt=a.imgAlt;b.style.height="32px";b.style.width="32px";k.appendChild(document.createTextNode(a.textLabel));return d.innerHTML}else return String.format(c_newDocDivHtml,f,g,a.imgSrc,Encoding.HtmlEncode(a.imgAlt),h,i,Encoding.HtmlEncode(a.textLabel))}function ParseNewMenuJson(data){return eval(data)}function RenderNewDocumentCallout(d,n){var c=[],i=d.wpq;c.push('<div id="');c.push(GetNewDocumentCalloutMainID(d));c.push('" class="ms-newdoc-callout-main">');var k=window["toolbarData"+i],o=false;if(Boolean(k)&&Boolean(k.NewMenuData)){var r="/Forms/template.do",q="Forms\\u002ftemplate.do",g=ParseNewMenuJson(k.NewMenuData);if(g.length>1||g.length==1&&Boolean(g[0].ClickScript)&&g[0].ClickScript.indexOf(r)===-1&&g[0].ClickScript.indexOf(q)===-1){o=true;for(var b=0;b<g.length;b++){var f=g[b].ClickScript,s=Encoding.HtmlEncode(g[b].LabelText),t=Encoding.HtmlEncode(g[b].Description),l=c_newdocWOPIID+"div"+b.toString()+"-",u=String.format(c_newDocDivHtml,ListModule.Util.addWPQtoId(l,i),ListModule.Util.addWPQtoId(l+"img-",i),g[b].Image32by32,t,ListModule.Util.addWPQtoId(l+"txt-",i),"CalloutManager.closeAll();"+f,s);c.push(u)}if(Boolean(d.AllowCreateFolder)){f="";var e=null;for(var a in NewDocumentInfo){e=NewDocumentInfo[a];if(Number(a)==DocumentType.Folder){f=RenderNewFolderUrl(d);break}}if(Boolean(f)){c.push("<hr/>");c.push(CreateDocItem(e,i,f))}}}}if(!o){var j=[],p=[];if(typeof IsFileHandlerFileCreationSupported=="function"&&IsFileHandlerFileCreationSupported()){var h=d.newDoc_seInfo;if(h==null)h=d.newDoc_seInfo={};if(h.menu==null)h.menu=TryCreateSuiteExtensionFileCreationMenu();if(h.menu!=null){WriteStart("FileHandler_StartLoadFileCreationEntries");if(h.entries==null)h.entries=h.menu.get_fileCreationEntries();for(b=0;b<h.entries.length;b++){var m=h.entries[b];j.push(new DocumentInformation(DocumentType.SuiteExtensionApp,"SuiteExtensionApp"+b.toString(),m.imageUrl+"",m.imageAlternateText+"",m.displayName+""));p.push("NewDocumentCallout_OnClickedSuiteExtensionApp('"+d.ctxId+"', "+b.toString()+"); return false;")}WriteSuccess("FileHandler_SuccessLoadFileCreationEntries")}}for(a in NewDocumentInfo){if(Number(a)==DocumentType.ExcelForm&&!Boolean(d.CanShareLinkForNewDocument))continue;if(Number(a)==DocumentType.Word||Number(a)==DocumentType.Excel||Number(a)==DocumentType.PowerPoint||Number(a)==DocumentType.OneNote||Number(a)==DocumentType.Visio||Number(a)==DocumentType.ExcelForm)if(false==Boolean(d.NewWOPIDocumentTypes&1<<Number(a)))continue;e=NewDocumentInfo[a];if(typeof e!="undefined"&&e!=null&&Number(a)!=DocumentType.Folder){if(Number(a)==DocumentType.ExcelForm)f="TryLaunchExcelForm('"+n+"'); return false;";else if(IsDefaultFileCreationSupported(Number(a)))f="CalloutManager.closeAll(); CreateNewDefaultDocument('"+d.ctxId+"', '"+String(e.type)+"'); return false;";else f=String.format(c_onClickCreateDoc,n,String(e.type));c.push(CreateDocItem(e,i,f))}}if(Boolean(d.AllowCreateFolder))for(a in NewDocumentInfo){e=NewDocumentInfo[a];if(typeof e!="undefined"&&e!=null&&Number(a)==DocumentType.Folder){c.push("<hr/>");f=RenderNewFolderUrl(d);c.push(CreateDocItem(e,i,f))}}if(j.length>0){WriteStart("FileHandler_StartAppendAppsToNewDocumentCallout");c.push("<hr/>");for(b=0;b<j.length;b++)c.push(CreateDocItem(j[b],i,p[b]));WriteSuccess("FileHandler_SuccessAppendAppsToNewDocumentCallout")}}c.push("</div>");return c.join("")}function RefreshNewDocumentCallout(c,e,g){WriteStart("FileHandler_StartRefreshNewDocumentCallout");var b=RenderNewDocumentCallout(c,e),f=GetNewDocumentCalloutMainID(c),d=document.getElementById(f);if(Boolean(d)){var a=d.parentNode;if(Boolean(a))a.innerHTML=b}g.set({content:b});WriteSuccess("FileHandler_SuccessRefreshNewDocumentCallout")}function GetNewDocumentCalloutMainID(a){return ListModule.Util.addWPQtoId(c_newdocWOPIID+"divMain-",a.wpq)}function NewDocumentCallout_OnOpeningCallback(b,c,d){if(typeof IsFileHandlerFileCreationSupported=="function"&&IsFileHandlerFileCreationSupported()){var a=b.newDoc_seInfo;if(a!=null)if(a.menu==null){a.menu=TryCreateSuiteExtensionFileCreationMenu();a.menu!=null&&RefreshNewDocumentCallout(b,c,d)}}}function TryCreateSuiteExtensionFileCreationMenu(){var a=null;if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function")if(typeof SuiteExtensions.ControlFactory.CreateControl=="function"&&typeof SuiteExtensions.ControlType.FileCreation=="number")try{a=SuiteExtensions.ControlFactory.CreateControl("",SuiteExtensions.ControlType.FileCreation)}catch(b){}return a}function NewDocumentCallout_OnClickedSuiteExtensionApp(l,j){WriteStart("FileHandler_StartGetNewFileControl");var b=window.g_ctxDict["ctx"+l];if(b==null){WriteFailure("FileHandler_FailedGetNewFileControl");return}var k=b.newDoc_seInfo,a=k.menu.createNewFileControl(j);if(a==null){WriteFailure("FileHandler_FailedGetNewFileControl");return}WriteSuccess("FileHandler_SuccessGetNewFileControl");a.pickFileHandler(i);var c,e,d;function i(){c=a.get_fileExtension();e=a.get_appId();CalloutManager.closeAll();WriteStart("FileHandler_StartCreateDoc");CreateDocumentWithExtension(b,c,g,f)}function f(a){WriteFailure("FileHandler_FailedCreateDoc");WriteDebugLog("FileHandler_FailedCreateDoc",true,"Failed with extension: "+c+", appId: "+e+", reason: "+a)}function g(c){WriteSuccess("FileHandler_SuccessCreateDoc");WriteStart("FileHandler_StartRedirectToNewDoc");a.set_httpRoot(b.HttpRoot);a.set_itemUrl(c);d=a.getRedirectUrl();GoToPage(d);setTimeout(h,5e3)}function h(){WriteFailure("FileHandler_FailedRedirectToNewDoc")}}function CreateDocumentWithExtension(e,g,m,h){var a=SP.ClientContext.get_current(),j=a.get_web(),n=j.get_lists().getById(e.listName),i=Boolean(e.clvp.rootFolder)?j.getFolderByServerRelativeUrl(e.clvp.rootFolder):n.get_rootFolder(),c=i.get_files(),d=i.get_folders(),b,f;a.load(c);a.load(d);a.executeQueryAsync(k,function(b,a){h(a.get_message())});function k(){for(var j={},k=0,e=0,m=c.get_count();e<m;++e){k+=1;j["KEY_"+c.getItemAtIndex(e).get_name()]=true}for(e=0,m=d.get_count();e<m;++e){k+=1;j["KEY_"+d.getItemAtIndex(e).get_name()]=true}var n=g.toUpperCase()+" File",p="."+g;b=n+p;if(j["KEY_"+b]===true)for(e=1;e<k+1;++e){var o=n+e.toString()+p;if(j["KEY_"+o]!==true){b=o;break}}var i=new SP.FileCreationInformation;i.set_url(b);i.set_overwrite(false);i.set_content(new SP.Base64EncodedByteArray);f=c.add(i);a.load(f);a.executeQueryAsync(l,function(b,a){h(a.get_message())})}function l(){m(f.get_serverRelativeUrl())}}var g_lastLaunchPointIIDClicked;function OpenCallout(a,b,c,d){SP.DebugLogger.Write("CalloutOpen",SP.DebugLogger.LoggingLevel.Boring,"Open Callout for Item "+d);if(typeof CalloutManager!="undefined"){var e=GetAncestor(c,"TD");if(CalloutManager.containsOneCalloutOpen(e))return;if(CalloutManager.containsOneCalloutOpen(a))return}EnsureScriptFunc("callout.js","Callout",function(){if(c.tagName=="DIV"){var f=GetParentLinkFromEvent(b);if(isInvalidAjaxMenuElement(f)){f=Boolean(b.srcElement)?b.srcElement:b.target;if(isInvalidAjaxMenuElement(f))return undefined}}CalloutManager.closeAll();var e=findIIDInAncestorNode(c);if(e===null)return false;g_lastLaunchPointIIDClicked=e;function g(){if(e!==g_lastLaunchPointIIDClicked)return;var b=CalloutManager.getFromLaunchPointIfExists(a);if(b===null){var c=generateUniqueCalloutIDFromBaseID(e);b=CalloutManager.createNew({launchPoint:a,ID:c,openOptions:{event:"none",showCloseButton:true,closeCalloutOnBlur:true},onOpeningCallback:function(a){Callout_OnOpeningCallback(a,d)},onOpenedCallback:function(){a.focus()},beakOrientation:"leftRight",onClosedCallback:ecbManager.DismissECB,contentWidth:parseInt(typeof Strings!="undefined"?Strings.STS.L_DocLibCalloutSize:""),boundingBox:document.getElementById("s4-workspace")})}b.toggle()}var h=GetCtxRgiidFromIid(e),i=h.ctx;if(i.ListSchema.IsDocLib)EnsureScriptFunc("filePreview.js","filePreviewManager",g);else g();return false});return}function findIIDInAncestorNode(a){while(a!==null&&a.tagName!=="TABLE"){var b=a.getAttribute("iid");if(b!==null&&b!=="")return b;else a=a.parentNode}return null}var usedCalloutIDs,generateUniqueCalloutIDFromBaseID,Callout_OnOpeningCallback,GenerateCtx;function getItemIdxByID(b,c){for(var a=0;a<b.length;a++)if(b[a].ID==c)return a;return-1}function CalloutRenderFooterArea(a){return Callout.GenerateDefaultFooter(a,null)}function GetCallOutOpenText(){return typeof Strings!="undefined"?Strings.STS.L_CalloutOpenAction:""}function CalloutOnPostRenderTemplate(a,b){Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)&&b.addAction(new CalloutAction({text:Strings.STS.L_AddToOneDrive_Text,onClickCallback:function(b,c){CalloutAction_AddToOneDrive_OnClick(b,c,a)},isVisibleCallback:function(b){return CalloutAction_AddToOneDrive_IsVisible(b,a)}}));var d=a.CurrentItem,e=GetCallOutOpenText(d,a),c=typeof Strings!="undefined"?Strings.STS.L_SPCalloutAction_EDIT:"";b.addAction(new CalloutAction({text:e,tooltip:c,onClickCallback:function(b,c){CalloutAction_Open_OnClick(b,c,a)},isVisibleCallback:function(b){return!Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||!CalloutAction_AddToOneDrive_IsVisible(b,a)}}));c=typeof Strings!="undefined"?Strings.STS.L_SPCalloutAction_SHARE:"";b.addAction(new CalloutAction({text:typeof Strings!="undefined"?Strings.STS.L_CalloutShareAction:"",tooltip:c,onClickCallback:function(b,c){CalloutAction_Share_OnClick(b,c,a)},isVisibleCallback:function(b){return CalloutAction_Share_IsVisible(b,a)}}))}function GetCalloutElementIDFromCallout(a){return"co"+a.getID()+"_callout"}function GetCalloutElementIDFromRenderCtx(a){return"co"+GetCalloutFromRenderCtx(a).getID()+"_callout"}function GetCalloutFromRenderCtx(a){return a.CurrentCallout}function GetCalloutLinkBoxElementID(b){var a=GetCalloutElementIDFromRenderCtx(b);return a+"SourceUrl"}function CalloutRenderLastModifiedInfo(b){var c=[],a=b.CurrentItem,g=GetCalloutElementIDFromRenderCtx(b),e=g+"Modified";c.push("<span id=",Encoding.AttrQuote(e),">");var d=function(i,d,g,h,f){var a="",j=false;if(i==b.CurrentUserId)j=true;else if(m$.isUndefinedOrNull(h)||m$.isUndefinedOrNull(g))a=Encoding.HtmlEncode(d);else{var e,m=_spPageContextInfo.webServerRelativeUrl;e=GetUrlFromWebUrlAndWebRelativeUrl(m,"_layouts/15/userdisp.aspx");var l={ID:"0",Editor:[{id:i,title:d,email:g,sip:h}]},k={Field:[{Name:"Editor",FieldType:"User",DefaultRender:"1",HasUserLink:"1",Type:"User"}],EffectivePresenceEnabled:"1",PresenceAlt:"No presence information",UserDispUrl:e},c=new ListModule.Context;c.Templates={};c.Templates.Fields={};a=spMgr.RenderFieldByName(c,"Editor",l,k)}return j?StBuildParam(typeof Strings!="undefined"?Strings.STS.L_CalloutLastEditedNameAndDate2:"",f):StringUtil.BuildParam(typeof Strings!="undefined"?Strings.STS.L_CalloutLastEditedNameAndDate:"",a,f)};if(m$.isDefinedAndNotNull(a.Editor)&&m$.isDefinedAndNotNull(a.Editor[0])&&m$.isDefinedAndNotNull(a.Modified))c.push(d(a.Editor[0].id,a.Editor[0].title,a.Editor[0].email,a.Editor[0].sip,a.Modified));else SPClientRenderer.AddPostRenderCallback(b,function(){var c=SP.ClientContext.get_current(),i=c.get_web().get_lists().getById(b.listName),g=i.getItemById(a.ID),h=function(){var a=g.get_fieldValues();if(m$.isDefinedAndNotNull(a.Editor)&&m$.isDefinedAndNotNull(a.Modified)){var b=SP.Utilities.Utility.formatDateTime(c,c.get_web(),a.Modified,SP.Utilities.DateTimeFormat.dateTime),h=function(){var c=document.getElementById(e);c.innerHTML=d(a.Editor.get_lookupId(),a.Editor.get_lookupValue(),null,null,b.get_value())};c.executeQueryAsync(h,f)}},f=function(){};c.load(g);c.executeQueryAsync(h,f)});c.push("&nbsp;</span>");var f=c.join("");return Callout.GenerateDefaultSection(null,f)}function CalloutRenderFilePreview(b){var f=b.CurrentItem,a=GetCalloutFromRenderCtx(b);if(m$.isUndefined(a.listItemPreviewer)){a.listItemPreviewer=filePreviewManager.createPreviewFromListItem(b,f);SPClientRenderer.AddPostRenderCallback(b,function(){a.listItemPreviewer.onPostRender();a.isOpen()&&a.listItemPreviewer.onVisible();a.addEventCallback("opened",function(){a.listItemPreviewer.onVisible()});a.addEventCallback("closing",function(){a.listItemPreviewer.onHidden()})})}if(m$.isDefinedAndNotNull(a.listItemPreviewer)){var d=a.getContentWidth(),c=a.listItemPreviewer.getWidth()+60;c!==null&&c>d&&a.set({contentWidth:c})}var e=a.listItemPreviewer.getHtml();return Callout.GenerateDefaultSection(null,e)}function GetCalloutSharingStatusDivId(a){return GetCalloutElementIDFromRenderCtx(a)+"SharedWithInfo"}function CalloutRenderSharingStatus(a){!Boolean(a.RealHttpRoot)&&SPClientRenderer.AddPostRenderCallback(a,CalloutPostRenderSharingStatus);return CalloutRenderSharingStatusDiv(a)}function CalloutRenderSharingStatusDiv(c){var b=GetCalloutSharingStatusDivId(c),a='<div class="js-callout-sharedWithInfo" id='+Encoding.AttrQuote(b)+"></div>";return a}function GetSharedWithUserInfo(d){var b=[],c=d.getEnumerator();while(c.moveNext()){var a=c.get_current(),e={id:a.get_id(),title:a.get_name(),email:a.get_email(),sip:a.get_sipAddress(),picture:a.get_picture(),isDomainGroup:a.get_isDomainGroup()};b.push(e)}return b}function CalloutPostRenderSharingStatus(d,j,i,h){var a=d.CurrentItem,b=Boolean(j);if(b||permMaskContains(a.PermMask,0,131072)){var r=GetCalloutFromRenderCtx(d),e=getViewCtxFromCalloutCtx(d),q=b?j:GetCalloutSharingStatusDivId(d),g=null,p=function(c,k){var j=c.get_isSharedWithMany(),h=c.get_isSharedWithSecurityGroup(),i=c.get_isSharedWithGuest()&&(ListModule.Util.isDefinedAndNotNullOrEmpty(c.get_anonymousEditLink())||ListModule.Util.isDefinedAndNotNullOrEmpty(c.get_anonymousViewLink())),f=null;if(ListModule.Util.isDefinedAndNotNullOrEmpty(a.FileLeafRef))f=a.FileLeafRef;else if(ListModule.Util.isDefinedAndNotNullOrEmpty(a.Title))f=a.Title;g=GetSharedWithUserInfo(k);EnsureScriptFunc("sharing.js","GetSharingStatusHtml",function(){if(!b){var y=GetCalloutLinkBoxElementID(d),n=document.getElementById(y);if(Boolean(n)){var w=c.get_sharingLinks();if(Boolean(w)&&w.length>0){var p=GetBestCsomSharingLink(w);if(p!=null){n.value=p.get_url();var l=n.parentNode,v=GetSharingLabelFromType(p.get_linkKind());if(Boolean(v))n.title=v;var x="js-sharingLinks-linkBoxLabel",k=document.getElementById(x);if(!Boolean(k)){k=document.createElement("div");k.id=x;CSSUtil.AddClass(k,"js-callout-sharingLink-label");l.parentNode.insertBefore(k,l);k.style.width=String(k.parentNode.offsetWidth)+"px"}k.innerHTML="<a href='javascript:;' class='js-sharingLinks-linkBoxLabelLink' title='"+Encoding.HtmlEncode(Strings.STS.L_SharedWithGuestTooltip)+"'>"+Encoding.HtmlEncode(v)+"</a>";if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40)){for(var o=null,s=0,z=l.parentNode.childNodes.length;s<z;s++)if(l.parentNode.childNodes[s].tagName.toUpperCase()=="A")o=l.parentNode.childNodes[s];if(Boolean(o)){var u=document.createElement("div");u.innerHTML=GenStyledQrImgLink(p.get_url());window.setTimeout(function(){for(var a=0,b=u.childNodes.length;a<b;a++)l.parentNode.insertBefore(u.childNodes[a],o);l.parentNode.removeChild(o)},0)}}}}}}var m=document.getElementById(q),t=GetSharingStatusHtml(g,j,h,i,false,e.ListSchema.UserDispUrl,f,e,b?null:r,b,a.ID);if(t.length>0){m.innerHTML=b?t:Callout.GenerateDefaultSection(null,t);m.calloutRenderCtx=d;m.objectSharingInformation=c}window.setTimeout(function(){ApplySharingListStyles(m,b);m$(m).find(".js-callout-sharedWithLink").click(function(){if(b)SP.QoS.WriteUserEngagement("OneDrive_FacePile_SharedWithStatusClicked");else WriteDocEngagementLog("TeamSite_Callout_SharedWithStatusClicked","OneDrive_Callout_SharedWithStatusClicked");var c=GetCalloutFromRenderCtx(d);m$.isDefinedAndNotNull(c)&&c.close();typeof DisplaySharedWithDialogCore=="function"&&DisplaySharedWithDialogCore(e.HttpRoot,e.listName,a.ID,a,false,a.FSObjType,a.HTML_x0020_File_x0020_Type);return false})},0)})},c=SP.ClientContext.get_current(),f=SP.ObjectSharingInformation.getListItemSharingInformation(c,e.listName,a.ID,true,false,b?false:true,true,b?true:false,false),k=f.getSharedWithUsers(c);c.load(f,"IsSharedWithMany","IsSharedWithSecurityGroup","IsSharedWithGuest","CanManagePermissions","AnonymousEditLink","AnonymousViewLink");c.load(f,"SharingLinks");if(b){var m=c.get_web().get_lists().getById(e.listName),l=m.getItemById(a.ID);c.load(m);c.load(l,"ID","SharedWithUsers")}c.load(k);var n=function(){p(f,k);Boolean(i)&&typeof i=="function"&&i(d,g,b?l.get_fieldValues().SharedWithUsers:null)},o=function(a,b){Boolean(h)&&typeof h=="function"&&h(a,b)};c.executeQueryAsync(n,o)}}function CalloutRenderSourceUrl(b){var a=[],g=GetCalloutLinkBoxElementID(b),c=GetItemUrlForLinking(b);if(IsMountPoint(b.CurrentItem))c=GetMountPointRedirectUrl(b);var e=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(40);a.push('<input id="');a.push(g);a.push('" value="');a.push(Encoding.HtmlEncode(c.getString()));a.push('" class="js-callout-location" ');a.push('onclick="javascript: this.select();" ');a.push('onblur="javascript: this.value = this.defaultValue;" ');a.push("oncopy=\"javascript: WriteDocEngagementLog('CalloutCopyUrl', 'OneDriveCalloutCopyUrl', { Source : 'ListView' })\" ");a.push("aria-label="+StAttrQuote(Strings.STS.L_SPCalloutEdit_URL));a.push("/>");var d=a.join("");if(e){var f=GenLinkBoxWithQrCode(c.getString(),d);return Callout.GenerateDefaultSection(null,f)}else return Callout.GenerateDefaultSection(null,d)}function CalloutAction_Open_OnClick(g,h,a){var e=g,c=e.target,f=a.ListSchema,b=a.CurrentItem;if(m$.isUndefinedOrNull(b)||m$.isUndefinedOrNull(b.ID))throw"Error: listItem is missing properties";if(f.IsDocLib=="1"||b.FSObjType=="1")if(IsFileExtensionControlsSupported()&&!IsFileHandlerForAllNonOfficeFilesSupported())if(typeof SuiteExtensions=="object"&&typeof SuiteExtensions.ControlFactory=="function"&&typeof SuiteExtensions.ControlType=="function"){var d=SuiteExtensions.ControlFactory.CreateControl(a.CurrentItem.File_x0020_Type,SuiteExtensions.ControlType.Edit);if(d!=null){d.httpRoot=a.HttpRoot;d.itemUrl=a.CurrentItem.FileRef;d.updateElement(c)}else CalloutAction_UpdateHref(c,b,a)}else CalloutAction_UpdateHref(c,b,a);else CalloutAction_UpdateHref(c,b,a);else c.setAttribute("href",ListModule.Util.createItemPropertiesTitleUrl(a,b));smartOpenFileOrFolderFromHrefCore(e.originalEvent,c,b,f,a);c.removeAttribute("isEdit");c.removeAttribute("App")}function CalloutAction_UpdateHref(a,c,d){var b=c.FileRef;b=Encoding.EncodePath(b,true);a.setAttribute("href",getHostUrl(d.HttpRoot)+b);a.setAttribute("isEdit","1");a.setAttribute("App",c["File_x0020_Type.mapapp"])}function CalloutAction_Share_OnClick(c,d,a){SP!=null&&SP.QoS!=null&&SP.QoS.WriteUserEngagement("Callout_ShareClicked");var b=GetCalloutFromRenderCtx(a);m$.isDefinedAndNotNull(b)&&b.close();DisplaySharingDialogForListItem(a)}function RenderNewFolderUrl(b){var a=[];a.push("CalloutManager.closeAll();");var c=Flighting.VariantConfiguration.IsExpFeatureClientEnabled(76);WriteEngagementLog("CreateSharedFolderDialog_Flight"+(c?"On":"Off"));if((c||window.enableCreateSharedFolderDialog)&&_spPageContextInfo.webUIVersion>=15&&Boolean(b.ListSchema.IsDocLib)&&Boolean(b.isXslView)&&!IsInIframe()){a.push("EnsureScriptParams('createsharedfolderdialog.js', 'DisplayCreateSharedFolderDialog', ");a.push("'WebPart"+b.wpq+"', 'Callout');")}else{a.push("NewItem2(event, &quot;");a.push(b.HttpRoot);a.push("/_layouts/15/listform.aspx?ListId=");a.push(unescapeProperly(b.listName));a.push("&PageType=8");a.push("&RootFolder=");if(Boolean(b.rootFolder)&&b.rootFolder!="")a.push(URI_Encoding.encodeURIComponent(unescapeProperly(b.rootFolder)));else a.push(URI_Encoding.encodeURIComponent(unescapeProperly(b.listUrlDir)));a.push("&Type=1&quot;);")}a.push("return false;");return a.join("")}function GenLinkBoxWithQrCode(e,b){var a=[],d=fRightToLeft?"right":"left",c=fRightToLeft?"left":"right";a.push('<div style="position:relative">');a.push("<div style='position:absolute; display:inline-block; "+d+":0px; "+c+":20px'>");a.push(b);a.push("</div>");a.push(GenStyledQrImgLink(e));a.push("<div style='height:16px;visibility:hidden' ></div>");a.push("</div>");return a.join("")}function GenStyledQrImgLink(c){var b=fRightToLeft?"left":"right",a="position:absolute; "+b+":0px;";return GenQrImgLink(c,a)}function GenQrImgLink(d,b){var a=[],c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAKpJREFUeNpi/P//PwMlgJEmBkyZNhMkeACLeoecrHRGFBGQAeh48tQZ/4kVZ0I2rLKyyoBULzCh8Q9ADVlArAEsaHx+kCFPHz90INcFcEOALhEgxwUwUCAtK58OjI0OaGw44IgVrC5IBGq2B0ZXJ4gDpB2RaUIGJLa3t4ECMAFo+35omkChMQC++MZFI2NCKdEBnUZPiUy4Qhfd77jCAJ8LcBnMSNXcCBBgAGhupLfk9EO6AAAAAElFTkSuQmCC";a.push("<a href='javascript:void(0)' onclick='LaunchQrCodePage(\""+STSScriptEncode(d)+"\")' ");a.push("style='display:inline-block;padding:2px;");a.push(b);a.push("' ");a.push("title="+StAttrQuote(Strings.STS.L_QRCodeOpenLink)+" >");a.push("<img alt="+StAttrQuote(Strings.STS.L_QRCodeOpenLink)+" style='border:none;' src='"+c+"' />");a.push("</a>");return a.join("")}function LaunchQrCodePage(c){var a=encodeURIComponent(c),b="/_layouts/15/qr.aspx#qrCodeData="+a;window.open(b,"_blank");try{SP!=null&&SP.QoS!=null&&SP.QoS.WriteUserEngagement("QrClicked")}catch(d){}}function CalloutRenderSection(a,b){Callout.GenerateDefaultSection(a,b)}function GetItemUrlForLinking(b){var a=b.CurrentItem,h=b.ListSchema.IsDocLib==="1",d=null;if(h){var g;g=Encoding.EncodePath(a.FileRef,true);d=new URI(b.HttpRoot);d.setPath(g)}else d=new URI(ListModule.Util.createItemPropertiesTitleUrl(b,a));var f=d.getString(),c=a["serverurl.progid"];if(Boolean(c)&&c.indexOf("?")!=-1){var e=a.UniqueId.toLowerCase();e=e.replace(/[\{\}-]/g,"");c="1"+f+"?d=w"+e}return new URI(GetRedirectedHref(f,b.ListSchema.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,c,a.FSObjType=="1",true,null))}function getItemIDFromIID(b){var a=b.split(",");return a[1]}function permMaskContains(a,d,e){var b=GetPermMaskH(a),c=GetPermMaskL(a);return CheckIfHasRights(d,e,b,c)}function getCtxFromCtxNum(a){return window["ctx"+a]}function getViewCtxFromCalloutCtx(a){return getCtxFromCtxNum(a.ctxId)}function smartOpenFileOrFolderFromHref(a,d,c,b){smartOpenFileOrFolderFromHrefCore(a,d,c,b,null)}function smartOpenFileOrFolderFromHrefCore(c,d,a,b,e){if(a.FSObjType==="1"){_WriteDocEngagement("Documents_OpenFolderCalloutClick","OneDrive_OpenFolderCalloutClick");var f=fMaintainUserChrome()?"&MaintainUserChrome=true":"";VerifyFolderHref(d,c,a["File_x0020_Type.url"],["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"]);HandleFolder(d,c,b.PagePath+"?RootFolder="+URI_Encoding.encodeURIComponent(a.FileRef)+b.ShowWebPart+"&FolderCTID="+a.ContentTypeId+"&View="+URI_Encoding.encodeURIComponent(b.View)+f,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",b.Userid,b.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}else{_WriteDocEngagement("Documents_OpenDocumentCalloutClick","OneDrive_OpenDocumentCalloutClick");VerifyHref(d,c,b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a["serverurl.progid"]);IsFileHandlerForAllNonOfficeFilesSupported()&&e&&ShouldCallSuiteExtensionControlFactory(e)&&CallSuiteExtensionControlFactory(d,c,a.File_x0020_Type,e.HttpRoot,a.FileRef);DispEx(d,c,"TRUE","FALSE",a["File_x0020_Type.url"],a["File_x0020_Type.progid"],b.DefaultItemOpen,a["HTML_x0020_File_x0020_Type.File_x0020_Type.mapcon"],a.HTML_x0020_File_x0020_Type,a["serverurl.progid"],Boolean(a.CheckoutUser)?a.CheckoutUser[0].id:"",b.Userid,b.ForceCheckout,a.IsCheckedoutToLocal,a.PermMask)}}function CalloutAction_Share_IsVisible(b,a){return ShouldEnableShareButtons(a)}function ShouldEnableShareButtons(a){return!Boolean(_spPageContextInfo.userId)?false:a.CurrentSelectedItems==1}function safeTruncateString(b,a){if(a<0)throw"Error: Negative number of characters is invalid parameter";var c=b.charCodeAt(a-1);if((c&64512)===55296)a=a-1;return b.substr(0,a)}function safeTruncateStringFromStart(b,a){if(a<0)throw"Error: Negative number of characters is invalid parameter";var c=b.charCodeAt(b.length-a);if((c&64512)===55296)a=a-1;return b.substr(b.length-a,b.length-1)}function calloutCreateAjaxMenu(b){IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPCreateAjaxMenuForCalloutStart);var a=GetParentLinkFromEvent(b);if(a===null)return;itemTable=a.parentNode;currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");setupMenuContextName(itemTable.getAttribute("CTXName"));_WriteDocEngagement("CalloutSubMenuClick","OneDrive_CalloutSubMenuClick");CreateAjaxMenu(b);IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfSPCreateAjaxMenuForCalloutEnd)}function TryLaunchExcelForm(a){EnsureScriptFunc("SP.js","SP.ClientContext",function(){var b=SP.ClientContext.get_current(),c=b.get_site();b.load(c);b.executeQueryAsync(function(){CalloutManager.closeAll();if(c.get_shareByLinkEnabled())OpenPopUpPageWithTitle(a+"&TemplateType="+String(DocumentType.ExcelForm),OnCloseDialogNavigate,null,null,null);else DisplayErrorDialog(typeof Strings!="undefined"?Strings.STS.L_CreateExcelSurveyErrorTitle:"",typeof Strings!="undefined"?Strings.STS.L_CreateExcelSurveyError:"")},function(){})})}function DisplayErrorDialog(d,e){var c="<div>"+e+"</div><div class='ms-core-form-bottomButtonBox'><button id='js-dnd-OKBtnDismissDlg' onclick='DismissErrDlg(this)'>"+(typeof Strings!="undefined"?Strings.STS.L_CloseButtonCaption:"")+"</button></div>",b=document.createElement("DIV");b.innerHTML=c;var f={html:b,title:d},g=new SP.UI.ModalDialog.showModalDialog(f),a=document.getElementById("js-dnd-OKBtnDismissDlg");Boolean(a)&&a.focus()}function CalloutPostRenderPolicyTip(a,d){if(!Flighting.VariantConfiguration.IsExpFeatureClientEnabled(340))return;if(d===undefined){if(a.CurrentItem._ip_UnifiedCompliancePolicyUIAction===undefined||Number(a.CurrentItem._ip_UnifiedCompliancePolicyUIAction)!=1&&Number(a.CurrentItem._ip_UnifiedCompliancePolicyUIAction)!=1+2)return;var f=Number(a.CurrentItem._ip_UnifiedCompliancePolicyUIAction)==1,l=f?Strings.STS.L_DLP_Callout_PolicyTip:Strings.STS.L_DLP_Callout_BlockedItem,g=GetCalloutElementIDFromRenderCtx(a)+"viewPolicyTip",j=[STSHtmlEncode(l),' <a id="',g,'" href="#">',STSHtmlEncode(Strings.STS.L_DLP_Callout_PolicyDialogLink),"</a>"].join(""),k=_createStatusMarkup("",j,false),b=document.getElementById(GetCalloutPolicyTipNotificationElementId(a)),m=f?StatusBarClassNames[StatusPriority.yellow]:StatusBarClassNames[StatusPriority.red];b.className="js-callout-bodySection ms-status-msg "+m;b.style.display="block";b.appendChild(k);var h=document.getElementById(g);h!=null&&DOM.AddEventHandler(h,"onclick",function(){var b=GetCalloutFromRenderCtx(a);b!==undefined&&b!=null&&b.close();LaunchDlpDialog(a.CurrentItem,a,"Callout");return false},false)}else{var c=null,i="E-mail";for(var n in a.ListData.Row){var e=a.ListData.Row[n];if(Boolean(e)&&e.ID==d){c=e;break}}if(c!=null)LaunchDlpDialog(c,a,i);else LaunchDlpDialog(d,a,i)}}function LaunchDlpDialog(c,a,d){function b(){return[a.HttpRoot,"/_api/web/lists(guid'",a.listName.replace(/[{}]/g,""),"')"].join("")}SP.QoS.WriteUserEngagement("DlpPolicyTipDialogLaunch",{Source:d});EnsureScriptFunc("dlp.js","DLP.InitializePolicyTipDialog",function(){DLP.InitializePolicyTipDialog(c,a.ListSchema,b())})}function _handleQCBManageButtonPress(g,b){WriteStart("DocLibQCB_HandleQCBManageBtn");if(typeof GetListContextFromContextNumber=="undefined"){WriteFailure("DocLibQCB_ExecMngBtnNoCoreJs");WriteDebugLog("DocLibQCB_ExecMngBtnNoCoreJs",false,"Could not find list context since Core.js is not loaded yet");return}var a=GetListContextFromContextNumber(b.ctxId);if(!Boolean(a)){WriteFailure("DocLibQCB_ExecMngBtnNoListCtx");WriteDebugLog("DocLibQCB_ExecMngBtnNoListCtx",true,"Could not find list context for "+b.wpq+". Expected with ctxId "+b.ctxId);return}var f,d=GetUnderElementPos(g.target),e="";if(a.CurrentSelectedItems===1){WriteDebugLog("DocumentLibraryQCB_ManageButtonOneItem",false,"Manage button pressed on QCB with 1 item selected. Invoking ECB.");for(f in a.dictSel){var i=GetTrFromIID(f);ShowECBMenuForTr(i,g,undefined,d.x,d.y);break}e="Manage button pressed on QCB with 1 item selected. Invoked ECB."}else{WriteDebugLog("DocumentLibraryQCB_ManageButtonMultiItem",false,"Manage button pressed on QCB with >1 item selected. Invoking multi-item context menu.");var c={evt:{clientX:d.x,clientY:d.y},items:[]};IsECBCommandEnabled("Delete",b)&&c.items.push({id:"ID_DeleteDocItem",text:Strings.STS.L_Delete_Text,onclick:function(){inplview.DeleteSelectedItems(a)}});IsECBCommandEnabled("CheckOut",b)&&c.items.push({id:"ID_Checkout",text:Strings.STS.L_Checkout_Text,onclick:function(){inplview.CheckoutSelectedItems(a)}});IsECBCommandEnabled("CheckIn",b)&&c.items.push({id:"ID_Checkin",text:Strings.STS.L_Checkin_Text,onclick:function(){inplview.CheckinSelectedItems(a)}});IsECBCommandEnabled("DiscardCheckOut",b)&&c.items.push({id:"ID_DiscardCheckou",text:Strings.STS.L_DiscardCheckou_Text,onclick:function(){inplview.DiscardCheckoutSelectedItems(a)}});IsECBCommandEnabled("MoveCopy",b)&&c.items.push({id:"ID_MoveCopy",text:Strings.STS.L_MoveCopy_MenuItemTitle,onclick:function(){_WriteDocEngagement("TeamSiteMoveCopyMultipleQCB","OneDriveMoveCopyMultipleQCB");SP.SOD.execute("movecopy.js","LaunchMoveCopyDialog",a)}});var h=new ContextMenu(c);h.open();e="Manage button pressed on QCB with >1 item selected. Invoked multi-item context menu."}SP.QoS.WriteSuccess("DocLibQCB_QCBMngBtnSuccess");WriteDebugLog("DocLibQCB_QCBMngBtnSuccess",false,e)}function GetUnderElementPos(a){if(!Boolean(a))return new Point(0,0);var e=AbsTop(a),d=AbsLeft(a),b=document.body,c=document.getElementById("s4-workspace");if(Boolean(c))b=c;return new Point(d-b.scrollLeft,e+a.offsetHeight-b.scrollTop)}function _handleQCBSyncButtonPress(e,b,d){var a=b.rootFolder;if(!Boolean(a))a="";else{a=a.trim();a=URI.decodeURIComponent(a);if(Boolean(b.listUrlDir)){var c=b.listUrlDir.trim();c=URI.decodeURIComponent(c);if(a.indexOf(c)==0)a=a.substr(c.length)}}EnsureScriptFunc("offline.js",Boolean(g_syncButtonUsePopup)||d?"TakeOfflineToClientWithPopup":"TakeOfflineToClientReal",function(){var c=Boolean(g_syncButtonUsePopup)||d||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(259)&&b.ListTemplateType!=700?TakeOfflineToClientWithPopup:TakeOfflineToClientReal;c(a!==""?3:2,b.SiteTemplateId,b.HttpRoot,b.listBaseType,b.ListTemplateType,b.listName,a,d,e==null?null:e.target,b)})}function _handleQCBAddToOneDriveButtonPress(d,b){var a=b.rootFolder;if(!Boolean(a))a="";else{a=a.trim();a=a.replace(/%2F/gi,"/")}EnsureScriptParams("MountPoint.js","CreateMountPointForList",b.listName,b.ListTemplateType,a)}function AjaxNavUpdate(a){Nav.ajaxNavigate.update(null,a)}function ExpandGroup(){g_ExpGroupInProgress=false;g_ExpInitializing=false;g_ExpGroupXSLTQueue.length>0&&ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),"true")}function _ExpGroup(h,c){var b=document.getElementById("tbod"+c+"_");if(b!=null)var d=DOM_afterglass.GetAncestor(b,"TABLE");if(b==null||b.tagName!="TBODY"||d==null||typeof d.clvp=="undefined"||d.clvp==null||b.getAttribute("isLoaded")==null)return;var g=c.substring(0,c.indexOf("-")),e=document.getElementById("GroupByCol"+g),a="?";if(e!=null){a=e.getAttribute("queryString");if(a.substring(a.length-1)=="&")a=a.substr(0,a.length-1)}a=ListModule.Util.removeOnlyPagingArgs(a);a+="&GroupString=";a+=ExpGroupFetchGroupString(c);a+="&IsGroupRender=TRUE";var f=d.clvp;f.tBody=b;f.RefreshPaging(a,null)}function _CLVPDeleteItemCore(a,e,g){var i=a.ctx.listBaseType==1;a.EnsureChangeContext();var b=null;if(typeof a.rgehs=="undefined")a.rgehs=[];var d,f;d=new SP.ExceptionHandlingScope(a.cctx);a.rgehs.push(d);f=d.startScope();a.cctx.get_pendingRequest().set_navigateWhenServerRedirect(true);var c=null;if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.ctx.RealHttpRoot))c=g.getListById(a.ctx.listName);else c=a.cctx.get_web().get_lists().getById(a.ctx.listName);if(a.ctx.ExternalDataList)b=c.getItemById(String(e));else b=c.getItemById(parseInt(e));if(i){b.retrieve("FileLeafRef");d.itmContext=b}var h=Boolean(a.ctx.RecycleBinEnabled)&&!a.ctx.ExternalDataList;if(h)b.recycle();else b.deleteObject();a.changePending=true;f.dispose()}function _DeleteSelectedItems(a){a=FixupCtx(a);var c=GetSelectedItemsDict(a),b=[];for(var e in c){var d=c[e];b.push(d.id)}b.length>0&&_DeleteSelectedItemsCore(a,b,RefreshOnDialogClose)}function ContainsRecurrenceItem(c){for(var d in c){var a=c[d];if(Boolean(a)&&typeof a.id!="undefined"&&Boolean(a.id)){var b=a.id;if(b.indexOf(".0.")!=-1||b.indexOf(".1.")!=-1||b.indexOf(".2.")!=-1)return true}}return false}function ContainsMountPoint(g,b){if(Boolean(ctx)&&Boolean(b)&&b.length>0&&Boolean(g)&&Boolean(g.ListData)){var c={},d=g.ListData.Row;if(Boolean(d)){for(var h=0;h<d.length;h++){var e=d[h];if(IsMountPoint(e))c[e.ID]=e["FileLeafRef.Name"]}var a=null;for(var i in b){var f=b[i];if(Boolean(c[f])){if(a==null)a={};a[f]=c[f]}}return a}}return null}function _CLVPCheckoutItem(a,e,g,d){a.EnsureChangeContext();if(typeof a.rgehs=="undefined")a.rgehs=[];var c,f,b=null;if(g!="0")return;c=new SP.ExceptionHandlingScope(a.cctx);a.rgehs.push(c);f=c.startScope();if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(d))b=d.getListById(a.ctx.listName).getItemById(Number(e));else b=a.cctx.get_web().get_lists().getById(a.ctx.listName).getItemById(Number(e));b.retrieve("FileLeafRef");c.itmContext=b;var h=b.get_file();h.checkOut();f.dispose();a.changePending=true}function _CLVPDiscardCheckoutItem(a,e,g,h){a.EnsureChangeContext();if(typeof a.rgehs=="undefined")a.rgehs=[];var b=null,c,i;if(g!="0"&&isDefinedAndNotNullOrEmpty(g))return;c=new SP.ExceptionHandlingScope(a.cctx);a.rgehs.push(c);i=c.startScope();if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(h))b=h.getListById(a.ctx.listName).getItemById(Number(e));else b=a.cctx.get_web().get_lists().getById(a.ctx.listName).getItemById(Number(e));b.retrieve("FileLeafRef");c.itmContext=b;var j=b.get_file(),f=a.GetEcbInfo(e);if(f!=null&&f.getAttribute("COut")=="1")try{var k=a.ctx.HttpRoot+f.getAttribute("Url"),d=StsOpenEnsureEx("SharePoint.OpenDocuments.3");d!=null&&typeof d.DiscardLocalCheckout=="function"&&d.DiscardLocalCheckout(k)}catch(l){}else j.undoCheckOut();a.changePending=true;i.dispose()}function _CLVPCheckinItem(a,f,l,b,h){a.EnsureChangeContext();if(typeof a.rgehs=="undefined")a.rgehs=[];var c=null,e,j;if(l!="0")return;e=new SP.ExceptionHandlingScope(a.cctx);a.rgehs.push(e);j=e.startScope();if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(h))c=h.getListById(a.ctx.listName).getItemById(Number(f));else c=a.cctx.get_web().get_lists().getById(a.ctx.listName).getItemById(Number(f));c.retrieve("FileLeafRef");e.itmContext=c;var i=c.get_file(),g=a.GetEcbInfo(f);if(g!=null&&g.getAttribute("COut")=="1")try{var k=a.ctx.HttpRoot+g.getAttribute("Url"),d=StsOpenEnsureEx("SharePoint.OpenDocuments.3");if(d!=null&&typeof d.CheckinDocument=="function")if(b.kco!=null)d.CheckinDocument(k,b.cit,b.cmt,true);else d.CheckinDocument(k,b.cit,b.cmt)}catch(m){}else{i.checkIn(b.cmt,b.cit);b.kco&&i.checkOut();a.changePending=true}j.dispose()}function _CheckOutSingleItem(b,c){b=FixupCtx(b);var f=GetAttributeFromItemTable(c,"Url","ServerUrl"),d=GetAttributeFromItemTable(c,"Icon","DocIcon").split("|"),a=null;if(d.length>=3)a=d[2];if(a=="SharePoint.OpenDocuments")a="SharePoint.OpenDocuments.3";var g=addNotification(typeof Strings!="undefined"?Strings.STS.L_Notification_CheckOut:"",true,null,null,true),e=CheckoutDocument(b.HttpRoot,f,a);!e&&removeNotification(g,true)}function FixupCtx(a){if(Boolean(a)&&typeof a.clvp=="undefined"&&typeof a.ctxId!="undefined"){var b=window["ctx"+a.ctxId];if(b)return b}return a}function _CheckInSingleItemFromECB(c,a,d){a=FixupCtx(a);var b=a.clvp;GetFocusInfo(c,b);if((Flighting.VariantConfiguration.IsExpFeatureClientEnabled(134)||Flighting.VariantConfiguration.IsExpFeatureClientEnabled(160))&&Boolean(a.RealHttpRoot))_CheckinSelectedItems(a);else _CheckInSingleItem(a,d)}function _CheckInSingleItem(b,e,c){var a=GetAttributeFromItemTable(e,"Url","ServerUrl");if(a!=null){var f=GetCurrentCtx();if(ShouldCallEncodeURIComponent()&&!c)a=encodeURIComponent(a);else a=URI_Encoding.encodeURIComponent(URI.decodeURIComponent(a))}var d=b.HttpRoot+"/_layouts/15/checkin.aspx?List="+b.listName+"&FileName="+a;OpenPopUpPage(d,CheckInNotifyAndRefreshPage)}function CheckInNotifyAndRefreshPage(a){if(a==SP.UI.DialogResult.OK){var b=typeof Strings!="undefined"?Strings.STS.L_Notification_CheckIn:"";addNotification(b,true)}RefreshPage(a)}var _CheckoutSelectedItems,_DiscardCheckoutSelectedItems,_CheckinSelectedItems,_CountDictionary,_DeleteSelectedItemsCore;function _AttachFile(a){var g=a.clvp,b=GetSelectedItemsDict(a),f=_CountDictionary(b),c,e;if(f==1)for(e in b){c=b[e];if(c.fsObjType=="0"){var d=a.HttpRoot+"/_layouts/15/AttachFile.aspx?ListId="+a.listName+"&ItemId="+c.id+"&Source="+Nav.getSource();if(FV4UI())OpenPopUpPage(d,RefreshPage);else GoToPage(d)}}}function _ManageCopies(c){var e=c.clvp,a=GetSelectedItemsDict(c),f=_CountDictionary(a),b,d;if(f==1)for(d in a){b=a[d];e.ManageCopies(b.id,b.fsObjType)}}function _CLVPModerateItem(a,f,d){a.EnsureChangeContext();if(typeof a.rgehs=="undefined")a.rgehs=[];var c,e,b=null;c=new SP.ExceptionHandlingScope(a.cctx);a.rgehs.push(c);e=c.startScope();b=a.cctx.get_web().get_lists().getById(a.ctx.listName).getItemById(Number(f));c.itmContext=b;b.set_item("_ModerationStatus",d.ModerationStatus);b.set_item("_ModerationComments",d.Comment);b.update();a.cctx.load(b);e.dispose();a.changePending=true}function _ModerateSelectedItems(j){var a=j.clvp,b=[],c=GetSelectedItemsDict(j),n=_CountDictionary(c),d,e,g=a.ctx.HttpRoot;b.push(g);g[g.length-1]!="/"&&b.push("/");b.push("_layouts/15/approve.aspx?List=");b.push(a.ctx.listName);var f=false;if(n==1)for(e in c){d=c[e];b.push("&ID="+d.id);break}else{b.push("&IsBulk=1");f=true;if(!(window.OffSwitch==null||OffSwitch.IsActive("C3DD9714-B881-4BCB-8E4E-F4755A038F2F"))){var i=a.ctx.rootFolder;if(Boolean(i)){b.push("&RootFolder=");b.push(i)}}}var k=function(b){var f,e=0;for(f in c){var g=c[f];ULS.AssertJS(ULSCat.msoulscat_WSS_Inplview,b!=null&&b!="","Null or empty parameter to deserialize");try{a.ModerateItem(g.id,SP_JSONParse(b));e++}catch(i){ULS.SendExceptionJS(ULSCat.msoulscat_WSS_Inplview,i)}}if(e>0){var h=typeof Strings!="undefined"?Strings.STS.L_Notification_Moderate:"",d=addNotification(h,true);a.cctx.executeQueryAsync(function(){if(typeof a.rgehs!="undefined"){removeNotification(d);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){removeNotification(d);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}},m=function(b,c){if(b==SP.UI.DialogResult.OK&&f)a.EnsureEcbInfo(k,"fnModerateWithEcb",c,null);else RefreshPage(b)},h={};for(e in c){d=c[e];h[d.id]=d.id}var l={url:b.join(""),dialogReturnValueCallback:m,args:h,delayAppearance:f,autoSize:true};OpenPopUpPageWithDialogOptions(l)}var _CLVPShowErrorDialog;function _CLVPShowPopup(a){MenuHtc_hide();if(typeof this.fnOnCommitPopup!="undefined"&&this.fnOnCommitPopup!=null)OpenPopUpPage(a,this.fnOnCommitPopup);else OpenPopUpPage(a,RefreshPage)}function CLVPFromEventToolbar(e){var n=DOM.GetEventSrcElement(e),a=null,c=null,j=null,h=GetEventPopup(e);if(h!=null){if(typeof e.currentCtx!="undefined"&&e.currentCtx!=null){var l=e.currentCtx,m=window["ctx"+l.ctxId];return inplview.CLVPFromCtx(m)}if(typeof currentCtx!="undefined"&&currentCtx!=null)return inplview.CLVPFromCtx(currentCtx);if(typeof ctxFilter!="undefined"&&ctxFilter!=null)return inplview.CLVPFromCtx(ctxFilter);var d=typeof h.master!="undefined"?h.master:null;if(d==null)return null;if(d.id!=null&&d.id.indexOf("onetViewSelector_menu")>0){var o=d.id.substr(0,d.id.indexOf("onetViewSelector_menu")+16);a=DOM_afterglass.GetAncestor(document.getElementById(o),"TABLE")}else a=DOM_afterglass.GetAncestor(d,"TABLE")}else a=DOM_afterglass.GetAncestor(n,"TABLE");while(a!=null){if(a.className=="ms-menutoolbar")break;if(HasCssClass(a,"ms-listviewtable")){c=a;a=null;break}else if(a.className=="ms-bottompaging"){if(a.previousSibling==null)a=a.parentNode.previousSibling;else a=a.previousSibling;if(a==null)break;for(var g=a.getElementsByTagName("TABLE"),f=0;f<g.length;f++)if(HasCssClass(g[f],"ms-listviewtable")){a=g[f];break}continue}a=a.parentNode;if(a!=null)a=DOM_afterglass.GetAncestor(a,"TABLE")}if(a==null&&c==null)return null;if(c==null){var b=a.nextSibling;while(b!=null&&(b.nodeType!=1||b.tagName!="TABLE"))b=b.nextSibling;if(b==null)return null;var k=b.getElementsByTagName("TABLE");if(k.length==0)return null;c=k[0]}var i=inplview.CLVPFromCtx(c);if(i==null&&b!=null){j=b.getElementsByTagName("DIV");if(j.length==0)return null;c=j[0];i=inplview.CLVPFromCtx(c)}return i}function getExceptionHandlingScopeLoggingInfo(a){var b=[];if(Boolean(a)){addToInfoIfExists("ServerErrorCode",b,a,a.get_serverErrorCode);addToInfoIfExists("ServerErrorType",b,a,a.get_serverErrorTypeName);addToInfoIfExists("ErrorMessage",b,a,a.get_errorMessage);addToInfoIfExists("ServerStackTrace",b,a,a.get_serverStackTrace);addToInfoIfExists("ServerErrorDetails",b,a,a.get_serverErrorDetails);addToInfoIfExists("ServerErrorValue",b,a,a.get_serverErrorValue)}return b.join("\n")}function DismissErrDlg(){var a=typeof window.top.g_childDialog!="undefined"?window.top.g_childDialog:undefined;Boolean(a)&&a.close(0)}function CalloutAction_AddToOneDrive_OnClick(d,e,a){CalloutManager.closeAll();var c=a.ListSchema,b=a.CurrentItem;if(m$.isUndefinedOrNull(b)||m$.isUndefinedOrNull(b.ID))throw"Error: listItem is missing properties";if(c.IsDocLib=="1"&&b.FSObjType=="1")Boolean(a.CurrentItem)&&EnsureScriptParams("MountPoint.js","CreateMountPointForListItem",a.CurrentItem,a.listTemplate)}function CalloutAction_AddToOneDrive_IsVisible(c,b){if(InMountPoint(b))return false;var a=b.CurrentItem;if(a==null||a.PermMask==null)throw"Error: listItem is missing properties";return IsListItemFolder(a)}function GetMountPointRedirectUrl(c){var b=c.CurrentItem,a=new URI(c.HttpRoot+"/_layouts/15/mountpoint.aspx");a.setQueryParameter("site",b[MountPointSiteIdFieldName]);a.setQueryParameter("web",b[MountPointWebIdFieldName]);a.setQueryParameter("item",b[MountPointItemUniqueIdFieldName]);return a}function ShareMountPoint(b,d){var a=b.mountedFolderInfo;if(Boolean(a)&&Boolean(a.webUrl)&&Boolean(a.listViewUrl)&&Boolean(a.itemId)){var c=a.listViewUrl;c=StURLSetVar2(c,"sharingDialogForListItemId",a.itemId);STSNavigate(c)}else if(d){var e=function(a){b.mountedFolderInfo=a;ShareMountPoint(b,false)};EnsureScriptParams("mountpoint.js","GetMountedFolderInfo",b.CurrentItem,e)}}var g_FP_nextId;function FacePile(c){var a=null,e="FP"+String(g_FP_nextId++),b=new Renderer;b.SetTemplate("root-facepile",'{%version 2.0}<div class="ms-table ms-fp-root " role="presentation" aria-label="{=regionLabel}" id="{=idFacePileContainer}"><div class="ms-tableRow ms-fp-row ms-noWrap ms-fp-shared-line" id="{=idFacePileShareWith}">\n                {=htmlSharedWithInfo}\n            </div><div class="ms-fp-tableRow ms-fp-row ms-noWrap" id="{=idFacePile}">\n                {%foreach face users}{%foreach cmdButton buttons}\n            </div></div>');b.SetTemplate("face",'{%version 2.0}<div class="ms-fp-item ms-fp-face" id="{=idUser}"></div>');b.SetTemplate("cmdButton",'{%version 2.0}<button tabIndex="-1" class="ms-verticalAlignTop ms-fp-item ms-fp-button" id="{=idBtn}" onclick="{+itemClick .}" type="button" title="{=tooltip}" role="button"><span class="ms-fp-button-glyph">{=glyph}</span></button>');this.Render=function(e){if(a!==null){a.parentNode.removeChild(a);a=null}e.innerHTML=b.Render("root-facepile",c);a=e.firstChild;d(c,function(a){if(Boolean(a.accessKey)){var b=document.getElementById(a.idBtn);if(!Boolean(b))return;b.setAttribute("accesskey",a.accessKey)}})};this.FillUserFaces=function(c){for(var e=a.querySelectorAll(".ms-fp-face"),b=0;b<e.length;b++)if(Boolean(c[b]))e[b].innerHTML=c[b];var d=a.querySelectorAll("a");for(b=0;b<d.length;b++)d[b].setAttribute("tabIndex","-1")};b.RegisterHandler("itemClick",function(b,a){a.onclick.call(this,b)});b.RegisterHandler("userClick",function(b,a){a.onclick.call(this,b)});f(c);function f(a){a.rootId=e;if(!Boolean(a.users))a.users=[];if(!Boolean(a.buttons))a.buttons=[];for(var b=0;b<a.numUsers;b++){var f={idUser:"idface_"+b.toString()};a.users.push(f)}var c=1;d(a,function(a){if(!Boolean(a.idBtn))a.idBtn=e+"_Button"+String(c++);if(!Boolean(a.buttonClass))a.buttonClass=""})}function d(d,e){for(var b=d.buttons,a=0;a<b.length;a++){var c=b[a];e(c)}}}var c_fpContainerID,c_maxFaces;function AsyncRenderSharedWithFacePile(a,b){SP.SOD.executeFunc("SP.js","SP.ClientContext",function(){SP.QoS.WriteStart("SharedWithFacePile_StartAsyncRender");if(!SupportFacePile(a)){SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender");(window.OffSwitch==null||OffSwitch.IsActive("06E8E26C-8D85-469D-9090-7F7EB9A0C9D8"))&&RemoveFacePile(a);WriteDebugLog("SharedWithFacePile_SuccessAsyncRender",false,"either SharedWithFacePile flight is not on or not mysite pages");return}if(typeof b!="undefined"&&b==""){RemoveFacePile(a);SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender");WriteDebugLog("SharedWithFacePile_SuccessAsyncRender",false,"No FacePile on Document lib root");return}if(!Boolean(a.CurrentItem))if(Boolean(a.CurrentSelectedItem))a.CurrentItem=a.CurrentSelectedItem;else a.CurrentItem=GetListItemDataByRootFolder(a,b);function d(c,j,g){try{var b,l=GetFPElementIDFromRenderCtx(c),f={onError:function(b,a){WriteDebugLog(b,true,a+" - onSuccessToPostRenderFacePile")},htmlShareInfo:"",users:[],buttons:[{idBtn:"fp_ShareBtn",glyph:"&#xE078",tooltip:Strings.STS.L_SharedWithSomeOne,accessKey:Strings.STS.L_AccessKey_SharedWithSomeOne,onclick:function(a){onShareButtonPress(a,c)}},{idBtn:"fp_MailToBtn",glyph:"&#xE009",tooltip:Strings.STS.L_EmailSomeone,accessKey:Strings.STS.L_AccessKey_EmailSomeone,onclick:function(a){onMailToButtonPress(a,c)}}]};f.idFacePileContainer=l;f.idFacePileShareWith=l+"_ShareWith";f.idFacePile=l+"_FacePile";f.regionLabel=Encoding.HtmlEncode(Strings.STS.L_SharedWithFacePileRegion);var k=document.getElementById(c_fpContainerID);f.htmlSharedWithInfo=k.innerHTML;k.innerHTML;var d=[];if(Boolean(g)&&g.length>0){var r=g.length-1;for(b=r;b>=0;b--){var q=i(j,g[b].get_lookupId());Boolean(q)&&d.push(q)}if(d.length<j.length&&d.length<c_maxFaces)for(b=d.length;b<c_maxFaces;b++){var p=e(j);Boolean(p)&&d.push(p)}}else d=j;c.sharedWithUsers=d;var m=0;if(Boolean(a.sharedWithUsers))m=h(c);else WriteDebugLog("SharedWithFacePile_AsyncRenderLog",false,"Could not find folder sharedWithUser information");f.numUsers=m;var n=new FacePile(f);n.Render(k);var s={PictureOnly:"1",PictureSize:"Size_36px",InlineRender:false,InlineRenderMoreAsLink:true},t={EffectivePresenceEnabled:"1",PresenceAlt:"No presence information"},o=[];for(b=0;b<m;b++){var u={title:c.sharedWithUsers[b].title,email:c.sharedWithUsers[b].email,sip:c.sharedWithUsers[b].sip,id:c.sharedWithUsers[b].id,picture:c.sharedWithUsers[b].picture,isDomainGroup:c.sharedWithUsers[b].idDomainGroup};o[b]=RenderUserFieldWorker(a,s,u,t)}n.FillUserFaces(o);typeof ProcessImn!="undefined"&&ProcessImn()}catch(v){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender");return}SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender")}function f(){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender");WriteDebugLog("SharedWithFacePile_FailedAsyncRender",true,"Retrieve sharing information failed during SharingStatus rendering.")}var c=function(b){if(!IsSharedWithItem(b.CurrentItem)){RemoveFacePile(a);SP.QoS.WriteSuccess("SharedWithFacePile_SuccessAsyncRender");WriteDebugLog("SharedWithFacePile_SuccessAsyncRender",false,"The item does not have SharedWith nature");return}try{saveContextByListItemID(b,b.CurrentItem.ID);var c=document.getElementById(c_fpContainerID);CalloutPostRenderSharingStatus(b,c_fpContainerID,d,f)}catch(e){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender")}},g=function(){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender")};function h(a){return!Boolean(a)||!Boolean(a.sharedWithUsers)?0:a.sharedWithUsers.length>c_maxFaces?c_maxFaces:a.sharedWithUsers.length}function i(b,c){for(var a=0;a<b.length;a++)if(b[a].id===c){b[a].dirty=true;return b[a]}WriteDebugLog("GetSharedUserByID",false,"cannot find current userID =="+c);return null}function e(b){for(var a=0;a<b.length;a++)if(!Boolean(b[a].dirty)){b[a].dirty=true;return b[a]}WriteDebugLog("GetNextUndirtySharedUser",false,"all users are used.");return null}try{if(!Boolean(a.CurrentItem)||!IsTwoFoldersEqual(a.CurrentItem.FileRef,b))AsyncGetFolderItem(a,b,c,g);else c(a)}catch(j){SP.QoS.WriteFailure("SharedWithFacePile_FailedAsyncRender")}})}function AsyncGetFolderItem(b,c,k,f){var a=SP.ClientContext.get_current(),d=null,e=null,h=null,g=null;if(!Boolean(b)||!Boolean(c)){WriteDebugLog("FacePile_AsyncGetFolderItem",true,"Invalid parameters renderCtx or rootfolder is null");f()}try{SP.QoS.WriteStart("FacePile_StartAsyncGetFolderItem");if(Boolean(b.RealHttpRoot)&&Boolean(b.HttpRoot)){var l=new SP.RemoteWeb(a,b.HttpRoot);d=l.getFolderByServerRelativeUrl(c)}else{var m=a.get_web();d=m.getFolderByServerRelativeUrl(c)}a.load(d,"Name");if(typeof d.get_listItemAllFields=="function"){e=d.get_listItemAllFields();a.load(e,"Id");a.executeQueryAsync(function(){SP.QoS.WriteSuccess("FacePile_SuccessAsyncGetFolderItem");SP.QoS.WriteStart("FacePile_StartAsyncGetFolderPrincipalCount");h=a.get_web().get_lists().getById(b.listName);g=h.getItemById(e.get_id());a.load(g,"ID","FileLeafRef","FileRef","FSObjType","PrincipalCount");a.executeQueryAsync(i,j)},function(b,a){WriteDebugLog("FacePile_AsyncGetFolderItem",true,"CSOM call to get Folder listItem failed for rootfolder: "+c+a.get_message());SP.QoS.WriteFailure("FacePile_FailAsyncGetFolderItem");f()})}else SP.QoS.WriteFailure("FacePile_FailAsyncGetFolderItem")}catch(n){WriteDebugLog("FacePile_AsyncGetFolderItem",true,"CSOM call to get Folder listItem failed for rootfolder with exception: "+c);SP.QoS.WriteFailure("FacePile_FailAsyncGetFolderItem")}var i=function(){var a=g.get_fieldValues(),c={ID:a.ID.toString(),FileLeafRef:a.FileLeafRef,FileRef:a.FileRef,FSObjType:a.FSObjType,PrincipalCount:a.PrincipalCount};b.CurrentItem=c;SP.QoS.WriteSuccess("FacePile_SuccessAsyncGetFolderPrincipalCount");k(b)},j=function(b,a){SP.QoS.WriteFailure("FacePile_FailAsyncGetFolderPrincipalCount");WriteDebugLog("FacePile_AsyncGetFolderPrincipalCount",true,"CSOM call to get Folder principal count failed at rootfolder: "+c+a.get_message());f()}}function RemoveFacePile(){var a=document.getElementById(c_fpContainerID);if(Boolean(a))a.innerHTML=""}function SupportFacePile(a){return Boolean(a)&&a.ListTemplateType==700&&a.BaseViewID==51&&!a.inGridMode&&Flighting.VariantConfiguration.IsExpFeatureClientEnabled(324)}function IsSharedWithItem(a){return!Boolean(a)?false:Boolean(a)&&a.FSObjType=="1"&&a.PrincipalCount>"0"?true:false}function IsTwoFoldersEqual(a,b){return unescape(a).toLowerCase()==unescape(b).toLowerCase()?true:false}function GetListItemDataByRootFolder(a,e){if(a==null||typeof a.rootFolder=="undefined"&&typeof e=="undefined"||a.ListData==null){WriteDebugLog("GetListItemDataByRootFolder",false,"cannot find current list item due to incomplete context or without rood folder specified.");return null}var c=a.ListData.Row;if(c==null){WriteDebugLog("GetListItemDataByRootFolder",false,"current item ListData row is null.");return null}var f=c.length,b=a.rootFolder;if(!Boolean(b)&&Boolean(e))b=e;b=URI.decodeURIComponent(b);for(var d=0;d<f;d++)if(c[d].FileRef===b)return c[d];return null}function GetFPElementIDFromRenderCtx(){return"idFPRoot"}function GenerateContextKey(a){return"FacePileCtx-"+a}function saveContextByListItemID(a,e){var b=GenerateContextKey(e),d=Boolean(a.rootFolder.indexOf("/")!=-1)?URI_Encoding.encodeURIComponent(a.rootFolder):a.rootFolder,c=GenerateContextKey(d);if(!Boolean(window[b])){if(!Boolean(a.facePileContainerItems))a.facePileContainerItems=[];a.facePileContainerItems[c]=a.CurrentItem;a.facePileContainerItems[b]=a.CurrentItem;window[b]=a;window[c]=a;if(Boolean(g_ctxDict)){g_ctxDict[b]=a;g_ctxDict[c]=a}}}function getContextByListItemIdOrRootFolder(d,c){var e=Boolean(c)&&Boolean(c.indexOf("/")!=-1)?URI_Encoding.encodeURIComponent(c):c,b=Boolean(d)?GenerateContextKey(d):GenerateContextKey(e),a=null;if(Boolean(window[b]))a=window[b];else if(Boolean(g_ctxDict[b]))a=g_ctxDict[b];if(Boolean(a)&&Boolean(a.facePileContainerItems))a.CurrentItem=a.facePileContainerItems[b];return a}function sharingModifiedCallbackFacePile(c,b){var a=getContextByListItemIdOrRootFolder(b,null);Boolean(a)&&AsyncRenderSharedWithFacePile(a,a.rootFolder)}function bindSharingEventsForFacePile(){m$(document).bind("SharingEvents.SharingAdded",sharingModifiedCallbackFacePile);m$(document).bind("SharingEvents.SharingModified",sharingModifiedCallbackFacePile)}function EnsureCtxCurrentItem(a){if(Boolean(a.CurrentItem))return a.CurrentItem;else if(!Boolean(a.CurrentItem)&&Boolean(a.rootFolder)){var b=getContextByListItemIdOrRootFolder(null,a.rootFolder);return Boolean(b)?b.CurrentItem:null}return null}function onShareButtonPress(b,a){SP.QoS.WriteUserEngagement("OneDrive_FacePile_OnShareBtnPress");CloseAllMenusAndCallouts();a.CurrentItem=EnsureCtxCurrentItem(a);typeof DisplaySharingDialogForListItem=="function"&&Boolean(a.CurrentItem)&&DisplaySharingDialogForListItem(a,a.CurrentItem.ID)}function onMailToButtonPress(j,a){SP.QoS.WriteUserEngagement("OneDrive_FacePile_OnMailToBtnPress");var f=[],g=document.getElementById("fp_MailToBtn"),c=null,b=null;a.CurrentItem=EnsureCtxCurrentItem(a);if(Boolean(a.CurrentItem)){c=a.CurrentItem.FileLeafRef;var i=a.CurrentItem.FileRef;b=getHostUrl(ajaxNavigate.get_href())+i}else if(Boolean(a.rootFolder)){var d=URI.decodeURIComponent(a.rootFolder);c=d.substring(d.lastIndexOf("/")+1);b=getHostUrl(ajaxNavigate.get_href())+d}else WriteDebugLog("FacePIle_onMailToButtonPress",false,"Neither CurrentItem nor renderCtx.rootFolder is set when click MailTo cmd.");if(Boolean(a.sharedWithUsers))for(var h=a.sharedWithUsers.length>30?30:a.sharedWithUsers.length,e=0;e<h;e++)f.push(a.sharedWithUsers[e].email);ConfigEmailLinkHelper(f,g,c,b)}function IsWebPartRegisteredForDragDrop(b){var a="WebPart"+b;return!fIsNullOrUndefined(g_spDragDropUpload)&&!fIsNullOrUndefined(g_spDragDropUpload[a])&&!fIsNullOrUndefined(getCtx(a))}function EasyUploadOrNewItem2(a,c,d,b){if(c&&IsWebPartRegisteredForDragDrop(b))HandleEasyUploadButtonClick(a,b);else NewItem2(a,d)}function HandleEasyUploadButtonClick(b,d){SP.QoS.WriteUserEngagement("EasyUpload_ButtonClick");var c=document.getElementById("easyUploadFile"+d);!fIsNullOrUndefined(c)&&c.click();if(!fIsNullOrUndefined(b.target)&&b.target.style.display!="none")b.target.focus();else{var a=document.querySelector("div.ms-dnd-progressInfo-inline");!fIsNullOrUndefined(a)&&a.style.display!="none"&&a.focus()}}function HandleEasyUploadInputOnChange(c,a,b){EnsureScriptFunc("dragdrop.js","registerDragUpload",function(){SP.QoS.WriteUserEngagement("EasyUpload_InputFileChange");TryPrepUploadDialogToDragDrop("WebPart"+b);UploadDialogToDragDrop(a.files,null,null,false,"EasyUpload")})}function _OpenViewSelectorPivotOptions(d,i){if(d==null)d=window.event;var b=g_ctxDict["ctx"+i];if(b==null)return;var h=b.wpq+"_ListTitleViewSelectorMenu_Container",g=document.getElementById(h),e=ClientPivotControl.PivotControlDict[h];if(g==null||e==null)return;if(g.getAttribute("data-viewsLoaded")=="true"){ClientPivotControlExpandOverflowMenu(d);return}var k=Boolean(b.RealHttpRoot)?b.HttpRoot:_spPageContextInfo.webServerRelativeUrl,j="_layouts/"+_spPageContextInfo.webUIVersion.toString()+"/vsmenu.aspx",f=b.ListSchema.ViewSelector_ViewParameters;if(f==null)f="";var a=[];a.push(GetUrlFromWebUrlAndWebRelativeUrl(k,j));a.push("?List=");a.push(escapeProperly(b.listName));a.push("&View=");a.push(escapeProperly(b.view));a.push("&Source=");a.push(escapeProperly(window.location.href));a.push("&RootFolder=");a.push(b.rootFolder);if(f!=""){a.push("&");a.push(escapeProperly(f))}var c=new XMLHttpRequest;c.open("POST",a.join(""),true);c.setRequestHeader("Content-Type","application/json");c.onreadystatechange=function(){if(c.readyState==4&&c.status!=601){for(var viewData=eval(c.responseText),idx=0;idx<viewData.length;idx++){var overflowItem=viewData[idx];if(overflowItem.Text==b.viewTitle)continue;if(overflowItem.ItemType=="MenuItem"){var overflowOpt=new ClientPivotControlMenuOption;overflowOpt.DisplayText=overflowItem.Text;overflowOpt.Description=overflowItem.Description;overflowOpt.OnClickAction=overflowItem.ActionScriptText;overflowOpt.ImageUrl=overflowItem.ImageSourceUrl;overflowOpt.ImageAltText=overflowItem.Text;overflowOpt.SelectedOption=b.viewTitle==overflowItem.Text;e.AddMenuOption(overflowOpt)}else overflowItem.ItemType=="MenuSeparator"&&e.AddMenuSeparator()}e.ProcessAllMenuItems();e.EnsureSelectedOption();ClientPivotControlExpandOverflowMenu(d);g.setAttribute("data-viewsLoaded","true")}};c.send("");d!=null&&DOM.CancelEvent(d)}function GetClientAppNameFromMapApp(b){var a={excel:"Microsoft Excel",onenote:"Microsoft OneNote",powerpoint:"Microsoft PowerPoint",project:"Microsoft Project",publisher:"Microsoft Publisher",visio:"Microsoft Visio",word:"Microsoft Word",infopath:"Microsoft InfoPath"};return b in a?a[b]:null}var g_ClipboardControl,g_IsClipboardControlValid;function EnsureClipboardControl(){if(m$.isUndefinedOrNull(g_ClipboardControl))try{if(m$.isDefinedAndNotNull(window.ActiveXObject)){g_ClipboardControl=new window.ActiveXObject("SharePoint.ClipboardCtl.1");g_IsClipboardControlValid=true}else if(IsSupportedMacBrowser()){g_ClipboardControl=CreateMacPlugin();if(g_ClipboardControl!=null)g_IsClipboardControlValid=m$.isDefinedAndNotNull(g_ClipboardControl.CopyToClipboard)}else if(IsSupportedNPApiBrowserOnWin()){g_ClipboardControl=CreateNPApiOnWindowsPlugin("application/x-sharepoint");g_IsClipboardControlValid=m$.isDefinedAndNotNull(g_ClipboardControl.CopyToClipboard)}}catch(a){g_ClipboardControl=null;g_IsClipboardControlValid=false}return g_IsClipboardControlValid}function CopyToClipboard(b,a){EnsureClipboardControl()&&g_ClipboardControl.CopyToClipboard(b,a)}function _ListHeaderTouchHandler(h){var a=GetEventSrcElement(h),e,b;if(a==null)return false;e=a.tagName=="TH"?a:GetSelectedElement(a,"TH");for(var f=e.getElementsByTagName("DIV"),c=0;c<f.length;c++)if(f[c].hasAttribute("CTXNum")){b=f[c];break}if(e!=null&&b!=null){if(bMenuLoadInProgress)return true;var g=false;if(IsFilterMenuOn()){var d=null;if(filterTable!=null&&filterTable.parentNode!=null)d=filterTable.parentNode.getElementsByClassName("ms-core-menu-box")[0];if(d!=null&&IsContained(a,d)||IsContained(a,currentFilterMenu))return false;if(filterTable==b)g=true;MenuHtc_hide()}!g&&OnMouseOverFilterDeferCall(b)&&CreateFilterMenu(h)}return true}var FollowDocumentFromEmail,PrepareYammerEnvironment,FollowSelectedDocument,IsSPSocialSwitchEnabled;$_global_core();